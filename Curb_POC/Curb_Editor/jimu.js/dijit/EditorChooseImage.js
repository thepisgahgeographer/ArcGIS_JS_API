// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo dijit dijit/_editor/_Plugin jimu/dijit/ImageChooser dojo/_base/html dojo/_base/lang dojo/i18n dojo/_base/connect dojo/_base/declare".split(" "),function(c,g,h,d,e,l,m){c.experimental("dojox.editor.plugins.ChooseImage");var f=c.declare("dojox.editor.plugins.ChooseImage",h,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,_initButton:function(){this.createFileInput();this.command="chooseImage";var a=m.getLocalization("dijit._editor","commands");this.button=new g.form.Button({label:a.insertImage,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"UploadImage",tabIndex:"-1",onClick:l.hitch(this,this._chooseImage)});this.button.set("readOnly",!1);this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){var a=this.get("disabled");this.button.set("disabled",this.get("disabled"));!0===a?(e.addClass(this.button,"dijitButtonDisabled"),this.imageChooser.disableChooseImage()):(e.removeClass(this.button,
"dijitButtonDisabled"),this.imageChooser.enableChooseImage())},createFileInput:function(){var a=c.create("span",{innerHTML:"."},document.body);this.imageChooser=new d({showSelfImg:!1,cropImage:!1,format:[d.GIF,d.JPEG,d.PNG]},a);this.connect(this.imageChooser,"onImageChange","insertTempImage")},_chooseImage:function(){e.setStyle(this.imageChooser.domNode,"display","none");this.imageChooser.triggerImgUpload()},onComplete:function(a){a=a[0];var b=c.byId(this.currentImageId,this.editor.document);var k=
this.downloadPath?this.downloadPath+a.name:a.file;b.src=k;c.attr(b,"_djrealurl",k);a.width&&(b.width=a.width,b.height=a.height)},insertTempImage:function(a,b){b=b&&b.fileName?'alt\x3d"'+b.fileName+'"':"";this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+a+'" '+b+"/\x3e")},destroy:function(){this.imageChooser&&this.imageChooser.destroy();this.inherited(arguments)}});c.subscribe(g._scopeName+".Editor.getPlugin",null,
function(a){if(!a.plugin)switch(a.args.name){case "chooseImage":a.plugin=new f({url:a.args.url})}});h.registry.chooseImage=function(a){return new f(a)};return f});