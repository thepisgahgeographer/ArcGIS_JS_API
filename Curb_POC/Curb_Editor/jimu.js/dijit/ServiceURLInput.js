// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),function(g,a,d,h,k,f,l,m){return g([m],{_validatingNode:null,_validNode:null,_inValidNode:null,_fetchHandle:null,_fetchErrHandle:null,declaredClass:"jimu.dijit.ServiceURLInput",verify:!0,_status:null,postCreate:function(){this.inherited(arguments);this._validatingNode=a.create("div",{"class":"jimu-service-validating"},this.domNode);this._validNode=a.create("div",
{"class":"jimu-service-valid"},this.domNode);this._inValidNode=a.create("div",{"class":"jimu-service-invalid jimu-icon jimu-icon-error"},this.domNode);a.addClass(this.domNode,"jimu-serviceurl-input");this.verify&&this.own(h(this,"Change",d.hitch(this,"_onServiceUrlChange")))},setProcessFunction:function(b,c){this._fetchHandle&&this._fetchErrHandle&&this._removeProcessFunction();"function"===typeof b&&(this._fetchHandle=f.after(this,"onFetch",b),this.own(this._fetchHandle));"function"===typeof c&&
(this._fetchErrHandle=f.after(this,"onFetchError",c),this.own(this._fetchErrHandle))},_removeProcessFunction:function(){this._fetchHandle&&this._fetchHandle.remove&&(this._fetchHandle.remove(),this._fetchHandle=null);this._fetchErrHandle&&this._fetchErrHandle.remove&&(this._fetchErrHandle.remove(),this._fetchErrHandle=null)},onFetch:function(b){return b},onFetchError:function(b){},getStatus:function(){return this._status},_onServiceUrlChange:function(b){var c=new k;c.then(d.hitch(this,function(){this._valid()}),
d.hitch(this,function(){this._inValid();this.onFetchError()}));this._validating();b?l({url:d.trim(b||""),handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(d.hitch(this,function(e){this.onFetch({url:this.getValue(),data:e})?c.resolve("success"):c.reject("error")}),d.hitch(this,function(e){c.reject(e)})):c.reject("error")},_validating:function(){this._status="validating";a.removeClass(this.domNode,"jimu-serviceurl-input-invalid");a.removeClass(this.domNode,"jimu-serviceurl-input-valid");
a.addClass(this.domNode,"jimu-serviceurl-input-validating")},_valid:function(){this._status="valid";a.removeClass(this.domNode,"jimu-serviceurl-input-invalid");a.removeClass(this.domNode,"jimu-serviceurl-input-validating");a.addClass(this.domNode,"jimu-serviceurl-input-valid")},_inValid:function(){this._status="invalid";a.removeClass(this.domNode,"jimu-serviceurl-input-validating");a.removeClass(this.domNode,"jimu-serviceurl-input-valid");a.addClass(this.domNode,"jimu-serviceurl-input-invalid")}})});