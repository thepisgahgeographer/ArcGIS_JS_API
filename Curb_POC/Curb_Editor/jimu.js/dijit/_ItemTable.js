// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(t,u,v,w,x,y,h,q,c,B,e,C,z,r,A,D){return t([u,v,w,y],{templateString:x,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,
hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=A.getStandardPortalUrl(this.portalUrl));this.showAllItemsSection();this.searchAllItems()},
show:function(){c.setStyle(this.domNode,"display","block")},hide:function(){c.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=h.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),r.getPortal(this.portalUrl).queryItems(this.query).then(h.hitch(this,function(b){this.domNode&&(this.allItemsShelter.hide(),this.query.start=b.nextStart,this._createItems(b,this.allItemTbody))}),
h.hitch(this,function(b){console.error(b);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=h.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),r.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(h.hitch(this,function(b){this.domNode&&(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),
this.filteredQuery.start=b.nextStart,this._createItems(b,this.filteredItemsTbody),this._filterItemCallback())}),h.hitch(this,function(b){console.error(b);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(c.setStyle(this.filteredItemsTableDiv,"display","block"),c.setStyle(this.searchNoneTipSection,"display","none")):(c.setStyle(this.filteredItemsTableDiv,"display","none"),c.setStyle(this.searchNoneTipSection,
"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){c.empty(this.allItemTbody)},clearFilteredItemsSection:function(){c.empty(this.filteredItemsTbody)},showAllItemsSection:function(){c.setStyle(this.allItemsSection,"display","block");c.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){c.setStyle(this.allItemsSection,"display","none");c.setStyle(this.filteredItemsSection,"display","block");
c.setStyle(this.filteredItemsTableDiv,"display","block");c.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return z.isScrollToBottom(a)},_createItems:function(a,b){a=a.results;var p=q.map(this.types,h.hitch(this,function(n){return n.toLowerCase()}));
a=q.filter(a,h.hitch(this,function(n){n=n.type&&n.type.toLowerCase()||"";return 0<=q.indexOf(p,n)}));if(0!==a.length){var k=e("td.empty",b),d;if(0<k.length){var f=Math.min(a.length,k.length),l=a.splice(0,f);for(d=0;d<f;d++){var m=k[d];var g=this._createItem(l[d]);c.place(g,m);c.removeClass(m,"empty")}}if(0!==a.length){k=Math.ceil(a.length/2);for(d=0;d<k;d++)for(g=c.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),c.place(g,b),f=e("td",g),l=0;l<f.length;l++)m=f[l],(g=a[2*d+
l])?(g=this._createItem(g),c.place(g,m)):c.addClass(m,"empty");this.emit("update")}}},_getItemCount:function(a){return e(".item",a).length},_createItem:function(a){var b=c.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
b.item=a;var p=e(".item-thumbnail",b)[0],k=e(".item-name",b)[0],d=e(".item-type-owner",b)[0],f=e(".item-date",b)[0],l=e(".item-details",b)[0],m=e(".none-thumbnail-tip",b)[0];if(!a.thumbnailUrl){var g=this._defaultThumbnail[a.type];g&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+g)}a.thumbnailUrl?c.setStyle(p,"backgroundImage","url("+a.thumbnailUrl+")"):m.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(f=e(".item-info",b)[0],this.onCreateItemContent(a,f)):(k.innerHTML=
a.title,k.title=k.innerHTML,d.innerHTML=a.type+" by "+a.owner,d.title=d.innerHTML,p=new Date,p.setTime(a.modified),f.innerHTML=p.toLocaleString(),f.title=f.innerHTML,l.innerHTML=this.nls.moreDetails,l.href=a.detailsPageUrl||"#");return b},_onItemsTableClicked:function(a){var b=a.target||a.srcElement;a=null;c.hasClass(b,"item-thumbnail")?a=b.parentNode:c.hasClass(b,"none-thumbnail-tip")&&(a=b.parentNode.parentNode);a&&(b=c.hasClass(a,"jimu-state-active"),e(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
b?c.removeClass(a,"jimu-state-active"):c.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,b=e(".item.jimu-state-active",this.domNode);0<b.length&&(a=h.mixin({},b[0].item));return a}})});