// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),function(v,C,L,I,H,c,
b,g,f,m,q,n,u,z,D,d,l,G,P,p,t,y,F,N,x){function E(h){return new p({command:h.name})}function k(h){return new p({buttonClass:P,command:h.name})}L=L("dijit.Editor",N,{plugins:null,extraPlugins:null,constructor:function(){q.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",t]);this._plugins=[];this._editInterval=
1E3*this.editActionInterval;if(n("ie")||n("trident")||n("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new I;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);q.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=H.getLocalization("dijit._editor","commands",this.lang);
n("webkit")&&f.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new d({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));C.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);b.add(this.iframe.parentNode,"dijitEditorIFrameContainer");b.add(this.iframe,"dijitEditorIFrame");c.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){C.forEach(this._plugins,function(h){h&&h.destroy&&h.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(h,B){var M=q.isString(h)?{name:h}:q.isFunction(h)?{ctor:h}:h;if(!M.setEditor){var a={args:M,plugin:null,editor:this};M.name&&(p.registry[M.name]?a.plugin=p.registry[M.name](M):z.publish(x._scopeName+".Editor.getPlugin",a));if(!a.plugin)try{var e=M.ctor||q.getObject(M.name)||
v(M.name);e&&(a.plugin=new e(M))}catch(r){throw Error(this.id+": cannot find plugin ["+M.name+"]");}if(!a.plugin)throw Error(this.id+": cannot find plugin ["+M.name+"]");h=a.plugin}1<arguments.length?this._plugins[B]=h:this._plugins.push(h);h.setEditor(this);q.isFunction(h.setToolbar)&&h.setToolbar(this.toolbar)},resize:function(h){h&&G.prototype.resize.apply(this,arguments)},layout:function(){var h=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+g.getPadBorderExtents(this.iframe.parentNode).h+
g.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=h+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(h){var B,M=this.document.body,a=M.clientWidth,e=M.clientHeight,r=M.clientLeft,A=M.offsetWidth,w=M.offsetHeight,J=M.offsetLeft;/^rtl$/i.test(M.dir||"")?a<A&&h.x>a&&h.x<A&&(B=!0):h.x<r&&h.x>J&&(B=!0);B||e<w&&h.y>e&&h.y<w&&(B=!0);B||(delete this._cursorToStart,delete this._savedSelection,"BODY"==h.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(h){this.customUndo&&this.endEditing(!0);"BODY"!=h.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(h){this._inEditing||(this._inEditing=!0,this._beginEditing(h));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(h){if(!this.customUndo||
"undo"!=h&&"redo"!=h){this.customUndo&&(this.endEditing(),this._beginEditing());var B=this.inherited(arguments);this.customUndo&&this._endEditing();return B}return this[h]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(h){try{var B=this.document.execCommand(h,!1,null);if(n("webkit")&&!B)throw{};}catch(M){B=u.substitute,alert(B(this.commands.systemShortcut,
[this.commands[h],B(this.commands[n("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[h]])])),B=!1}return B},queryCommandEnabled:function(h){return!this.customUndo||"undo"!=h&&"redo"!=h?this.inherited(arguments):"undo"==h?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(h){var B=h.mark,M=h.mark;h=h.isCollapsed;var a;if(M)if(9>n("ie")||9===n("ie")&&n("quirks"))if(q.isArray(M))B=[],C.forEach(M,function(A){B.push(F.getNode(A,this.editNode))},this),this.selection.moveToBookmark({mark:B,
isCollapsed:h});else{if(M.startContainer&&M.endContainer&&(a=F.getSelection(this.window))&&a.removeAllRanges){a.removeAllRanges();h=F.create(this.window);var e=F.getNode(M.startContainer,this.editNode);var r=F.getNode(M.endContainer,this.editNode);e&&r&&(h.setStart(e,M.startOffset),h.setEnd(r,M.endOffset),a.addRange(h))}}else(a=F.getSelection(this.window))&&a.removeAllRanges&&(a.removeAllRanges(),h=F.create(this.window),e=F.getNode(M.startContainer,this.editNode),r=F.getNode(M.endContainer,this.editNode),
e&&r&&(h.setStart(e,M.startOffset),h.setEnd(r,M.endOffset),a.addRange(h)))},_changeToStep:function(h,B){this.setValue(B.text);(h=B.bookmark)&&this._moveToBookmark(h)},undo:function(){var h=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var B=this._steps.pop();B&&0<this._steps.length&&(this.focus(),this._changeToStep(B,this._steps[this._steps.length-1]),this._undoedSteps.push(B),this.onDisplayChanged(),delete this._undoRedoActive,h=!0);delete this._undoRedoActive}return h},
redo:function(){var h=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var B=this._undoedSteps.pop();B&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],B),this._steps.push(B),this.onDisplayChanged(),h=!0);delete this._undoRedoActive}return h},endEditing:function(h){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(h),this._inEditing=!1)},_getBookmark:function(){var h=this.selection.getBookmark(),
B=[];if(h&&h.mark){var M=h.mark;if(9>n("ie")||9===n("ie")&&n("quirks")){var a=F.getSelection(this.window);if(q.isArray(M))C.forEach(h.mark,function(r){B.push(F.getIndex(r,this.editNode).o)},this),h.mark=B;else if(a){var e;a.rangeCount&&(e=a.getRangeAt(0));h.mark=e?e.cloneRange():this.selection.getBookmark()}}try{h.mark&&h.mark.startContainer&&(B=F.getIndex(h.mark.startContainer,this.editNode).o,h.mark={startContainer:B,startOffset:h.mark.startOffset,endContainer:h.mark.endContainer===h.mark.startContainer?
B:F.getIndex(h.mark.endContainer,this.editNode).o,endOffset:h.mark.endOffset})}catch(r){h.mark=null}}return h},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:y.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var h=y.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:h,bookmark:this._getBookmark()})},onKeyDown:function(h){n("ie")||this.iframe||h.keyCode!=m.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var B=
h.keyCode;if(h.ctrlKey&&!h.shiftKey&&!h.altKey){if(90==B||122==B){h.stopPropagation();h.preventDefault();this.undo();return}if(89==B||121==B){h.stopPropagation();h.preventDefault();this.redo();return}}this.inherited(arguments);switch(B){case m.ENTER:case m.BACKSPACE:case m.DELETE:this.beginEditing();break;case 88:case 86:if(h.ctrlKey&&!h.altKey&&!h.metaKey){this.endEditing();88==h.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!h.ctrlKey&&!h.altKey&&
!h.metaKey&&(h.keyCode<m.F1||h.keyCode>m.F15)){this.beginEditing();break}case m.ALT:this.endEditing();break;case m.UP_ARROW:case m.DOWN_ARROW:case m.LEFT_ARROW:case m.RIGHT_ARROW:case m.HOME:case m.END:case m.PAGE_UP:case m.PAGE_DOWN:this.endEditing(!0);case m.CTRL:case m.SHIFT:case m.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(h){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(h){this.customUndo?this.isClosed?this.setValue(h):(this.beginEditing(),h||(h="\x26#160;"),this.setValue(h),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(h){this.setValueDeferred.then(q.hitch(this,function(){!this.disabled&&h||!this._buttonEnabledPlugins&&h?
C.forEach(this._plugins,function(B){B.set("disabled",!0)}):this.disabled&&!h&&C.forEach(this._plugins,function(B){B.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(f.set(this.document.body,"color",f.get(this.iframe,"color")),f.set(this.document.body,"background-color",f.get(this.iframe,"background-color")))}catch(h){}}});q.mixin(p.registry,{undo:E,redo:E,cut:E,copy:E,paste:E,insertOrderedList:E,insertUnorderedList:E,
indent:E,outdent:E,justifyCenter:E,justifyFull:E,justifyLeft:E,justifyRight:E,"delete":E,selectAll:E,removeFormat:E,unlink:E,insertHorizontalRule:E,bold:k,italic:k,underline:k,strikethrough:k,subscript:k,superscript:k,"|":function(){return new p({setEditor:function(h){this.editor=h;this.button=new l({ownerDocument:h.ownerDocument})}})}});return L})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(v,C,L,I,H,c,b,g){L("dijit-legacy-requires")&&H(0,function(){v(["dijit/ToolbarSeparator"])});return C("dijit.Toolbar",[c,g,b],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(v,C,L,I){return v("dijit.ToolbarSeparator",[L,I],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);C.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(v,C,L,I,H){C=C("dijit._editor._Plugin",I,{constructor:function(c){this.params=
c||{};L.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:H,disabled:!1,getLabel:function(c){return this.editor.commands[c]},_initButton:function(){if(this.command.length){var c=this.getLabel(this.command),b=this.editor,g=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(c=L.mixin({label:c,ownerDocument:b.ownerDocument,dir:b.dir,
lang:b.lang,showLabel:!1,iconClass:g,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete c.name,this.button=new this.buttonClass(c))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(c,b,g){this.own(v.connect(c,b,this,g))},updateState:function(){var c=this.editor,b=this.command;if(c&&c.isLoaded&&b.length){var g=this.get("disabled");if(this.button)try{var f=
c._implCommand(b);var m=!g&&(this[f]?this[f](b):c.queryCommandEnabled(b));this.enabled!==m&&(this.enabled=m,this.button.set("disabled",!m));if(m&&"boolean"==typeof this.button.checked){var q=c.queryCommandState(b);this.checked!==q&&(this.checked=q,this.button.set("checked",c.queryCommandState(b)))}}catch(n){console.log(n)}}},setEditor:function(c){this.editor=c;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",L.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",L.hitch(this,"updateState")))},setToolbar:function(c){this.button&&c.addChild(this.button)},set:function(c,b){if("object"===typeof c){for(var g in c)this.set(g,c[g]);return this}g=this._getAttrNames(c);if(this[g.s])var f=this[g.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(c,b);return f||this},get:function(c){var b=this._getAttrNames(c);
return this[b.g]?this[b.g]():this[c]},_setDisabledAttr:function(c){this._set("disabled",c);this.updateState()},_getAttrNames:function(c){var b=this._attrPairNames;if(b[c])return b[c];var g=c.charAt(0).toUpperCase()+c.substr(1);return b[c]={s:"_set"+g+"Attr",g:"_get"+g+"Attr"}},_set:function(c,b){this[c]=b}});C.registry={};return C})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q){return v("dijit._editor.plugins.EnterKeyHandling",f,{blockNodeForEnter:"BR",constructor:function(n){n&&("blockNodeForEnter"in n&&(n.blockNodeForEnter=n.blockNodeForEnter.toUpperCase()),I.mixin(this,n))},setEditor:function(n){if(this.editor!==n)if(this.editor=n,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,n.onLoadDeferred.then(I.hitch(this,function(z){this.own(H(n.document,"keydown",I.hitch(this,function(D){if(D.keyCode==L.ENTER){var d=I.mixin({},D);d.shiftKey=
!0;this.handleEnterKey(d)||(D.stopPropagation(),D.preventDefault())}})));9<=c("ie")&&10>=c("ie")&&this.own(H(n.document,"paste",I.hitch(this,function(D){setTimeout(I.hitch(this,function(){var d=this.editor.document.selection.createRange();d.move("character",-1);d.select();d.move("character",1);d.select()}),0)})));return z}));else if(this.blockNodeForEnter){var u=I.hitch(this,"handleEnterKey");n.addKeyHandler(13,0,0,u);n.addKeyHandler(13,0,1,u);this.own(this.editor.on("KeyPressed",I.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var n=this.editor.selection.getAncestorElement("LI");if(n){c("mozilla")&&"LI"==n.parentNode.parentNode.nodeName&&(n=n.parentNode.parentNode);var u=n.firstChild;!u||1!=u.nodeType||"UL"!=u.nodeName&&"OL"!=u.nodeName||(n.insertBefore(u.ownerDocument.createTextNode("\u00a0"),u),u=q.create(this.editor.window),u.setStart(n.firstChild,0),n=q.getSelection(this.editor.window,!0),n.removeAllRanges(),n.addRange(u))}else m.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(n=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(n.innerHTML=this.bogusHtmlContent,9>=c("ie")&&(n=this.editor.document.selection.createRange(),n.move("character",-1),n.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(n){var u,z=this.editor.document,D;if(n.shiftKey){n=this.editor.selection.getParentElement();if(u=q.getAncestor(n,this.blockNodes)){if("LI"==u.tagName)return!0;n=q.getSelection(this.editor.window);var d=n.getRangeAt(0);d.collapsed||(d.deleteContents(),n=q.getSelection(this.editor.window),d=n.getRangeAt(0));if(q.atBeginningOfContainer(u,d.startContainer,d.startOffset)){var l=z.createElement("br");d=q.create(this.editor.window);u.insertBefore(l,
u.firstChild);d.setStartAfter(l);n.removeAllRanges();n.addRange(d)}else if(q.atEndOfContainer(u,d.startContainer,d.startOffset))d=q.create(this.editor.window),l=z.createElement("br"),u.appendChild(l),u.appendChild(z.createTextNode("\u00a0")),d.setStart(u.lastChild,0),n.removeAllRanges(),n.addRange(d);else{if((D=d.startContainer)&&3==D.nodeType){var G=D.nodeValue;var P=z.createTextNode(G.substring(0,d.startOffset));var p=z.createTextNode(G.substring(d.startOffset));u=z.createElement("br");""==p.nodeValue&&
c("webkit")&&(p=z.createTextNode("\u00a0"));C.place(P,D,"after");C.place(u,P,"after");C.place(p,u,"after");C.destroy(D);d=q.create(this.editor.window);d.setStart(p,0);n.removeAllRanges();n.addRange(d);return!1}return!0}}else n=q.getSelection(this.editor.window),n.rangeCount?(d=n.getRangeAt(0))&&d.startContainer&&(d.collapsed||(d.deleteContents(),n=q.getSelection(this.editor.window),d=n.getRangeAt(0)),(D=d.startContainer)&&3==D.nodeType?(u=d.startOffset,D.length<u&&(p=this._adjustNodeAndOffset(D,u),
D=p.node,u=p.offset),G=D.nodeValue,P=z.createTextNode(G.substring(0,u)),p=z.createTextNode(G.substring(u)),u=z.createElement("br"),p.length||(p=z.createTextNode("\u00a0")),P.length?C.place(P,D,"after"):P=D,C.place(u,P,"after"),C.place(p,u,"after"),C.destroy(D)):(0<=d.startOffset&&(l=D.childNodes[d.startOffset]),u=z.createElement("br"),p=z.createTextNode("\u00a0"),l?(C.place(u,l,"before"),C.place(p,u,"after")):(D.appendChild(u),D.appendChild(p))),d=q.create(this.editor.window),d.setStart(p,0),d.setEnd(p,
p.length),n.removeAllRanges(),n.addRange(d),this.editor.selection.collapse(!0)):m.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var t=!0;n=q.getSelection(this.editor.window);d=n.getRangeAt(0);d.collapsed||(d.deleteContents(),n=q.getSelection(this.editor.window),d=n.getRangeAt(0));l=q.getBlockAncestor(d.endContainer,null,this.editor.editNode);var y=l.blockNode;if(this._checkListLater=y&&("LI"==y.nodeName||"LI"==y.parentNode.nodeName))return c("mozilla")&&(this._pressedEnterInBlock=
y),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(y.innerHTML)&&(y.innerHTML="",c("webkit")&&(d=q.create(this.editor.window),d.setStart(y,0),n.removeAllRanges(),n.addRange(d)),this._checkListLater=!1),!0;if(!l.blockNode||l.blockNode===this.editor.editNode){try{m.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(F){}l={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(l.blockNode){if(l.blockNode!=this.editor.editNode&&!(l.blockNode.textContent||l.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(l.blockNode),!1}else l.blockNode=this.editor.editNode;n=q.getSelection(this.editor.window);d=n.getRangeAt(0)}y=z.createElement(this.blockNodeForEnter);y.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(l.blockNode);p=d.endOffset;t=d.endContainer;t.length<p&&(p=this._adjustNodeAndOffset(t,p),t=
p.node,p=p.offset);if(q.atEndOfContainer(l.blockNode,t,p))l.blockNode===l.blockContainer?l.blockNode.appendChild(y):C.place(y,l.blockNode,"after"),t=!1,d=q.create(this.editor.window),d.setStart(y,0),n.removeAllRanges(),n.addRange(d),this.editor.height&&g.scrollIntoView(y);else if(q.atBeginningOfContainer(l.blockNode,d.startContainer,d.startOffset))C.place(y,l.blockNode,l.blockNode===l.blockContainer?"first":"before"),y.nextSibling&&this.editor.height&&(d=q.create(this.editor.window),d.setStart(y.nextSibling,
0),n.removeAllRanges(),n.addRange(d),g.scrollIntoView(y.nextSibling)),t=!1;else{l.blockNode===l.blockContainer?l.blockNode.appendChild(y):C.place(y,l.blockNode,"after");t=!1;l.blockNode.style&&y.style&&l.blockNode.style.cssText&&(y.style.cssText=l.blockNode.style.cssText);if((D=d.startContainer)&&3==D.nodeType){p=d.endOffset;D.length<p&&(p=this._adjustNodeAndOffset(D,p),D=p.node,p=p.offset);G=D.nodeValue;P=z.createTextNode(G.substring(0,p));p=z.createTextNode(G.substring(p,G.length));C.place(P,D,
"before");C.place(p,D,"after");C.destroy(D);for(d=P.parentNode;d!==l.blockNode;){G=z.createElement(d.tagName);d.style&&G.style&&d.style.cssText&&(G.style.cssText=d.style.cssText);"FONT"===d.tagName&&(d.color&&(G.color=d.color),d.face&&(G.face=d.face),d.size&&(G.size=d.size));for(;p;)D=p.nextSibling,G.appendChild(p),p=D;C.place(G,d,"after");P=d;p=G;d=d.parentNode}if(1==p.nodeType||3==p.nodeType&&p.nodeValue)y.innerHTML="";for(P=p;p;)D=p.nextSibling,y.appendChild(p),p=D}d=q.create(this.editor.window);
z=P;if("BR"!==this.blockNodeForEnter){for(;z;)u=z,z=D=z.firstChild;u&&u.parentNode?(y=u.parentNode,d.setStart(y,0),n.removeAllRanges(),n.addRange(d),this.editor.height&&g.scrollIntoView(y),c("mozilla")&&(this._pressedEnterInBlock=l.blockNode)):t=!0}else d.setStart(y,0),n.removeAllRanges(),n.addRange(d),this.editor.height&&g.scrollIntoView(y),c("mozilla")&&(this._pressedEnterInBlock=l.blockNode)}return t},_adjustNodeAndOffset:function(n,u){for(;n.length<u&&n.nextSibling&&3==n.nextSibling.nodeType;)u-=
n.length,n=n.nextSibling;return{node:n,offset:u}},removeTrailingBr:function(n){if(n=/P|DIV|LI/i.test(n.tagName)?n:this.editor.selection.getParentOfType(n,["P","DIV","LI"]))n.lastChild&&(1<n.childNodes.length&&3==n.lastChild.nodeType&&/^[\s\xAD]*$/.test(n.lastChild.nodeValue)||"BR"==n.lastChild.tagName)&&C.destroy(n.lastChild),n.childNodes.length||(n.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u,z,D,d,l,G,P,p,t,y,F,N,x,E,k,h,B){var M=L("dijit._editor.RichText",[F,N],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&u.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new I},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[u.trim,u.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);l("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));l("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(l("ie")||l("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[u.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[u.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);P.publish(B._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=u.hitch(this,function(A,w){return function(){return!this.execCommand(A,w)}}),e={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};l("ie")||(e.Z=a("redo"));for(var r in e)this.addKeyHandler(r,!0,!1,e[r])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(M._editorCommandsLocalized)this._local2NativeFormatNames=M._local2NativeFormatNames,this._native2LocalFormatNames=M._native2LocalFormatNames;else{M._editorCommandsLocalized=!0;M._local2NativeFormatNames={};
M._native2LocalFormatNames={};this._local2NativeFormatNames=M._local2NativeFormatNames;this._native2LocalFormatNames=M._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),e="",r,A=0;r=a[A++];)e="l"!==r.charAt(1)?e+("\x3c"+r+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+r+"\x3e\x3cbr/\x3e"):e+("\x3c"+r+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+r+"\x3e\x3cbr/\x3e");var w=g.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:e});this.ownerDocumentBody.appendChild(w);
a=u.hitch(this,function(){for(var J=w.firstChild;J;)try{this.selection.selectElement(J.firstChild);var K=J.tagName.toLowerCase();this._local2NativeFormatNames[K]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[K]]=K;J=J.nextSibling.nextSibling}catch(Q){}g.destroy(w)});this.defer(a)}},open:function(a){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new I;this.isClosed||this.close();P.publish(B._scopeName+"._editor.RichText::open",
this);1===arguments.length&&a.nodeName&&(this.domNode=a);var e=this.domNode;if(u.isString(this.value)){var r=this.value;e.innerHTML=""}else if(e.nodeName&&"textarea"==e.nodeName.toLowerCase()){var A=this.textarea=e;this.name=A.name;r=A.value;e=this.domNode=this.ownerDocument.createElement("div");e.setAttribute("widgetId",this.id);A.removeAttribute("widgetId");e.cssText=A.cssText;e.className+=" "+A.className;g.place(e,A,"before");var w=u.hitch(this,function(){m.set(A,{display:"block",position:"absolute",
top:"-1000px"});if(l("ie")){var O=A.style;this.__overflow=O.overflow;O.overflow="hidden"}});l("ie")?this.defer(w,10):w();if(A.form){var J=A.value;this.reset=function(){this.getValue()!==J&&this.replaceValue(J)};z(A.form,"submit",u.hitch(this,function(){c.set(A,"disabled",this.disabled);A.value=this.getValue()}))}}else r=k.getChildrenHtml(e),e.innerHTML="";this.value=r;e.nodeName&&"LI"===e.nodeName&&(e.innerHTML=" \x3cbr\x3e");this.header=e.ownerDocument.createElement("div");e.appendChild(this.header);
this.editingArea=e.ownerDocument.createElement("div");e.appendChild(this.editingArea);this.footer=e.ownerDocument.createElement("div");e.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!C.useXDomain||C.allowXdRichTextSave)){if((r=H.byId(B._scopeName+"._editor.RichText.value"))&&""!==r.value){w=r.value.split(this._SEPARATOR);for(var K=0,Q;Q=w[K++];)if(Q=Q.split(this._NAME_CONTENT_SEP),Q[0]===this.name){this.value=Q[1];w=w.splice(K,1);r.value=w.join(this._SEPARATOR);
break}}M._globalSaveHandler||(M._globalSaveHandler={},p.addOnUnload(function(){for(var O in M._globalSaveHandler){var S=M._globalSaveHandler[O];u.isFunction(S)&&S()}}));M._globalSaveHandler[this.id]=u.hitch(this,"_saveContent")}this.isClosed=!1;r=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");r.id=this.id+"_iframe";r.style.border="none";r.style.width="100%";this._layoutMode?r.style.height="100%":7<=l("ie")?(this.height&&(r.style.height=this.height),this.minHeight&&(r.style.minHeight=
this.minHeight)):r.style.height=this.height?this.height:this.minHeight;r.frameBorder=0;r._loadFunc=u.hitch(this,function(O){this.window=O;this.document=O.document;this.selection=new x.SelectionManager(O);l("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});w=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");w=11>l("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+w+"');document.close()":"javascript: '"+
w+"'";this.editingArea.appendChild(r);r.src=w;"LI"===e.nodeName&&(e.lastChild.style.marginTop="-1.2em");b.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=m.getComputedStyle(this.domNode);if(this["aria-label"])var e=this["aria-label"];else{var r=D('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||H.byId(this["aria-labelledby"],this.ownerDocument);r&&(e=r.textContent||r.innerHTML||"")}r="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(e?" aria-label\x3d'"+G.escape(e)+"'":"")+"\x3e\x3c/div\x3e";var A=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),w=a.lineHeight;w=0<=w.indexOf("px")?parseFloat(w)/parseFloat(a.fontSize):0<=w.indexOf("em")?parseFloat(w):"normal";var J="",K=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(Q){Q=Q.replace(/^;/ig,"")+";";var O=Q.split(":")[0];if(O){O=u.trim(O);O=O.toLowerCase();var S,R="";for(S=0;S<O.length;S++){var T=O.charAt(S);switch(T){case "-":S++,T=O.charAt(S).toUpperCase();default:R+=
T}}m.set(K.domNode,R,"")}J+=Q+";"});this.iframe.setAttribute("title",e);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||q.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",e?"\x3ctitle\x3e"+G.escape(e)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",A,";\n",this.height||l("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",w,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",l("ie")||l("trident")||l("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",e?" aria-label\x3d'"+G.escape(e)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+J+"'\x3e",r,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var e="",r=0,A,w=y.get(this.ownerDocument);A=a[r++];)A=(new t(w.location,A)).toString(),this.editingAreaStyleSheets.push(A),e+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+A+'"/\x3e';return e},addStyleSheet:function(a){var e=a.toString(),r=y.get(this.ownerDocument);if("."===e.charAt(0)||"/"!==e.charAt(0)&&!a.host)e=(new t(r.location,e)).toString();-1<v.indexOf(this.editingAreaStyleSheets,e)||(this.editingAreaStyleSheets.push(e),
this.onLoadDeferred.then(u.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(e);else{var A=this.document.getElementsByTagName("head")[0],w=this.document.createElement("link");w.rel="stylesheet";w.type="text/css";w.href=e;A.appendChild(w)}})))},removeStyleSheet:function(a){var e=a.toString(),r=y.get(this.ownerDocument);if("."===e.charAt(0)||"/"!==e.charAt(0)&&!a.host)e=(new t(r.location,e)).toString();a=v.indexOf(this.editingAreaStyleSheets,e);-1!==a&&(delete this.editingAreaStyleSheets[a],
D('link[href\x3d"'+e+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var e=l("ie")&&(this.isLoaded||!this.focusOnLoad);e&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;e&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(l("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var r in a)if(a.hasOwnProperty(r))try{this.document.execCommand(r,
!1,a[r])}catch(A){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=h.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var e=this;this.beforeIframeNode=g.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=g.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){e.editNode.focus()};this.focusNode=
this.editNode;var r=this.events.concat(this.captureEvents),A=this.iframe?this.document:this.editNode;this.own.apply(this,v.map(r,function(w){var J=w.toLowerCase().replace(/^on/,"");return z(A,J,u.hitch(this,w))},this));this.own(z(A,"mouseup",u.hitch(this,"onClick")));l("ie")&&(this.own(z(this.document,"mousedown",u.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);l("webkit")&&(this._webkitListener=this.own(z(this.document,"mouseup",u.hitch(this,"onDisplayChanged")))[0],this.own(z(this.document,
"mousedown",u.hitch(this,function(w){w=w.target;!w||w!==this.document.body&&w!==this.document||this.defer("placeCursorAtEnd")}))));if(l("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(w){}this.isLoaded=!0;this.set("disabled",this.disabled);r=u.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&d(u.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(r):r()},onKeyDown:function(a){if(a.keyCode===n.SHIFT||a.keyCode===n.ALT||a.keyCode===n.META||a.keyCode===n.CTRL)return!0;a.keyCode===n.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==n.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>l("ie")&&a.keyCode===n.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));l("ff")&&(a.keyCode===n.PAGE_UP||a.keyCode===n.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var e=this._keyHandlers[a.keyCode],r=arguments;e&&!a.altKey&&v.some(e,function(A){if(!(A.shift^a.shiftKey||A.ctrl^(a.ctrlKey||a.metaKey)))return A.handler.apply(this,r)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){q.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?c.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(u.hitch(this,function(){c.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,e,r,A){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));u.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:r||!1,ctrl:e||!1,handler:A})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(l("ie")||l("trident"))&&this.defer(function(){h.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var e=this.getValue(!0);if(e!==this.value)this.onChange(e);
this._set("value",e)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!l("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>l("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,e){a=a.toLowerCase();"formatblock"===a?l("safari")&&void 0===e&&(a="heading"):"hilitecolor"!==a||l("mozilla")||(a="backcolor");return a},_implCommand:function(a){return"_"+this._normalizeCommand(a)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(a){var e=this._qcaCache[a];return void 0!==e?e:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return l("ie")||l("trident")||l("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!l("webkit");default:return!1}},execCommand:function(a,e){this.focused&&this.focus();a=this._normalizeCommand(a,e);if(void 0!==e){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(l("ie")||l("trident"))&&(e="\x3c"+e+"\x3e")}var r="_"+a+"Impl";if(this[r])var A=this[r](e);else if((e=1<arguments.length?e:null)||"createlink"!==a)A=this.document.execCommand(a,!1,e);this.onDisplayChanged();return A},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var e=this._implCommand(a);return this[e]?this[e](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(e){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(l("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(l("mozilla")&&"hilitecolor"===a){try{var e=this.document.queryCommandValue("styleWithCSS")}catch(r){e=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,e)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,e){return this.selection[a].apply(this.selection,e)},placeCursorAtStart:function(){this.focus();var a=!1;if(l("mozilla"))for(var e=this.editNode.firstChild;e;){if(3===e.nodeType){if(0<e.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(e);break}}else if(1===e.nodeType){a=!0;var r=e.tagName?e.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(r)?this.selection.selectElement(e):
this.selection.selectElementChildren(e);break}e=e.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(l("mozilla"))for(var e=this.editNode.lastChild;e;){if(3===e.nodeType){if(0<e.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(e);break}}else if(1===e.nodeType){a=!0;this.selection.selectElement(e.lastChild||e);break}e=e.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var e=this.isClosed?this.domNode:this.editNode;e.innerHTML=a;this._preDomFilterContent(e)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(u.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!l("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var e=
a;v.forEach(this.contentPreFilters,function(r){r&&(e=r(e))});return e},_preDomFilterContent:function(a){a=a||this.editNode;v.forEach(this.contentDomPreFilters,function(e){e&&u.isFunction(e)&&e(a)},this)},_postFilterContent:function(a,e){if(u.isString(a))var r=a;else a=a||this.editNode,this.contentDomPostFilters.length&&(e&&(a=u.clone(a)),v.forEach(this.contentDomPostFilters,function(A){a=A(a)})),r=k.getChildrenHtml(a);u.trim(r.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(r="");v.forEach(this.contentPostFilters,
function(A){r=A(r)});return r},_saveContent:function(){var a=H.byId(B._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,e){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");e||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){q.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return k.getNodeHtml(a)},getNodeChildrenHtml:function(a){q.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return k.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);l("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var e=this.textarea.style;e.position="";e.left=e.top="";l("ie")&&(e.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;g.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;b.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);M._globalSaveHandler&&delete M._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(l("ie")||l("trident")||l("edge"))return this.focused&&!this.disabled;var e=9>l("ie")?this.document.selection.createRange():this.document;try{return e.queryCommandEnabled(a)}catch(r){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=l("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=l("mozilla")||l("webkit")||l("ie")||l("trident")||l("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=l("mozilla")||l("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;l("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;l("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return l("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return l("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(l("mozilla")||l("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){if(!this._handleTextColorOrProperties("hilitecolor",a))if(l("mozilla")){this.document.execCommand("styleWithCSS",!1,!0);console.log("Executing color command.");var e=this.document.execCommand("hilitecolor",!1,a);this.document.execCommand("styleWithCSS",!1,!1)}else e=this.document.execCommand("hilitecolor",!1,a);return e},_backcolorImpl:function(a){l("ie")&&(a=a?a:null);var e=this._handleTextColorOrProperties("backcolor",a);e||(e=this.document.execCommand("backcolor",
!1,a));return e},_forecolorImpl:function(a){l("ie")&&(a=a?a:null);var e=!1;(e=this._handleTextColorOrProperties("forecolor",a))||(e=this.document.execCommand("forecolor",!1,a));return e},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var e=!0;if(9>l("ie")){var r=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var A=r.item(0);r.length;)r.remove(r.item(0));A.outerHTML=a}else r.pasteHTML(a);r.select()}else if(8>l("trident")){var w=E.getSelection(this.window);
if(w&&w.rangeCount&&w.getRangeAt){r=w.getRangeAt(0);r.deleteContents();var J=g.create("div");J.innerHTML=a;for(A=this.document.createDocumentFragment();a=J.firstChild;)var K=A.appendChild(a);r.insertNode(A);K&&(r=r.cloneRange(),r.setStartAfter(K),r.collapse(!1),w.removeAllRanges(),w.addRange(r))}}else l("mozilla")&&!a.length?this.selection.remove():e=this.document.execCommand("inserthtml",!1,a);return e},_boldImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("bold");
e||(e=this.document.execCommand("bold",!1,a));return e},_italicImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("italic");e||(e=this.document.execCommand("italic",!1,a));return e},_underlineImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("underline");e||(e=this.document.execCommand("underline",!1,a));return e},_strikethroughImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),
e=this._adaptIEFormatAreaAndExec("strikethrough");e||(e=this.document.execCommand("strikethrough",!1,a));return e},_superscriptImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("superscript");e||(e=this.document.execCommand("superscript",!1,a));return e},_subscriptImpl:function(a){var e=!1;if(l("ie")||l("trident"))this._adaptIESelection(),e=this._adaptIEFormatAreaAndExec("subscript");e||(e=this.document.execCommand("subscript",!1,a));return e},
_fontnameImpl:function(a){if(l("ie")||l("trident"))var e=this._handleTextColorOrProperties("fontname",a);e||(e=this.document.execCommand("fontname",!1,a));return e},_fontsizeImpl:function(a){if(l("ie")||l("trident"))var e=this._handleTextColorOrProperties("fontsize",a);e||(e=this.document.execCommand("fontsize",!1,a));return e},_insertorderedlistImpl:function(a){var e=!1;if(l("ie")||l("trident")||l("edge"))e=this._adaptIEList("insertorderedlist",a);e||(e=this.document.execCommand("insertorderedlist",
!1,a));return e},_insertunorderedlistImpl:function(a){var e=!1;if(l("ie")||l("trident")||l("edge"))e=this._adaptIEList("insertunorderedlist",a);e||(e=this.document.execCommand("insertunorderedlist",!1,a));return e},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var e=0;if(a&&a.childNodes){var r;for(r=0;r<a.childNodes.length;r++){var A=f.position(a.childNodes[r]);
e+=A.h}}return e},_isNodeEmpty:function(a,e){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],e):!0:3===a.nodeType?""===a.nodeValue.substring(e):!1},_removeStartingRangeFromRange:function(a,e){if(a.nextSibling)e.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&e.setStart(a.nextSibling,0)}return e},_adaptIESelection:function(){var a=E.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var e=a.getRangeAt(0),r=e.startContainer,
A=e.startOffset;3===r.nodeType&&A>=r.length&&r.nextSibling;)A-=r.length,r=r.nextSibling;for(var w=null;this._isNodeEmpty(r,A)&&r!==w;)w=r,e=this._removeStartingRangeFromRange(r,e),r=e.startContainer,A=0;a.removeAllRanges();a.addRange(e)}},_adaptIEFormatAreaAndExec:function(a){var e=E.getSelection(this.window),r=this.document,A;if(a&&e&&e.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);var w=e.getRangeAt(0);var J=w.startContainer;if(3===J.nodeType){var K=w.endOffset;J.length<
K&&(K=this._adjustNodeAndOffset(Q,K),J=K.node,K=K.offset)}for(;J&&J!==this.editNode;){var Q=J.tagName?J.tagName.toLowerCase():"";if(-1<v.indexOf(a,Q)){var O=J;break}J=J.parentNode}if(O&&(Q=w.startContainer,a=r.createElement(O.tagName),g.place(a,O,"after"),Q&&3===Q.nodeType)){K=w.endOffset;Q.length<K&&(K=this._adjustNodeAndOffset(Q,K),Q=K.node,K=K.offset);J=Q.nodeValue;w=r.createTextNode(J.substring(0,K));var S=J.substring(K,J.length);S&&(A=r.createTextNode(S));g.place(w,Q,"before");if(A){var R=r.createElement("span");
R.className="ieFormatBreakerSpan";g.place(R,Q,"after");g.place(A,R,"after");A=R}g.destroy(Q);K=w.parentNode;for(Q=[];K!==O;){J=K.tagName;w={tagName:J};Q.push(w);J=r.createElement(J);K.style&&J.style&&K.style.cssText&&(J.style.cssText=K.style.cssText,w.cssText=K.style.cssText);"FONT"===K.tagName&&(K.color&&(J.color=K.color,w.color=K.color),K.face&&(J.face=K.face,w.face=K.face),K.size&&(J.size=K.size,w.size=K.size));K.className&&(J.className=K.className,w.className=K.className);if(A)for(;A;)w=A.nextSibling,
J.appendChild(A),A=w;J.tagName==K.tagName?(R=r.createElement("span"),R.className="ieFormatBreakerSpan",g.place(R,K,"after"),g.place(J,R,"after")):g.place(J,K,"after");w=K;A=J;K=K.parentNode}if(A){if(1===A.nodeType||3===A.nodeType&&A.nodeValue)a.innerHTML="";for(;A;)w=A.nextSibling,a.appendChild(A),A=w}if(Q.length){w=Q.pop();A=r.createElement(w.tagName);w.cssText&&A.style&&(A.style.cssText=w.cssText);w.className&&(A.className=w.className);"FONT"===w.tagName&&(w.color&&(A.color=w.color),w.face&&(A.face=
w.face),w.size&&(A.size=w.size));for(g.place(A,a,"before");Q.length;)w=Q.pop(),O=r.createElement(w.tagName),w.cssText&&O.style&&(O.style.cssText=w.cssText),w.className&&(O.className=w.className),"FONT"===w.tagName&&(w.color&&(O.color=w.color),w.face&&(O.face=w.face),w.size&&(O.size=w.size)),A.appendChild(O),A=O;O=r.createTextNode(".");R.appendChild(O);A.appendChild(O)}else R=r.createElement("span"),R.className="ieFormatBreakerSpan",O=r.createTextNode("."),R.appendChild(O),g.place(R,a,"before");A=
E.create(this.window);A.setStart(O,0);A.setEnd(O,O.length);e.removeAllRanges();e.addRange(A);this.selection.collapse(!1);O.parentNode.innerHTML="";a.firstChild||g.destroy(a);return!0}return!1}w=e.getRangeAt(0);if((Q=w.startContainer)&&3===Q.nodeType)return K=w.startOffset,Q.length<K&&(K=this._adjustNodeAndOffset(Q,K),Q=K.node,K=K.offset),J=Q.nodeValue,w=r.createTextNode(J.substring(0,K)),S=J.substring(K),""!==S&&(A=r.createTextNode(J.substring(K))),R=r.createElement("span"),O=r.createTextNode("."),
R.appendChild(O),w.length?g.place(w,Q,"after"):w=Q,g.place(R,w,"after"),A&&g.place(A,R,"after"),g.destroy(Q),A=E.create(this.window),A.setStart(O,0),A.setEnd(O,O.length),e.removeAllRanges(),e.addRange(A),r.execCommand(a),g.place(R.firstChild,R,"before"),g.destroy(R),A.setStart(O,0),A.setEnd(O,O.length),e.removeAllRanges(),e.addRange(A),this.selection.collapse(!1),O.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var e=E.getSelection(this.window);if(e.isCollapsed&&e.rangeCount&&
!this.queryCommandValue(a)){var r=e.getRangeAt(0),A=r.startContainer;if(A&&3==A.nodeType&&!r.startOffset)return r="ul","insertorderedlist"===a&&(r="ol"),a=this.document.createElement(r),r=g.create("li",null,a),g.place(a,A,"before"),r.appendChild(A),g.create("br",null,a,"after"),a=E.create(this.window),a.setStart(A,0),a.setEnd(A,A.length),e.removeAllRanges(),e.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,e){var r=E.getSelection(this.window),A=this.document,
w,J;e=e||null;if(a&&r&&r.isCollapsed&&r.rangeCount){var K=r.getRangeAt(0);if((w=K.startContainer)&&3===w.nodeType){var Q=K.startOffset;w.length<Q&&(K=this._adjustNodeAndOffset(w,Q),w=K.node,Q=K.offset);var O=w.nodeValue;K=A.createTextNode(O.substring(0,Q));""!==O.substring(Q)&&(J=A.createTextNode(O.substring(Q)));O=A.createElement("span");Q=A.createTextNode(".");O.appendChild(Q);A=A.createElement("span");O.appendChild(A);K.length?g.place(K,w,"after"):K=w;g.place(O,K,"after");J&&g.place(J,O,"after");
g.destroy(w);w=E.create(this.window);w.setStart(Q,0);w.setEnd(Q,Q.length);r.removeAllRanges();r.addRange(w);if(l("webkit")){r="color";if("hilitecolor"===a||"backcolor"===a)r="backgroundColor";m.set(O,r,e);this.selection.remove();g.destroy(A);O.innerHTML="\x26#160;";this.selection.selectElement(O);this.focus()}else this.execCommand(a,e),g.place(O.firstChild,O,"before"),g.destroy(O),w.setStart(Q,0),w.setEnd(Q,Q.length),r.removeAllRanges(),r.addRange(w),this.selection.collapse(!1),Q.parentNode.removeChild(Q);
return!0}}return!1},_adjustNodeAndOffset:function(a,e){for(;a.length<e&&a.nextSibling&&3===a.nextSibling.nodeType;)e-=a.length,a=a.nextSibling;return{node:a,offset:e}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return D(".ieFormatBreakerSpan",a).forEach(function(e){for(;e.firstChild;)g.place(e.firstChild,
e,"before");g.destroy(e)}),a},_stripTrailingEmptyNodes:function(a){function e(r){return/^(p|div|br)$/i.test(r.nodeName)&&0==r.children.length&&/^[\s\xA0]*$/.test(r.textContent||r.innerText||"")||3===r.nodeType&&/^[\s\xA0]*$/.test(r.nodeValue)}for(;a.lastChild&&e(a.lastChild);)g.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(u.hitch(this,function(){this.editNode.dir=a}))}});return M})},"dijit/_editor/range":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/lang"],function(v,C,L){var I={getIndex:function(b,g){for(var f=[],m=[],q=b,n,u;b!=g;){var z=0;for(n=b.parentNode;u=n.childNodes[z++];)if(u===b){--z;break}f.unshift(z);m.unshift(z-n.childNodes.length);b=n}if(0<f.length&&3==q.nodeType){for(u=q.previousSibling;u&&3==u.nodeType;)f[f.length-1]--,u=u.previousSibling;for(u=q.nextSibling;u&&3==u.nodeType;)m[m.length-1]++,u=u.nextSibling}return{o:f,r:m}},getNode:function(b,g){if(!L.isArray(b)||0==b.length)return g;var f=g;
v.every(b,function(m){if(0<=m&&m<f.childNodes.length)f=f.childNodes[m];else return f=null,!1;return!0});return f},getCommonAncestor:function(b,g,f){f=f||b.ownerDocument.body;var m=function(u){for(var z=[];u;)if(z.unshift(u),u!==f)u=u.parentNode;else break;return z};b=m(b);g=m(g);m=Math.min(b.length,g.length);for(var q=b[0],n=1;n<m;n++)if(b[n]===g[n])q=b[n];else break;return q},getAncestor:function(b,g,f){for(f=f||b.ownerDocument.body;b&&b!==f;){var m=b.nodeName.toUpperCase();if(g.test(m))return b;
b=b.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(b,g,f){f=f||b.ownerDocument.body;g=g||I.BlockTagNames;for(var m=null,q;b&&b!==f;){var n=b.nodeName.toUpperCase();!m&&g.test(n)&&(m=b);!q&&/^(?:BODY|TD|TH|CAPTION)$/.test(n)&&(q=b);b=b.parentNode}return{blockNode:m,blockContainer:q||b.ownerDocument.body}},atBeginningOfContainer:function(b,g,f){var m=!1,q=0==f;q||3!=g.nodeType||/^[\s\xA0]+$/.test(g.nodeValue.substr(0,f))&&(q=
!0);if(q)for(m=!0;g&&g!==b;){if(g.previousSibling){m=!1;break}g=g.parentNode}return m},atEndOfContainer:function(b,g,f){var m=!1,q=f==(g.length||g.childNodes.length);q||3!=g.nodeType||/^[\s\xA0]+$/.test(g.nodeValue.substr(f))&&(q=!0);if(q)for(m=!0;g&&g!==b;){if(g.nextSibling){m=!1;break}g=g.parentNode}return m},adjacentNoneTextNode:function(b,g){var f=b;b=0-b.length||0;for(g=g?"nextSibling":"previousSibling";f&&3==f.nodeType;)b+=f.length,f=f[g];return[f,b]},create:function(b){b=b||window;return b.getSelection?
b.document.createRange():new c},getSelection:function(b,g){if(b.getSelection)return b.getSelection();b=new H.selection(b);g||b._getCurrentSelection();return b}};if(!window.getSelection)var H=I.ie={cachedSelection:{},selection:function(b){this._ranges=[];this.addRange=function(g,f){this._ranges.push(g);f||g._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(g){return this._ranges[g]};this._getCurrentSelection=function(){this.removeAllRanges();
var g=b.document.selection.createRange();g="CONTROL"==b.document.selection.type.toUpperCase()?new c(H.decomposeControlRange(g)):new c(H.decomposeTextRange(g));this.addRange(g,!0),this.isCollapsed=g.collapsed}},decomposeControlRange:function(b){var g=b.item(0),f=b.item(b.length-1);b=g.parentNode;var m=f.parentNode;g=I.getIndex(g,b).o[0];f=I.getIndex(f,m).o[0]+1;return[b,g,m,f]},getEndPoint:function(b,g){var f=b.duplicate();f.collapse(!g);var m="EndTo"+(g?"End":"Start"),q=f.parentElement(),n;if(0<q.childNodes.length)v.every(q.childNodes,
function(D,d){if(3!=D.nodeType)if(f.moveToElementText(D),0<f.compareEndPoints(m,b))if(n&&3==n.nodeType){u=n;var l=!0}else return u=q,z=d,!1;else{if(d==q.childNodes.length-1)return u=q,z=q.childNodes.length,!1}else d==q.childNodes.length-1&&(u=D,l=!0);if(l&&u)return u=(D=I.adjacentNoneTextNode(u)[0])?D.nextSibling:q.firstChild,d=I.adjacentNoneTextNode(u),D=d[0],d=d[1],D?(f.moveToElementText(D),f.collapse(!1)):f.moveToElementText(q),f.setEndPoint(m,b),z=f.text.length-d,!1;n=D;return!0});else{var u=
q;var z=0}g||1!=u.nodeType||z!=u.childNodes.length||(g=u.nextSibling)&&3==g.nodeType&&(u=g,z=0);return[u,z]},setEndPoint:function(b,g,f){b=b.duplicate();var m;if(3!=g.nodeType)if(0<f){if(m=g.childNodes[f-1])if(3==m.nodeType)g=m,f=m.length;else if(m.nextSibling&&3==m.nextSibling.nodeType)g=m.nextSibling,f=0;else{b.moveToElementText(m.nextSibling?m:g);var q=m.parentNode;m=q.insertBefore(m.ownerDocument.createTextNode(" "),m.nextSibling);b.collapse(!1);q.removeChild(m)}}else b.moveToElementText(g),b.collapse(!0);
3==g.nodeType&&(m=I.adjacentNoneTextNode(g),q=m[0],m=m[1],q?(b.moveToElementText(q),b.collapse(!1),"inherit"!=q.contentEditable&&m++):(b.moveToElementText(g.parentNode),b.collapse(!0),b.move("character",1),b.move("character",-1)),f+=m,0<f&&b.move("character",f)!=f&&console.error("Error when moving!"));return b},decomposeTextRange:function(b){var g=H.getEndPoint(b),f=g[0],m=g[1],q=g[0];g=g[1];b.htmlText.length&&(b.htmlText==b.text?g=m+b.text.length:(g=H.getEndPoint(b,!0),q=g[0],g=g[1]));return[f,m,
q,g]},setRange:function(b,g,f,m,q,n){g=H.setEndPoint(b,g,f);b.setEndPoint("StartToStart",g);if(!n)var u=H.setEndPoint(b,m,q);b.setEndPoint("EndToEnd",u||g);return b}},c=I.W3CRange=C(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=
this.startContainer!==this.endContainer?I.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(b,g){g=parseInt(g);if(this.startContainer!==b||this.startOffset!=g)delete this._cachedBookmark,this.startContainer=b,this.startOffset=g,this.endContainer?this._updateInternal():this.setEnd(b,g)},setEnd:function(b,g){g=parseInt(g);if(this.endContainer!==b||this.endOffset!=g)delete this._cachedBookmark,
this.endContainer=b,this.endOffset=g,this.startContainer?this._updateInternal():this.setStart(b,g)},setStartAfter:function(b,g){this._setPoint("setStart",b,g,1)},setStartBefore:function(b,g){this._setPoint("setStart",b,g,0)},setEndAfter:function(b,g){this._setPoint("setEnd",b,g,1)},setEndBefore:function(b,g){this._setPoint("setEnd",b,g,0)},_setPoint:function(b,g,f,m){f=I.getIndex(g,g.parentNode).o;this[b](g.parentNode,f.pop()+m)},_getIERange:function(){var b=(this._body||this.endContainer.ownerDocument.body).createTextRange();
H.setRange(b,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return b},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var b=this.startContainer,g=this._getIERange();3!==b.nodeType||this.startOffset||this.setStartBefore(b);g.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var b=new c([this.startContainer,
this.startOffset,this.endContainer,this.endOffset]);b._body=this._body;return b},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});L.setObject("dijit.range",I);return I})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(v,C,L){var I={};C.setObject("dijit._editor.html",I);var H=I.escapeXml=function(c,b){c=c.replace(/&/gm,"\x26amp;").replace(/</gm,
"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(c=c.replace(/'/gm,"\x26#39;"));return c};I.getNodeHtml=function(c){var b=[];I.getNodeHtmlHelper(c,b);return b.join("")};I.getNodeHtmlHelper=function(c,b){switch(c.nodeType){case 1:var g=c.nodeName.toLowerCase();if(!g||"/"==g.charAt(0))return"";b.push("\x3c",g);var f=[],m={},q;if(L("dom-attributes-explicit")||L("dom-attributes-specified-flag"))for(var n=0;q=c.attributes[n++];){var u=q.name;"_dj"===u.substr(0,3)||L("dom-attributes-specified-flag")&&
!q.specified||u in m||(q=q.value,("src"==u||"href"==u)&&c.getAttribute("_djrealurl")&&(q=c.getAttribute("_djrealurl")),8===L("ie")&&"style"===u&&(q=q.replace("HEIGHT:","height:").replace("WIDTH:","width:")),f.push([u,q]),m[u]=q)}else{var z=(/^input$|^img$/i.test(c.nodeName)?c:c.cloneNode(!1)).outerHTML;m=z.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);z=z.substr(0,z.indexOf("\x3e"));v.forEach(m,function(D){if(D){var d=D.indexOf("\x3d");if(0<d&&(D=D.substring(0,d),"_dj"!=D.substr(0,3)))if("src"!=D&&"href"!=
D||!c.getAttribute("_djrealurl")){switch(D){case "style":var l=c.style.cssText.toLowerCase();break;case "class":l=c.className;break;case "width":if("img"===g){(d=/width=(\S+)/i.exec(z))&&(l=d[1]);break}case "height":if("img"===g){(d=/height=(\S+)/i.exec(z))&&(l=d[1]);break}default:l=c.getAttribute(D)}null!=l&&f.push([D,l.toString()])}else f.push([D,c.getAttribute("_djrealurl")])}},this)}f.sort(function(D,d){return D[0]<d[0]?-1:D[0]==d[0]?0:1});for(m=0;q=f[m++];)b.push(" ",q[0],'\x3d"',"string"===
typeof q[1]?H(q[1],!0):q[1],'"');switch(g){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":b.push(" /\x3e");break;case "script":b.push("\x3e",c.innerHTML,"\x3c/",g,"\x3e");break;default:b.push("\x3e"),c.hasChildNodes()&&I.getChildrenHtmlHelper(c,b),b.push("\x3c/",g,"\x3e")}break;case 4:case 3:b.push(H(c.nodeValue,!0));break;case 8:b.push("\x3c!--",H(c.nodeValue,!0),"--\x3e");break;default:b.push("\x3c!-- Element not recognized - Type: ",c.nodeType," Name: ",
c.nodeName,"--\x3e")}};I.getChildrenHtml=function(c){var b=[];I.getChildrenHtmlHelper(c,b);return b.join("")};I.getChildrenHtmlHelper=function(c,b){if(c)for(var g=c.childNodes||c,f=!L("ie")||g!==c,m,q=0;m=g[q++];)f&&m.parentNode!=c||I.getNodeHtmlHelper(m,b)};return I})},"widgets/BatchAttributeEditor/setting/SymChooser":function(){define(["dojo/_base/declare","dijit/_WidgetsInTemplateMixin","jimu/BaseWidgetSetting","esri/symbols/jsonUtils","dojo/text!./SymChooser.html"],function(v,C,L,I,H){return v([L,
C],{templateString:H,baseClass:"solutions-widget-batcheditor-setting",data:null,selectionSymbols:null,constructor:function(c){this.data=c.data;this.selectionSymbols=c.selectionSymbols},postCreate:function(){this.inherited(arguments);this.showSymbolSelector()},showSymbolSelector:function(){var c=null,b=this.data;this.selectionSymbols[b.id]&&(c=I.fromJson(this.selectionSymbols[b.id]));null===c?"esriGeometryPolygon"===b.geometryType?this.symbolSelector.showByType("fill"):"esriGeometryPoint"===b.geometryType?
this.symbolSelector.showByType("marker"):"esriGeometryPolyline"===b.geometryType&&this.symbolSelector.showByType("line"):this.symbolSelector.showBySymbol(c)},okPress:function(){return this.symbolSelector}})})},"widgets/BatchAttributeEditor/utils":function(){define(["dojo/_base/lang","dojo/_base/array","jimu/utils"],function(v,C,L){return{getFieldInfosFromWebmap:function(I,H){var c=null,b=H.getLayerInfoByTopLayerId(I);b&&((I=b.getPopupInfo())&&I.fieldInfos?(c=v.clone(I.fieldInfos),b.layerObject&&C.forEach(c,
function(g){C.some(b.layerObject.fields,function(f){if(g.fieldName===f.name)return g.type=f.type,!0})})):(c=[],b&&b.layerObject&&C.forEach(b.layerObject.fields,function(g){var f=L.getDefaultPortalFieldInfo(g);f.type=g.type;f.visible=!0;f.isEditable=!0;c.push(f)})));c&&C.forEach(c,function(g){g.format&&g.format.dateFormat&&g.format.dateFormat.toLowerCase()&&0<=g.format.dateFormat.toLowerCase().indexOf("time")&&(g.format.time=!0)});return c}}})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),
function(v,C,L,I,H,c){var b=null,g=v([L,H],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new c({whiteList:this.whiteList,safeAttrValue:I.hitch(this,function(f,m,q,n){return"style"===m?this.xss.friendlyAttrValue(q).replace(/"/g,"'"):"img"===f&&"src"===m?this.xss.escapeAttrValue(q):this.xss.safeAttrValue(f,m,q,n)}),onTag:I.hitch(this,function(f,
m,q){if(q.isWhite&&this._isInWhiteList(f,this.graphicsWhiteList))return m}),onIgnoreTagAttr:I.hitch(this,function(f,m,q,n){if("data-"===m.substr(0,5))return m+'\x3d"'+this.xss.escapeAttrValue(q)+'"'}),onIgnoreTag:I.hitch(this,function(f,m,q){if("o:"===f.substr(0,2)||"!--[if"===f||"!--[endif]--"===f)return m})},!0);this.xss=this.sanitizer.xss},sanitize:function(f){return this.sanitizer.sanitize(f)},_getWhiteList:function(){var f="title height width class style font-family id align text-align".split(" "),
m={div:f,h1:f,h2:f,h3:f,h4:f,h5:f,h6:f,span:f,p:f,s:f,strong:f,em:f,u:f,ol:f,ul:f,li:f,a:["href","target"].concat(f),img:["src","alt","border"].concat(f),blockquote:f,font:["face","size","color"].concat(f),pre:f,code:f,b:f,i:f,wbr:f,video:"autoplay controls loop muted poster preload".split(" ").concat(f),audio:["autoplay","controls","loop","muted","preload"].concat(f),source:["media","src","type"].concat(f),table:["cellpadding","cellspacing","border"].concat(f),tbody:[].concat(f),tr:["valign"].concat(f),
td:["valign","colspan","rowspan","nowrap"].concat(f),th:["valign","colspan","rowspan","nowrap"].concat(f),hr:f,html:f,title:f,link:["rel","href"],style:["type"].concat(f),body:f};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],
feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],
textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:f};return this._extendObjectOfArrays([m,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],
em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align",
"valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(f){var m={};C.forEach(f,function(q){var n=Object.keys(q);C.forEach(n,function(u){Array.isArray(q[u])&&Array.isArray(m[u])?m[u]=m[u].concat(q[u]):m[u]=q[u]},this)},this);return m},_isInWhiteList:function(f,m){m=Object.keys(m);var q=!1;C.forEach(m,function(n){f===n&&(q=!0)},this);return q}});g.getInstance=function(){null===b&&(b=new g);return b};return g})},
"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(v,C,L,I,H,c,b,g,f,m,q,n,u){var z=L("dijit._editor.plugins.LinkDialog",q,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:n,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=c.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(d){v("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),c.hitch(this,function(l,G,P){var p=this;this.tag="insertImage"==this.command?"img":"a";l=c.delegate(l.getLocalization("dijit","common",this.lang),l.getLocalization("dijit._editor",
"LinkDialog",this.lang));var t=this.dropDown=this.button.dropDown=new G({title:l[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:c.hitch(this,"setValue"),onOpen:function(){p._onOpenDialog();G.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(c.hitch(p,"_onCloseDialog"),0)}});l.urlRegExp=this.urlRegExp;l.id=P.getUniqueId(this.editor.id);this._uniqueId=l.id;this._setContent(t.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
m.substitute(this.linkDialogTemplate,l));t.startup();this._urlInput=P.byId(this._uniqueId+"_urlInput");this._textInput=P.byId(this._uniqueId+"_textInput");this._setButton=P.byId(this._uniqueId+"_setButton");this.own(P.byId(this._uniqueId+"_cancelButton").on("click",c.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",c.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",c.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=c.hitch(this,function(){var y=this._urlInput.get("value");return this._urlRegExp.test(y)||this._emailRegExp.test(y)});this.own(b(t.domNode,"keydown",c.hitch(this,c.hitch(this,function(y){!y||y.keyCode!=H.ENTER||y.shiftKey||y.metaKey||y.ctrlKey||y.altKey||this._setButton.get("disabled")||(t.onExecute(),t.execute(t.get("value")))}))));d()}))},_checkAndFixInput:function(){var d=this,l=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var G=l,P=!1,p=!1;G&&1<G.length&&(G=c.trim(G),0!==G.indexOf("mailto:")&&(0<G.indexOf("/")?-1===G.indexOf("://")&&"/"!==G.charAt(0)&&G.indexOf("./")&&0!==G.indexOf("../")&&d._hostRxp.test(G)&&(P=!0):d._userAtRxp.test(G)&&(p=!0)));P&&d._urlInput.set("value","http://"+G);p&&d._urlInput.set("value","mailto:"+G);d._setButton.set("disabled",!d._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(c.hitch(this,
function(){this.own(b(this.editor.editNode,"mouseup",c.hitch(this,"_onMouseUp")));this.own(b(this.editor.editNode,"dblclick",c.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(d){this.dropDown.set({parserScope:"dojo",content:d})},_checkValues:function(d){d&&d.urlInput&&(d.urlInput=d.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&d&&d.textInput&&("function"===typeof this.linkFilter?d.textInput=this.linkFilter(d.textInput):
C.forEach(this.linkFilter,function(l){d.textInput=d.textInput.replace(l[0],l[1])}));return d},_createlinkEnabledImpl:function(){return!0},setValue:function(d){this._onCloseDialog();if(9>g("ie")){var l=u.getSelection(this.editor.window).getRangeAt(0).endContainer;3===l.nodeType&&(l=l.parentNode);l&&l.nodeName&&l.nodeName.toLowerCase()!==this.tag&&(l=this.editor.selection.getSelectedElement(this.tag));l&&l.nodeName&&l.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(l),
this.editor.execCommand("unlink"))}d=this._checkValues(d);this.editor.execCommand("inserthtml",m.substitute(this.htmlTemplate,d));f("a",this.editor.document).forEach(function(G){G.innerHTML||I.has(G,"name")||G.parentNode.removeChild(G)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(d){if(d&&d.tagName.toLowerCase()===this.tag){var l=d.getAttribute("_djrealurl")||d.getAttribute("href");var G=d.getAttribute("target")||"_self";var P=d.textContent||
d.innerText;this.editor.selection.selectElement(d,!0)}else P=this.editor.selection.getSelectedText();return{urlInput:l||"",textInput:P||"",targetSelect:G||""}},_onOpenDialog:function(){if(g("ie")){var d=u.getSelection(this.editor.window);if(d.rangeCount){var l=d.getRangeAt(0);var G=l.endContainer;3===G.nodeType&&(G=G.parentNode);G&&G.nodeName&&G.nodeName.toLowerCase()!==this.tag&&(G=this.editor.selection.getSelectedElement(this.tag));if(!G||G.nodeName&&G.nodeName.toLowerCase()!==this.tag)(d=this.editor.selection.getAncestorElement(this.tag))&&
d.nodeName&&d.nodeName.toLowerCase()==this.tag?(G=d,this.editor.selection.selectElement(G)):l.startContainer===l.endContainer&&(d=l.startContainer.firstChild)&&d.nodeName&&d.nodeName.toLowerCase()==this.tag&&(G=d,this.editor.selection.selectElement(G))}}else G=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(G))},_onDblClick:function(d){if(d&&d.target&&(d=d.target,(d.tagName?d.tagName.toLowerCase():
"")===this.tag&&I.get(d,"href"))){var l=this.editor;this.editor.selection.selectElement(d);l.onDisplayChanged();l._updateTimer&&(l._updateTimer.remove(),delete l._updateTimer);l.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}},_onMouseUp:function(){if(g("ff")){var d=this.editor.selection.getAncestorElement(this.tag);if(d){var l=u.getSelection(this.editor.window).getRangeAt(0);
if(l.collapsed&&d.childNodes.length){var G=l.cloneRange();G.selectNodeContents(d.childNodes[d.childNodes.length-1]);G.setStart(d.childNodes[0],0);1!==l.compareBoundaryPoints(G.START_TO_START,G)?l.setStartBefore(d):-1!==l.compareBoundaryPoints(G.END_TO_START,G)&&l.setStartAfter(d)}}}}}),D=L("dijit._editor.plugins.ImgLinkDialog",[z],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(d){if(d&&d.tagName.toLowerCase()===this.tag){var l=d.getAttribute("_djrealurl")||d.getAttribute("src");var G=d.getAttribute("alt");this.editor.selection.selectElement(d,!0)}else G=this.editor.selection.getSelectedText();return{urlInput:l||"",textInput:G||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(c.hitch(this,function(){this.own(b(this.editor.editNode,"mousedown",c.hitch(this,"_selectTag")))}))},_selectTag:function(d){d&&d.target&&(d=d.target,(d.tagName?d.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(d))},_checkValues:function(d){d&&d.urlInput&&(d.urlInput=d.urlInput.replace(/"/g,"\x26quot;"));d&&d.textInput&&(d.textInput=d.textInput.replace(/"/g,"\x26quot;"));return d},_onDblClick:function(d){if(d&&d.target&&(d=d.target,(d.tagName?
d.tagName.toLowerCase():"")===this.tag&&I.get(d,"src"))){var l=this.editor;this.editor.selection.selectElement(d);l.onDisplayChanged();l._updateTimer&&(l._updateTimer.remove(),delete l._updateTimer);l.onNormalizedDisplayChanged();var G=this.button;setTimeout(function(){G.set("disabled",!1);G.loadAndOpenDropDown().then(function(){G.dropDown.focus&&G.dropDown.focus()})},10)}}});q.registry.createLink=function(d){var l={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in d?d.allowUnsafeHtml:!1};
"linkFilter"in d&&(l.linkFilter=d.linkFilter);return new z(l)};q.registry.insertImage=function(){return new D({command:"insertImage"})};z.ImgLinkDialog=D;return z})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u,z,D,d,l,G){var P=L("dijit._editor.plugins.ViewSource",D,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){n("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var p=g.getLocalization("dijit._editor","commands"),t=this.editor;this.button=new d({label:p.viewSource,ownerDocument:t.ownerDocument,dir:t.dir,lang:t.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:m.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(p){this.editor=p;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=C.before(this.editor,"setValue",m.hitch(this,function(t){return[this._filter(t)]}));this._getValueFilterHandle=C.after(this.editor,"getValue",m.hitch(this,function(t){return this._filter(t)}));this.editor.addKeyHandler(f.F12,!0,!0,m.hitch(this,function(t){this.button.focus();
this.toggle();t.stopPropagation();t.preventDefault();setTimeout(m.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(p){var t=this.editor,y=t._plugins;this._sourceShown=p;var F=this;try{this.sourceArea||this._createSourceView();if(p)t._sourceQueryCommandEnabled=t.queryCommandEnabled,t.queryCommandEnabled=function(x){return"viewsource"===x.toLowerCase()},this.editor.onDisplayChanged(),v.forEach(y,function(x){!x||x instanceof P||!x.isInstanceOf(D)||x.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return F.sourceArea}),this.sourceArea.value=t.get("value"),this.sourceArea.style.height=t.iframe.style.height,this.sourceArea.style.width=t.iframe.style.width,t.iframe.parentNode.style.position="relative",b.set(t.iframe,{position:"absolute",top:0,visibility:"hidden"}),b.set(this.sourceArea,{display:"block"}),this._resizeHandle=q(window,"resize",m.hitch(this,function(){var x=u.getBox(t.ownerDocument);"_prevW"in this&&"_prevH"in this&&
x.w===this._prevW&&x.h===this._prevH||(this._prevW=x.w,this._prevH=x.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(m.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(m.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=m.hitch(this,function(){var x=this.sourceArea.value;return x=this._filter(x)}),this._setListener=C.after(this.editor,
"setValue",m.hitch(this,function(x){this.sourceArea.value=x||""}),!0);else{if(!t._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);t.queryCommandEnabled=t._sourceQueryCommandEnabled;if(!this._readOnly){var N=this.sourceArea.value;t.beginEditing();t.set("value",N);t.endEditing()}v.forEach(y,function(x){x&&
x.isInstanceOf(D)&&x.set("disabled",!1)});b.set(this.sourceArea,"display","none");b.set(t.iframe,{position:"relative",visibility:"visible"});delete t._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(m.hitch(this,function(){var x=t.domNode.parentNode;x&&(x=G.getEnclosingWidget(x))&&x.resize&&x.resize();t.resize()}),300)}catch(x){console.log(x)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var p=this.editor,t=p.getHeaderHeight(),y=
p.getFooterHeight(),F=c.position(p.domNode),N=c.getPadBorderExtents(p.iframe.parentNode),x=c.getMarginExtents(p.iframe.parentNode),E=c.getPadBorderExtents(p.domNode),k=F.w-E.w;F=F.h-(t+E.h+y);this._fsPlugin&&this._fsPlugin.isFullscreen&&(p=u.getBox(p.ownerDocument),k=p.w-E.w,F=p.h-(t+E.h+y));c.setMarginBox(this.sourceArea,{w:Math.round(k-(N.w+x.w)),h:Math.round(F-(N.h+x.h))})},_createSourceView:function(){var p=this.editor,t=p._plugins;this.sourceArea=H.create("textarea");this.readOnly&&(I.set(this.sourceArea,
"readOnly",!0),this._readOnly=!0);b.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});I.set(this.sourceArea,"aria-label",this.editor.id);H.place(this.sourceArea,p.iframe,"before");n("ie")&&p.iframe.parentNode.lastChild!==p.iframe&&b.set(p.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});p._viewsource_oldFocus=p.focus;var y=this;p.focus=function(){if(y._sourceShown)y.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,z.focus(p.editNode)):p._viewsource_oldFocus()}catch(x){console.log("ViewSource focus code error: "+x)}};var F,N;for(F=0;F<t.length;F++)if((N=t[F])&&("dijit._editor.plugins.FullScreen"===N.declaredClass||N.declaredClass===l._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=N;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return y._sourceShown?y.sourceArea:this._viewsource_getAltViewNode()});
this.own(q(this.sourceArea,"keydown",m.hitch(this,function(x){this._sourceShown&&x.keyCode==f.F12&&x.ctrlKey&&x.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(m.hitch(this,function(){p.focus()}),100),x.stopPropagation(),x.preventDefault())})))},_stripScripts:function(p){p&&(p=p.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),p=p.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),p=p.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return p},_stripComments:function(p){p&&
(p=p.replace(/\x3c!--(.|\s){1,}?--\x3e/g,""));return p},_stripIFrames:function(p){p&&(p=p.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return p},_stripEventHandlers:function(p){if(p){var t=p.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(t)for(var y=0,F=t.length;y<F;y++){var N=t[y],x=N.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");p=p.replace(N,x)}}return p},_filter:function(p){p&&(this.stripScripts&&(p=this._stripScripts(p)),this.stripComments&&(p=this._stripComments(p)),
this.stripIFrames&&(p=this._stripIFrames(p)),this.stripEventHandlers&&(p=this._stripEventHandlers(p)));return p},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var p=this.sourceArea;z.focus(p);this._sourceShown&&!this.readOnly&&(p.setSelectionRange?p.setSelectionRange(0,0):this.sourceArea.createTextRange&&
(p=p.createTextRange(),p.collapse(!0),p.moveStart("character",-99999),p.moveStart("character",0),p.moveEnd("character",0),p.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});D.registry.viewSource=D.registry.viewsource=function(p){return new P({readOnly:"readOnly"in
p?p.readOnly:!1,stripComments:"stripComments"in p?p.stripComments:!0,stripScripts:"stripScripts"in p?p.stripScripts:!0,stripIFrames:"stripIFrames"in p?p.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in p?p.stripEventHandlers:!0})};return P})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u,z,D){v=L("dijit._editor.plugins._FontDropDown",[m,q,n],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:v,postMixInProperties:function(){this.inherited(arguments);this.strings=H.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=f.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new g({idProperty:"value",data:C.map(this.values,function(p){var t=this.strings[p]||p;return{label:this.getLabel(p,t),name:t,value:p}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(p,t){t=!1!==t;this.select.set("value",0>C.indexOf(this.values,p)?"":p,t);t||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(p){this._set("disabled",p);this.select.set("disabled",p)}});var d=L("dijit._editor.plugins._FontNameDropDown",v,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(p,t){return this.plainText?t:"\x3cdiv style\x3d'font-family: "+p+"'\x3e"+t+"\x3c/div\x3e"},_normalizeFontName:function(p){var t=this.values;if(!p||!t)return p;var y=p.split(",");if(1<y.length)for(var F=0,N=y.length;F<N;F++){var x=b.trim(y[F]);if(-1<C.indexOf(t,x))return x}return p},_setValueAttr:function(p,t){t=!1!==
t;p=this._normalizeFontName(p);this.generic&&(p={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[p]||p);this.inherited(arguments,[p,t])}}),l=L("dijit._editor.plugins._FontSizeDropDown",v,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(p,
t){return this.plainText?t:"\x3cfont size\x3d"+p+"'\x3e"+t+"\x3c/font\x3e"},_setValueAttr:function(p,t){t=!1!==t;p.indexOf&&-1!=p.indexOf("px")&&(p={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(p,10)]||p);this.inherited(arguments,[p,t])}}),G=L("dijit._editor.plugins._FormatBlockDropDown",v,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(p,t){return this.plainText||
"noFormat"==p?t:"\x3c"+p+"\x3e"+t+"\x3c/"+p+"\x3e"},_execCommand:function(p,t,y){if("noFormat"===y){var F;if((t=D.getSelection(p.window))&&0<t.rangeCount&&(y=t.getRangeAt(0),y)){t=y.startContainer;for(F=y.endContainer;t&&t!==p.editNode&&t!==p.document.body&&1!==t.nodeType;)t=t.parentNode;for(;F&&F!==p.editNode&&F!==p.document.body&&1!==F.nodeType;)F=F.parentNode;var N=c.hitch(this,function(h,B){if(h.childNodes&&h.childNodes.length){var M;for(M=0;M<h.childNodes.length;M++){var a=h.childNodes[M];if(1==
a.nodeType&&p.selection.inSelection(a)){var e=a.tagName?a.tagName.toLowerCase():"";-1!==C.indexOf(this.values,e)&&B.push(a);N(a,B)}}}});y=c.hitch(this,function(h){if(h&&h.length){for(p.beginEditing();h.length;)this._removeFormat(p,h.pop());p.endEditing()}});var x=[];if(t==F){for(F=t;F&&F!==p.editNode&&F!==p.document.body;){if(1==F.nodeType){var E=F.tagName?F.tagName.toLowerCase():"";if(-1!==C.indexOf(this.values,E)){var k=F;break}}F=F.parentNode}N(t,x);k&&(x=[k].concat(x))}else for(F=t;p.selection.inSelection(F);)1==
F.nodeType&&(E=F.tagName?F.tagName.toLowerCase():"",-1!==C.indexOf(this.values,E)&&x.push(F),N(F,x)),F=F.nextSibling;y(x);p.onDisplayChanged()}}else p.execCommand(t,y)},_removeFormat:function(p,t){if(p.customUndo){for(;t.firstChild;)I.place(t.firstChild,t,"before");t.parentNode.removeChild(t)}else{p.selection.selectElementChildren(t);var y=p.selection.getSelectedHtml();p.selection.selectElement(t);p.execCommand("inserthtml",y||"")}}}),P=L("dijit._editor.plugins.FontChoice",z,{useDefaultCommand:!1,
_initButton:function(){var p={fontName:d,fontSize:l,formatBlock:G}[this.command],t=this.params;this.params.custom&&(t.values=this.params.custom);var y=this.editor;this.button=new p(c.delegate({dir:y.dir,lang:y.lang},t));this.own(this.button.select.on("change",c.hitch(this,function(F){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=F.indexOf(" ")&&(F="'"+F+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,F):this.editor.execCommand(this.command,
F)})))},updateState:function(){var p=this.editor,t=this.command;if(p&&p.isLoaded&&t.length&&this.button){var y=this.get("disabled");this.button.set("disabled",y);if(!y){try{var F=p.queryCommandValue(t)||""}catch(x){F=""}(y=c.isString(F)&&(F.match(/'([^']*)'/)||F.match(/"([^"]*)"/)))&&(F=y[1]);"fontSize"!==t||F||(F=3);if("formatBlock"===t)if(F&&"p"!=F)0>C.indexOf(this.button.values,F)&&(F="noFormat");else{F=null;if((t=D.getSelection(this.editor.window))&&0<t.rangeCount&&(t=t.getRangeAt(0)))var N=t.endContainer;
for(;N&&N!==p.editNode&&N!==p.document;){if((t=N.tagName?N.tagName.toLowerCase():"")&&-1<C.indexOf(this.button.values,t)){F=t;break}N=N.parentNode}F||(F="noFormat")}F!==this.button.get("value")&&this.button.set("value",F,!1)}}}});C.forEach(["fontName","fontSize","formatBlock"],function(p){z.registry[p]=function(t){return new P({command:p,plainText:t.plainText})}});P._FontDropDown=v;P._FontNameDropDown=d;P._FontSizeDropDown=l;P._FormatBlockDropDown=G;return P})},"dojox/editor/plugins/Preview":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/Button dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Preview".split(" "),
function(v,C,L,I){var H=v.declare("dojox.editor.plugins.Preview",I,{useDefaultCommand:!1,styles:"",stylesheets:null,iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Preview");this.button=new C.form.Button({label:this._nlsResources.preview,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Preview",tabIndex:"-1",onClick:v.hitch(this,"_preview")})},setEditor:function(c){this.editor=c;this._initButton()},
updateState:function(){this.button.set("disabled",this.get("disabled"))},_preview:function(){try{var c=this.editor.get("value"),b="\t\t\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dUTF-8'\x3e\n",g;if(this.stylesheets)for(g=0;g<this.stylesheets.length;g++)b+="\t\t\x3clink rel\x3d'stylesheet' type\x3d'text/css' href\x3d'"+this.stylesheets[g]+"'\x3e\n";this.styles&&(b+="\t\t\x3cstyle\x3e"+this.styles+"\x3c/style\x3e\n");c="\x3chtml\x3e\n\t\x3chead\x3e\n"+b+"\t\x3c/head\x3e\n\t\x3cbody\x3e\n"+
c+"\n\t\x3c/body\x3e\n\x3c/html\x3e";var f=window.open("javascript: ''",this._nlsResources.preview,"status\x3d1,menubar\x3d0,location\x3d0,toolbar\x3d0");f.document.open();f.document.write(c);f.document.close()}catch(m){console.warn(m)}}});v.subscribe(C._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"preview"!==c.args.name.toLowerCase()||(c.plugin=new H({styles:"styles"in c.args?c.args.styles:"",stylesheets:"stylesheets"in c.args?c.args.stylesheets:null}))});return H})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(v,C,L,I,H,c){var b=L("dijit._editor.plugins.TextColor",H,{buttonClass:c,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var g=this;this.button.loadDropDown=function(f){function m(q){g.button.dropDown=new q({dir:g.editor.dir,ownerDocument:g.editor.ownerDocument,value:g.value,onChange:function(n){g.editor.execCommand(g.command,n)},onExecute:function(){g.editor.execCommand(g.command,this.get("value"))}});f()}"string"==
typeof g.colorPicker?v([g.colorPicker],m):m(g.colorPicker)}},updateState:function(){var g=this.editor,f=this.command;if(g&&g.isLoaded&&f.length){if(this.button){var m=this.get("disabled");this.button.set("disabled",m);if(m)return;try{var q=g.queryCommandValue(f)||""}catch(n){q=""}}""==q&&(q="#000000");"transparent"==q&&(q="#ffffff");"string"==typeof q?-1<q.indexOf("rgb")&&(q=C.fromRgb(q).toHex()):(q=((q&255)<<16|q&65280|(q&16711680)>>>16).toString(16),q="#000000".slice(0,7-q.length)+q);this.value=
q;(g=this.button.dropDown)&&g.get&&q!==g.get("value")&&g.set("value",q,!1)}}});H.registry.foreColor=function(g){return new b(g)};H.registry.hiliteColor=function(g){return new b(g)};return b})},"dojox/editor/plugins/ToolbarLineBreak":function(){define("dojo dijit dojox dijit/_Widget dijit/_TemplatedMixin dijit/_editor/_Plugin dojo/_base/declare".split(" "),function(v,C,L,I,H,c,b){var g=b("dojox.editor.plugins.ToolbarLineBreak",[I,H],{templateString:"\x3cspan class\x3d'dijit dijitReset'\x3e\x3cbr\x3e\x3c/span\x3e",
postCreate:function(){v.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}});v.subscribe(C._scopeName+".Editor.getPlugin",null,function(f){if(!f.plugin){var m=f.args.name.toLowerCase();if("||"===m||"toolbarlinebreak"===m)f.plugin=new c({button:new g,setEditor:function(q){this.editor=q}})}});return g})},"dojox/editor/plugins/FindReplace":function(){define("dojo dijit dojox dijit/_base/manager dijit/_base/popup dijit/_Widget dijit/_TemplatedMixin dijit/_KeyNavContainer dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/Toolbar dijit/form/CheckBox dijit/form/_TextBoxMixin dijit/form/TextBox dijit/_editor/_Plugin dijit/form/Button dijit/form/DropDownButton dijit/form/ToggleButton ./ToolbarLineBreak dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/FindReplace".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u,z,D){v.experimental("dojox.editor.plugins.FindReplace");var d=v.declare("dojox.editor.plugins._FindReplaceCloseBox",[c,b,f],{btnId:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'float: right' class\x3d'dijitInline' tabindex\x3d'-1'\x3e\x3cbutton class\x3d'dijit dijitReset dijitInline' id\x3d'${btnId}' dojoAttachPoint\x3d'button' dojoType\x3d'dijit.form.Button' tabindex\x3d'-1' iconClass\x3d'dijitEditorIconsFindReplaceClose' showLabel\x3d'false'\x3eX\x3c/button\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=C.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.btnId=this.id+"_close";this.inherited(arguments)},startup:function(){this.connect(this.button,"onClick","onClick")},onClick:function(){}}),l=v.declare("dojox.editor.plugins._FindReplaceTextBox",[c,b,f],{textId:"",label:"",toolTip:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceTextBox' title\x3d'${tooltip}' tabindex\x3d'-1'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${textId}' tabindex\x3d'-1'\x3e${label}\x3c/label\x3e\x3cinput dojoType\x3d'dijit.form.TextBox' intermediateChanges\x3d'true' class\x3d'focusTextBox' tabIndex\x3d'0' id\x3d'${textId}' dojoAttachPoint\x3d'textBox, focusNode' value\x3d'' dojoAttachEvent\x3d'onKeyPress: _onKeyPress'/\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=C.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.textId=this.id+"_text";this.inherited(arguments)},postCreate:function(){this.textBox.set("value","");this.disabled=this.textBox.get("disabled");this.connect(this.textBox,"onChange","onChange");v.attr(this.textBox.textbox,"formnovalidate","true")},_setValueAttr:function(t){this.value=t;this.textBox.set("value",t)},focus:function(){this.textBox.focus()},_setDisabledAttr:function(t){this.disabled=t;this.textBox.set("disabled",
t)},onChange:function(t){this.value=t},_onKeyPress:function(t){var y=0,F=0;!t.target||t.ctrlKey||t.altKey||t.shiftKey||(t.keyCode==v.keys.LEFT_ARROW?(y=t.target.selectionStart,F=t.target.selectionEnd,y<F&&(C.selectInputText(t.target,y,y),v.stopEvent(t))):t.keyCode==v.keys.RIGHT_ARROW&&(y=t.target.selectionStart,F=t.target.selectionEnd,y<F&&(C.selectInputText(t.target,F,F),v.stopEvent(t))))}}),G=v.declare("dojox.editor.plugins._FindReplaceCheckBox",[c,b,f],{checkId:"",label:"",tooltip:"",widget:null,
widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' tabindex\x3d'-1' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceCheckBox' title\x3d'${tooltip}' \x3e\x3cinput dojoType\x3d'dijit.form.CheckBox' tabIndex\x3d'0' id\x3d'${checkId}' dojoAttachPoint\x3d'checkBox, focusNode' value\x3d''/\x3e\x3clabel tabindex\x3d'-1' class\x3d'dijitLeft dijitInline' for\x3d'${checkId}'\x3e${label}\x3c/label\x3e\x3c/span\x3e",postMixInProperties:function(){this.id=C.getUniqueId(this.declaredClass.replace(/\./g,
"_"));this.checkId=this.id+"_check";this.inherited(arguments)},postCreate:function(){this.checkBox.set("checked",!1);this.disabled=this.checkBox.get("disabled");this.checkBox.isFocusable=function(){return!1}},_setValueAttr:function(t){this.checkBox.set("value",t)},_getValueAttr:function(){return this.checkBox.get("value")},focus:function(){this.checkBox.focus()},_setDisabledAttr:function(t){this.disabled=t;this.checkBox.set("disabled",t)}}),P=v.declare("dojox.editor.plugins._FindReplaceToolbar",q,
{postCreate:function(){this.connectKeyNavHandlers([],[]);this.connect(this.containerNode,"onclick","_onToolbarEvent");this.connect(this.containerNode,"onkeydown","_onToolbarEvent");v.addClass(this.domNode,"dijitToolbar")},addChild:function(t,y){C._KeyNavContainer.superclass.addChild.apply(this,arguments)},_onToolbarEvent:function(t){t.stopPropagation()}}),p=v.declare("dojox.editor.plugins.FindReplace",[D],{buttonClass:C.form.ToggleButton,iconClassPrefix:"dijitEditorIconsFindReplace",editor:null,button:null,
_frToolbar:null,_closeBox:null,_findField:null,_replaceField:null,_findButton:null,_replaceButton:null,_replaceAllButton:null,_caseSensitive:null,_backwards:null,_promDialog:null,_promDialogTimeout:null,_strings:null,_bookmark:null,_initButton:function(){this._strings=v.i18n.getLocalization("dojox.editor.plugins","FindReplace");this.button=new C.form.ToggleButton({label:this._strings.findReplace,showLabel:!1,iconClass:this.iconClassPrefix+" dijitEditorIconFindString",tabIndex:"-1",onChange:v.hitch(this,
"_toggleFindReplace")});v.isOpera&&this.button.set("disabled",!0);this.connect(this.button,"set",v.hitch(this,function(t,y){"disabled"===t&&this._toggleFindReplace(!y&&this._displayed,!0,!0)}))},setEditor:function(t){this.editor=t;this._initButton()},toggle:function(){this.button.set("checked",!this.button.get("checked"))},_toggleFindReplace:function(t,y,F){var N=v.marginBox(this.editor.domNode);t&&!v.isOpera?(v.style(this._frToolbar.domNode,"display","block"),this._populateFindField(),y||(this._displayed=
!0)):(v.style(this._frToolbar.domNode,"display","none"),y||(this._displayed=!1),F||this.editor.focus());this.editor.resize({h:N.h})},_populateFindField:function(){var t=this.editor._sCall("getSelectedText",[null]);this._findField&&this._findField.textBox&&(t&&this._findField.textBox.set("value",t),this._findField.textBox.focus(),C.selectInputText(this._findField.textBox.focusNode))},setToolbar:function(t){this.inherited(arguments);if(!v.isOpera){var y=this._frToolbar=new P;v.style(y.domNode,"display",
"none");v.place(y.domNode,t.domNode,"after");y.startup();this._closeBox=new d;y.addChild(this._closeBox);this._findField=new l({label:this._strings.findLabel,tooltip:this._strings.findTooltip});y.addChild(this._findField);this._replaceField=new l({label:this._strings.replaceLabel,tooltip:this._strings.replaceTooltip});y.addChild(this._replaceField);y.addChild(new L.editor.plugins.ToolbarLineBreak);this._findButton=new C.form.Button({label:this._strings.findButton,showLabel:!0,iconClass:this.iconClassPrefix+
" dijitEditorIconFind"});this._findButton.titleNode.title=this._strings.findButtonTooltip;y.addChild(this._findButton);this._replaceButton=new C.form.Button({label:this._strings.replaceButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplace"});this._replaceButton.titleNode.title=this._strings.replaceButtonTooltip;y.addChild(this._replaceButton);this._replaceAllButton=new C.form.Button({label:this._strings.replaceAllButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplaceAll"});
this._replaceAllButton.titleNode.title=this._strings.replaceAllButtonTooltip;y.addChild(this._replaceAllButton);this._caseSensitive=new G({label:this._strings.matchCase,tooltip:this._strings.matchCaseTooltip});y.addChild(this._caseSensitive);this._backwards=new G({label:this._strings.backwards,tooltip:this._strings.backwardsTooltip});y.addChild(this._backwards);this._findButton.set("disabled",!0);this._replaceButton.set("disabled",!0);this._replaceAllButton.set("disabled",!0);this.connect(this._findField,
"onChange","_checkButtons");this.connect(this._findField,"onKeyDown","_onFindKeyDown");this.connect(this._replaceField,"onKeyDown","_onReplaceKeyDown");this.connect(this._findButton,"onClick","_find");this.connect(this._replaceButton,"onClick","_replace");this.connect(this._replaceAllButton,"onClick","_replaceAll");this.connect(this._closeBox,"onClick","toggle");this._promDialog=new C.TooltipDialog;this._promDialog.startup();this._promDialog.set("content","")}},_checkButtons:function(){this._findField.get("value")?
(this._findButton.set("disabled",!1),this._replaceButton.set("disabled",!1),this._replaceAllButton.set("disabled",!1)):(this._findButton.set("disabled",!0),this._replaceButton.set("disabled",!0),this._replaceAllButton.set("disabled",!0))},_onFindKeyDown:function(t){t.keyCode==v.keys.ENTER&&(this._find(),v.stopEvent(t))},_onReplaceKeyDown:function(t){t.keyCode==v.keys.ENTER&&(this._replace()||this._replace(),v.stopEvent(t))},_find:function(t){var y=this._findField.get("value")||"";if(y){var F=this._caseSensitive.get("value"),
N=this._backwards.get("value");y=this._findText(y,F,N);!y&&t&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextFind})),C.popup.open({popup:this._promDialog,around:this._findButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;C.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return y}return!1},_replace:function(t){var y=
!1,F=this.editor;F.focus();var N=this._findField.get("value")||"",x=this._replaceField.get("value")||"";if(N){var E=this._caseSensitive.get("value"),k=this._backwards.get("value"),h=F._sCall("getSelectedText",[null]);v.isMoz&&(N=v.trim(N),h=v.trim(h));N=this._filterRegexp(N,!E);h&&N.test(h)&&(F.execCommand("inserthtml",x),y=!0,k&&(this._findText(x,E,k),F._sCall("collapse",[!0])));!this._find(!1)&&t&&(this._promDialog.set("content",v.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextReplace})),
C.popup.open({popup:this._promDialog,around:this._replaceButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;C.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this.editor.focus()}),0));return y}return null},_replaceAll:function(t){var y=0;this._backwards.get("value")?this.editor.placeCursorAtEnd():this.editor.placeCursorAtStart();this._replace(!1)&&y++;var F=v.hitch(this,function(){this._replace(!1)?
(y++,setTimeout(F,10)):t&&(this._promDialog.set("content",v.string.substitute(this._strings.replaceDialogText,{0:""+y})),C.popup.open({popup:this._promDialog,around:this._replaceAllButton.domNode}),this._promDialogTimeout=setTimeout(v.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;C.popup.close(this._promDialog)}),3E3),setTimeout(v.hitch(this,function(){this._findField.focus();this._findField.textBox.focusNode.select()}),0))});F()},_findText:function(t,y,
F){var N=this.editor,x=N.window,E=!1;if(t)if(x.find)E=x.find(t,y,F,!1,!1,!1,!1);else{var k=N.document;if(k.selection||x.getSelection)if(this.editor.focus(),N=k.body.createTextRange(),E=N.duplicate(),x.getSelection().getRangeAt(0),(k=k.selection?k.selection.createRange():null)?F?N.setEndPoint("EndToStart",k):N.setEndPoint("StartToEnd",k):this._bookmark&&(x=x.getSelection().toString(),N.moveToBookmark(this._bookmark),N.text!=x?(N=E.duplicate(),this._bookmark=null):(F?E.setEndPoint("EndToStart",N):E.setEndPoint("StartToEnd",
N),N=E.duplicate())),y=y?4:0,F&&(y|=1),E=N.findText(t,N.text.length,y))N.select(),this._bookmark=N.getBookmark()}return E},_filterRegexp:function(t,y){for(var F="",N=null,x=0;x<t.length;x++)switch(N=t.charAt(x),N){case "\\":F+=N;x++;F+=t.charAt(x);break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":F+="\\";default:F+=N}F="^"+F+"$";return y?new RegExp(F,"mi"):new RegExp(F,"m")},updateState:function(){this.button.set("disabled",this.get("disabled"))},
destroy:function(){this.inherited(arguments);this._promDialogTimeout&&(clearTimeout(this._promDialogTimeout),this._promDialogTimeout=null,C.popup.close(this._promDialog));this._frToolbar&&(this._frToolbar.destroyRecursive(),this._frToolbar=null);this._promDialog&&(this._promDialog.destroyRecursive(),this._promDialog=null)}});p._FindReplaceCloseBox=d;p._FindReplaceTextBox=l;p._FindReplaceCheckBox=G;p._FindReplaceToolbar=P;v.subscribe(C._scopeName+".Editor.getPlugin",null,function(t){t.plugin||"findreplace"!==
t.args.name.toLowerCase()||(t.plugin=new p({}))});return p})},"dojox/editor/plugins/PasteFromWord":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/RichText dijit/form/Button dijit/Dialog dojox/html/format dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/PasteFromWord dojo/i18n!dijit/nls/common dojo/i18n!dijit/_editor/nls/commands".split(" "),function(v,C,L,I){var H=v.declare("dojox.editor.plugins.PasteFromWord",
I,{iconClassPrefix:"dijitAdditionalEditorIcon",width:"400px",height:"300px",_template:"\x3cdiv class\x3d'dijitPasteFromWordEmbeddedRTE'\x3e\x3cdiv style\x3d'width: ${width}; padding-top: 5px; padding-bottom: 5px;'\x3e${instructions}\x3c/div\x3e\x3cdiv id\x3d'${uId}_rte' style\x3d'width: ${width}; height: ${height}'\x3e\x3c/div\x3e\x3ctable style\x3d'width: ${width}' tabindex\x3d'-1'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_paste'\x3e${paste}\x3c/button\x3e\x26nbsp;\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_cancel'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",
_filters:[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(\x3c!--(.|\s){1,}?--\x3e)/gi,handler:""},{regexp:/(<p[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/ig,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,
handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/ig,handler:""},{regexp:/<(\/?)o:p[^>]*>/gi,handler:""}],_initButton:function(){this._filters=this._filters.slice(0);var c=v.i18n.getLocalization("dojox.editor.plugins","PasteFromWord");v.mixin(c,v.i18n.getLocalization("dijit","common"));v.mixin(c,v.i18n.getLocalization("dijit._editor","commands"));this.button=new C.form.Button({label:c.pasteFromWord,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"PasteFromWord",tabIndex:"-1",onClick:v.hitch(this,"_openDialog")});this._uId=C.getUniqueId(this.editor.id);c.uId=this._uId;c.width=this.width||"400px";c.height=this.height||"300px";this._dialog=(new C.Dialog({title:c.pasteFromWord})).placeAt(v.body());this._dialog.set("content",v.string.substitute(this._template,c));v.style(v.byId(this._uId+"_rte"),"opacity",.001);this.connect(C.byId(this._uId+"_paste"),"onClick","_paste");this.connect(C.byId(this._uId+
"_cancel"),"onClick","_cancel");this.connect(this._dialog,"onHide","_clearDialog")},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_openDialog:function(){this._dialog.show();this._rte||setTimeout(v.hitch(this,function(){this._rte=new C._editor.RichText({height:this.height||"300px"},this._uId+"_rte");this._rte.startup();this._rte.onLoadDeferred.addCallback(v.hitch(this,function(){v.animateProperty({node:this._rte.domNode,
properties:{opacity:{start:.001,end:1}}}).play()}))}),100)},_paste:function(){var c=L.html.format.prettyPrint(this._rte.get("value"));this._dialog.hide();var b;for(b=0;b<this._filters.length;b++){var g=this._filters[b];c=c.replace(g.regexp,g.handler)}c=L.html.format.prettyPrint(c);this.editor.focus();this.editor.execCommand("inserthtml",c)},_cancel:function(){this._dialog.hide()},_clearDialog:function(){this._rte.set("value","")},destroy:function(){this._rte&&this._rte.destroy();this._dialog&&this._dialog.destroyRecursive();
delete this._dialog;delete this._rte;this.inherited(arguments)}});v.subscribe(C._scopeName+".Editor.getPlugin",null,function(c){c.plugin||"pastefromword"!==c.args.name.toLowerCase()||(c.plugin=new H({width:"width"in c.args?c.args.width:"400px",height:"height"in c.args?c.args.width:"300px"}))});return H})},"dojox/html/format":function(){define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,C,L,I,H){var c=v.getObject("dojox.html.format",!0);c.prettyPrint=
function(b,g,f,m,q){var n=[],u=0,z=[],D="\t",d="",l=[],G,P=/[=]([^"']+?)(\s|>)/g,p=/style=("[^"]*"|'[^']*'|\S*)/gi,t=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(g&&0<g&&10>g)for(D="",G=0;G<g;G++)D+=" ";g=I.doc.createElement("div");g.innerHTML=b;var y=C.encode,F=C.decode,N=g.ownerDocument.createElement("div"),x=function(e){e=e.cloneNode(!1);N.appendChild(e);e=N.innerHTML;N.innerHTML="";return e},E=function(){var e;for(e=0;e<u;e++)n.push(D)},k=function(){n.push("\n")},h=function(e){var r;e=e.split("\n");for(r=
0;r<e.length;r++)e[r]=v.trim(e[r]);e=e.join(" ");e=v.trim(e);if(""!==e){var A=[];if(f&&0<f){var w="";for(r=0;r<u;r++)w+=D;r=w.length;w=f;for(f>r&&(w-=r);e;)if(e.length>f){for(r=w;0<r&&" "!==e.charAt(r);r--);if(!r)for(r=w;r<e.length&&" "!==e.charAt(r);r++);var J=e.substring(0,r);J=v.trim(J);e=v.trim(e.substring(r==e.length?e.length:r+1,e.length));if(J){var K="";for(r=0;r<u;r++)K+=D;J=K+J+"\n"}A.push(J)}else{K="";for(r=0;r<u;r++)K+=D;e=K+e+"\n";A.push(e);e=null}return A.join("")}K="";for(r=0;r<u;r++)K+=
D;return K+e+"\n"}return""},B=function(e){if(e){var r=e;r&&(r=r.replace(/&quot;/gi,'"'),r=r.replace(/&gt;/gi,"\x3e"),r=r.replace(/&lt;/gi,"\x3c"),r=r.replace(/&amp;/gi,"\x26"));var A;e=0;var w=r.split("\n"),J=[];for(r=0;r<w.length;r++){var K=w[r],Q=-1<K.indexOf("\n");if(K=v.trim(K)){Q=e;for(A=0;A<K.length;A++){var O=K.charAt(A);"{"===O?e++:"}"===O&&(e--,Q=e)}O="";for(A=0;A<u+Q;A++)O+=D;J.push(O+K+"\n")}else Q&&0===r&&J.push("\n")}e=J.join("")}return e},M=function(e){var r=e.nodeName.toLowerCase(),
A=v.trim(x(e));e=A.substring(0,A.indexOf("\x3e")+1);e=e.replace(P,'\x3d"$1"$2');e=e.replace(p,function(J){var K=J.substring(0,6);J=J.substring(6,J.length);var Q=J.charAt(0);J=v.trim(J.substring(1,J.length-1));J=J.split(";");var O=[];L.forEach(J,function(R){if(R=v.trim(R))R=R.substring(0,R.indexOf(":")).toLowerCase()+R.substring(R.indexOf(":"),R.length),O.push(R)});O=O.sort();J=O.join("; ");var S=v.trim(J);return S&&";"!==S?K+Q+(J+";")+Q:""});var w=[];e=e.replace(t,function(J){w.push(v.trim(J));return""});
w=w.sort();e="\x3c"+r;w.length&&(e+=" "+w.join(" "));-1!=A.indexOf("\x3c/")?(z.push(r),e+="\x3e"):(e=q?e+" /\x3e":e+"\x3e",z.push(!1));a:switch(r){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "small":r=!0;break a;default:r=!1}l.push(r);d&&!r&&(n.push(h(d)),d="");r?d+=e:(E(),n.push(e),k(),u++)},a=function(e){var r=e.childNodes;if(r){var A;for(A=0;A<r.length;A++){var w=r[A];if(1===
w.nodeType){var J=v.trim(w.tagName.toLowerCase());H("ie")&&w.parentNode!=e||J&&"/"===J.charAt(0)||(M(w),"script"===J?n.push(B(w.innerHTML)):"pre"===J?(w=w.innerHTML,H("mozilla")&&(w=w.replace("\x3cbr\x3e","\n"),w=w.replace("\x3cpre\x3e",""),w=w.replace("\x3c/pre\x3e","")),"\n"!==w.charAt(w.length-1)&&(w+="\n"),n.push(w)):a(w),w=l.pop(),d&&!w&&(n.push(h(d)),d=""),(J=z.pop())?(J="\x3c/"+J+"\x3e",w?d+=J:(u--,E(),n.push(J),k())):u--)}else 3===w.nodeType||4===w.nodeType?d+=y(w.nodeValue,m):8===w.nodeType&&
(w=F(w.nodeValue,m),E(),n.push("\x3c!--"),k(),u++,n.push(h(w)),u--,E(),n.push("--\x3e"),k())}}};a(g);d&&(n.push(h(d)),d="");return n.join("")};return c})},"dojox/editor/plugins/InsertAnchor":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/range dijit/_Templated dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/Select dijit/form/Button dijit/form/DropDownButton dojo/_base/declare dojo/i18n dojo/string dojo/NodeList-dom dojox/editor/plugins/ToolbarLineBreak dojo/i18n!dojox/editor/plugins/nls/InsertAnchor dojo/i18n!dijit/nls/common".split(" "),
function(v,C,L,I){var H=v.declare("dojox.editor.plugins.InsertAnchor",I,{htmlTemplate:'\x3ca name\x3d"${anchorInput}" class\x3d"dijitEditorPluginInsertAnchorStyle"\x3e${textInput}\x3c/a\x3e',iconClassPrefix:"dijitAdditionalEditorIcon",_template:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_anchorInput'\x3e${anchor}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_anchorInput' name\x3d'anchorInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${cancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){var c=this,b=v.i18n.getLocalization("dojox.editor.plugins","InsertAnchor",this.lang),g=this.dropDown=new C.TooltipDialog({title:b.title,execute:v.hitch(this,"setValue"),onOpen:function(){c._onOpenDialog();C.TooltipDialog.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(v.hitch(c,"_onCloseDialog"),0)}});this.button=new C.form.DropDownButton({label:b.insertAnchor,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"InsertAnchor",tabIndex:"-1",
dropDown:this.dropDown});b.id=C.getUniqueId(this.editor.id);this._uniqueId=b.id;this.dropDown.set("content",g.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+v.string.substitute(this._template,b));g.startup();this._anchorInput=C.byId(this._uniqueId+"_anchorInput");this._textInput=C.byId(this._uniqueId+"_textInput");this._setButton=C.byId(this._uniqueId+"_setButton");this.connect(C.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel()});
this._anchorInput&&this.connect(this._anchorInput,"onChange","_checkInput");this._textInput&&this.connect(this._anchorInput,"onChange","_checkInput");this.editor.contentDomPreFilters.push(v.hitch(this,this._preDomFilter));this.editor.contentDomPostFilters.push(v.hitch(this,this._postDomFilter));this._setup()},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(c){this.editor=c;this._initButton()},_checkInput:function(){var c=!0;this._anchorInput.isValid()&&
(c=!1);this._setButton.set("disabled",c)},_setup:function(){this.editor.onLoadDeferred.addCallback(v.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);setTimeout(v.hitch(this,function(){this._applyStyles()}),100)}))},getAnchorStyle:function(){var c=v.moduleUrl(L._scopeName,"editor/plugins/resources").toString();if(!c.match(/^https?:\/\//i)&&!c.match(/^file:\/\//i)){var b="/"===c.charAt(0)?v.doc.location.protocol+"//"+v.doc.location.host:this._calcBaseUrl(v.global.location.href);
"/"!==b[b.length-1]&&"/"!==c.charAt(0)&&(b+="/");c=b+c}return"@media screen {\n\t.dijitEditorPluginInsertAnchorStyle {\n\t\tbackground-image: url({MODURL}/images/anchor.gif);\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-position: top left;\n\t\tborder-width: 1px;\n\t\tborder-style: dashed;\n\t\tborder-color: #D0D0D0;\n\t\tpadding-left: 20px;\n\t}\n}\n".replace(/\{MODURL\}/gi,c)},_applyStyles:function(){if(!this._styled)try{this._styled=!0;var c=this.editor.document,b=this.getAnchorStyle();if(v.isIE)c.createStyleSheet("").cssText=
b;else{var g=c.createElement("style");g.appendChild(c.createTextNode(b));c.getElementsByTagName("head")[0].appendChild(g)}}catch(f){}},_calcBaseUrl:function(c){var b=null;null!==c&&(b=c.indexOf("?"),-1!=b&&(c=c.substring(0,b)),b=c.lastIndexOf("/"),b=0<b&&b<c.length?c.substring(0,b):c);return b},_checkValues:function(c){c&&(c.anchorInput&&(c.anchorInput=c.anchorInput.replace(/"/g,"\x26quot;")),c.textInput||(c.textInput="\x26nbsp;"));return c},setValue:function(c){this._onCloseDialog();if(!this.editor.window.getSelection){var b=
C.range.getSelection(this.editor.window).getRangeAt(0).endContainer;3===b.nodeType&&(b=b.parentNode);b&&b.nodeName&&"a"!==b.nodeName.toLowerCase()&&(b=this.editor._sCall("getSelectedElement",["a"]));b&&b.nodeName&&"a"===b.nodeName.toLowerCase()&&this.editor.queryCommandEnabled("unlink")&&(this.editor._sCall("selectElementChildren",[b]),this.editor.execCommand("unlink"))}c=this._checkValues(c);this.editor.execCommand("inserthtml",v.string.substitute(this.htmlTemplate,c))},_onCloseDialog:function(){this.editor.focus()},
_getCurrentValues:function(c){if(c&&"a"===c.tagName.toLowerCase()&&v.attr(c,"name")){var b=v.attr(c,"name");var g=c.textContent||c.innerText;this.editor._sCall("selectElement",[c,!0])}else g=this.editor._sCall("getSelectedText");return{anchorInput:b||"",textInput:g||""}},_onOpenDialog:function(){if(this.editor.window.getSelection)var c=this.editor._sCall("getAncestorElement",["a"]);else c=C.range.getSelection(this.editor.window).getRangeAt(0).endContainer,3===c.nodeType&&(c=c.parentNode),c&&c.nodeName&&
"a"!==c.nodeName.toLowerCase()&&(c=this.editor._sCall("getSelectedElement",["a"]));this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(c))},_onDblClick:function(c){c&&c.target&&(c=c.target,"a"===(c.tagName?c.tagName.toLowerCase():"")&&v.attr(c,"name")&&(this.editor.onDisplayChanged(),this.editor._sCall("selectElement",[c]),setTimeout(v.hitch(this,function(){this.button.set("disabled",!1);this.button.openDropDown();this.button.dropDown.focus&&this.button.dropDown.focus()}),
10)))},_preDomFilter:function(c){v.query("a[name]:not([href])",this.editor.editNode).addClass("dijitEditorPluginInsertAnchorStyle")},_postDomFilter:function(c){c&&v.query("a[name]:not([href])",c).removeClass("dijitEditorPluginInsertAnchorStyle");return c}});v.subscribe(C._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin){var b=c.args.name;b&&(b=b.toLowerCase());"insertanchor"===b&&(c.plugin=new H)}});return H})},"dojox/editor/plugins/Blockquote":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/ToggleButton dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Blockquote".split(" "),
function(v,C,L,I){var H=v.declare("dojox.editor.plugins.Blockquote",I,{iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=v.i18n.getLocalization("dojox.editor.plugins","Blockquote");this.button=new C.form.ToggleButton({label:this._nlsResources.blockquote,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Blockquote",tabIndex:"-1",onClick:v.hitch(this,"_toggleQuote")})},setEditor:function(c){this.editor=c;this._initButton();this.connect(this.editor,
"onNormalizedDisplayChanged","updateState");c.customUndo=!0},_toggleQuote:function(c){try{var b=this.editor;b.focus();var g=this.button.get("checked"),f=C.range.getSelection(b.window),m,q,n,u;f&&0<f.rangeCount&&(m=f.getRangeAt(0));if(m){b.beginEditing();if(g)if(m.startContainer===m.endContainer){if(this._isRootInline(m.startContainer)){for(n=m.startContainer;n&&n.parentNode!==b.editNode;)n=n.parentNode;for(;n&&n.previousSibling&&(this._isTextElement(n)||1===n.nodeType&&this._isInlineFormat(this._getTagName(n)));)n=
n.previousSibling;n&&1===n.nodeType&&!this._isInlineFormat(this._getTagName(n))&&(n=n.nextSibling);if(n){var z=b.document.createElement("blockquote");v.place(z,n,"after");z.appendChild(n);for(u=z.nextSibling;u&&(this._isTextElement(u)||1===u.nodeType&&this._isInlineFormat(this._getTagName(u)));)z.appendChild(u),u=z.nextSibling}}else{for(var D=m.startContainer;(this._isTextElement(D)||this._isInlineFormat(this._getTagName(D))||"li"===this._getTagName(D))&&D!==b.editNode&&D!==b.document.body;)D=D.parentNode;
D!==b.editNode&&D!==D.ownerDocument.documentElement&&(z=b.document.createElement("blockquote"),v.place(z,D,"after"),z.appendChild(D))}z&&(b._sCall("selectElementChildren",[z]),b._sCall("collapse",[!0]))}else{var d;n=m.startContainer;for(u=m.endContainer;n&&this._isTextElement(n)&&n.parentNode!==b.editNode;)n=n.parentNode;for(d=n;d.nextSibling&&b._sCall("inSelection",[d]);)d=d.nextSibling;u=d;if(u===b.editNode||u===b.document.body){z=b.document.createElement("blockquote");v.place(z,n,"after");var l=
this._getTagName(n);if(this._isTextElement(n)||this._isInlineFormat(l))for(b=n;b&&(this._isTextElement(b)||1===b.nodeType&&this._isInlineFormat(this._getTagName(b)));)z.appendChild(b),b=z.nextSibling;else z.appendChild(n);return}u=u.nextSibling;for(d=n;d&&d!==u;){if(1===d.nodeType){if(l=this._getTagName(d),"br"!==l){if(!window.getSelection&&"p"===l&&this._isEmpty(d)){d=d.nextSibling;continue}this._isInlineFormat(l)?z||(z=b.document.createElement("blockquote"),v.place(z,d,"after")):(z&&this._isEmpty(z)&&
z.parentNode.removeChild(z),z=b.document.createElement("blockquote"),v.place(z,d,"after"));z.appendChild(d);d=z}}else this._isTextElement(d)&&(z||(z=b.document.createElement("blockquote"),v.place(z,d,"after")),z.appendChild(d),d=z);d=d.nextSibling}z&&(this._isEmpty(z)?z.parentNode.removeChild(z):(b._sCall("selectElementChildren",[z]),b._sCall("collapse",[!0])),z=null)}else if(z=!1,m.startContainer===m.endContainer){for(q=m.endContainer;q&&q!==b.editNode&&q!==b.document.body;){if("blockquote"===(q.tagName?
q.tagName.toLowerCase():"")){z=!0;break}q=q.parentNode}if(z){for(var G;q.firstChild;)G=q.firstChild,v.place(G,q,"before");q.parentNode.removeChild(q);G&&(b._sCall("selectElementChildren",[G]),b._sCall("collapse",[!0]))}}else{n=m.startContainer;for(u=m.endContainer;n&&this._isTextElement(n)&&n.parentNode!==b.editNode;)n=n.parentNode;for(m=[];n&&n.nextSibling&&b._sCall("inSelection",[n]);)n.parentNode&&"blockquote"===this._getTagName(n.parentNode)&&(n=n.parentNode),m.push(n),n=n.nextSibling;for(var P=
this._findBlockQuotes(m);P.length;){var p=P.pop();if(p.parentNode){for(;p.firstChild;)v.place(p.firstChild,p,"before");p.parentNode.removeChild(p)}}}b.endEditing()}b.onNormalizedDisplayChanged()}catch(t){}},updateState:function(){var c=this.editor,b=this.get("disabled");if(c&&c.isLoaded&&this.button&&(this.button.set("disabled",b),!b)){b=!1;var g=C.range.getSelection(c.window);if(g&&0<g.rangeCount&&(g=g.getRangeAt(0)))var f=g.endContainer;for(;f&&f!==c.editNode&&f!==c.document;){if("blockquote"===
(f.tagName?f.tagName.toLowerCase():"")){b=!0;break}f=f.parentNode}this.button.set("checked",b)}},_findBlockQuotes:function(c){var b=[];if(c){var g;for(g=0;g<c.length;g++){var f=c[g];1===f.nodeType&&("blockquote"===this._getTagName(f)&&b.push(f),f.childNodes&&0<f.childNodes.length&&(b=b.concat(this._findBlockQuotes(f.childNodes))))}}return b},_getTagName:function(c){var b="";c&&1===c.nodeType&&(b=c.tagName?c.tagName.toLowerCase():"");return b},_isRootInline:function(c){var b=this.editor;if(this._isTextElement(c)&&
c.parentNode===b.editNode||1===c.nodeType&&this._isInlineFormat(c)&&c.parentNode===b.editNode)return!0;if(this._isTextElement(c)&&this._isInlineFormat(this._getTagName(c.parentNode))){for(c=c.parentNode;c&&c!==b.editNode&&this._isInlineFormat(this._getTagName(c));)c=c.parentNode;if(c===b.editNode)return!0}return!1},_isTextElement:function(c){return c&&3===c.nodeType||4===c.nodeType?!0:!1},_isEmpty:function(c){if(c.childNodes){var b=!0,g;for(g=0;g<c.childNodes.length;g++){var f=c.childNodes[g];if(1===
f.nodeType){if("p"!==this._getTagName(f)||v.trim(f.innerHTML)){b=!1;break}}else if(this._isTextElement(f)){if((f=v.trim(f.nodeValue))&&"\x26nbsp;"!==f&&"\u00a0"!==f){b=!1;break}}else{b=!1;break}}return b}return!0},_isInlineFormat:function(c){switch(c){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "img":case "small":return!0;default:return!1}}});v.subscribe(C._scopeName+".Editor.getPlugin",
null,function(c){c.plugin||"blockquote"!==c.args.name.toLowerCase()||(c.plugin=new H({}))});return H})},"dojox/editor/plugins/UploadImage":function(){define("dojo dijit dojox dijit/_editor/_Plugin dojo/_base/connect dojo/_base/declare dojox/form/FileUploader dijit/_editor/_Plugin".split(" "),function(v,C,L,I){v.experimental("dojox.editor.plugins.UploadImage");var H=v.declare("dojox.editor.plugins.UploadImage",I,{tempImageUrl:"",iconClassPrefix:"editorIcon",useDefaultCommand:!1,uploadUrl:"",button:null,
label:"Upload",setToolbar:function(c){this.button.destroy();this.createFileInput();c.addChild(this.button)},_initButton:function(){this.command="uploadImage";this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){this.button.set("disabled",this.get("disabled"))},createFileInput:function(){var c=v.create("span",{innerHTML:"."},document.body);v.style(c,{width:"40px",height:"20px",paddingLeft:"8px",paddingRight:"8px"});this.button=
new L.form.FileUploader({isDebug:!0,uploadUrl:this.uploadUrl,uploadOnChange:!0,selectMultipleFiles:!1,baseClass:"dojoxEditorUploadNorm",hoverClass:"dojoxEditorUploadHover",activeClass:"dojoxEditorUploadActive",disabledClass:"dojoxEditorUploadDisabled"},c);this.connect(this.button,"onChange","insertTempImage");this.connect(this.button,"onComplete","onComplete")},onComplete:function(c,b,g){c=c[0];b=v.byId(this.currentImageId,this.editor.document);g=this.downloadPath?this.downloadPath+c.name:c.file;
b.src=g;v.attr(b,"_djrealurl",g);c.width&&(b.width=c.width,b.height=c.height)},insertTempImage:function(){this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+this.tempImageUrl+'" width\x3d"32" height\x3d"32"/\x3e')}});v.subscribe(C._scopeName+".Editor.getPlugin",null,function(c){if(!c.plugin)switch(c.args.name){case "uploadImage":c.plugin=new H({url:c.args.url})}});return H})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u,z,D,d,l,G,P,p,t,y,F,N,x,E){v.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return C("dojox.form.FileUploader",[t,y,F],{swfPath:d.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(N.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();if("flash"==this.uploaderType)var k="createFlashUploader";else this.uploaderType="html",k="createHtmlUploader";this[k]();this.fileListId&&this.connect(f.byId(this.fileListId),"click",function(h){h=h.target.parentNode.parentNode.parentNode;h.id&&-1<h.id.indexOf("file_")&&
this.removeFile(h.id.split("file_")[1])});p.addOnUnload(this,this.destroy)},getHiddenNode:function(k){if(!k)return null;var h=null;for(k=k.parentNode;k&&"body"!=k.tagName.toLowerCase();){if("none"==m.get(k,"display")){h=k;break}k=k.parentNode}return h},getButtonStyle:function(){var k=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(k))&&m.set(this._hiddenNode,"display","block");if(!k&&this.button&&this.button.domNode){var h=!0;k=this.button.domNode.className+" dijitButtonNode";var B=this.getText(g(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=k=z.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+k+'"\x3e'+B+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(k=this.button);n.get(k,"class")&&(this.baseClass+=" "+n.get(k,"class"));n.set(k,"class",this.baseClass);this.norm=this.getStyle(k);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(k,this.baseClass+" "+this.hoverClass,h),this.down=this.getTempNodeStyle(k,this.baseClass+" "+this.activeClass,h),this.dsbl=this.getTempNodeStyle(k,this.baseClass+" "+this.disabledClass,h),this.fhtml={cn:this.getText(k),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(k),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){m.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&m.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
m.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),m.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):z.destroy(this.progNode);
m.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});u.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&u.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(h){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);c.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var k=H.connect(this,"onReady",this,function(){H.disconnect(k);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&m.set(this._hiddenNode,"display","none")},onChange:function(k){},onProgress:function(k){},onComplete:function(k){},onCancel:function(){},onError:function(k){},onReady:function(k){},onLoad:function(k){},submit:function(k){k=k?D.toObject(k):null;this.upload(k);return!1},upload:function(k){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var h=l.byId(this.progressWidgetId).domNode;"none"==m.get(h,"display")&&(this.restoreProgDisplay="none",m.set(h,"display","block"));"hidden"==m.get(h,"visibility")&&(this.restoreProgDisplay="hidden",m.set(h,"visibility","visible"))}k&&!k.target&&(this.postData=k);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(k=0;k<this.fileList.length;k++)h=
this.fileList[k],h.bytesLoaded=0,h.bytesTotal=h.size||1E5,h.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(k,h){var B;for(B=0;B<this.fileList.length;B++)if(this.fileList[B].name==k){h||this.fileList.splice(B,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(k):h||(z.destroy(this.fileInputs[B]),this.fileInputs.splice(B,1),this._renumberInputs());this.fileListId&&z.destroy("file_"+k)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(I.forEach(this._subs,H.unsubscribe,dojo),I.forEach(this._cons,H.disconnect,dojo),this.scrollConnect&&H.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(z.destroy(this._fileInput),z.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(H.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(k){!0===k?("flash"==this.uploaderType?m.set(this.insideNode,"top","-2500px"):m.set(this.insideNode,"display",
"none"),m.set(this.progNode,"display","")):!1===k?(m.set(this.insideNode,{display:"",top:"0"}),m.set(this.progNode,"display","none")):m.set(this.progNode,"width",k*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var k=!1,h=H.connect(this,"_complete",function(){H.disconnect(h);k=!0}),B=0,M=setInterval(L.hitch(this,function(){B+=5;B>this.fhtml.nr.w&&(B=0,k=!0);this._displayProgress(B/this.fhtml.nr.w);k&&(clearInterval(M),setTimeout(L.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(k){"string"==typeof k&&(k=Error(k));this.onError(k)},_addToFileList:function(){if(this.fileListId){var k="";I.forEach(this.fileList,function(h){k+='\x3ctable id\x3d"file_'+h.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+h.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(h.size?Math.ceil(.001*h.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);f.byId(this.fileListId).innerHTML=
k}},_change:function(k){b("ie")&&I.forEach(k,function(h){h.name=h.name.split("\\")[h.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(k):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=k);this._addToFileList();this.onChange(k);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(k){k=
L.isArray(k)?k:[k];I.forEach(k,function(h){h.ERROR&&this._error(h.ERROR)},this);I.forEach(this.fileList,function(h){h.bytesLoaded=1;h.bytesTotal=1;h.percent=100;this._progress(h)},this);I.forEach(this.fileList,function(h){this.removeFile(h.name,!0)},this);this.onComplete(k);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(L.hitch(this,function(){m.set(l.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(k){for(var h=0,B=0,M=0;M<this.fileList.length;M++){var a=this.fileList[M];a.name==k.name&&(a.bytesLoaded=k.bytesLoaded,a.bytesTotal=k.bytesTotal,a.percent=Math.ceil(a.bytesLoaded/a.bytesTotal*100),this.log(a.name,"percent:",a.percent));B+=Math.ceil(.001*a.bytesLoaded);h+=Math.ceil(.001*a.bytesTotal)}k=Math.ceil(B/h*100);this.progressWidgetId&&l.byId(this.progressWidgetId).update({progress:k+"%"});this.showProgress&&this._displayProgress(.01*k);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(k){if(this._disabled!=k){if("flash"==this.uploaderType){if(!this.flashReady){var h=H.connect(this,"onLoad",this,function(){H.disconnect(h);this._setDisabledAttr(k)});return}this._disabled=k;this.flashMovie.doDisable(k)}else this._disabled=k,m.set(this._fileInput,"display",this._disabled?"none":"");u.toggle(this.domNode,this.disabledClass,k)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var k=
g("[tabIndex]"),h=0;h<k.length;h++)if(k[h].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=k[h];break}this.nextFocusObject.focus()},_disconnect:function(){I.forEach(this._cons,H.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&z.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();G.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:L.hitch(this,function(k){this._error("HTML Upload Error:"+k.message)}),load:L.hitch(this,
function(k,h,B){this._complete(k)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();m.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(H.connect(this._fileInput,"mouseover",this,function(k){u.add(this.domNode,this.hoverClass);this.onMouseOver(k)}));this._cons.push(H.connect(this._fileInput,"mouseout",this,function(k){setTimeout(L.hitch(this,
function(){u.remove(this.domNode,this.activeClass);u.remove(this.domNode,this.hoverClass);this.onMouseOut(k);this._checkHtmlCancel("off")}),0)}));this._cons.push(H.connect(this._fileInput,"mousedown",this,function(k){u.add(this.domNode,this.activeClass);u.remove(this.domNode,this.hoverClass);this.onMouseDown(k)}));this._cons.push(H.connect(this._fileInput,"mouseup",this,function(k){u.remove(this.domNode,this.activeClass);this.onMouseUp(k);this.onClick(k);this._checkHtmlCancel("up")}));this._cons.push(H.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var k=this._fileInput.value;k?this._change([{name:k,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&n.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(k){"change"==k&&(this.dialogIsOpen=!1);"up"==k&&(this.dialogIsOpen=!0);if("off"==k){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var k=this.fhtml.nr;m.set(this.insideNode,{width:k.w+"px",height:"middle"==k.va?k.h+"px":"auto",
textAlign:k.ta,paddingTop:k.p[0]+"px",paddingRight:k.p[1]+"px",paddingBottom:k.p[2]+"px",paddingLeft:k.p[3]+"px"});try{m.set(this.insideNode,"lineHeight","inherit")}catch(h){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],g("*",this._formNode).forEach(function(k){z.destroy(k)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>b("ie")||b("ie")&&b("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=l.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=z.create("form",{enctype:"multipart/form-data",method:"post",id:l.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,m.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var k=
this.htmlFieldName;this.selectMultipleFiles&&(k+=this.fileCount,this.fileCount++);n.set(this._fileInput,{id:this.id,name:k,type:"file"});u.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);k=q.getMarginBox(this._fileInput);m.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-k.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var k;this.fileCount=0;I.forEach(this.fileInputs,function(h){k=this.htmlFieldName+this.fileCount;this.fileCount++;
n.set(h,"name",k)},this)}},_setFormStyle:function(){E.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");m.set(this.domNode,{overflow:"hidden",position:"relative"});m.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var k in this.postData)z.create("input",{type:"hidden",name:k,value:this.postData[k]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var k=H.connect(this,"_complete",this,function(){H.disconnect(k);this._displayProgress(!1)})}var h={},B;for(B in this.postData)h[B]=this.postData[B];this.flashMovie.doUpload(h)}catch(M){this._error("FileUploader - Sorry, the SWF failed to initialize."+M)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var k=window.location.href.split("/");k.pop();k=k.join("/")+"/";this.uploadUrl=k+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",k," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");k={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:x.serialize("fh",this.fhtml),fileMask:x.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new N(k,this.insideNode);this.flashObject.onError=L.hitch(function(h){this._error("Flash Error: "+h)});this.flashObject.onReady=L.hitch(this,function(){m.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=L.hitch(this,function(h){this.flashMovie=h;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&n.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(k,h){this._subs.push(H.subscribe(this.id+k,this,h))},urlencode:function(k){return k&&"none"!=k?k.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(k){k=k.tagName.toLowerCase();
return"button"==k||"input"==k},getTextStyle:function(k){var h={};h.ff=m.get(k,"fontFamily");if(h.ff){h.ff=h.ff.replace(", ",",");h.ff=h.ff.replace(/"|'/g,"");h.ff="sans-serif"==h.ff?"Arial":h.ff;h.fw=m.get(k,"fontWeight");h.fi=m.get(k,"fontStyle");h.fs=parseInt(m.get(k,"fontSize"),10);if(-1<m.get(k,"fontSize").indexOf("%"))for(var B=k;B.tagName;){if(-1==m.get(B,"fontSize").indexOf("%")){h.fs=parseInt(m.get(B,"fontSize"),10);break}"body"==B.tagName.toLowerCase()&&(h.fs=.16*parseInt(m.get(B,"fontSize"),
10));B=B.parentNode}h.fc=(new P(m.get(k,"color"))).toHex();h.fc=parseInt(h.fc.substring(1,Infinity),16)}h.lh=m.get(k,"lineHeight");h.ta=m.get(k,"textAlign");h.ta="start"!=h.ta&&h.ta?h.ta:"left";h.va=this.isButton(k)?"middle":h.lh==h.h?"middle":m.get(k,"verticalAlign");return h},getText:function(k){k=L.trim(k.innerHTML);-1<k.indexOf("\x3c")&&(k=escape(k));return k},getStyle:function(k){var h={},B=q.getContentBox(k),M=q.getPadExtents(k);h.p=[M.t,M.w-M.l,M.h-M.t,M.l];h.w=B.w+M.w;h.h=B.h+M.h;h.d=m.get(k,
"display");B=new P(m.get(k,"backgroundColor"));h.bc=0==B.a?"#ffffff":B.toHex();h.bc=parseInt(h.bc.substring(1,Infinity),16);if(B=this.urlencode(m.get(k,"backgroundImage")))h.bi={url:B,rp:m.get(k,"backgroundRepeat"),pos:escape(m.get(k,"backgroundPosition"))},h.bi.pos||(B=m.get(k,"backgroundPositionX"),M=m.get(k,"backgroundPositionY"),h.bi.pos=escape(("left"==B?"0%":"right"==B?"100%":B)+" "+("top"==M?"0%":"bottom"==M?"100%":M)));return L.mixin(h,this.getTextStyle(k))},getTempNodeStyle:function(k,h,
B){if(B){B=z.place("\x3c"+k.tagName+"\x3e\x3cspan\x3e"+k.innerHTML+"\x3c/span\x3e\x3c/"+k.tagName+"\x3e",k.parentNode);var M=B.firstChild;u.add(M,k.className);u.add(B,h);k=this.getStyle(M)}else B=z.place("\x3c"+k.tagName+"\x3e"+k.innerHTML+"\x3c/"+k.tagName+"\x3e",k.parentNode),u.add(B,k.className),u.add(B,h),B.id=k.id,k=this.getStyle(B);z.destroy(B);return k}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(v,C,L,I,H,c,b,g,f,m,q,n,u){L.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");c=u._iframeName;c=c.substring(0,c.lastIndexOf("_"));var z=I.delegate(u,{create:function(){return z._frame=u.create.apply(u,arguments)},get:null,post:null,send:function(D){var d=H._ioSetArgs(D,function(y){t&&t.cancel()},function(y){var F=null;y=y.ioArgs;try{var N=y.handleAs;"xml"===N||"html"===N?F=t.response.data:(F=t.response.text,"json"===N?F=C.fromJson(F):"javascript"===N&&(F=L.eval(F)))}catch(x){F=
x}return F},function(y,F){F.ioArgs._hasError=!0;return y}),l=d.ioArgs,G="GET",P=g.byId(D.form);D.method&&"POST"===D.method.toUpperCase()&&P&&(G="POST");D={method:G,handleAs:"json"===D.handleAs||"javascript"===D.handleAs?"text":D.handleAs,form:D.form,query:P?null:D.content,data:P?D.content:null,timeout:D.timeout,ioArgs:l};D.method&&(D.method=D.method.toUpperCase());if(v.ioPublish&&L.publish&&!1!==l.args.ioPublish)var p=n.after(u,"_notifyStart",function(y){y.options.ioArgs===l&&(p.remove(),H._ioNotifyStart(d))},
!0);var t=u(l.url,D,!0);l._callNext=t._callNext;t.then(function(){d.resolve(d)}).otherwise(function(y){d.ioArgs.error=y;d.reject(y)});return d},_iframeOnload:b.global[c+"_onload"]});I.setObject("dojo.io.iframe",z);return z})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(v,C,L,I,H,c,b,g,f){function m(d){d=v.delegate(n,d);if(!("path"in d))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in d||(d.id="dojox-embed-flash-"+q++);return d}var q=0,n={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};if(H("ie")){var u=function(d){d=m(d);if(!d)return null;var l,G=d.path;if(d.vars){var P=[];for(l in d.vars)P.push(encodeURIComponent(l)+"\x3d"+encodeURIComponent(d.vars[l]));d.params.FlashVars=P.join("\x26");delete d.vars}G='\x3cobject id\x3d"'+f.escape(String(d.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
f.escape(String(d.width))+'" height\x3d"'+f.escape(String(d.height))+'"'+(d.style?' style\x3d"'+f.escape(String(d.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+f.escape(String(G))+'" /\x3e';if(d.params)for(l in d.params)G+='\x3cparam name\x3d"'+f.escape(l)+'" value\x3d"'+f.escape(String(d.params[l]))+'" /\x3e';return{id:d.id,markup:G+"\x3c/object\x3e"}};var z=function(){for(var d=10,l=null;!l&&7<d;)try{l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d--)}catch(G){}return l?(d=l.GetVariable("$version").split(" ")[1].split(","),
{major:null!=d[0]?parseInt(d[0]):0,minor:null!=d[1]?parseInt(d[1]):0,rev:null!=d[2]?parseInt(d[2]):0}):{major:0,minor:0,rev:0}}();C.addOnWindowUnload(function(){console.warn("***************UNLOAD");var d=function(){};I("object").reverse().style("display","none").forEach(function(l){for(var G in l)if("FlashVars"!=G&&"function"==typeof l[G])try{l[G]=d}catch(P){}})})}else u=function(d){d=m(d);if(!d)return null;var l,G=d.path;if(d.vars){var P=[];for(l in d.vars)P.push(encodeURIComponent(l)+"\x3d"+encodeURIComponent(d.vars[l]));
d.params.flashVars=P.join("\x26");delete d.vars}G='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+f.escape(String(G))+'" id\x3d"'+f.escape(String(d.id))+'" width\x3d"'+f.escape(String(d.width))+'" height\x3d"'+f.escape(String(d.height))+'"'+(d.style?' style\x3d"'+f.escape(String(d.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(d.params)for(l in d.params)G+=" "+f.escape(l)+'\x3d"'+f.escape(String(d.params[l]))+'"';return{id:d.id,markup:G+
" /\x3e"}},z=function(){var d=navigator.plugins["Shockwave Flash"];return d&&d.description?(d=d.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=d[0]?parseInt(d[0]):0,minor:null!=d[1]?parseInt(d[1]):0,rev:null!=d[2]?parseInt(d[2]):0}):{major:0,minor:0,rev:0}}();var D=function(d,l){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=z.major;this.minimumVersion=d.minimumVersion||9;this.domNode=this.movie=this.id=null;l&&(l=c.byId(l));setTimeout(v.hitch(this,function(){if(d.expressInstall||this.available&&this.available>=this.minimumVersion)if(d&&l)this.init(d,l);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};v.extend(D,{onReady:function(d){},onLoad:function(d){},onError:function(d){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(d,l){this.destroy();l=c.byId(l||this.domNode);if(!l)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var G=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;D.initialized&&(this.id=D.place(d,l),this.domNode=l,setTimeout(v.hitch(this,
function(){this.movie=this.byId(this.id,d.doc);this.onReady(this.movie);this._poller=setInterval(v.hitch(this,function(){try{G=this.movie.PercentLoaded()}catch(P){console.warn("this.movie.PercentLoaded() failed",P,this.movie)}if(100==G)this._onload();else if(0==G&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(d){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var d=
v.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),l;for(l in this)d[l]||delete this[l];this._poller?b(this,"Load",this,"_destroy"):this._destroy()}},byId:function(d,l){l=l||document;return l.embeds[d]?l.embeds[d]:l[d]?l[d]:window[d]?window[d]:document[d]?document[d]:null}});v.mixin(D,{minSupported:8,available:z.major,supported:z.major>=z.required,minimumRequired:z.required,version:z,initialized:!1,onInitialize:function(){D.initialized=!0},__ie_markup__:function(d){return u(d)},proxy:function(d,
l){L.forEach(l instanceof Array?l:[l],function(G){this[G]=v.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+G+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+L.map(arguments,function(P){return __flash__toXML(P)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},d)}});D.place=function(d,l){d=u(d);l=c.byId(l);l||(l=g.doc.createElement("div"),l.id=d.id+"-container",g.body().appendChild(l));return d?(l.innerHTML=d.markup,
d.id):null};D.onInitialize();v.setObject("dojox.embed.Flash",D);return D})},"dojox/embed/flashVars":function(){define(["dojo"],function(v){v.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var C={serialize:function(L,I){var H=function(f){"string"==typeof f&&(f=f.replace(/;/g,"_sc_"),f=f.replace(/\./g,"_pr_"),f=f.replace(/:/g,"_cl_"));return f},c=dojox.embed.flashVars.serialize,b="";if(v.isArray(I)){for(var g=0;g<I.length;g++)b+=c(L+"."+g,H(I[g]))+";";return b.replace(/;{2,}/g,";")}if(v.isObject(I)){for(g in I)b+=
c(L+"."+g,H(I[g]))+";";return b.replace(/;{2,}/g,";")}return L+":"+I}};v.setObject("dojox.embed.flashVars",C);return C})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(v,C,L,I){var H=v.getObject("dojox.html",!0),c={},b={},g=[];H.insertCssRule=function(f,m,q){q=H.getDynamicStyleSheet(q);var n=f+" {"+m+"}";console.log("insertRule:",n);I("ie")?(q.cssText+=n,console.log("ss.cssText:",q.cssText)):q.sheet?q.sheet.insertRule(n,
q._indicies.length):q.appendChild(L.doc.createTextNode(n));q._indicies.push(f+" "+m);return f};H.removeCssRule=function(f,m,q){var n=-1,u,z;for(u in c)if(!q||q===u){var D=c[u];for(z=0;z<D._indicies.length;z++)if(f+" "+m===D._indicies[z]){n=z;break}if(-1<n)break}if(!D)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===n)return console.warn("The css rule was not found and could not be removed."),!1;D._indicies.splice(n,1);I("ie")?D.removeRule(n):D.sheet&&
D.sheet.deleteRule(n);return!0};H.modifyCssRule=function(f,m,q){};H.getStyleSheet=function(f){if(c[f||"default"])return c[f||"default"];if(!f)return!1;var m=H.getStyleSheets();if(m[f])return H.getStyleSheets()[f];for(var q in m)if(m[q].href&&-1<m[q].href.indexOf(f))return m[q];return!1};H.getDynamicStyleSheet=function(f){f||(f="default");c[f]||(L.doc.createStyleSheet?(c[f]=L.doc.createStyleSheet(),9>I("ie")&&(c[f].title=f)):(c[f]=L.doc.createElement("style"),c[f].setAttribute("type","text/css"),L.doc.getElementsByTagName("head")[0].appendChild(c[f]),
console.log(f," ss created: ",c[f].sheet)),c[f]._indicies=[]);return c[f]};H.enableStyleSheet=function(f){if(f=H.getStyleSheet(f))f.sheet?f.sheet.disabled=!1:f.disabled=!1};H.disableStyleSheet=function(f){if(f=H.getStyleSheet(f))f.sheet?f.sheet.disabled=!0:f.disabled=!0};H.activeStyleSheet=function(f){var m=H.getToggledStyleSheets(),q;if(1===arguments.length)C.forEach(m,function(n){n.disabled=n.title===f?!1:!0});else for(q=0;q<m.length;q++)if(!1===m[q].disabled)return m[q];return!0};H.getPreferredStyleSheet=
function(){};H.getToggledStyleSheets=function(){var f;if(!g.length){var m=H.getStyleSheets();for(f in m)m[f].title&&g.push(m[f])}return g};H.getStyleSheets=function(){if(b.collected)return b;C.forEach(L.doc.styleSheets,function(f){var m=f.sheet?f.sheet:f;f=m.title||m.href;if(I("ie"))-1===m.cssText.indexOf("#default#VML")&&(m.href?b[f]=m:m.imports.length?C.forEach(m.imports,function(q){b[q.title||q.href]=q}):b[f]=m);else{b[f]=m;b[f].id=m.ownerNode.id;f=[];try{f=m[m.cssRules?"cssRules":"rules"]}catch(q){console.warn("Reading css rules from stylesheet "+
m.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",m)}C.forEach(f,function(q){q.href&&(b[q.href]=q.styleSheet,b[q.href].id=m.ownerNode.id)})}});b.collected=!0;return b};return H})},"widgets/BatchAttributeEditor/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/BatchAttributeEditor/setting/SymChooser.html":'\x3cdiv style\x3d"height:100%;width:100%;overflow:auto"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"symbolPage"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"symbolSelector" data-dojo-type\x3d"jimu/dijit/SymbolChooser"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n\r\n',
"url:widgets/BatchAttributeEditor/setting/Setting.html":'\x3cdiv style\x3d"width:100%;"\x3e\r\n\r\n\x3cdiv data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"firstPageDiv"\x3e\r\n        \x3cdiv class\x3d"settings-heading" data-dojo-attach-point\x3d"tableToolHeader"\x3e${nls.page1.selectToolHeader}\x3c/div\x3e\r\n        \x3cdiv class\x3d"settings-description" data-dojo-attach-point\x3d"tableToolDescription"\x3e${nls.page1.selectToolDesc}\x3c/div\x3e\r\n\r\n        \x3ctable class\x3d"setting-tool-table" cellspacing\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                         \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"selectByShape"\r\n                               data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"selectByShape" checked /\x3e\r\n                        \x3cspan\x3e${nls.page1.selectByShape}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"drawToolSelection"\x3e\r\n                            ${nls.page1.shapeTypeSelector}\x3cbr\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.point}" data-dojo-attach-point\x3d"drawPoint" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.line}" data-dojo-attach-point\x3d"drawLine" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.polyline}" data-dojo-attach-point\x3d"drawPolyline" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.freehandPolyline}" data-dojo-attach-point\x3d"drawFreehandPolyline" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.extent}" data-dojo-attach-point\x3d"drawExtent" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.polygon}" data-dojo-attach-point\x3d"drawPolygon" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon"\x3e\x3c/div\x3e\r\n                            \x3cdiv title\x3d"${nls.page1.shapeType.freehandPolygon}" data-dojo-attach-point\x3d"drawFreehandPolygon" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon"\x3e\x3c/div\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr class\x3d"controls"\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"selectByFeature"\r\n                               data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"selectByFeature" /\x3e\r\n                        \x3cspan\x3e${nls.page1.selectBySpatQuery}\x3c/span\x3e\r\n\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr class\x3d"controls"\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"selectByFeatureQuery"\r\n                               data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"selectByFeatureQuery" /\x3e\r\n                        \x3cspan\x3e${nls.page1.selectByAttQuery}\x3c/span\x3e\r\n\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3c!--\r\n                \x3ctr class\x3d"controls"\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"selectByQuery"\r\n                               data-dojo-type\x3d"dijit/form/RadioButton" value\x3d"selectByQuery" /\x3e\r\n                        \x3cspan\x3e${nls.page1.selectByQuery}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n\t\t\t\t--\x3e\r\n            \x3c/tbody\x3e\r\n        \x3c/table\x3e\x3cbr /\x3e\r\n\r\n        \x3ctable class\x3d"settings-navigation-table" data-dojo-attach-point\x3d"pageOneControls" cellspacing\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n\r\n                \x3ctr class\x3d"controls"\x3e\r\n\r\n                    \x3ctd\x3e\r\n                        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:page1ToPage2"\x3e${nls.next}\x3c/div\x3e\r\n                        \x3cspan class\x3d"settings-error" data-dojo-attach-point\x3d"settingsFirstPageError" style\x3d"display:none"\x3e${nls.page1.toolNotSelected}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3cspan class\x3d"settings-error" data-dojo-attach-point\x3d"settingsFirstPageSaveError" style\x3d"display:none"\x3e${nls.errorOnOk}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"secondPageDiv" style\x3d"display:none"\x3e\r\n\r\n\r\n        \x3cdiv class\x3d"settings-heading" data-dojo-attach-point\x3d"layersToolHeader"\x3e${nls.page2.layersToolHeader}\x3c/div\x3e\r\n        \x3cdiv class\x3d"settings-description" data-dojo-attach-point\x3d"layersToolDesc"\x3e${nls.page2.layersToolDesc}\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"setting-layer-table" data-dojo-attach-point\x3d"tableLayerInfos"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"tableLayerInfosError" class\x3d"settings-nolayer-error" style\x3d"display:none"\x3e${nls.page2.noEditableLayers}\x3c/div\x3e\r\n        \x3cdiv class\x3d"setting-layer-toggle-checkbox-group"\x3e\r\n            \x3cdiv class\x3d"setting-layer-toggle-checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"toggleLayers"\x3e\x3c/div\x3e\r\n            \x3cspan class\x3d"setting-layer-toggle-checkbox-text"\x3e${nls.page2.toggleLayers}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3ctable class\x3d"settings-navigation-table" data-dojo-attach-point\x3d"pageTwoControls" cellspacing\x3d"0"\x3e\r\n            \x3ctbody\x3e\r\n\r\n                \x3ctr class\x3d"controls"\x3e\r\n\r\n                    \x3ctd\x3e\r\n                        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:page2ToPage1"\x3e${nls.back}\x3c/div\x3e\r\n                        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:page2ToPage3"\x3e${nls.next}\x3c/div\x3e\r\n                        \x3cspan class\x3d"settings-error" data-dojo-attach-point\x3d"settingsSecondPageError" style\x3d"display:none"\x3e${nls.page2.noLayersSelected}\x3c/span\x3e\r\n\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3cspan class\x3d"settings-error" data-dojo-attach-point\x3d"settingsSecondPageSaveError" style\x3d"display:none"\x3e${nls.errorOnOk}\x3c/span\x3e\r\n\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"thirdPageDiv" style\x3d"display:none"\x3e\r\n\r\n        \x3cdiv class\x3d"settings-heading" data-dojo-attach-point\x3d"tableCommonFieldHeader"\x3e${nls.page3.commonFieldsHeader}\x3c/div\x3e\r\n        \x3cdiv class\x3d"settings-description" data-dojo-attach-point\x3d"tableCommonFieldDesc"\x3e${nls.page3.commonFieldsDesc}\x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"setting-common-fields-table" data-dojo-attach-point\x3d"tableCommonFields"\x3e\x3c/div\x3e\x3cbr /\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"tableCommonFieldsError" class\x3d"settings-error" style\x3d"display:none"\x3e${nls.page3.noCommonFields}\x3c/div\x3e\r\n        \x3ctable class\x3d"settings-navigation-table" data-dojo-attach-point\x3d"pageThreeControls" cellspacing\x3d" 0"\x3e\r\n            \x3ctbody\x3e\r\n                \x3ctr class\x3d"controls"\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:page3ToPage2"\x3e${nls.back}\x3c/div\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n        \x3cspan class\x3d"settings-error" data-dojo-attach-point\x3d"settingsThirdPageSaveError" style\x3d"display:none"\x3e${nls.errorOnOk}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"divider"\x3e \x3c/div\x3e\r\n    \x3cdiv class\x3d"settings-heading"\x3e${nls.editHeaderText}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"editorDescription"\x3e\x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/BatchAttributeEditor/setting/css/style.css":'.solutions-widget-batcheditor-setting {margin: 0; padding: 0; font-size: 15px;}.solutions-widget-batcheditor-setting .dijitArrowButtonContainer {width: 17px;}.solutions-widget-batcheditor-setting .dijitSelect {height: 30px; width: 100%;}.solutions-widget-batcheditor-setting .editable {width: 100px;}.solutions-widget-batcheditor-setting .symbolselector {width: 140px;}.hide {display: none;}.solutions-widget-batcheditor-setting .settings-heading {font-size: 14px; margin-top: 15px; color: #2b2d39;}.solutions-widget-batcheditor-setting .settings-description {font-size: 12px; margin-top: 15px; margin-left: 10px; margin-right: 10px; color: #2b2d39;}.solutions-widget-batcheditor-setting .settings-error {font-size: 12px; font-style: italic; color: #999999;}.solutions-widget-batcheditor-setting .settings-nolayer-error {font-size: 12px; font-style: italic; color: #999999; margin-left: 10px; margin-right: 10px; margin-top: 5px; margin-bottom: 5px;}.batcheditor-settings-error {float:left; font-size: 12px; font-style: italic; color: #999999;}.solutions-widget-batcheditor-setting .settings-navigation-table \x3e tbody \x3e tr \x3e .controls {width: 100%;}.solutions-widget-batcheditor-setting .settings-navigation-table \x3e tbody \x3e tr \x3e td {vertical-align: middle; font-size: 1em;}.solutions-widget-batcheditor-setting .setting-tool-table {margin-top: 20px; margin-left: 10px; margin-right: 10px; border-width: 0px;}.solutions-widget-batcheditor-setting .setting-tool-table \x3e tbody \x3e tr \x3e .controls {width: 100%;}.solutions-widget-batcheditor-setting .setting-tool-table \x3e tbody \x3e tr \x3e td \x3e span {margin-left: 5px; margin-right: 5px;}.solutions-widget-batcheditor-setting .setting-tool-table \x3e tbody \x3e tr \x3e td \x3e input {margin-left: 0px; margin-right: 0px;}.solutions-widget-batcheditor-setting .setting-tool-table \x3e thead \x3e tr \x3e th, .solutions-widget-batcheditor-setting .setting-tool-table \x3e tbody \x3e tr \x3e td {line-height: 22px; vertical-align: middle; font-size: 12px;}.solutions-widget-batcheditor-setting .setting-layer-table {margin-left: 10px; margin-right: 10px; margin-top: 20px; margin-bottom: 10px;}.solutions-widget-batcheditor-setting .setting-layer-toggle-checkbox-group {margin-left: 10px; margin-right: 10px; margin-top: 15px;}.solutions-widget-batcheditor-setting .setting-layer-toggle-checkbox {margin-left: 0px; margin-right: 0px;}.solutions-widget-batcheditor-setting .setting-layer-toggle-checkbox-text {font-size: 12px; color: #2b2d39;}.solutions-widget-batcheditor-setting .setting-common-fields-table {margin: 15px; padding-left: 15px; padding-right: 15px;}.solutions-widget-batcheditor-setting .draw-item {width: 40px; height: 40px; background-repeat: no-repeat; text-align: center; float: left; margin: 7px;}.solutions-widget-batcheditor-setting .point-icon {background-image: url(../images/point.png);}.solutions-widget-batcheditor-setting .line-icon {background-image: url(../images/line.png);}.solutions-widget-batcheditor-setting .polyline-icon {background-image: url(../images/polyline.png);}.solutions-widget-batcheditor-setting .freehand-polyline-icon {background-image: url(../images/freehand_polyline.png);}.solutions-widget-batcheditor-setting .extent-icon {background-image: url(../images/extent.png);}.solutions-widget-batcheditor-setting .polygon-icon {background-image: url(../images/polygon.png);}.solutions-widget-batcheditor-setting .freehand-polygon-icon {background-image: url(../images/freehand_polygon.png);}.solutions-widget-batcheditor-setting .selected {background-color: #38b5ca !important;}.solutions-widget-batcheditor-setting .footer {text-align: right;}.solutions-widget-batcheditor-setting .divider {padding-top: 15px; width: "100%"; height: "5px"; border-style: none none solid none; border-width: 2px; border-color: #c1c1c1;}.solutions-widget-batcheditor-setting .editorDiv {padding-top: "50px";}.footer {padding-top: 5px; width: 100%; height: 30px;}',
"*now":function(v){v(['dojo/i18n!*preload*widgets/BatchAttributeEditor/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/TabContainer3 dojo dojo/query dojo/_base/html dojo/dom-style dojo/_base/array dojo/on dojo/_base/lang dijit/form/Select dijit/registry dijit/Editor jimu/utils dojo/dom-construct jimu/dijit/SymbolChooser jimu/dijit/Popup jimu/LayerInfos/LayerInfos esri/toolbars/draw ./SymChooser ../utils jimu/dijit/EditorXssFilter dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage".split(" "),function(v,
C,L,I,H,c,b,g,f,m,q,n,u,z,D,d,l,G,P,p,t,y,F,N){return v([L,C],{baseClass:"solutions-widget-batcheditor-setting",layersTable:null,commonFieldsTable:null,layerSelects:null,currentLayer:null,selectionSymbols:{},currentPage:1,controlsAddedToWidgetFrame:!1,toolOption:{Shape:{value:0},FeatureSpatial:{value:1},FeatureQuery:{value:2},Query:{value:3}},drawTools:["POINT","EXTENT","POLYGON","FREEHAND_POLYGON"],tabContainer:null,popup:null,_jimuLayerInfos:null,_editorObj:null,startup:function(){this.inherited(arguments);
this.editorXssFilter=N.getInstance();p.getInstance(this.map,this.map.itemInfo).then(n.hitch(this,function(E){this._jimuLayerInfos=E}));this.tabContainer=new H({tabs:[{title:this.nls.tabs.selection,content:this.firstPageDiv},{title:this.nls.tabs.layers,content:""},{title:this.nls.tabs.fields,content:""}],isNested:!0},this.controlNode);this.tabContainer.startup();this.own(q(this.tabContainer,"tabChanged",n.hitch(this,function(E){var k=this.currentPage;if(E===this.nls.tabs.selection){if(1<k)for(;1<k;)this.btnBackClick(),
k--}else if(E===this.nls.tabs.layers)if(2>k)for(;2>k;)this.btnNextClick(),k++;else for(;2<k;)this.btnBackClick(),k--;else if(3>k)for(;3>k;)this.btnNextClick(),k++})));null===this.config&&(this.config={});void 0===this.config&&(this.config={});""===this.config&&(this.config={});this.setConfig(this.config);try{var x=this.domNode.parentNode.parentNode.parentNode.parentNode.lastChild;this.btnErrorMsg=l.toDom("\x3cdiv class\x3d'batcheditor-settings-error hide'\x3e\x3c/div\x3e");l.place(this.btnErrorMsg,
x,"first");g.addClass(this.pageOneControls,"hide");g.addClass(this.pageTwoControls,"hide");g.addClass(this.pageThreeControls,"hide");g.addClass(this.settingsFirstPageSaveError,"hide");g.addClass(this.settingsSecondPageSaveError,"hide");g.addClass(this.settingsThirdPageSaveError,"hide");this.controlsAddedToWidgetFrame=!0;this.own(q(this.selectByShape,"change",n.hitch(this,function(E){this.checkHeaderSyntax();this.showDrawTools(!0)})));this.own(q(this.selectByFeature,"change",n.hitch(this,function(E){this.checkHeaderSyntax();
this.showDrawTools(!1)})));this.own(q(this.selectByFeatureQuery,"change",n.hitch(this,function(E){this.checkHeaderSyntax();this.showDrawTools(!1)})));this.own(q(this.drawPoint,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawLine,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawPolyline,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawFreehandPolyline,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawExtent,
"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawPolygon,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.own(q(this.drawFreehandPolygon,"click",n.hitch(this,function(E){this._onItemClick(E)})));this.config.hasOwnProperty("drawTools")&&(this.drawTools=this.config.drawTools);this.drawTools.map(n.hitch(this,function(E){this.checkDrawToolsState(E)}));this._createHeaderEditor()}catch(E){console.log(E.message)}},_createHeaderEditor:function(){this._editorObj=
new D({height:"100px",plugins:"bold italic underline foreColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent".split(" "),extraPlugins:["|","createLink","unlink","pastefromword","|","undo","redo","|","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editorDescription);
this._editorObj.startup();if(this.config.hasOwnProperty("headerText"))this._editorObj.set("value",this.editorXssFilter.sanitize(this.config.headerText));else{var x=this.nls.widgetIntroSelectByArea;this.selectByShape.get("checked")&&(x=this.nls.widgetIntroSelectByArea);this.selectByFeature.get("checked")&&(x=this.nls.widgetIntroSelectByFeature);this.selectByFeatureQuery.get("checked")&&(x=this.nls.widgetIntroSelectByFeatureQuery);this._editorObj.set("value",x)}},checkHeaderSyntax:function(){var x=
this.editorXssFilter.sanitize(this._editorObj.get("value"));this.config.hasOwnProperty("headerText")&&(x=this.editorXssFilter.sanitize(this.config.headerText),this._editorObj.set("value",x));this.selectByShape.get("checked")&&x!==this.nls.widgetIntroSelectByArea&&(this.config.hasOwnProperty("headerText")&&this.config.selectByShape?this._editorObj.set("value",this.editorXssFilter.sanitize(this.config.headerText)):this._editorObj.set("value",this.nls.widgetIntroSelectByArea));this.selectByFeature.get("checked")&&
x!==this.nls.widgetIntroSelectByFeature&&(this.config.hasOwnProperty("headerText")&&this.config.selectByFeature?this._editorObj.set("value",this.editorXssFilter.sanitize(this.config.headerText)):this._editorObj.set("value",this.nls.widgetIntroSelectByFeature));this.selectByFeatureQuery.get("checked")&&x!==this.nls.widgetIntroSelectByFeatureQuery&&(this.config.hasOwnProperty("headerText")&&this.config.selectByFeatureQuery?this._editorObj.set("value",this.editorXssFilter.sanitize(this.config.headerText)):
this._editorObj.set("value",this.nls.widgetIntroSelectByFeatureQuery))},btnNextClick:function(){1===this.currentPage?this.page1ToPage2():2===this.currentPage&&this.page2ToPage3()},btnBackClick:function(){2===this.currentPage?this.page2ToPage1():3===this.currentPage&&this.page3ToPage2()},getSelectedTool:function(){if(this.selectByShape.checked)return this.toolOption.Shape;if(this.selectByFeature.checked)return this.toolOption.FeatureSpatial;if(this.selectByFeatureQuery.checked)return this.toolOption.FeatureQuery},
showDrawTools:function(x){x?this.selectByShape.get("checked")?(f.set(this.drawToolSelection,"display",""),this.config.hasOwnProperty("drawTools")&&(this.drawTools=0<this.config.drawTools.length?this.config.drawTools:["POINT","EXTENT","POLYGON","FREEHAND_POLYGON"]),this.drawTools.map(n.hitch(this,function(E){this.checkDrawToolsState(E)}))):f.set(this.drawToolSelection,"display","none"):this.selectByShape.get("checked")||(f.set(this.drawToolSelection,"display","none"),this.drawTools=[],b(".draw-item",
this.domNode).map(n.hitch(this,function(E){g.hasClass(E,"selected")&&g.removeClass(E,"selected")})))},checkDrawToolsState:function(x){switch(x){case "POINT":q.emit(this.drawPoint,"click",{bubbles:!0,cancelable:!0});break;case "LINE":q.emit(this.drawLine,"click",{bubbles:!0,cancelable:!0});break;case "POLYLINE":q.emit(this.drawPolyline,"click",{bubbles:!0,cancelable:!0});break;case "FREEHAND_POLYLINE":q.emit(this.drawFreehandPolyline,"click",{bubbles:!0,cancelable:!0});break;case "EXTENT":q.emit(this.drawExtent,
"click",{bubbles:!0,cancelable:!0});break;case "POLYGON":q.emit(this.drawPolygon,"click",{bubbles:!0,cancelable:!0});break;case "FREEHAND_POLYGON":q.emit(this.drawFreehandPolygon,"click",{bubbles:!0,cancelable:!0})}},_onItemClick:function(x){var E=x.target||x.srcElement;b(".draw-item",this.domNode);g.hasClass(E,"selected")?1<this.drawTools.length&&(g.removeClass(E,"selected"),this.drawTools=this.drawTools.filter(n.hitch(this,function(k){return k!==E.getAttribute("data-geotype")}))):(g.addClass(E,
"selected"),x=E.getAttribute("data-geotype"),0>this.drawTools.indexOf(x)&&this.drawTools.push(x))},page1ToPage2:function(){!1===this.selectByShape.checked&&!1===this.selectByFeature.checked&&!1===this.selectByFeatureQuery.checked?this.controlsAddedToWidgetFrame?(this.btnErrorMsg.innerHTML=this.config.nls.page1.toolNotSelected,g.removeClass(this.btnErrorMsg,"hide")):f.set(this.settingsFirstPageError,"display",""):this.selectByShape.checked?0<this.drawTools.length?(this.savePageToConfig("1"),this.showPage2()):
(this.btnErrorMsg.innerHTML=this.config.nls.page1.noDrawToolSelected,g.removeClass(this.btnErrorMsg,"hide")):(this.savePageToConfig("1"),this.showPage2())},page2ToPage1:function(){this.savePageToConfig("2");this.showPage1()},page2ToPage3:function(){this.createFieldsTable();m.some(this.layersTable.getRows(),function(x){return this.layersTable.getRowData(x).update},this)?(this.savePageToConfig("2"),this.showPage3()):this.controlsAddedToWidgetFrame?(this.btnErrorMsg.innerHTML=this.nls.page2.noLayersSelected,
g.removeClass(this.btnErrorMsg,"hide"),this.tabContainer.selectTab(this.nls.tabs.layers)):f.set(this.settingsSecondPageError,"display","")},page3ToPage2:function(){this.savePageToConfig("3");this.showPage2()},savePageToConfig:function(x){if("1"===x)!0===this.selectByShape.checked?(this.config.selectByShape=this.selectByShape.checked,this.config.drawTools=this.drawTools):(this.config.selectByShape=!1,this.config.drawTools=[]),this.config.selectByFeature=!0===this.selectByFeature.checked?this.selectByFeature.checked:
!1,this.config.selectByFeatureQuery=!0===this.selectByFeatureQuery.checked?this.selectByFeatureQuery.checked:!1;else if("2"===x){var E;null!==this.layersTable&&(this.config.toggleLayersOnOpen=this.toggleLayers.checked,this.config.updateLayers=[],this.config.selectByLayer={},m.forEach(this.layersTable.getRows(),function(k){var h=this.layersTable.getRowData(k),B=null;B=new G;void 0===this.selectionSymbols[h.id]&&("esriGeometryPolygon"===h.geometryType?B.showByType("fill"):"esriGeometryPoint"===h.geometryType||
"esriGeometryMultipoint"===h.geometryType?B.showByType("marker"):"esriGeometryPolyline"===h.geometryType&&B.showByType("line"),this.selectionSymbols[h.id]=B.getSymbol().toJson());B=this.selectionSymbols[h.id];!0===h.update&&(!0===this.selectByFeatureQuery.checked&&(E=b('input[name\x3d"queryFldSelect"]',k).shift().value,"NOTSET1"!==E?(h.queryField=E,this.layersTable.editRow(k,{queryField:h.queryField})):h.queryField=null),this.config.updateLayers.push({id:h.id,name:h.label,queryField:h.queryField,
selectionSymbol:B}));if(!0===this.selectByFeature.checked||!0===this.selectByFeatureQuery.checked)!0===this.selectByFeatureQuery.checked&&(E=b('input[name\x3d"queryFldSelect"]',k).shift().value.toString(),"NOTSET1"!==E?(h.queryField=E,this.layersTable.editRow(k,{queryField:h.queryField})):h.queryField=null),!0===h.selectByLayer&&(this.config.selectByLayer={id:h.id,name:h.label,queryField:h.queryField,selectionSymbol:B})},this))}else"3"===x&&null!==this.commonFieldsTable&&(this.config.commonFields=
[],m.forEach(this.commonFieldsTable.getRows(),function(k){k=this.commonFieldsTable.getRowData(k);!0===k.isEditable&&this.config.commonFields.push({alias:k.label,name:k.fieldName})},this))},showPage1:function(){this.selectByShape.set("checked",this.config.selectByShape);this.selectByFeature.set("checked",this.config.selectByFeature);this.selectByFeatureQuery.set("checked",this.config.selectByFeatureQuery);"undefined"===typeof this.config.selectByShape&&"undefined"===typeof this.config.selectByFeature&&
"undefined"===typeof this.config.selectByFeatureQuery&&this.selectByShape.set("checked",!0);f.set(this.firstPageDiv,"display","");f.set(this.secondPageDiv,"display","none");this.selectByShape.get("checked")?f.set(this.drawToolSelection,"display",""):(f.set(this.drawToolSelection,"display","none"),this.drawTools=["POINT","EXTENT","POLYGON","FREEHAND_POLYGON"]);f.set(this.settingsFirstPageError,"display","none");this.hideOkError();this.controlsAddedToWidgetFrame&&(this.currentPage=1)},showPage2:function(){null!==
this.config.toggleLayersOnOpen&&this.toggleLayers.setChecked(this.config.toggleLayersOnOpen);var x=this.getSelectedTool(),E;if(x===this.toolOption.Shape){var k=E=!1;var h=!0}else x===this.toolOption.FeatureSpatial?(E=!0,h=k=!1):x===this.toolOption.FeatureQuery?(k=E=!0,h=!1):x===this.toolOption.Query&&(E=!1,k=!0,h=!1);this.createLayerTable(E,k);this.layersTable.clear();this.loadLayerTable(h,k);f.set(this.firstPageDiv,"display","none");f.set(this.secondPageDiv,"display","");f.set(this.thirdPageDiv,
"display","none");f.set(this.settingsSecondPageError,"display","none");this.controlsAddedToWidgetFrame&&(this.currentPage=2);this.hideOkError()},showPage3:function(){this.loadFieldsTable();f.set(this.firstPageDiv,"display","none");f.set(this.secondPageDiv,"display","none");f.set(this.thirdPageDiv,"display","");this.controlsAddedToWidgetFrame&&(this.currentPage=3);this.hideOkError()},hideOkError:function(){this.controlsAddedToWidgetFrame?g.addClass(this.btnErrorMsg,"hide"):(f.set(this.settingsFirstPageSaveError,
"display","none"),f.set(this.settingsSecondPageSaveError,"display","none"),f.set(this.settingsThirdPageSaveError,"display","none"))},showOKError:function(){if(this.controlsAddedToWidgetFrame)this.btnErrorMsg.innerHTML=this.nls.errorOnOk,g.removeClass(this.btnErrorMsg,"hide");else{var x=f.get(this.firstPageDiv,"display");"none"!==x?f.set(this.settingsFirstPageSaveError,"display",""):(x=f.get(this.secondPageDiv,"display"),"none"!==x?f.set(this.settingsSecondPageSaveError,"display",""):(x=f.get(this.thirdPageDiv,
"display"),"none"!==x&&f.set(this.settingsThirdPageSaveError,"display","")))}},setConfig:function(x){this.config=x;this.showPage1()},getConfig:function(){this.savePageToConfig("1");if(!1===this.selectByShape.checked&&!1===this.selectByFeature.checked&&!1===this.selectByFeatureQuery.checked)return this.showOKError(),!1;this.savePageToConfig("2");if(this.config.updateLayers){if(0===this.config.updateLayers.length)return this.showOKError(),!1}else return this.showOKError(),!1;if(!0===this.selectByFeature.checked||
!0===this.selectByFeatureQuery.checked)if(this.config.selectByLayer){if(null===this.config.selectByLayer.id||void 0===this.config.selectByLayer.id||""===this.config.selectByLayer.id)return this.showOKError(),!1}else return this.showOKError(),!1;if(!0===this.selectByFeatureQuery.checked){if(m.some(this.config.updateLayers,function(x){if(null===x.queryField||void 0===x.queryField||""===x.queryField)return this.showOKError(),!0},this))return!1;if(null===this.config.selectByLayer.queryField||void 0===
this.config.selectByLayer.queryField||""===this.config.selectByLayer.queryField)return this.showOKError(),!1}this.savePageToConfig("3");if(this.config){if(0===this.config.commonFields.length)return this.showOKError(),!1}else return this.showOKError(),!1;this.config.headerText=d.sanitizeHTML(this._editorObj.get("value"));return this.config},_getDefaultFieldInfos:function(x){return F.getFieldInfosFromWebmap(x,this._jimuLayerInfos)},addQueryFields:function(){this.layerSelects=[];m.forEach(this.layersTable.getRows(),
function(x){var E=b(".queryFieldDropdown.empty-text-td",x).shift(),k=this.layersTable.getRowData(x);x=this.map.getLayer(k.id);x=this.getVisibleFields(this._getDefaultFieldInfos(x.id));var h=new u({name:"queryFldSelect",options:x});h.placeAt(E);this.layerSelects.push(h);k.queryField&&""!==k.queryField&&m.some(x,function(B){if(B.value===k.queryField)return h.set("value",k.queryField),!0})},this)},getEditableFields:function(x){return c.filter(x,function(E){return!0===E.isEditable&&E.type?"esriFieldTypeGlobalID"!==
E.type&&"esriFieldTypeRaster"!==E.type&&"esriFieldTypeGeometry"!==E.type&&"esriFieldTypeOID"!==E.type&&"esriFieldTypeBlob"!==E.type&&"esriFieldTypeXML"!==E.type?!0:!1:!1})},getVisibleFields:function(x){var E=[{label:"",value:"NOTSET1"}];m.forEach(x,function(k){!0===k.visible&&E.push({label:k.label,value:k.fieldName})});return E},arrayObjectIndexOf:function(x,E,k){for(var h=0,B=x.length;h<B;h++)if(x[h][k]===E)return h;return-1},intersect_array:function(x,E){return m.filter(x,function(k){return 0<=
this.arrayObjectIndexOf(E,k.fieldName,"fieldName")?!0:!1},this)},loadFieldsTable:function(){this.commonFieldsTable.clear();var x=null,E=!0;m.forEach(this.layersTable.getRows(),function(B){B=this.layersTable.getRowData(B);!0===B.update&&(B=this.map.getLayer(B.id),B=this.getEditableFields(this._getDefaultFieldInfos(B.id)),!0===E?(x=B,E=!1):x=this.intersect_array(x,B))},this);if(null===x)f.set(this.tableCommonFieldsError,"display",""),f.set(this.tableCommonFieldDesc,"display","none"),f.set(this.tableCommonFieldHeader,
"display","none"),f.set(this.tableCommonFields,"display","none"),this.tableCommonFieldsError.innerHTML=this.nls.page3.noCommonFields;else if(0===x.length)f.set(this.tableCommonFieldsError,"display",""),f.set(this.tableCommonFieldDesc,"display","none"),f.set(this.tableCommonFieldHeader,"display","none"),f.set(this.tableCommonFields,"display","none"),this.tableCommonFieldsError.innerHTML=this.nls.page3.noCommonFields;else{f.set(this.tableCommonFieldsError,"display","none");f.set(this.tableCommonFieldDesc,
"display","");f.set(this.tableCommonFieldHeader,"display","");f.set(this.tableCommonFields,"display","");var k=m.map(this.config.commonFields,function(B){return B.name}),h=!1;m.forEach(x,function(B){h=-1<k.indexOf(B.fieldName)?!0:!1;this.commonFieldsTable.addRow({fieldName:B.fieldName,label:B.label,isEditable:h})},this)}},createFieldsTable:function(){null===this.commonFieldsTable&&(this.commonFieldsTable=new I({fields:[{name:"isEditable",title:this.nls.page3.fieldTable.colEdit,type:"checkbox",width:125,
"class":"editable"},{name:"fieldName",title:this.nls.page3.fieldTable.colName,type:"text"},{name:"label",title:this.nls.page3.fieldTable.colAlias,type:"text",editable:!1},{name:"actions",title:this.nls.page3.fieldTable.colAction,type:"actions",actions:["up","down"],"class":"editable"}],selectable:!1}),this.commonFieldsTable.placeAt(this.tableCommonFields),this.commonFieldsTable.startup())},loadLayerTable:function(x,E){var k="",h=!1,B=!1,M,a;m.forEach(this.map.itemInfo.itemData.operationalLayers,function(e){if(null!==
e.layerObject&&void 0!==e.layerObject&&"Feature Layer"===e.layerObject.type&&e.url&&(!x||!1!==e.layerObject.isEditable())){k=e.title;a=B=!1;M=null;var r=c.filter(this.config.updateLayers,function(A){return A.name===k});0<r.length&&(r[0].selectionSymbol&&(this.selectionSymbols[e.layerObject.id]=r[0].selectionSymbol),B=!0,M=r[0].queryField);this.config.selectByLayer&&this.config.selectByLayer.name===k&&(a=!0,this.config.selectByLayer.hasOwnProperty("queryField")&&(M=this.config.selectByLayer.queryField),
this.config.selectByLayer.hasOwnProperty("selectionSymbol")&&(this.selectionSymbols[e.layerObject.id]=this.config.selectByLayer.selectionSymbol));r=this.layersTable.addRow({label:k,update:B,id:e.layerObject.id,selectByLayer:a,geometryType:e.layerObject.geometryType,queryField:M});h=!0;!1===e.layerObject.isEditable()&&(e=b(".jimu-checkbox",r.tr)[0],z.byNode(e).setStatus(!1))}},this);h?(f.set(this.tableLayerInfosError,"display","none"),!0===E&&this.addQueryFields()):f.set(this.tableLayerInfosError,
"display","")},createLayerTable:function(x,E){x={fields:[{name:"update",title:this.nls.page2.layerTable.colUpdate,type:"checkbox",width:125,"class":"editable"},{name:"label",title:this.nls.page2.layerTable.colLabel,type:"text"},{name:"selectByLayer",title:this.nls.page2.layerTable.colSelectByLayer,type:"radio",hidden:!x},{name:"queryFieldDropdown",title:this.nls.page2.layerTable.colSelectByField,type:"empty",hidden:!E},{name:"actions",title:this.nls.page2.layerTable.colhighlightSymbol,type:"actions",
width:200,"class":"symbolselector",actions:["edit"]},{name:"id",type:"text",hidden:!0},{name:"queryField",type:"text",hidden:!0},{name:"geometryType",type:"text",hidden:!0}],selectable:!1};l.empty(this.tableLayerInfos);this.layersTable=new I(x);this.layersTable.placeAt(this.tableLayerInfos);this.layersTable.startup();this.own(q(this.layersTable,"actions-edit",n.hitch(this,this.showSymbolSelector)))},showSymbolSelector:function(x){var E=b(".action-item-parent",x);if(E&&E.length){x=this.layersTable.getRowData(x);
this.currentLayer=x.id;E={};E.data=x;E.selectionSymbols=this.selectionSymbols;E.nls=this.nls;var k=new y(E),h=new P({width:425,height:475,content:k,titleLabel:this.nls.symbolPopup,onClose:n.hitch(this,function(){k.destroy()}),buttons:[{label:this.nls.ok,onClick:n.hitch(this,function(){this.selectionSymbols[this.currentLayer]=k.okPress().getSymbol().toJson();h.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:n.hitch(this,function(){h.close()})}]})}}})});