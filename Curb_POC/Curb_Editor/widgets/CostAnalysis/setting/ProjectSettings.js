// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/CostAnalysis/setting/ProjectSettings.html":'\x3cdiv\x3e\r\n\t\x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n\t\t\x3clegend class\x3d"esriCTFieldSetLegend"\x3e\r\n\t\t\t${nls.projectSettings.costingGeometrySectionTitle}\r\n\t\t\x3c/legend\x3e\r\n\t\t\x3cdiv class\x3d"esriCTNote esriCTFullWidth"\x3e${nls.projectSettings.costingGeometrySectionNote}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3c!--Costing Geometry Layer Label--\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.costingGeometryLayerLabel}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.costingGeometryLayerLabel}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c!--Costing Geometry Later Dropdown--\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer" data-dojo-attach-point\x3d"costingGeometryLayerDropDown" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\x3c/select\x3e\r\n\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"costingGeometryHelp"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3c!--Field to Label Geography Label--\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.fieldLabelGeography}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.fieldLabelGeography}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c!--Field to Label Geography Dropdown--\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer" data-dojo-attach-point\x3d"fieldToLabelGeography" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\x3c/select\x3e\r\n\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"fieldToLabelGeographyHelp"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/fieldset\x3e\r\n\t\x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n\t\t\x3clegend class\x3d"esriCTFieldSetLegend"\x3e\r\n\t\t\t${nls.projectSettings.projectTableSectionTitle}\r\n\t\t\x3c/legend\x3e\r\n\t\t\x3cdiv class\x3d"esriCTNote esriCTFullWidth"\x3e${nls.projectSettings.projectTableSectionNote}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3c!--Project Assets Table Label--\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.projectAssetsTableLabel}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.projectAssetsTableLabel}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c!--Project Assets Table Dropdown--\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer" data-dojo-attach-point\x3d"projectAssetsTable" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\x3c/select\x3e\r\n\t\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"projectAssetsTableHelp"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3c!--Project Multiplier Additional Cost Table Label--\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.projectMultiplierTableLabel}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.projectMultiplierTableLabel}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c!--Project Multiplier Additional Cost Table Dropdown--\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer" data-dojo-attach-point\x3d"projectMultiplierTable" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\x3c/select\x3e\r\n\t\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"projectMultiplierTableHelp"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3c!--Project Layer Label--\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.projectLayerLabel}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.projectLayerLabel}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c!--Project Layer Dropdown--\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer esriCTProjectLayerDropdown" data-dojo-attach-point\x3d"projectLayerDropDown" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\x3c/select\x3e\r\n\t\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"projectLayerHelp"\x3e\x3c/div\x3e\r\n\t\t\t\x3c!--Configure Fields Settings--\x3e\r\n\t\t\t\x3cdiv class\x3d"esriCTConfigureFieldsContainer"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3c!-- Point layer centroid starts --\x3e\r\n\t\t\x3cdiv class\x3d"esriCTRowContainer esriCTFullWidth"\x3e\r\n\t\t\t\x3cdiv title\x3d"${nls.projectSettings.pointLayerCentroidLabel}" class\x3d"esriCTLabelContainer esriCTEllipsis"\x3e\r\n\t\t\t\t${nls.projectSettings.pointLayerCentroidLabel}:\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cselect class\x3d"esriCTDropDownContainer" disabled\x3dtrue data-dojo-attach-point\x3d"pointLayerCentroidDropDown"\r\n\t\t\tdata-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cdiv class\x3d"esriCTHelpIcon" data-dojo-attach-point\x3d"pointLayerCentroidHelp"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3c!-- Point layer centroid ends --\x3e\r\n\t\t\x3c!--Configured Fields Table--\x3e\r\n\t\t\x3cdiv class\x3d"esriCTConfiguredFieldsTable esriCTHidden" data-dojo-attach-point\x3d"configuredFieldsTable"\x3e\x3c/div\x3e\r\n\t\x3c/fieldset\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./ProjectSettings.html dojo/_base/lang dojo/on dojo/_base/array dojo/Evented dojo/string esri/layers/FeatureLayer dojo/promise/all dojo/Deferred jimu/dijit/CheckBox".split(" "),function(n,p,q,r,e,h,k,t,m,u,v,w){return n([p,q,t],{baseClass:"jimu-widget-cost-analysis-project-settings",templateString:r,_configuredFieldsTable:null,_prevCostingGeometryLayerValue:"",_prevProjectLayerValue:"",_prevPointLayerCentroidValue:"",
_prevProjectAssetsTableValue:"",_prevProjectMultiplierTableValue:"",_defaultSelectOption:{},_assetsTableRequiredFields:{},_multiplierTableRequiredFields:{},constructor:function(a){e.mixin(this,a)},postMixInProperties:function(){this.nls.common={};e.mixin(this.nls.common,window.jimuNls.common)},postCreate:function(){this._configuredFieldsTable=null;this._prevProjectMultiplierTableValue=this._prevProjectAssetsTableValue=this._prevPointLayerCentroidValue=this._prevProjectLayerValue=this._prevCostingGeometryLayerValue=
"";this.own(h(this.costingGeometryHelp,"click",e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.costingGeometryHelp)})));this.own(h(this.fieldToLabelGeographyHelp,"click",e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.fieldToLabelGeographyHelp)})));this.own(h(this.projectAssetsTableHelp,"click",e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.projectAssetsTableHelp)})));this.own(h(this.projectMultiplierTableHelp,"click",
e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.projectMultiplierTableHelp)})));this.own(h(this.projectLayerHelp,"click",e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.projectLayerHelp)})));this.own(h(this.pointLayerCentroidHelp,"click",e.hitch(this,function(){this.appUtils.showMessage(this.nls.projectSettings.pointLayerHintText)})));this._assetsTableRequiredFields={ASSETGUID:["esriFieldTypeGUID"],COSTEQUATION:["esriFieldTypeString"],SCENARIO:["esriFieldTypeString"],
TEMPLATENAME:["esriFieldTypeString"],GEOGRAPHYGUID:["esriFieldTypeGUID"],PROJECTGUID:["esriFieldTypeGUID"]};this._multiplierTableRequiredFields={DESCRIPTION:["esriFieldTypeString"],TYPE:["esriFieldTypeString"],VALUE:["esriFieldTypeDouble","esriFieldTypeSingle"],COSTINDEX:["esriFieldTypeSmallInteger","esriFieldTypeInteger"],PROJECTGUID:["esriFieldTypeGUID"]};this._defaultSelectOption={value:"",label:this.nls.projectSettings.selectLabel};this.inherited(arguments);this._init()},getConfig:function(){return{costingGeometryLayer:this._prevCostingGeometryLayerValue,
geographyField:this.fieldToLabelGeography.value,assetTable:this._prevProjectAssetsTableValue,multiplierAdditionalCostTable:this._prevProjectMultiplierTableValue,projectLayer:this._prevProjectLayerValue,pointLayerCentroid:this._prevPointLayerCentroidValue}},validate:function(){var a=!0;var b="";""===this._prevProjectAssetsTableValue&&""===this._prevProjectMultiplierTableValue&&""===this._prevProjectLayerValue||""!==this._prevProjectAssetsTableValue&&""!==this._prevProjectMultiplierTableValue&&""!==
this._prevProjectLayerValue||(b=[],""===this._prevProjectAssetsTableValue&&b.push(this.nls.projectSettings.projectAssetsTableLabel),""===this._prevProjectMultiplierTableValue&&b.push(this.nls.projectSettings.projectMultiplierTableLabel),""===this._prevProjectLayerValue&&b.push(this.nls.projectSettings.projectLayerLabel),b=b.join(" and "),a=!1,b=m.substitute(this.nls.projectSettings.errorMessages.invalidConfiguration,{fieldsString:e.trim(b)}));return{isValid:a,errorMessage:b}},_init:function(){var a=
[];var b=[];var c=[];this.map&&this.map.itemInfo&&this.map.itemInfo.itemData&&(this.map.itemInfo.itemData.operationalLayers&&0<this.map.itemInfo.itemData.operationalLayers.length&&(a=this.map.itemInfo.itemData.operationalLayers),this.map.itemInfo.itemData.tables&&0<this.map.itemInfo.itemData.tables.length&&(b=this.map.itemInfo.itemData.tables));this._filterValidLayersForDropDown(a);this._populatePointLayerDropdown(a);k.forEach(b,e.hitch(this,function(d){var f=new w;c.push(f);d=new u(d.url);h(d,"load",
e.hitch(this,function(g){k.forEach(this.map.itemInfo.itemData.tables,e.hitch(this,function(l){if(l.url===g.layer.url)return g.layer.id=l.id,g.layer.title=l.title,!0}));f.resolve(g.layer)}));h(d,"error",e.hitch(this,function(){f.resolve(null)}))}));v(c).then(e.hitch(this,function(d){this._populateTablesForDropDown(d)}));h(this.fieldToLabelGeography,"change",e.hitch(this,function(d){this.emit("onGeographyFieldChange",d,this.costingGeometryLayerDropDown.getValue())}));this._attachingEvents();this._setConfig()},
_filterValidLayersForDropDown:function(a){var b=[this._defaultSelectOption];var c=[this._defaultSelectOption];this._costingGeometryLayerFieldOptions={defaultSelectOption:{options:[this._defaultSelectOption]}};a=a&&0<a.length?this._getLayerOptions(a,b,c):{costingGeometryLayerOptions:b,projectLayerOptions:c};this.costingGeometryLayerDropDown.set("options",e.clone(a.costingGeometryLayerOptions));this.projectLayerDropDown.set("options",e.clone(a.projectLayerOptions))},_getLayerOptions:function(a,b,c){var d;
k.forEach(a,e.hitch(this,function(f){if(f.layerObject&&f.layerObject.capabilities)d=f.layerObject.capabilities;else return!0;"esriGeometryPolygon"===f.layerObject.geometryType&&-1<d.indexOf("Query")&&this._hasGlobalIDField(f)&&(b.push({value:f.id,label:f.title}),"ArcGISFeatureLayer"===f.layerType&&(-1<d.indexOf("Editing")||-1<d.indexOf("Update"))&&-1<d.indexOf("Create")&&-1<d.indexOf("Delete")&&this._isValidProjectLayer(f)&&c.push({value:f.id,label:f.title}))}));return{costingGeometryLayerOptions:b,
projectLayerOptions:c}},_isValidProjectLayer:function(a){var b;var c=["esriFieldTypeDouble","esriFieldTypeSingle"];a=a.layerObject.fields;var d=[];for(b in a){var f=a[b].type;var g=a[b].name.toUpperCase();("PROJECTNAME"===g&&"esriFieldTypeString"===f||"DESCRIPTION"===g&&"esriFieldTypeString"===f||"TOTALASSETCOST"===g&&-1<c.indexOf(f)||"GROSSPROJECTCOST"===g&&-1<c.indexOf(f)||"esriFieldTypeGlobalID"===f)&&d.push(g)}return 5===d.length?!0:!1},_hasGlobalIDField:function(a){var b=!1;(a=a.layerObject.fields||
a.fields)&&0<a.length&&k.some(a,e.hitch(this,function(c){if("esriFieldTypeGlobalID"===c.type)return b=!0}));return b},_populateTablesForDropDown:function(a){var b=[this._defaultSelectOption];var c=[this._defaultSelectOption];a&&0<a.length&&k.forEach(a,e.hitch(this,function(d){d&&this._isValidTable(d,"projectAssets")&&b.push({value:d.id||d.name,label:d.title||d.name});d&&this._isValidTable(d,"projectMultiplier")&&c.push({value:d.id||d.name,label:d.title||d.name})}));this.projectAssetsTable.addOption(e.clone(b));
this.projectMultiplierTable.addOption(e.clone(c));this._setSelectedValuesInTables()},_isValidTable:function(a,b){var c,d=[];var f=!1;(a=a.fields)&&0<a.length&&k.some(a,e.hitch(this,function(g){c=g.name.toUpperCase();if("projectAssets"===b&&this._assetsTableRequiredFields[c]&&-1<this._assetsTableRequiredFields[c].indexOf(g.type)&&!g.domain){if(d.push(g.name),d.length===Object.keys(this._assetsTableRequiredFields).length)return f=!0}else if("projectMultiplier"===b&&this._multiplierTableRequiredFields[c]&&
-1<this._multiplierTableRequiredFields[c].indexOf(g.type)&&!g.domain&&(d.push(g.name),d.length===Object.keys(this._multiplierTableRequiredFields).length))return f=!0}));return f},_setSelectedValuesInTables:function(){var a;this.config.assetTable?(a=this.layerInfosObj.getTableInfoById(this.config.assetTable))&&a.layerObject?(this.projectAssetsTable.set("value",this.config.assetTable),this._prevProjectAssetsTableValue=this.config.assetTable):(this.projectAssetsTable.set("value",""),this._prevProjectAssetsTableValue=
""):(this.projectAssetsTable.set("value",""),this._prevProjectAssetsTableValue="");this.config.multiplierAdditionalCostTable?(a=this.layerInfosObj.getTableInfoById(this.config.multiplierAdditionalCostTable))&&a.layerObject?(this.projectMultiplierTable.set("value",this.config.multiplierAdditionalCostTable),this._prevProjectMultiplierTableValue=this.config.multiplierAdditionalCostTable):(this.projectMultiplierTable.set("value",""),this._prevProjectMultiplierTableValue=""):(this.projectMultiplierTable.set("value",
""),this._prevProjectMultiplierTableValue="")},_setConfig:function(){if(this.config.costingGeometryLayer&&this.layerInfosObj.getLayerInfoById(this.config.costingGeometryLayer))var a=this.layerInfosObj.getLayerInfoById(this.config.costingGeometryLayer).layerObject;a?(this.costingGeometryLayerDropDown.set("value",this.config.costingGeometryLayer),this._prevCostingGeometryLayerValue=this.config.costingGeometryLayer,this._createCostingGeometryLayerFieldOptions(a,this._costingGeometryLayerFieldOptions),
this.fieldToLabelGeography.options=[],this.fieldToLabelGeography.options.length=0,this.config.geographyField?(this.fieldToLabelGeography.set("options",this._costingGeometryLayerFieldOptions[this.config.costingGeometryLayer].options),this.fieldToLabelGeography.set("disabled",!1)):(this.fieldToLabelGeography.set("options",this._costingGeometryLayerFieldOptions.defaultSelectOption.options),this.fieldToLabelGeography.set("disabled",!0))):(this.costingGeometryLayerDropDown.set("value",""),this._prevCostingGeometryLayerValue=
"",this.fieldToLabelGeography.set("options",this._costingGeometryLayerFieldOptions.defaultSelectOption.options),this.fieldToLabelGeography.set("disabled",!0),this.fieldToLabelGeography.set("value",""));this.config.projectLayer&&this.projectLayerDropDown&&1<this.projectLayerDropDown.options.length?(this.projectLayerDropDown.set("value",this.config.projectLayer),this._prevProjectLayerValue=this.config.projectLayer):(this.projectLayerDropDown.set("value",""),this._prevProjectLayerValue="");this.config.pointLayerCentroid&&
this.pointLayerCentroidDropDown&&1<this.pointLayerCentroidDropDown.options.length?(this.pointLayerCentroidDropDown.set("value",this.config.pointLayerCentroid),this._prevPointLayerCentroidValue=this.config.pointLayerCentroid):(this.pointLayerCentroidDropDown.set("value",""),this._prevPointLayerCentroidValue="")},_attachingEvents:function(){this.own(h(this.costingGeometryLayerDropDown,"change",e.hitch(this,function(a){a!==this.costingGeometryLayerDropDown.value&&this.costingGeometryLayerDropDown.set("value",
a);""===a||this._costingGeometryLayerFieldOptions[a]||(a=this.layerInfosObj.getLayerInfoById(a))&&a.layerObject&&(a=a.layerObject,this._createCostingGeometryLayerFieldOptions(a,this._costingGeometryLayerFieldOptions));this._onDropdownChange(this.costingGeometryLayerDropDown,"costingGeometryLayer","layer")})));this.own(h(this.projectLayerDropDown,"change",e.hitch(this,function(){this._onDropdownChange(this.projectLayerDropDown,"projectLayer","layer");this._enableOrDisablePointLayerDropdown()})));this.own(h(this.projectAssetsTable,
"change",e.hitch(this,function(){this._onDropdownChange(this.projectAssetsTable,"projectAssets","table")})));this.own(h(this.projectMultiplierTable,"change",e.hitch(this,function(){this._onDropdownChange(this.projectMultiplierTable,"projectMultiplier","table")})));this.own(h(this.pointLayerCentroidDropDown,"change",e.hitch(this,function(){this._onDropdownChange(this.pointLayerCentroidDropDown,"pointLayerCentroidDropdown","layer")})))},_onDropdownChange:function(a,b,c){("layer"===c?this._validateDuplicateSelection(a,
this.projectLayerDropDown,this.costingGeometryLayerDropDown):this._validateDuplicateSelection(a,this.projectAssetsTable,this.projectMultiplierTable))?this._setNewDropdownValue(a,b):this._restorePreviousDropdownValue(a,b)},_validateDuplicateSelection:function(a,b,c){return a.value&&b.value===c.value?(a=m.substitute(this.nls.projectSettings.errorMessages.duplicateLayerSelection,{layerName:e.trim(a.tableNode.innerText)}),this.emit("onDuplicateLayerSelect",a),!1):!0},_setNewDropdownValue:function(a,b){switch(b){case "costingGeometryLayer":this._onCostingGeometryLayerDropDownChange();
this._prevCostingGeometryLayerValue!==a.value&&(this.emit("onLayerSelected",{lastSelectedId:this._prevCostingGeometryLayerValue,currentSelectedLayerId:a.value}),this.emit("onGeographyFieldChange",this.fieldToLabelGeography.get("value"),this.costingGeometryLayerDropDown.get("value")),this._prevCostingGeometryLayerValue=a.value);break;case "projectLayer":this._onProjectLayerDropDownChange();this._prevProjectLayerValue!==a.value&&(this.emit("onLayerSelected",{lastSelectedId:this._prevProjectLayerValue,
currentSelectedLayerId:a.value}),this._prevProjectLayerValue=a.value);break;case "pointLayerCentroidDropdown":this._prevPointLayerCentroidValue!==a.value&&(this.emit("onLayerSelected",{lastSelectedId:this._prevPointLayerCentroidValue,currentSelectedLayerId:a.value}),this._prevPointLayerCentroidValue=a.value);break;case "projectAssets":this._prevProjectAssetsTableValue=a.value;break;case "projectMultiplier":this._prevProjectMultiplierTableValue=a.value}},_restorePreviousDropdownValue:function(a,b){switch(b){case "costingGeometryLayer":a.set("value",
this._prevCostingGeometryLayerValue);break;case "projectLayer":a.set("value",this._prevProjectLayerValue);break;case "projectAssets":a.set("value",this._prevProjectAssetsTableValue);break;case "projectMultiplier":a.set("value",this._prevProjectMultiplierTableValue);break;case "pointLayerCentroidDropdown":a.set("value",this._prevPointLayerCentroidValue)}},_createCostingGeometryLayerFieldOptions:function(a,b){var c=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble",
"esriFieldTypeString"];a&&a.fields&&0<a.fields.length?(b[a.id]||(b[a.id]={},b[a.id].options=[]),k.forEach(a.fields,e.hitch(this,function(d){-1<c.indexOf(d.type)&&b[a.id].options.push({value:d.name,label:d.alias?d.alias:d.name})}))):b[a.id].options.push([this._defaultSelectOption])},_onCostingGeometryLayerDropDownChange:function(){this.fieldToLabelGeography.options=[];this.fieldToLabelGeography.options.length=0;var a=this.costingGeometryLayerDropDown.value;""!==a?(this.fieldToLabelGeography.set("options",
this._costingGeometryLayerFieldOptions[a].options),this.fieldToLabelGeography.set("disabled",!1)):(this.fieldToLabelGeography.set("options",this._costingGeometryLayerFieldOptions.defaultSelectOption.options),this.fieldToLabelGeography.set("disabled",!0));this.config.geographyField?this.fieldToLabelGeography.set("value",this.config.geographyField,!1):this.fieldToLabelGeography.set("value","",!1)},_onProjectLayerDropDownChange:function(){var a;var b={idFieldOptions:[this._defaultSelectOption],stringFieldOptions:[this._defaultSelectOption],
costFieldOptions:[this._defaultSelectOption]};this.projectLayerDropDown.value&&(a=this.layerInfosObj.getLayerInfoById(this.projectLayerDropDown.value))&&a.layerObject&&(a=a.layerObject,b=this._getTableDropdownOptions(a.fields,b));this.emit("onProjectLayerSelected",this.projectLayerDropDown.value)},_getTableDropdownOptions:function(a,b){var c;var d=["esriFieldTypeOID","esriFieldTypeGlobalID"];var f=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];k.forEach(a,
e.hitch(this,function(g){c={value:g.name,label:g.alias?g.alias:g.name};-1<d.indexOf(g.type)?b.idFieldOptions.push(c):-1<f.indexOf(g.type)?b.costFieldOptions.push(c):"esriFieldTypeString"===g.type&&b.stringFieldOptions.push(c)}));return b},_isValidFieldType:function(a){var b,c=!1;k.some(a.fields,e.hitch(this,function(d){b=d.name.toUpperCase();if("PROJECTID"===b&&"esriFieldTypeGUID"===d.type)return c=!0;c=!1}));return c},_isEditable:function(a){a=a.capabilities;return(-1<a.indexOf("Editing")||-1<a.indexOf("Update"))&&
-1<a.indexOf("Create")&&-1<a.indexOf("Delete")?!0:!1},_populatePointLayerDropdown:function(a){var b=[];b.push(this._defaultSelectOption);this._getValidPointLayersOptions(b,a);this.pointLayerCentroidDropDown.set("options",e.clone(b));this._prevPointLayerCentroidValue=this.projectLayerDropDown.getValue();this._enableOrDisablePointLayerDropdown()},_getValidPointLayersOptions:function(a,b){k.forEach(b,e.hitch(this,function(c){c.hasOwnProperty("layerObject")&&(c=c.layerObject,c.hasOwnProperty("geometryType")&&
"esriGeometryPoint"===c.geometryType&&this._isEditable(c)&&this._isValidFieldType(c)&&"Feature Layer"===c.type&&a.push({value:c.id,label:c.title||c.name}))}))},_enableOrDisablePointLayerDropdown:function(){var a=this.projectLayerDropDown.getValue();""!==a&&null!==a&&void 0!==a?this.pointLayerCentroidDropDown.set("disabled",!1):(this.pointLayerCentroidDropDown.set("disabled",!0),this.pointLayerCentroidDropDown.set("value",""))}})});