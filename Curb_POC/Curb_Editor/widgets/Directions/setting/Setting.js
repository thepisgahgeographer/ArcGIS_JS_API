// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Directions/setting/PresetDestinations":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query esri/lang dojo/Deferred esri/tasks/locator jimu/utils ../searchUtil jimu/LayerInfos/LayerInfos dojo/when dojo/promise/all dojo/_base/array esri/layers/FeatureLayer dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PresetDestinations.html esri/dijit/Search jimu/dijit/RadioBtn".split(" "),function(H,B,C,J,G,q,p,l,t,z,
w,c,x,y,u,f,d,g,E,k){return H([f,d,g],{templateString:E,_defaultLocations:null,_startSearchResults:null,_endSearchResults:null,_isSearchResultsShown:!1,_ERROR_CLASS:"have-error",constructor:function(b){b&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b.defaultLocations),this.nls=b.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this._getLayerInfos().then(B.hitch(this,function(){this.startSearch=new k({enableSuggestions:!1,enableButtonMode:!1,
theme:"arcgisSearch"});this.startSearch.placeAt(this.startSearchDom);this.own(C(this.startSearch,"search-results",B.hitch(this,"_onStartSearchResults")));this.own(C(this.startSearchResultsNode,"li:click",B.hitch(this,"_onSelectStartSearchResult")));this.own(C(this.startSearch.inputNode,"focus",B.hitch(this,"_onCleanStartError")));this.own(C(this.startSearch.inputNode,"blur",B.hitch(this,function(){!1===this._isSearchResultsShown&&this.startSearch&&this.startSearch.search&&this.startSearch.search()})));
this.endSearch=new k({enableSuggestions:!1,enableButtonMode:!1,theme:"arcgisSearch"});this.endSearch.placeAt(this.endSearchDom);this.own(C(this.endSearch,"search-results",B.hitch(this,"_onEndSearchResults")));this.own(C(this.endSearchResultsNode,"li:click",B.hitch(this,"_onSelectEndSearchResult")));this.own(C(this.endSearch.inputNode,"focus",B.hitch(this,"_onCleanEndError")));this.own(C(this.endSearch.inputNode,"blur",B.hitch(this,function(){!1===this._isSearchResultsShown&&this.endSearch&&this.endSearch.search&&
this.endSearch.search()})));this.own(C(window.document,"click",B.hitch(this,function(v){J.isDescendant(v.target,this.searchResultsNode)||this._hideResultMenu()})));if(this._defaultLocations&&this._defaultLocations.length&&0<this._defaultLocations.length)for(var b=0,e=this._defaultLocations.length;b<e;b++)0===b?this._setSearchValue(this.startSearch,this._defaultLocations[b]):1===b&&this._setSearchValue(this.endSearch,this._defaultLocations[b])}));this.inherited(arguments)},_setSearchValue:function(b,
e){"string"===typeof e?b.set("value",e):e.name&&(b.set("selectedResult",e),b.set("value",e.name))},getValue:function(){var b=[],e=this._getSearchRest(this.startSearch,this._defaultLocations[0]);b.push(e);e=this._getSearchRest(this.endSearch,this._defaultLocations[1]);b.push(e);return b},_getSearchRest:function(b,e){var v=b.selectedResult;if(v)v.feature&&(v.feature._layer&&(v.feature._layer=""),v.feature._sourceLayer&&(v.feature._sourceLayer=""));else if(b.value)v=!1,"string"===typeof e?v=e!==b.value:
e.name&&(v=e.name!==b.value),v=v?b.value:e;else return"";return v},_parseDefaultLocations:function(b){for(var e=[],v=0,F=b.length;v<F;v++)e.push(b[v]);return e},setValue:function(b){b&&0<b.length&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b))},validate:function(){var b=!1;G(".searchLoading",this.domNode).forEach(B.hitch(this,function(){b=!0}));return!1!==b||J.hasClass(this.startSearch,this._ERROR_CLASS)||J.hasClass(this.endSearch,this._ERROR_CLASS)?!1:!0},setSources:function(b){if(b&&
b.sources&&b.sources.length)this.shelter.show(),c(z.getConfigInfo(b)).then(B.hitch(this,function(v){return x(this._convertConfig(v)).then(function(F){return y.filter(F,function(K){return K})})})).then(B.hitch(this,function(v){this.startSearch.set("sources",v);this.endSearch.set("sources",v);this.shelter.hide()}));else if(e&&e.url&&e.singleLineFieldName){var e={locator:new l(e.url||""),outFields:["*"],singleLineFieldName:e.singleLineFieldName};this.startSearch.set("sources",[e]);this.endSearch.set("sources",
[e])}else this.startSearch.set("sources",[]),this.endSearch.set("sources",[])},_onCleanError:function(b){J.removeClass(b,this._ERROR_CLASS)},_onCleanStartError:function(){this._onCleanError(this.startSearch)},_onCleanEndError:function(){this._onCleanError(this.endSearch)},_onStartSearchResults:function(b){this._onSearchResults(b,{searchDijit:this.startSearch,searchResultsNode:this.startSearchResultsNode,searchError:this.startSearchError,results:"start"})},_onEndSearchResults:function(b){this._onSearchResults(b,
{searchDijit:this.endSearch,searchResultsNode:this.endSearchResultsNode,searchError:this.endSearchError,results:"end"})},_onSearchResults:function(b,e){var v=e.searchDijit.get("sources"),F=e.searchDijit.get("activeSourceIndex"),K=e.searchDijit.get("value"),I="",L=b.results;if(""!==K)if(L&&0<b.numResults){"start"===e.results?this._startSearchResults=L:"end"===e.results&&(this._endSearchResults=L);I+='\x3cdiv class\x3d"searchMenu searchResultsMenu" role\x3d"menu"\x3e';for(var S in L)if(L[S]&&L[S].length){b=
v[parseInt(S,10)].name;1<v.length&&"all"===F&&(I+='\x3cdiv title\x3d"'+b+'" class\x3d"menuHeader"\x3e'+b+"\x3c/div\x3e");I+="\x3cul\x3e";b=v[S].maxResults||5;K=0;for(var Z=L[S].length;K<Z&&K<b;K++){if(q.isDefined(L[S][K].name)){var W=L[S][K].name;W=t.sanitizeHTML(W)}else W=this.nls.untitled;I+='\x3cli title\x3d"'+W+'" data-index\x3d"'+K+'" data-source-index\x3d"'+S+'" role\x3d"menuitem" tabindex\x3d"0"\x3e'+W.toString()+"\x3c/li\x3e"}I+="\x3c/url\x3e"}e.searchResultsNode.innerHTML=I+"\x3c/div\x3e";
this._showResultMenu(e.searchDijit,e.searchResultsNode);this._resetSelectorPosition(e.searchDijit,".searchResultsMenu")}else J.addClass(e.searchDijit,this._ERROR_CLASS),this._resetSelectorPosition(e.searchDijit,".noResultsMenu")},_onSelectStartSearchResult:function(b){this._onSelectSearchResult(b,this.startSearch,this._startSearchResults)},_onSelectEndSearchResult:function(b){this._onSelectSearchResult(b,this.endSearch,this._endSearchResults)},_onSelectSearchResult:function(b,e,v){for(b=b.target;!J.hasAttr(b,
"data-source-index")||!J.getAttr(b,"data-index");)b=b.parentNode;var F=null;F=J.getAttr(b,"data-source-index");b=parseInt(J.getAttr(b,"data-index"),10);"all"!==F&&(F=parseInt(F,10));v&&v[F]&&v[F][b]&&(F=v[F][b],e.select(F),F.name&&e.set("value",F.name))},_showResultMenu:function(b,e){J.setStyle(e,"display","block");G(".searchMenu",e).style("display","block");this._isSearchResultsShown=!0;if(b=G(".searchInputGroup",b.domNode)[0])b={width:J.getMarginBox(b).w+"px"},G(".searchMenu",e).style(b)},_resetSelectorPosition:function(b,
e){var v=J.getMarginBox(this.domNode.offsetParent);G(e,this.domNode).forEach(B.hitch(this,function(F){var K=J.position(F),I=J.position(b.domNode);I=".noResultsMenu"===e?0:I.h;K.y+K.h>v.h&&J.setStyle(F,"top",-(K.h+I)-4+"px")}))},_hideResultMenu:function(){G(".searchMenu",this.domNode).style("display","none");this._isSearchResultsShown=!1},_getLayerInfos:function(){var b=new p;w.getInstance(this.map,this.map.itemInfo).then(B.hitch(this,function(e){this.layerInfosObj=e;this.own(this.layerInfosObj.on("layerInfosFilterChanged",
B.hitch(this,function(v){z.config.onLayerInfosFilterChanged(v,this.config)})));b.resolve()}));return b},_convertConfig:function(b){return y.map(b.sources,B.hitch(this,function(e){var v=new p;if(e&&e.url&&"locator"===e.type){var F={locator:new l(e.url||""),outFields:["*"],singleLineFieldName:e.singleLineFieldName||"",name:t.stripHTML(e.name||""),placeholder:t.stripHTML(e.placeholder||""),countryCode:e.countryCode||"",maxSuggestions:e.maxSuggestions,useMapExtent:!!e.searchInCurrentMapExtent};e.enableLocalSearch&&
(F.localSearchOptions={minScale:e.localSearchMinScale,distance:e.localSearchDistance});e.zoomScale&&(F.autoNavigate=!1);v.resolve(F)}else e&&e.url&&"query"===e.type?(F=new u(e.url||null,{outFields:["*"]}),this.own(C(F,"load",B.hitch(this,function(K){var I=K.layer;K=this.map.getLayer(e.layerId);var L=this.layerInfosObj.getLayerInfoById(e.layerId);K?L=K=!1:L?L=K=!1:(K=!1,L=!0);var S=null;e.searchFields&&0<e.searchFields.length?S=e.searchFields:(S=[],y.forEach(I.fields,function(W){"esriFieldTypeOID"!==
W.type&&W.name!==I.objectIdField&&"esriFieldTypeGeometry"!==W.type&&S.push(W.name)}));var Z={featureLayer:I,outFields:["*"],searchFields:S,autoNavigate:!1,displayField:e.displayField||"",exactMatch:!!e.exactMatch,name:t.stripHTML(e.name||""),placeholder:t.stripHTML(e.placeholder||""),maxSuggestions:e.maxSuggestions||6,useMapExtent:!!e.searchInCurrentMapExtent,showInfoWindowOnSelect:K,enableInfoWindow:L,_featureLayerId:e.layerId};Z._featureLayerId&&(K=this.layerInfosObj.getLayerInfoById(Z._featureLayerId))&&
I.setDefinitionExpression(K.getFilter());z.config.getInfoTemplate(I,e,this.layerInfosObj).then(B.hitch(this,function(W){Z.infoTemplate=B.clone(W);v.resolve(Z)}),B.hitch(this,function(){v.resolve(Z)}))}))),this.own(C(F,"error",function(){v.resolve(null)}))):v.resolve(null);return v}))}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w){H=H(z,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(c){this._geocodeHandler=B.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=B.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=B.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(c){this.outSpatialReference=c},_geocodeHandler:function(c,x,y,u,f){try{var d=c.candidates;x=[];var g,E=d.length,k=c.spatialReference,b;for(g=0;g<E;g++){var e=d[g];if(b=e.location)b.spatialReference=k;x[g]=new w(e)}this._successHandler([x],"onAddressToLocationsComplete",y,f)}catch(v){this._errorHandler(v,u,f)}},_geocodeAddressesHandler:function(c,x,y,u,f){try{var d=c.locations;x=[];var g,E=d.length,k=c.spatialReference,b;for(g=0;g<E;g++){if(b=
d[g].location)b.spatialReference=k;x[g]=new w(d[g])}this._successHandler([x],"onAddressesToLocationsComplete",y,f)}catch(e){this._errorHandler(e,u,f)}},addressToLocations:function(c,x,y,u,f){var d;if(c.address){u=y;y=x;x=c.outFields;f=c.searchExtent;var g=c.countryCode;var E=c.magicKey;var k=c.distance;var b=c.categories;c.location&&this.normalization&&(d=c.location.normalize());var e=c.locationType;var v=c.maxLocations;var F=c.forStorage;c=c.address}f&&(f=f.shiftCentralMeridian());var K=this.outSpatialReference;
c=this._encode(B.mixin({},this._url.query,c,{f:"json",outSR:K&&G.toJson(K.toJson()),outFields:x&&x.join(",")||null,searchExtent:f&&G.toJson(f.toJson()),category:b&&b.join(",")||null,countryCode:g||null,magicKey:E||null,distance:k||null,location:d||null,locationType:e||null,maxLocations:v||null,forStorage:F||null}));var I=this._geocodeHandler,L=this._errorHandler,S=new J(t._dfdCanceller);S._pendingDfd=l({url:this._url.path+"/findAddressCandidates",content:c,callbackParamName:"callback",load:function(Z,
W){I(Z,W,y,u,S)},error:function(Z){L(Z,u,S)}});return S},suggestLocations:function(c){var x=new J(t._dfdCanceller);c.hasOwnProperty("location")&&this.normalization&&(c.location=c.location.normalize());c.searchExtent&&(c.searchExtent=c.searchExtent.shiftCentralMeridian());c=this._encode(B.mixin({},this._url.query,{f:"json",text:c.text,maxSuggestions:c.maxSuggestions,searchExtent:c.searchExtent&&G.toJson(c.searchExtent.toJson()),category:c.categories&&c.categories.join(",")||null,countryCode:c.countryCode||
null,location:c.location||null,distance:c.distance||null},{f:"json"}));c=l({url:this._url.path+"/suggest",content:c,callbackParamName:"callback"});x._pendingDfd=c;c.then(B.hitch(this,function(y){y=y.suggestions||[];this.onSuggestLocationsComplete(y);x.resolve(y)}),B.hitch(this,function(y){this._errorHandler(y);x.reject(y)}));return x},addressesToLocations:function(c,x,y){var u=this.outSpatialReference,f=[],d=c.categories,g=c.locationType,E=c.countryCode;C.forEach(c.addresses,function(v,F){f.push({attributes:v})});
c=this._encode(B.mixin({},this._url.query,{category:d&&d.join(",")||null,locationType:g||null,sourceCountry:E||null},{addresses:G.toJson({records:f})},{f:"json",outSR:u&&G.toJson(u.toJson())}));var k=this._geocodeAddressesHandler,b=this._errorHandler,e=new J(t._dfdCanceller);e._pendingDfd=l({url:this._url.path+"/geocodeAddresses",content:c,callbackParamName:"callback",load:function(v,F){k(v,F,x,y,e)},error:function(v){b(v,y,e)}});return e},_reverseGeocodeHandler:function(c,x,y,u,f){try{var d=new w({address:c.address,
location:c.location,score:100});this._successHandler([d],"onLocationToAddressComplete",y,f)}catch(g){this._errorHandler(g,u,f)}},locationToAddress:function(c,x,y,u){c&&this.normalization&&(c=c.normalize());var f=this.outSpatialReference;c=this._encode(B.mixin({},this._url.query,{outSR:f&&G.toJson(f.toJson()),location:c&&G.toJson(c.toJson()),distance:x,f:"json"}));var d=this._reverseGeocodeHandler,g=this._errorHandler,E=new J(t._dfdCanceller);E._pendingDfd=l({url:this._url.path+"/reverseGeocode",content:c,
callbackParamName:"callback",load:function(k,b){d(k,b,y,u,E)},error:function(k){g(k,u,E)}});return E},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});q("extend-esri")&&B.setObject("tasks.Locator",H,p);return H})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(H,B,C,J,G){H=H(null,{declaredClass:"esri.tasks.AddressCandidate",
constructor:function(q){B.mixin(this,q);this.location=new G(this.location)}});C("extend-esri")&&B.setObject("tasks.AddressCandidate",H,J);return H})},"widgets/Directions/searchUtil":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils esri/lang esri/request jimu/utils esri/dijit/PopupTemplate esri/graphic esri/geometry/webMercatorUtils esri/tasks/ProjectParameters".split(" "),function(H,B,C,J,G,q,p,l,t,z,w,c,x){var y={map:null,layerInfosObj:null,
appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(u){this.map=u},setLayerInfosObj:function(u){this.layerInfosObj=u},setAppConfig:function(u){this.appConfig=u},getConfigInfo:function(u){if(u&&u.sources&&0<u.sources.length){var f=null;return this.searchLayer(this.map)&&u.upgradeFromGeocoder?(f=this.map.itemInfo.itemData.applicationProperties.viewing.search,f=B.map(f.layers,H.hitch(this,function(d,g){g.hintText=d;return this._getQueryTypeGeocoder(g)},
f.hintText)),G(f).then(H.hitch(this,function(d){u.sources=[].concat(d).concat(u.sources);return u}))):u}return J(this._getSoucesFromPortalAndWebmap()).then(H.hitch(this,function(d){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:d}}))},_getSoucesFromPortalAndWebmap:function(){var u=[],f=null;this.searchLayer(this.map)&&(f=this.map.itemInfo.itemData.applicationProperties.viewing.search,B.forEach(f.layers,H.hitch(this,function(d,g){g.hintText=d;u.push(this._getQueryTypeGeocoder(g))},f.hintText)));
return q.getPortalSelfInfo(this.appConfig.portalUrl).then(H.hitch(this,function(d){if((d=d.helperServices&&d.helperServices.geocode)&&0<d.length)for(var g=0,E=d.length;g<E;g++){var k=d[g];k&&u.push(this._processSingleLine(k))}return G(u).then(H.hitch(this,function(b){for(var e=[],v=0;v<b.length;v++){var F=b[v];F&&(F&&"query"===F.type?e.push(F):(F={name:F.name||this._getGeocodeName(F.url),url:F.url,singleLineFieldName:F.singleLineFieldName,placeholder:"Find address or place",maxResults:6,searchInCurrentMapExtent:!1,
type:"locator"},F.enableLocalSearch=this._isEsriLocator(F.url),F.localSearchMinScale=3E5,F.localSearchDistance=5E4,e.push(F)))}return e}))}))},_getQueryTypeGeocoder:function(u){var f=this.map.getLayer(u.id),d=null,g=null,E=null;E=p.isDefined(u.subLayer)?u.id+"_"+u.subLayer:u.id;d=this.layerInfosObj.traversal(function(k){return k.id===E?(g=k,!0):!1});return f&&d&&g?(d=p.isDefined(u.subLayer)?g.url||f.url+"/"+u.subLayer:g.url||f.url,{name:g.title,layerId:E,url:d,placeholder:u.hintText,searchFields:[u.field.name],
displayField:u.field.name,exactMatch:u.field.exactMatch||!1,maxResults:6,searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(u){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(u)},_processSingleLine:function(u){if(u.singleLineFieldName)return u;if(this._isEsriLocator(u.url))return u.singleLineFieldName="SingleLine",u;var f=new C;l({url:u.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(H.hitch(this,function(d){d.singleLineAddressField&&
d.singleLineAddressField.name?(u.singleLineFieldName=d.singleLineAddressField.name,f.resolve(u)):(console.warn(u.url+"has no singleLineFieldName"),f.resolve(null))}),H.hitch(this,function(d){console.error(d);f.resolve(null)}));return f.promise},_getGeocodeName:function(u){if("string"!==typeof u)return"geocoder";u=u.split("/");return u[u.length-2]||"geocoder"},getGeocoderName:function(u){return this._getGeocodeName(u)},hasAppSearchInfo:function(u){return u.itemInfo&&u.itemInfo.itemData&&u.itemInfo.itemData.applicationProperties&&
u.itemInfo.itemData.applicationProperties.viewing&&u.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(u){if(!this.hasAppSearchInfo(u))return!1;u=u.itemInfo.itemData.applicationProperties.viewing.search;return u.enabled&&0!==u.layers.length?!0:!1},getSingleLineAddressName:function(u){var f=new C;l({url:u,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(H.hitch(this,function(d){d&&d.singleLineAddressField&&d.singleLineAddressField.name?f.resolve(d.singleLineAddressField.name):
f.resolve(null)}),H.hitch(this,function(d){console.error(d);f.reject()}));return f},version:{isConfigBefore63:function(u){var f=!1;u&&u.geocoderOptions&&(f=!0);return f},upgradeConfig:function(u){u.geocoderOptions&&delete u.geocoderOptions},getVersionState:function(){}},config:{onLayerInfosFilterChanged:function(u,f){B.some(u,H.hitch(this,function(d){f.searchOptions&&f.searchOptions.sources&&0<f.searchOptions.sources.length&&B.forEach(f.searchOptions.sources,function(g){g._featureLayerId===d.id&&
g.featureLayer.setDefinitionExpression(d.getFilter())})}))},getInfoTemplate:function(u,f,d){var g=new C;d=d.getLayerInfoById(f.layerId);var E;if(d)g=d.loadInfoTemplate();else{var k=[];B.filter(u.fields,function(b){"shape"!==b.name.toLowerCase()&&k.push(b.name)});(u=t.getDefaultPopupInfo(u,f.name+": {"+f.displayField+"}",k))&&(E=new z(u));g.resolve(E)}return g},getWayPoints:function(u,f,d){var g=new C;f&&g.resolve(u.defaultLocations);f=[];for(var E=0,k=u.defaultLocations.length;E<k;E++){var b=u.defaultLocations[E];
if("object"===typeof b&&b.feature&&b.name){var e={};e=b.feature.attributes;b.name&&(e.Name=b.name);b=new w(b.feature,null,e);f.push(b)}else"string"===typeof b?f.push(b):f.push("")}y.config.projectGeometriesToMapCoords(f,d).then(H.hitch(this,function(v){g.resolve(v)}),H.hitch(this,function(v){g.reject(v)}));return g},projectGeometriesToMapCoords:function(u,f){var d=new C,g=[],E=[];if(4326===parseInt(f.spatialReference.wkid,10))g.push((new C).resolve(u));else if(f.spatialReference.isWebMercator()){for(var k=
0,b=u.length;k<b;k++){var e=u[k];if(f=e.geometry)if(f=c.geographicToWebMercator(f))e.geometry=f;E.push(e)}g.push((new C).resolve(E))}else for(E=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService,E&&"esri.tasks.GeometryService"===E.declaredClass||(geoServiceUrl&&"string"===typeof geoServiceUrl&&H.trim(geoServiceUrl)?(geoServiceUrl=H.trim(geoServiceUrl),E=new GeometryService(geoServiceUrl)):E=t.getArcGISDefaultGeometryService()),k=0,b=u.length;k<b;k++)(e=u[k])?g.push(y.config.projectedToOthersCoords(e,
E,f)):g.push((new C).resolve(""));G(g).then(H.hitch(this,function(v){var F=[];if(1<v.length){for(var K=0,I=v.length;K<I;K++)F.push(v[K]);return d.resolve(F)}return d.resolve(v[0])}),H.hitch(this,function(v){return d.reject(v)}));return d},projectedToOthersCoords:function(u,f,d){var g=new C,E=new x;E.geometries=[u.geometry];E.outSR=d.spatialReference;f.project(E).then(function(k){return(k=k&&k[0])?(u.geometry=k,g.resolve(u)):g.reject("")},function(k){console.error(k);return g.reject("")});return g},
_toPointGeometry:function(u){var f=u.feature.geometry;f&&(f.getCentroid?u.feature.geometry=f.getCentroid():f.getExtent&&(f=f.getExtent())&&(u.feature.geometry=f.getCenter()));return u},_getLocationObject:function(u){return{name:u.name,extent:u.extent,feature:{geometry:u.feature.geometry,attributes:{Score:100,Addr_Type:"PointAddress"}}}}}};return y})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E,k,b,e,v,F,K,I,L,S,Z,W,fa,ma,la,na,oa,ca,ja,ha,n,A,N,P,U,ka){function aa(a,h){a&&h&&(a._layer=h,a._sourceLayer=h)}B=B([k,b,e,G],{declaredClass:"esri.dijit.Search",templateString:E,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,h){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new N("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:g.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:g.widgets.Search.main.placeholder,highlightSymbol:(new fa(H.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new oa).setColor(new U([181,56,46,.9])).setFont(new ca("14px",ca.STYLE_NORMAL,ca.VARIANT_NORMAL,ca.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new I(g.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:3,enableSearchingAll:!0};a=C.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=g;this._defaultSR=new S(4326);this.domNode=h},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(C.hitch(this,this._init))},postCreate:function(){var a=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(l(this.submitNode,v,C.hitch(this,this._searchButton)));this.own(l(this.sourcesBtnNode,v,C.hitch(this,this._toggleSourcesMenu)));this.own(l(this.inputNode,v,C.hitch(this,this._inputClick)));this.own(l(this.clearNode,v,C.hitch(this,this._clearButton)));this.own(l(this.formNode,"submit",C.hitch(this,function(h){h.preventDefault();this._cancelSuggest();this.search()})));this.own(l(this.inputNode,"keyup",C.hitch(this,function(h){this._inputKey(h)})));
this.own(l(this.sourcesBtnNode,"keyup",C.hitch(this,function(h){this._sourceBtnKey(h)})));this.own(l(this.suggestionsNode,"li:click, li:keyup",function(h){a._suggestionsEvent(h,this)}));this.own(l(this.sourcesNode,"li:click, li:keyup",function(h){a._sourcesEvent(h,this)}));this.own(l(this.inputNode,"input, paste",C.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",C.hitch(this,function(h){this._showMoreResultsClick(h)}))),this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",C.hitch(this,function(h){this._moreResultsClick(h)}))),this.own(l(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",C.hitch(this,function(h){this._switchCoordinatesClick(h)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();f.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();x.get(this.inputNode,"value")&&x.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);y.remove(this.containerNode,this.css.hasValue);x.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){u.set(this.domNode,"display","block")},hide:function(){u.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(y.add(this.containerNode,this.css.searchExpanded),y.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(y.remove(this.containerNode,this.css.searchExpanded),y.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"===typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var h=new q;this._mapLoaded().then(C.hitch(this,function(){this._searchDeferred(a).then(C.hitch(this,function(r){var m=r.results;this.set("searchResults",m);0===r.numResults&&(this._noResults(r.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",r);this._selectFirstResult(m,
r.activeSourceIndex);h.resolve(m)}),C.hitch(this,function(r){h.reject(r)}))}));return h.promise},suggest:function(a){var h=new q;this._mapLoaded().then(C.hitch(this,function(){this._suggestDeferred(a).then(C.hitch(this,function(r){if(r){var m=r.results;this.set("suggestResults",m);this._insertSuggestions(m,r.value);this.emit("suggest-results",r);h.resolve(m)}}),C.hitch(this,function(r){h.reject(r)}))}));return h.promise},select:function(a){var h=this._getDefaultSymbol(a),r=this.labelSymbol,m=this.sources,
D=this.activeSourceIndex,M=this.enableHighlight,Q=this.enableLabel,X=this.autoNavigate,R=this.showInfoWindowOnSelect,T=this.enableInfoWindow,O=this.infoTemplate,V=a.feature?new Z(a.feature.toJson()):null,ea=V?a.feature._sourceLayer:null;aa(V,ea);if(D===this._allIndex){var ba=this._getSourceIndexOfResult(a);if(null!==ba){var Y=m[ba];D=ba}}else Y=m[D];Y&&(Y.hasOwnProperty("highlightSymbol")&&(h=Y.highlightSymbol),Y.hasOwnProperty("labelSymbol")&&(r=Y.labelSymbol),Y.hasOwnProperty("enableHighlight")&&
(M=Y.enableHighlight),Y.hasOwnProperty("enableLabel")&&(Q=Y.enableLabel),Y.hasOwnProperty("autoNavigate")&&(X=Y.autoNavigate),Y.hasOwnProperty("showInfoWindowOnSelect")&&(R=Y.showInfoWindowOnSelect),Y.hasOwnProperty("enableInfoWindow")&&(T=Y.enableInfoWindow),Y.hasOwnProperty("infoTemplate")?O=Y.infoTemplate:Y.featureLayer&&Y.featureLayer.infoTemplate&&(O=Y.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(V){m=this.highlightGraphic;var da=this.graphicsLayer;ba=this.labelGraphic;
var ia=C.mixin({},V.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),pa=null;T&&(pa=O);ba?(ba.setGeometry(V.geometry),ba.setAttributes(ia),ba.setSymbol(r),r&&"textsymbol"===r.type&&ba.symbol.setText(a.name)):(ba=new Z(V.geometry,r,ia),aa(ba,ea),r&&"textsymbol"===r.type&&ba.symbol.setText(a.name),
Q&&(da?da.add(ba):this.map&&this.map.graphics&&this.map.graphics.add(ba)));m?(m.setGeometry(V.geometry),m.setAttributes(ia),m.setInfoTemplate(pa),m.setSymbol(h)):(m=new Z(V.geometry,h,ia,pa),aa(m,ea),M&&(da?da.add(m):this.map&&this.map.graphics&&this.map.graphics.add(m)));m&&m.symbol&&"textsymbol"===m.symbol.type&&m.symbol.setText(a.name);this.map&&this.map.infoWindow&&T&&R&&(this.map.infoWindow.setFeatures([m]),h=this._getPointFromGeometry(m.geometry),this.map.infoWindow.show(h));this.map&&X&&a&&
a.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(a.extent,!0);this.set("highlightGraphic",m);this.set("labelGraphic",ba)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:Y,sourceIndex:D})},focus:function(){F.focus(this.inputNode)},blur:function(){this.inputNode.blur();F.curNode&&F.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,h=this.graphicsLayer,r=this.labelGraphic;a&&(h?h.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));
r&&(h?h.remove(r):this.map&&this.map.graphics&&this.map.graphics.remove(r));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new q;if(this.map)if(this.map.loaded)a.resolve();else l.once(this.map,"load",C.hitch(this,function(){a.resolve()}));else a.resolve();return a.promise},_init:function(){this._getMapLayers().then(C.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();F.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+
" "+a)},_searchDeferred:function(a){var h=new q,r=this.value,m=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(m=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var D={magicKey:this.magicKey,text:r};a?"string"===typeof a?(D.text=a,a=this._searchQueries(D)):a="object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?this._searchQueries({geometry:a}):"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?
this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):this._searchQueries(D):a=this._searchQueries(D);a.always(C.hitch(this,function(M){M=this._formatResults(M,m,r);h.resolve(M)}));return h.promise},_suggestDeferred:function(a){var h=new q;this._deferreds.push(h);a||(a=this.value);var r=this.activeSourceIndex;this._suggestQueries({text:a}).always(C.hitch(this,function(m){var D;if(m)for(var M=0;M<
m.length;M++)m[M]&&(D=!0);D?(m=this._formatResults(m,r,a),h.resolve(m)):h.resolve()}));return h.promise},_getDefaultSymbol:function(a){var h;this.map&&(h=this.map.getBasemap());h||(h="topo");if(a&&a.feature&&a.feature.geometry)var r=a.feature.geometry.type;"polyline"===r?r="line":"circle"===r||"extent"===r?r="polygon":"multipoint"===r&&(r="point");if(r){if(a=ka.getSchemes({theme:"default",basemap:h,geometryType:r}))var m=a.primaryScheme;if(m){m.color&&m.hasOwnProperty("opacity")&&(m.color.a=m.opacity);
var D=m;a=m.color;m=m.size;switch(r){case "point":var M=new ma;M.setColor(a);M.setSize(null!==m?m:D.size);r=new la;r.setColor(D.outline.color);r.setWidth(D.outline.width);M.setOutline(r);break;case "line":M=new la;M.setColor(a);M.setWidth(null!==m?m:D.width);break;case "polygon":M=new na,M.setColor(a),r=new la,r.setColor(D.outline.color),r.setWidth(D.outline.width),M.setOutline(r)}D=M}}return D},_selectFirstResult:function(a,h){if(this.autoSelect&&a){var r;h===this._allIndex?r=this._getFirstResult(a):
a[h]&&a[h][0]&&(r=a[h][0]);r&&this.select(r)}},_getSourceIndexOfResult:function(a){var h=this.searchResults;if(h)for(var r in h)if(h[r]&&h[r].length)for(var m=0;m<h[r].length;m++)if(h[r][m]===a)return parseInt(r,10);return null},_getFirstResult:function(a){if(a)for(var h in a)if(a[h]&&a[h][0])return a[h][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new q;if(this.addLayersFromMap&&this.map){var h=[],r=this.map.graphicsLayerIds;if(r&&r.length){for(var m=0;m<r.length;m++){var D=this.map.getLayer(r[m]);D&&h.push(this._featureLayerLoaded(D))}W(h).always(C.hitch(this,function(M){for(var Q,X=this.sources,R=0;R<M.length;R++)M[R]&&
M[R].loaded&&"Feature Layer"===M[R].type&&(X.push({featureLayer:M[R],enableSuggestions:!0}),Q=!0);Q&&this.set("sources",X);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=x.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();var h=a.target;a=parseInt(x.get(h,"data-source-index"),10);h=parseInt(x.get(h,"data-index"),10);var r=this.searchResults;
r&&r[a]&&(a=r[a][h])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=c.byId(this._moreResultsId)){y.toggle(a,this.css.searchShowMoreResults);var h=c.byId(this._moreResultsId+"_show");h&&(y.contains(a,this.css.searchShowMoreResults)?x.set(h,"textContent",g.widgets.Search.main.hideMoreResults):x.set(h,"textContent",g.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(a){var h=new q;if(a.loaded)h.resolve(a);else if(a.loadError)h.reject(this._error("Layer failed to load."));
else{var r=l.once(a,"load",C.hitch(this,function(){m.remove();h.resolve(a)}));var m=l.once(a,"error",C.hitch(this,function(){r.remove();h.reject(this._error("Layer could not be loaded."))}))}return h.promise},_getObjectSize:function(a){var h=0,r;for(r in a)a.hasOwnProperty(r)&&h++;return h},_sourcesEvent:function(a,h){var r=x.get(h,"data-index"),m=t("li",this.sourcesNode);h=J.indexOf(m,h);r!==this._allIndex&&(r=parseInt(r,10));"click"===a.type||a.keyCode===p.ENTER?(this.set("activeSourceIndex",r),
F.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),a=h-1,0>a?F.focus(this.sourcesBtnNode):F.focus(m[a])):a.keyCode===p.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),a=h+1,a>=m.length?F.focus(this.sourcesBtnNode):F.focus(m[a])):a.keyCode===p.ESCAPE&&(this._hideSourcesMenu(),F.focus(this.inputNode))},_suggestionsEvent:function(a,h){var r=x.get(h,"data-source-index"),m=parseInt(x.get(h,"data-index"),10),D=t("li",this.suggestionsNode),
M=this.sources;h=J.indexOf(D,h);r!==this._allIndex&&(r=parseInt(r,10));var Q;this._clearQueryTimeout();"click"===a.type||a.keyCode===p.ENTER?((D=this.suggestResults)&&D[r]&&D[r][m]&&(Q=D[r][m]),Q&&(Q.index=r,M[r].featureLayer?(r=M[r].featureLayer.objectIdField,Q[this._objectIdIdentifier]=Q.feature.attributes[r],this.set("value",this._getSuggestionName(Q)),this.set("selectedFeatureId",Q.feature.attributes[r])):Q.magicKey&&Q.text&&(this.set("value",Q.text),this.set("magicKey",Q.magicKey)),this.search(Q),
F.focus(this.inputNode))):a.keyCode===p.BACKSPACE||a.keyCode===p.DELETE?F.focus(this.inputNode):a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),Q=h-1,0>Q?F.focus(this.inputNode):F.focus(D[Q])):a.keyCode===p.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),Q=h+1,Q>=D.length?F.focus(this.inputNode):F.focus(D[Q])):a.keyCode===p.ESCAPE&&(this._hideMenus(),F.focus(this.inputNode))},_getResultName:function(a){var h;a.hasOwnProperty("name")&&null!==a.name&&(h=a.name.toString());h||(h=g.widgets.Search.main.untitledResult);
return h},_getSuggestionName:function(a){var h;a.hasOwnProperty("name")&&null!==a.name&&(h=a.name.toString());a=a.text||h;a||(a=g.widgets.Search.main.untitledResult);return a},_searchResultHTML:function(a){var h="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var r=a.name.split(" ");if(2===r.length){var m=r[0];var D=r[1]}D&&m?(a=parseFloat(m),D=parseFloat(D),r=D+", "+a,h+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',
h+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+g.widgets.Search.main.lonlat+"\x3c/div\x3e",h=h+(a+", "+D)+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsItem+'"\x3e'),a===D||90<a||-90>a||180<D||-180>D||(h+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+g.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",h+='\x3ca data-switch-coordinates\x3d"'+r+'" tabindex\x3d"0" href\x3d"#"\x3e'+r+"\x3c/a\x3e\x3c/div\x3e")):h=a.name}else h=a.name;return h},_moreResultsHTML:function(a){var h=
"",r="",m=this.searchResults,D=this.sources,M=0;if(m){r+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e';r+='\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+g.widgets.Search.main.showMoreResults+"\x3c/a\x3e";r=r+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsList+'"\x3e');r+='\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e';for(var Q in m)if(m[Q]){var X=m[Q].length;if(X){var R=1===X&&m[Q][0]===a;if(1<this._getObjectSize(m)&&!R){var T=this._getSourceName(Q);r+=
'\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+T+"\x3c/div\x3e"}if(X&&!R){r+="\x3cul\x3e";T=D[Q].maxResults||this.maxResults;for(R=0;R<X&&R<T;++R)if(m[Q][R]!==a){var O=this._getResultName(m[Q][R]);r+='\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+R+'" data-source-index\x3d"'+Q+'" href\x3d"#"\x3e'+O+"\x3c/a\x3e\x3c/li\x3e";M++}r+="\x3c/ul\x3e"}}}r+="\x3c/div\x3e\x3c/div\x3e"}M&&(h+=r);return h},_validField:function(a,h){return a.getField(h)},_validFields:function(a,h){if(a&&h&&
h.length){for(var r=0;r<h.length;r++)if(!this._validField(a,h[r]))return!1;return!0}return!1},_getCodedName:function(a,h){if(a&&a.length)for(var r=0,m=a.length;r<m;r++){var D=a[r];if(D.code===h)return D.name}},_getCodedValue:function(a,h,r){if(a&&a.length)for(var m=0,D=a.length;m<D;m++){var M=a[m],Q=M.name,X=h;r||(Q=Q.toLowerCase(),X=X.toLowerCase());if(Q===X)return M.code}return!1},_whereClause:function(a,h,r,m){var D=null;if(a){var M="";this.reHostedFS.test(h.url)&&this._containsNonLatinCharacter(a)&&
(M="N");if(r&&r.length)for(var Q=0,X=r.length;Q<X;Q++){var R="",T=a.replace(/'/g,"''");R=r[Q];var O=h.getField(R),V=h.getDomain(R);V&&"codedValue"===V.type&&(T=this._getCodedValue(V.codedValues,T,m));!1!==T&&(O=O.type,"esriFieldTypeString"===O||"esriFieldTypeDate"===O?R=m?R+" \x3d "+M+"'"+T+"'":"UPPER("+R+") LIKE "+M+"'%"+T.toUpperCase()+"%'":"esriFieldTypeOID"===O||"esriFieldTypeSmallInteger"===O||"esriFieldTypeInteger"===O||"esriFieldTypeSingle"===O||"esriFieldTypeDouble"===O?(T=parseFloat(T),R=
isNaN(T)?!1:R+" \x3d "+T):R=R+" \x3d "+T,R&&(D=D?D+" or ":"",D+=R))}}return D},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var h=new q,r=a.index,m=this.sources[r],D=this.enableSuggestions;m.hasOwnProperty("enableSuggestions")&&(D=m.enableSuggestions);var M=0;if(a.hasOwnProperty("text")&&a.text){var Q=C.trim(a.text);M=a.text.length}a=m.minCharacters||this.minCharacters;if(D&&Q&&M>=a&&this._supportsPagination(m)){var X="";m.prefix&&(X+=m.prefix);X+=Q;m.suffix&&(X+=m.suffix);
var R=this._defaultSR;this.map&&(R=this.map.spatialReference);D={};m.locator?(m.categories&&(D.categories=m.categories),m.locator.outSpatialReference=R,this.map&&m.localSearchOptions&&m.localSearchOptions.hasOwnProperty("distance")&&m.localSearchOptions.hasOwnProperty("minScale")&&(M=this._getScale(),!m.localSearchOptions.minScale||M&&M<=parseFloat(m.localSearchOptions.minScale))&&(D.location=this.map.extent.getCenter(),D.distance=m.localSearchOptions.distance),D.text=X,m.useMapExtent&&this.map&&
this.map.extent&&(D.searchExtent=this.map.extent),m.searchExtent&&(D.searchExtent=m.searchExtent),D.maxSuggestions=m.maxSuggestions||this.maxSuggestions,m.sourceCountry&&(D.countryCode=m.sourceCountry),m.countryCode&&(D.countryCode=m.countryCode),m.locator.suggestLocations(D).then(C.hitch(this,function(T){h.resolve(T)}),C.hitch(this,function(T){T||(T=this._error("Locator suggestLocations could not be performed."));h.reject(T)}))):m.featureLayer?this._featureLayerLoaded(m.featureLayer).then(C.hitch(this,
function(){var T=this._getDisplayField(m),O=m.searchFields||[T],V=[];m.suggestionTemplate?m.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(da,ia){V.push(ia)}):V=[T];-1===J.indexOf(V,m.featureLayer.objectIdField)&&V.push(m.featureLayer.objectIdField);T=this._validField(m.featureLayer,T);var ea=this._validFields(m.featureLayer,V),ba=this._validFields(m.featureLayer,O);if(T&&ea&&ba){T=new P;m.hasOwnProperty("suggestQueryParams")&&C.mixin(T,m.suggestQueryParams);T.outSpatialReference=R;T.returnGeometry=
!1;T.num=m.maxSuggestions||this.maxSuggestions;T.outFields=V;m.useMapExtent&&this.map&&this.map.extent&&(T.geometry=this.map.extent);m.searchExtent&&(T.geometry=m.searchExtent);if(O=this._whereClause(X,m.featureLayer,O,!1)){T.where=O;var Y=!0}Y?m.featureLayer.queryFeatures(T,C.hitch(this,function(da){var ia;(da=da.features)&&(ia=this._hydrateResults(da,r,!0));h.resolve(ia)}),C.hitch(this,function(da){da||(da=this._error("FeatureLayer queryFeatures errored with suggestions"));h.reject(da)})):h.resolve()}else h.reject(this._error("Invalid FeatureLayer field"))})):
h.reject(this._error("Invalid source"))}else h.resolve();return h.promise},_supportsPagination:function(a){var h;a.locator?h=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(h=!0);return h},_suggestQueries:function(a){var h=this.sources,r=this.activeSourceIndex,m=[];if(r===this._allIndex)for(r=0;r<h.length;r++){var D=a;D.index=r;D=this._suggest(D);m.push(D)}else a.index=r,D=this._suggest(a),m.push(D);return W(m)},_getPointFromGeometry:function(a){switch(a.type){case "extent":var h=
a.getCenter();break;case "multipoint":h=a.getPoint(0);break;case "point":h=a;break;case "polygon":h=a.getCentroid();break;case "polyline":h=a.getPoint(0,0)}return h},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var h=[];if(a.index===this._allIndex)for(var r=this.sources,m=0;m<r.length;m++){var D=a;D.index=m;D=this._search(D);h.push(D)}else a=this._search(a),h.push(a);return W(h)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),
F.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(a.text=null,a[this._objectIdIdentifier]=this.selectedFeatureId);var h,r=new q,m=a.index,D=this.sources[m],M;a.hasOwnProperty("text")&&a.text&&(M=C.trim(a.text));if(D){var Q="";D.prefix&&!a.magicKey&&(Q+=D.prefix);Q+=M;D.suffix&&!a.magicKey&&(Q+=D.suffix);var X=this._defaultSR;this.map&&
(X=this.map.spatialReference);if(D.locator)if(a.hasOwnProperty("text")&&M){var R={};D.categories&&(R.categories=D.categories);D.locationType&&(R.locationType=D.locationType);X&&(D.locator.outSpatialReference=X);if(this.map&&D.localSearchOptions&&D.localSearchOptions.hasOwnProperty("distance")&&D.localSearchOptions.hasOwnProperty("minScale")){var T=this._getScale();if(!D.localSearchOptions.minScale||T&&T<=parseFloat(D.localSearchOptions.minScale))R.location=this.map.extent.getCenter(),R.distance=D.localSearchOptions.distance}R.address=
{};R.maxLocations=D.maxResults||this.maxResults;D.useMapExtent&&this.map&&this.map.extent&&(R.searchExtent=this.map.extent);D.searchExtent&&(R.searchExtent=D.searchExtent);D.sourceCountry&&(R.countryCode=D.sourceCountry);D.countryCode&&(R.countryCode=D.countryCode);a.magicKey&&(R.magicKey=a.magicKey);D.singleLineFieldName?R.address[D.singleLineFieldName]=Q:R.address["Single Line Input"]=Q;D.outFields&&(R.outFields=D.outFields);D.locator.addressToLocations(R).then(C.hitch(this,function(O){O=this._hydrateResults(O,
m,!1);r.resolve(O)}),C.hitch(this,function(O){O||(O=this._error("Locator addressToLocations could not be performed"));r.reject(O)}))}else a.geometry?(h=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(m,h).then(function(O){r.resolve(O)},function(O){r.reject(O)}):r.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(m,a.point).then(function(O){r.resolve(O)},function(O){r.reject(O)}):a.latlon?(R=new ja(a.latlon,this._defaultSR),this._reverseGeocodePoint(m,
R).then(function(O){r.resolve(O)},function(O){r.reject(O)})):a.hasOwnProperty("text")&&!M?r.resolve([]):r.reject(this._error("Invalid query type for Locator"));else D.featureLayer?this._featureLayerLoaded(D.featureLayer).then(C.hitch(this,function(){var O=this._getDisplayField(D),V=D.searchFields||[O];O=this._validField(D.featureLayer,O);var ea=this._validFields(D.featureLayer,V);if(O&&ea){O=new P;D.hasOwnProperty("searchQueryParams")&&C.mixin(O,D.searchQueryParams);X&&(O.outSpatialReference=X,ea=
this.map&&this.map.getMaxResolution()||1/A.getUnitValueForSR(X))&&(O.maxAllowableOffset=ea);O.returnGeometry=!0;D.outFields&&(O.outFields=D.outFields);if(!a.hasOwnProperty(this._objectIdIdentifier)){this._supportsPagination(D)&&(O.num=D.maxResults||this.maxResults);D.useMapExtent&&this.map&&this.map.extent&&(O.geometry=this.map.extent);D.searchExtent&&(O.geometry=D.searchExtent);var ba=D.exactMatch}a.hasOwnProperty("text")&&M?(V=this._whereClause(Q,D.featureLayer,V,ba))?(O.where=V,V=!0):V=!1:a.hasOwnProperty(this._objectIdIdentifier)?
(O.objectIds=[a[this._objectIdIdentifier]],V=!0):a.geometry?(O.geometry=a.geometry,V=!0):a.point?(O.geometry=a.point,V=!0):a.latlon?(h=new ja(a.latlon,this._defaultSR),O.geometry=h,V=!0):(a.hasOwnProperty("text")&&!M?r.resolve([]):r.reject(this._error("Invalid query type for FeatureLayer")),V=!1);V?D.featureLayer.queryFeatures(O,C.hitch(this,function(Y){Y=Y.features;var da;Y&&(da=this._hydrateResults(Y,m,!1));r.resolve(da)}),C.hitch(this,function(Y){Y||(Y=this._error("FeatureLayer queryFeatures could not be performed"));
r.reject(Y)})):r.resolve()}else r.reject(this._error("Invalid FeatureLayer field"))})):r.reject(this._error("Invalid source"))}else r.reject(this._error("Source is undefined"));return r.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,h,r){r={activeSourceIndex:h,value:r,numResults:0,numErrors:0,errors:null,results:null};var m={},D={};if(a)if(h===this._allIndex)for(h=0;h<a.length;h++)a[h]&&(a[h]instanceof Error?(m[h]=a[h],r.numErrors++):
(D[h]=a[h],r.numResults+=a[h].length));else a[0]&&(a[0]instanceof Error?(m[h]=a[0],r.numErrors++):(D[h]=a[0],r.numResults+=a[0].length));r.numErrors&&(r.errors=m);r.numResults&&(r.results=D);return r},_reverseGeocodePoint:function(a,h){var r=new q,m=this.sources[a];if(h&&m){var D=m.locationToAddressDistance||this.locationToAddressDistance;m.locator.outSpatialReference=this._defaultSR;this.map&&(m.locator.outSpatialReference=this.map.spatialReference);m.locator.locationToAddress(h,D,C.hitch(this,function(M){M=
this._hydrateResults([M],a,!1);r.resolve(M)}),C.hitch(this,function(M){M||(M=this._error("Locator locationToAddress could not be performed"));r.reject(M)}))}else r.reject(this._error("No point or source defined for reverse geocoding"));return r.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var h=t("li",this.sourcesNode);
a.keyCode===p.UP_ARROW?(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),(a=h.length)&&F.focus(h[a-1])):a.keyCode===p.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),h[0]&&F.focus(h[0]))}},_inputKey:function(a){if(a){var h=t("li",this.suggestionsNode),r=this.suggestResults;if(a.keyCode===p.TAB||a.keyCode===p.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===p.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),r&&this._showSuggestionsMenu(),
(a=h.length)&&F.focus(h[a-1]);else if(a.keyCode===p.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),r&&this._showSuggestionsMenu(),h[0]&&F.focus(h[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===p.copyKey||a.keyCode===p.LEFT_ARROW||a.keyCode===p.RIGHT_ARROW||a.keyCode===p.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(C.hitch(this,
function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=J.filter(a,function(h){return!!h.featureLayer});a=J.map(a,function(h){return this._featureLayerLoaded(h.featureLayer)},this);return W(a)},
_createSourceNameMap:function(a){return this._loadSources(a).then(C.hitch(this,function(){var h=J.map(a,function(r){return r.name||r.featureLayer&&r.featureLayer.name||g.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(a,h);return h}))},_getDuplicateSourceNameIndexes:function(a){var h={},r=[];J.forEach(a,function(m,D){h.hasOwnProperty(m)?(-1===r.indexOf(h[m])&&r.push(h[m]),r.push(D)):a.lastIndexOf(m)!==D&&(h[m]=D)});return r},_preventDuplicateSourceNames:function(a,h){if(h&&
1<h.length){var r=this._getDuplicateSourceNameIndexes(h);J.forEach(r,function(m){h[m]+=this._getFieldsString(a[m])},this)}},_getFieldsString:function(a){var h="",r=a.featureLayer;if(r){a=a.searchFields||[this._getDisplayField(a)];for(var m=0;m<a.length;m++){h=0===m?h+": ":h+", ";var D=a[m],M=r.getFieldLabel(D);h+=M||D}}return h},_splitResult:function(a,h){h=w.escapeString(h);return a.replace(new RegExp("(^|)("+h+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,h){if(this.enableSuggestionsMenu&&
this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var r=this.sources;if(a){var m=f.create("div");for(var D in a)if(a[D]&&a[D].length){var M=this._getSourceName(D);1<r.length&&this.activeSourceIndex===this._allIndex&&f.create("div",{className:this.css.searchMenuHeader,textContent:M},m);M=f.create("ul",{role:"menu"},m);for(var Q=r[D].maxSuggestions||this.maxSuggestions,X=0;X<a[D].length&&X<Q;++X){var R=f.create("li",{"data-index":X,"data-source-index":D,role:"menuitem",tabindex:0},
M),T=this._getSuggestionName(a[D][X]);T=this._splitResult(T,h);for(var O=T.length,V=0;V<O;V++){var ea=T[V];ea.toLowerCase()===h.toLowerCase()?f.create("strong",{textContent:ea},R):(ea=document.createTextNode(ea),f.place(ea,R))}}}}m?(f.place(m,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(f.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var h,r=this.activeSourceIndex,m=f.create("ul",{role:"menu"});if(this.enableSearchingAll){var D=
"";r===this._allIndex&&(D="active");f.create("li",{"data-index":this._allIndex,role:"menuitem",className:D,tabIndex:0,textContent:g.widgets.Search.main.all},m)}for(h=0;h<a.length;h++){D="";h===r&&(D=this.css.activeSource);var M=this._getSourceName(h);f.create("li",{"data-index":h,role:"menuitem",className:D,tabIndex:0,textContent:M},m)}y.add(this.containerNode,this.css.hasMultipleSources);f.place(m,this.sourcesNode,"only")}else y.remove(this.containerNode,this.css.hasMultipleSources),f.empty(this.sourcesNode)},
_showLoading:function(){y.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){y.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(y.add(this.containerNode,this.css.hasValue),x.set(this.clearNode,"title",g.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var h;a&&(h=C.trim(a));var r=f.create("div",{className:this.css.searchNoResultsBody});
a&&h?(f.create("div",{className:this.css.searchNoResultsHeader,textContent:g.widgets.Search.main.noResults},r),f.create("div",{className:this.css.searchNoResultsText,textContent:K.substitute({value:'"'+a+'"'},g.widgets.Search.main.noResultsFound)},r)):(a=f.create("div",{},r),f.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),f.create("span",{className:this.css.searchNoValueText,textContent:g.widgets.Search.main.emptyValue},a));f.place(r,this.noResultsMenuNode,"only")},
_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){y.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();y.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){y.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){y.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();y.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();y.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();y.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var h=0;h<a.length;h++){var r=a[h];if("esriFieldTypeString"===r.type)return r.name}return""},
_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validLocation:function(a){return a&&"number"===typeof a.x&&"number"===typeof a.y},_validExtent:function(a){return a&&"number"===typeof a.xmin&&"number"===typeof a.ymin&&"number"===typeof a.xmax&&"number"===typeof a.ymax},_hydrateResult:function(a,h,r){var m={},D=this._defaultSR;h=this.sources[h];this.map&&(D=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;
if(a.hasOwnProperty("geometry")){var M=new Z(a.toJson());m.feature=M;(M=m.feature.geometry)&&M.setSpatialReference(D)}else if(a.hasOwnProperty("location")&&this._validLocation(a.location)){var Q=new ja(a.location.x,a.location.y,D);M={};a.hasOwnProperty("attributes")&&(M=a.attributes);a.hasOwnProperty("address")&&"object"===typeof a.address&&C.mixin(M,a.address);a.hasOwnProperty("score")&&(M.score=a.score);m.feature=new Z(Q,null,M,null)}!m.feature&&r&&(M={},a.hasOwnProperty("attributes")&&(M=a.attributes),
a.hasOwnProperty("score")&&(M.score=a.score),m.feature=new Z(null,null,M,null));if(m.feature){if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))m.extent=new ha(a.extent),m.extent.setSpatialReference(D);else if(m.feature&&m.feature.geometry)switch(m.feature.geometry.type){case "extent":m.extent=m.feature.geometry;break;case "multipoint":m.extent=n.getDenormalizedExtent(m.feature.geometry);break;case "polygon":m.extent=n.getDenormalizedExtent(m.feature.geometry);break;case "polyline":m.extent=
n.getDenormalizedExtent(m.feature.geometry);break;case "point":this.map?(D=this.zoomScale,h&&h.zoomScale&&(D=h.zoomScale),this._getScale()>D?m.extent=A.getExtentForScale(this.map,D).centerAt(m.feature.geometry):m.extent=this.map.extent.centerAt(m.feature.geometry)):m.extent=new ha({xmin:m.feature.geometry.x-.25,ymin:m.feature.geometry.y-.25,xmax:m.feature.geometry.x+.25,ymax:m.feature.geometry.y+.25,spatialReference:this._defaultSR})}else m.extent=null;m.name="";h.featureLayer?h.suggestionTemplate&&
r?m.name=K.substitute(a.attributes,h.suggestionTemplate):h.searchTemplate?m.name=K.substitute(a.attributes,h.searchTemplate):(M=this._getDisplayField(h),r=h.featureLayer.getField(M),D=h.featureLayer.getDomain(M),M&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(M)&&(a=a.attributes[M],D&&"codedValue"===D.type?m.name=this._getCodedName(D.codedValues,a):r&&"esriFieldTypeDate"===r.type&&!isNaN(a)?m.name=d.format(new Date(a)):m.name=a)):a.address&&h.searchTemplate?m.name=K.substitute(a.address,
h.searchTemplate):a.hasOwnProperty("name")?m.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.LongLabel?m.name=a.attributes.LongLabel:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(m.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City?m.name+=" - "+a.attributes.StAddr+", "+a.attributes.City:a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&
a.attributes.City&&(m.name+=" - "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?m.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?m.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(m.name=a.address.Address):m.feature&&m.feature.geometry&&(m.name=m.feature.geometry.x+","+m.feature.geometry.y);h.featureLayer&&m.feature&&aa(m.feature,h.featureLayer);return m}},
_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,h,r,m){m=[];var D=0;if(a&&a.length)for(D;D<a.length;D++){var M=this._hydrateResult(a[D],h,r);M&&m.push(M)}return m},_containsNonLatinCharacter:function(a){for(var h=0;h<a.length;h++)if(255<a.charCodeAt(h))return!0;return!1},_setPlaceholder:function(a){var h="",r=this.sources[a];a===this._allIndex?h=this.allPlaceholder||g.widgets.Search.main.allPlaceholder:r&&r.placeholder&&
(h=r.placeholder);var m=g.widgets.Search.main.all;r&&(m=this._getSourceName(a));x.set(this.sourceNameNode,"textContent",m);x.set(this.inputNode,"placeholder",h);x.set(this.inputNode,"title",h)},_updateActiveSource:function(){var a=this.sources,h=this.activeSourceIndex,r;a&&a[h]&&(r=a[h]);r?this.set("activeSource",r):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(y.toggle(this.containerNode,this.css.searchExpanded,this.expanded),
y.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),y.add(this.containerNode,this.css.hasButtonMode)):(y.remove(this.containerNode,this.css.searchExpanded),y.remove(this.containerNode,this.css.searchCollapsed),y.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",
a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._createSourceNameMap(a).then(C.hitch(this,function(h){this._sourceNames=h;this._created&&(this._setDefaultActiveSourceIndex(a),this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",
a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&x.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(x.set(this.inputNode,
"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(y.remove(this.domNode,this.theme),y.add(this.domNode,a));this._set("theme",a)}});z("extend-esri")&&C.setObject("dijit.Search",B,L);return B})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has",
"../kernel","../Color"],function(H,B,C,J,G){function q(w,c){if(w){var x={};x.color=new G(w.color);x.opacity=w.opacity||1;switch(c){case "point":x.outline={color:new G(w.outline.color),width:w.outline.width};x.size=w.size;break;case "line":x.width=w.width;break;case "polygon":x.outline={color:new G(w.outline.color),width:w.outline.width}}}return x}function p(w){if("esriGeometryPoint"===w||"esriGeometryMultipoint"===w)w="point";else if("esriGeometryPolyline"===w)w="line";else if("esriGeometryPolygon"===
w||"esriGeometryMultiPatch"===w)w="polygon";return w}var l={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,
255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,
119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,
92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},t={};(function(){var w,c,x;for(w in l){var y=l[w];var u=y.basemapGroups;var f=t[w]={basemaps:[].concat(u.light).concat(u.dark),point:{},line:{},polygon:{}};for(c in u){var d=u[c];for(x=0;x<d.length;x++){var g=d[x];y.pointSchemes&&(f.point[g]=y.pointSchemes[c]);y.lineSchemes&&(f.line[g]=y.lineSchemes[c]);
y.polygonSchemes&&(f.polygon[g]=y.polygonSchemes[c])}}}})();var z={getAvailableThemes:function(w){var c=[],x;for(x in l){var y=l[x];var u=t[x];w&&-1===H.indexOf(u.basemaps,w)||c.push({name:y.name,label:y.label,description:y.description,basemaps:u.basemaps.slice(0)})}return c},getSchemes:function(w){var c=w.theme,x=w.basemap,y=p(w.geometryType);w=t[c];var u;(w=(w=w&&w[y])&&w[x])&&(u={primaryScheme:q(w.primary,y),secondarySchemes:H.map(w.secondary,function(f){return q(f,y)})});return u},cloneScheme:function(w){if(w){var c=
B.mixin({},w);c.color&&(c.color=new G(c.color));c.outline&&(c.outline={color:c.outline.color&&new G(c.outline.color),width:c.outline.width})}return c}};C("extend-esri")&&B.setObject("styles.basic",z,J);return z})},"widgets/Directions/setting/SearchConfig/SearchConfig":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query dojo/_base/array dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SearchConfig.html ./QuerySourceSetting ./LocatorSourceSetting jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter dojo/Deferred ../../searchUtil dojo/when jimu/dijit/Message jimu/dijit/SimpleTable jimu/dijit/RadioBtn".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E,k){return H([l,t,z,p],{templateString:w,postMixInProperties:function(){this.inherited(arguments);B.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.sourceList=new k({autoHeight:!1,selectable:!0,fields:[{name:"name",title:this.nls.name,width:"auto",type:"text",editable:!1},{name:"type",hidden:!0,type:"text",editable:!1},{name:"actions",title:"",width:"70px",type:"actions",actions:["up","down","delete"]}]},this.sourceList);
J.setStyle(this.sourceList.domNode,"height","100%");this.sourceList.startup();this.own(C(this.sourceList,"row-select",B.hitch(this,this._onSourceItemSelected)));this.own(C(this.sourceList,"row-delete",B.hitch(this,this._onSourceItemRemoved)));this.own(C(this.sourceList,"row-edit",B.hitch(this,this._onSourceItemChanged)));this.shelter=new u({hidden:!0})},startup:function(){this.inherited(arguments);this.shelter.show();y.getInstance(this.map,this.map.itemInfo).then(B.hitch(this,function(b){this.layerInfosObj=
b;d.setMap(this.map);d.setLayerInfosObj(this.layerInfosObj);d.setAppConfig(this.appConfig);this._upgradeConfig().then(B.hitch(this,function(){g(d.getConfigInfo(this.config.searchOptions)).then(B.hitch(this,function(e){this.domNode&&(this.setConfig(e),this.shelter.hide())}))}))}))},setConfig:function(b){q.forEach(b.sources,B.hitch(this,function(e,v){var F=this.sourceList.addRow({name:e.name||"",type:e.type});F&&F.success?(this._setRelatedConfig(F.tr,e),0===v&&setTimeout(B.hitch(this,function(){this.sourceList.selectRow(F.tr)}),
100)):console.error("add row failed ",F)}))},getConfig:function(b){this._currentSourceSetting&&this._closeSourceSetting(!0===b?!0:!1);var e={},v=this.sourceList.getRows(),F=[];q.forEach(v,B.hitch(this,function(K){var I=this._getRelatedConfig(K);b&&(delete I._definition,this._removeRelatedConfig(K));F.push(I)}));e.sources=F;return e},destroy:function(){d.setMap(null);d.setLayerInfosObj(null);d.setAppConfig(null);this.inherited(arguments)},validate:function(){return!0},_onMenuItemClick:function(b){this._currentSourceSetting&&
!this._currentSourceSetting.isValidConfig()?this._currentSourceSetting.showValidationTip():(b=b&&b.target&&J.getAttr(b.target,"type"),"locator"===b?this._addNewLocator():"query"===b&&this._addNewQuerySource())},_addNewLocator:function(){this._createNewLocatorSourceSettingFromMenuItem({},{})},_addNewQuerySource:function(){this._createNewQuerySourceSettingFromMenuItem({},{})},_setRelatedConfig:function(b,e){G(b).data("config",B.clone(e))},_getRelatedConfig:function(b){return G(b).data("config")[0]},
_removeRelatedConfig:function(b){return G(b).removeData("config")},_createNewLocatorSourceSettingFromMenuItem:function(b,e){var v=new x({nls:this.nls,map:this.map});v.setDefinition(e);b={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,
minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);v.setConfig(b);v._openLocatorChooser();v.own(C(v,"select-locator-url-ok",B.hitch(this,function(F){(F=this.sourceList.addRow({name:F.name||"New Geocoder",type:"locator"},this.sourceList.getRows().length))&&F.success&&(this._currentSourceSetting&&this._closeSourceSetting(),v.setRelatedTr(F.tr),v.placeAt(this.sourceSettingNode),this.sourceList.selectRow(F.tr),this._currentSourceSetting=v,this._checkConfig())})));v.own(C(v,
"reselect-locator-url-ok",B.hitch(this,function(F){var K=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(K,{name:F.name,type:"locator"});this._checkConfig()})));v.own(C(v,"select-locator-url-cancel",B.hitch(this,function(){this._currentSourceSetting!==v&&(v.destroy(),v=null)})))},_createNewLocatorSourceSettingFromSourceList:function(b,e,v){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new x({nls:this.nls,map:this.map});this._currentSourceSetting.setDefinition(e);
e={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,enableLocalSearch:!!b.enableLocalSearch,localSearchMinScale:b.localSearchMinScale,localSearchDistance:b.localSearchDistance,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};
this._upgradeGeocoderConfig(e);this._currentSourceSetting.setConfig(e);this._currentSourceSetting.setRelatedTr(v);this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting._processlocalSearchTable(!!b.enableLocalSearch);this._currentSourceSetting.own(C(this._currentSourceSetting,"reselect-locator-url-ok",B.hitch(this,function(F){var K=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(K,{name:F.name,type:"locator"});this._checkConfig()})))},_closeSourceSetting:function(b){var e=
this._currentSourceSetting.getRelatedTr(),v=this._currentSourceSetting.getConfig();v._definition=this._currentSourceSetting.getDefinition();this._setRelatedConfig(e,v);this.sourceList.editRow(e,{name:v.name});"undefined"!==typeof b&&!0!==b||this._currentSourceSetting.destroy()},_createNewQuerySourceSettingFromMenuItem:function(b,e){var v=new c({nls:this.nls,map:this.map,appConfig:this.appConfig});v.setDefinition(e);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||
[],displayField:b.displayField||e.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);v.setConfig(b);v._openQuerySourceChooser();v.own(C(v,"select-query-source-ok",B.hitch(this,function(F){(F=this.sourceList.addRow({name:F.name,type:"query"},0))&&
F.success&&(this._currentSourceSetting&&this._closeSourceSetting(),v.setRelatedTr(F.tr),v.placeAt(this.sourceSettingNode),this.sourceList.selectRow(F.tr),this._currentSourceSetting=v)})));v.own(C(v,"reselect-query-source-ok",B.hitch(this,function(F){var K=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(K,{name:F.name})})));v.own(C(v,"select-query-source-cancel",B.hitch(this,function(){this._currentSourceSetting!==v&&(v.destroy(),v=null)})))},_createNewQuerySourceSettingFromSourceList:function(b,
e,v){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new c({nls:this.nls,map:this.map,appConfig:this.appConfig});this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting.setDefinition(e);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||[],displayField:b.displayField||e.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,
type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);this._currentSourceSetting.setConfig(b);this._currentSourceSetting.setRelatedTr(v);this._currentSourceSetting.own(C(this._currentSourceSetting,"reselect-query-source",B.hitch(this,function(F){var K=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(K,{name:F.name})})))},_onSourceItemRemoved:function(b){this._checkConfig();
this._currentSourceSetting&&this._currentSourceSetting.getRelatedTr()===b&&(this._currentSourceSetting.destroy(),this._currentSourceSetting=null)},_onSourceItemChanged:function(){this._checkConfig()},_checkConfig:function(){!1===this._hasGeoLocator()?this.emit("isConfigValid","false"):this.emit("isConfigValid","true")},_hasGeoLocator:function(){var b=!1,e=this.sourceList.getData();q.some(e,B.hitch(this,function(v){if(v&&"locator"===v.type)return b=!0}));return b},_onSourceItemSelected:function(b){var e=
this._getRelatedConfig(b),v=this._currentSourceSetting&&this._currentSourceSetting.tr;e&&b!==v&&(this._currentSourceSetting&&!this._currentSourceSetting.isValidConfig()?(this._currentSourceSetting.showValidationTip(),this.sourceList.selectRow(v)):"query"===e.type?this._createNewQuerySourceSettingFromSourceList(e,e._definition||{},b):"locator"===e.type&&this._createNewLocatorSourceSettingFromSourceList(e,e._definition||{},b))},_upgradeConfig:function(){var b=new f,e=[],v="";if(d.version.isConfigBefore63(this.config)&&
(e=this.config.geocoderOptions&&this.config.geocoderOptions.geocoders)&&0<e.length){var F=e[0];F&&F.url&&(v=F.url)}v?d.getSingleLineAddressName(v).then(B.hitch(this,function(K){if(K){var I=[];I.push({type:"locator",url:v,name:d.getGeocoderName(v),placeholder:F.placeholder||"",singleLineFieldName:K});this.config.searchOptions={};this.config.searchOptions.sources=I;b.resolve()}else null===K&&(b.resolve(null),new E({message:this.nls.locatorWarning}))}),B.hitch(this,function(){b.resolve(null)})):b.resolve(null);
return b},_upgradeGeocoderConfig:function(b){this.config.geocoderOptions&&(b._oldConfig={},this.config.geocoderOptions.geocoders[0]&&(b._oldConfig.placeholder=this.config.geocoderOptions.geocoders[0].placeholder||""),b._oldConfig.autoComplete=this.config.geocoderOptions.autoComplete,b._oldConfig.maxLocations=this.config.geocoderOptions.maxLocations,b._oldConfig.minCharacters=this.config.geocoderOptions.minCharacters,b._oldConfig.searchDelay=this.config.geocoderOptions.searchDelay)}})})},"widgets/Directions/setting/SearchConfig/QuerySourceSetting":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./QuerySourceSetting.html dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented jimu/dijit/_FeaturelayerSourcePopup jimu/portalUrlUtils esri/request esri/lang jimu/utils jimu/dijit/Popup jimu/dijit/CheckBox jimu/dijit/LoadingShelter dijit/form/ValidationTextBox dojo/NodeList-data".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E){return H([C,J,G,c],{baseClass:"jimu-widget-search-query-source-setting",templateString:q,nls:null,appConfig:null,map:null,tr:null,config:null,fieldsPopup:null,_layerDefinition:null,_fieldsCheckBox:null,_layerId:null,_suggestible:!1,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exactMatch=new E({checked:!1,label:this.nls.exactMatch},this.exactMatch);this.searchInCurrentMapExtent=new E({checked:!1,label:this.nls.searchInCurrentMapExtent},
this.searchInCurrentMapExtent);this._layerDefinition={};this._fieldsCheckBox=[];this._setMessageNodeContent("");this.autoComplete=new E({checked:!1,label:this.nls.autoComplete},this.autoComplete)},setDefinition:function(k){this._layerDefinition=k||{}},getDefinition:function(){return this._layerDefinition},setRelatedTr:function(k){this.tr=k},getRelatedTr:function(){return this.tr},setConfig:function(k){if("[object Object]"===Object.prototype.toString.call(k)){var b=k.url;b&&(this.config=k,this.shelter.show(),
this._layerDefinition.url!==b?this._getDefinitionFromRemote(b).then(p.hitch(this,function(e){b&&e&&"error"!==e.type?(this._layerDefinition=e,this._layerDefinition.url=b,this._setSourceItems(),this._setMessageNodeContent("")):b&&e&&"error"===e.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(f.substitute({URL:e.url},p.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setMessageNodeContent(""),this._setSourceItems(),this.shelter.hide()))}},isValidConfig:function(){var k=
this.getConfig();return k.url&&k.name&&k.displayField?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.sourceUrl);this._showValidationErrorTip(this.sourceName)},getConfig:function(){var k={layerId:this._layerId,url:this.sourceUrl.get("value"),name:d.stripHTML(this.sourceName.get("value")),placeholder:d.stripHTML(this.placeholder.get("value")),searchFields:this._getSearchFields(),displayField:this.displayField.get("value"),exactMatch:this.exactMatch.getValue(),searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
maxSuggestions:this.maxSuggestions.get("value")||6,type:"query",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(k._isUpgrade=!0);return k},destroy:function(){this.inherited(arguments);this.fieldsPopup&&(this.fieldsPopup.close(),this.fieldsPopup=null);this.tr=this.nls=this.config=this._layerDefinition=null},_onSourceNameBlur:function(){this.sourceName.set("value",
d.stripHTML(this.sourceName.get("value")))},_onPlaceholderBlur:function(){this.placeholder.set("value",d.stripHTML(this.placeholder.get("value")))},_disableSourceItems:function(){this.sourceName.set("disabled",!0);this.placeholder.set("disabled",!0);this.searchFields.set("disabled",!0);B.setStyle(this.fieldsSelectorNode,"display","none");this.displayField.set("disabled",!0);this.maxSuggestions.set("disabled",!0);this.autoComplete.set("disabled",!0);this.searchDelay.set("disabled",!0);this.minCharacters.set("disabled",
!0)},_enableSourceItems:function(){this.sourceName.set("disabled",!1);this.placeholder.set("disabled",!1);this.searchFields.set("disabled",!1);B.setStyle(this.fieldsSelectorNode,"display","inline-block");this.displayField.set("disabled",!1);this.maxSuggestions.set("disabled",!1);this.autoComplete.set("disabled",!1);this.searchDelay.set("disabled",!1);this.minCharacters.set("disabled",!1)},_setSourceItems:function(){this.sourceUrl.set("value",this.config.url);this.sourceName.set("value",d.stripHTML(this.config.name||
""));this.placeholder.set("value",d.stripHTML(this.config.placeholder||""));this.maxSuggestions.set("value",this.config.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:!0);this.searchDelay.set("value",this.config.searchDelay||350);this.minCharacters.set("value",this.config.minCharacters||3);this.config._oldConfig&&!this.config._isUpgrade&&(this.config._oldConfig.placeholder&&this.placeholder.set("value",d.stripHTML(this.config._oldConfig.placeholder)),
this.config._oldConfig.maxLocations&&this.maxSuggestions.set("value",this.config._oldConfig.maxLocations),this.config._oldConfig.autoComplete&&this.autoComplete.setValue(this.config._oldConfig.autoComplete),this.config._oldConfig.searchDelay&&this.searchDelay.set("value",this.config._oldConfig.searchDelay),this.config._oldConfig.minCharacters&&this.minCharacters.set("value",this.config._oldConfig.minCharacters),this.config._isUpgrade=!0);this._setSearchFields2Node();this.searchFields.set("value",
this._getSearchFieldsAlias());this._setDisplayFieldOptions();this.displayField.set("value",this.config.displayField||"");this.exactMatch.setValue(!!this.config.exactMatch);this.searchInCurrentMapExtent.setValue(!!this.config.searchInCurrentMapExtent);this._layerId=this.config.layerId;(this._suggestible=this._layerDefinition&&this._layerDefinition.advancedQueryCapabilities&&this._layerDefinition.advancedQueryCapabilities.supportsPagination)?this._hideSuggestibleTips():this._showSuggestibleTips();this._enableSourceItems()},
_getDefinitionFromRemote:function(k){var b=new w,e=u({url:k,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(e);e.then(p.hitch(this,function(v){b.resolve(v)}),p.hitch(this,function(v){console.error(v);b.resolve({type:"error",url:this._getRequestUrl(k)})}));return b.promise},_setMessageNodeContent:function(k,b){B.empty(this.messageNode);k.nodeType||(k=B.toDom(k));B.place(k,this.messageNode);b?B.setStyle(this.messageTr,"display",""):B.setStyle(this.messageTr,"display","none")},
_getRequestUrl:function(k){var b=window.location.protocol;return"http:"===b?y.setHttpProtocol(k):"https:"===b?y.setHttpsProtocol(k):k},_setSearchFields2Node:function(){var k=null,b=this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length;this.config&&this.config.searchFields&&0<this.config.searchFields.length||(k=[]);if(b){var e=this._layerDefinition.fields;k=l.filter(this.config.searchFields,function(v){return l.some(e,function(F){return F.name===v})})}else k=this.config.searchFields;
this.searchFields.set("_fields",k)},_setDisplayFieldOptions:function(){var k=[];this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length?k=l.map(this._layerDefinition.fields,function(b){return{label:b.alias||b.name||"",value:b.name||""}}):this.config&&this.config.displayField&&(k=[{label:this.config.displayField,value:this.config.displayField}]);this.displayField.set("options",k)},_getSearchFieldsAlias:function(){var k=this._getSearchFields();if(!(k&&0<k.length))return"";
if(this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length){for(var b=this._layerDefinition.fields,e=l.map(b,function(L){return L&&L.name}),v=[],F=0,K=k.length;F<K;F++){var I=e.indexOf(k[F]);-1<I&&v.push(b[I].alias)}return v.join(",")}return k.join(",")},_getSearchFields:function(){return this.searchFields.get("_fields")},_setSearchFields:function(k){this.searchFields.set("_fields",k)},_onSetSourceClick:function(){this._clickSet=!0;this._openServiceChooser()},_openQuerySourceChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){var k=new x({titleLabel:this.nls.setLayerSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});t.once(k,"ok",p.hitch(this,function(b){k.close();this.setDefinition(b.definition||{});this.setConfig({layerId:b.layerInfo&&b.layerInfo.id||null,url:b.url,name:b.name||"",placeholder:"",searchFields:[],displayField:this._layerDefinition.displayField||"",exactMatch:!1,
maxSuggestions:6,type:"query"});k=null;this._setMessageNodeContent("");this._clickSet?this.emit("reselect-query-source-ok",b):this.emit("select-query-source-ok",b)}));t.once(k,"cancel",p.hitch(this,function(){k.close();k=null;this.emit("select-query-source-cancel")}))},_onFieldsSelectorClick:function(){var k=B.create("div",{style:{maxHeight:"480px"}}),b=this._layerDefinition.fields;this._fieldsCheckBox=[];l.forEach(b,p.hitch(this,function(e,v){var F=new E({checked:this._isSearchable(e),label:e.alias||
e.name});B.addClass(F.domNode,"fields-checkbox");B.addClass(F.labelNode,"jimu-ellipsis");B.setAttr(F.domNode,{title:e.alias||e.name});0===v%3&&(window.isRTL?B.setStyle(F.domNode,"marginRight",0):B.setStyle(F.domNode,"marginLeft",0));F.placeAt(k);z(F.domNode).data("fieldName",e.name);this._fieldsCheckBox.push(F)}));this.fieldsPopup=new g({titleLabel:this.nls.setSearchFields,autoHeight:!0,content:k,container:window.jimuConfig.layoutId,width:640,maxHeight:600,buttons:[{label:this.nls.ok,onClick:p.hitch(this,
"_onSearchFieldsOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}],onClose:p.hitch(this,function(){this.fieldsPopup=null})});B.addClass(this.fieldsPopup.domNode,"direction-setting jimu-widget-search-query-source-setting-fields")},_onSearchFieldsOk:function(){var k=[];l.forEach(this._fieldsCheckBox,function(b){if(b.getValue()){var e=z(b.domNode).data("fieldName");k.push(e[0]);z(b.domNode).removeData()}});this._setSearchFields(k);this.searchFields.set("value",this._getSearchFieldsAlias());
this.fieldsPopup.close()},_isSearchable:function(k){var b=this._getSearchFields();return l.some(b,p.hitch(this,function(e){return k.name===e}))},_showSuggestibleTips:function(){B.addClass(this.tipsNode,"source-tips-show");B.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){B.removeClass(this.tipsNode,"source-tips-show");B.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(k){if(!k.validate()&&k.domNode&&k.focusNode){var b=
k.get("disabled");b&&k.set("disabled",!1);k.focusNode.focus();setTimeout(p.hitch(this,function(){k.focusNode.blur();b&&k.set("disabled",!0);k=null}),100)}}})})},"jimu/dijit/_FeaturelayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/FeaturelayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(H,B,C,J,G,q,p,l,t){return H([q,B],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);
G.addClass(this.domNode,"jimu-featurelayer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.fls.getSelectedRadioType()},_initFls:function(){this.fls=new p(this.dijitArgs);this.fls.placeAt(this.contentContainerNode);this.fls.startup();this.own(C(this.fls,"ok",J.hitch(this,function(z){if(0!==z.length){var w=z[0];if(w.definition)try{w.definition.name=w.name,w.definition.url=w.url,this.emit("ok",w)}catch(c){console.error(c)}else this.loading.show(),t({url:w.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(J.hitch(this,function(c){if(this.domNode){this.loading.hide();w.definition=c;try{w.definition.name=w.name,w.definition.url=w.url,this.emit("ok",w)}catch(x){console.error(x)}}}),J.hitch(this,function(c){console.error(c);this.domNode&&this.loading.hide()}))}})));this.own(C(this.fls,"cancel",J.hitch(this,function(){try{this.emit("cancel")}catch(z){console.error(z)}})))},_initLoading:function(){this.loading=new l({hidden:!0});this.loading.placeAt(this.domNode);
this.loading.startup()}})})},"jimu/dijit/FeaturelayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/RadioBtn jimu/dijit/_FeaturelayerChooserWithButtons jimu/dijit/FeaturelayerChooserFromPortal jimu/dijit/_FeaturelayerServiceChooserContent jimu/portalUrlUtils".split(" "),function(H,B,C,J,G,q,p,l,t,z,w,c,x,y){return H([B,C,
J,t],{templateString:G,baseClass:"jimu-layer-source jimu-featurelayer-source",declaredClass:"jimu.dijit.FeaturelayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,layerChooserFromMap:null,postMixInProperties:function(){this.nls=window.jimuNls.featureLayerSource;this.portalUrl=y.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";if(this.portalRadio.checked)return"portal";
if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var u=[];this.mapRadio.checked?u=this.flcMap.getSelectedItems():this.portalRadio.checked?u=this.flcPortal.getSelectedItems():this.urlRadio.checked&&(u=this.flcUrl.getSelectedItems());return u},startup:function(){this.inherited(arguments);this.flcMap.startup();this.flcPortal.startup();this.flcUrl.startup()},_initSelf:function(){this._initRadios();this._createFeaturelayerChooserWithButtons();this._createFeaturelayerChooserFromPortal();
this._createFeaturelayerServiceChooserContent();this._onRadioClicked()},_createFeaturelayerChooserWithButtons:function(){this.flcMap=new w({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,onlyShowWebMapLayers:!0,layerChooserFromMap:this.layerChooserFromMap});this.flcMap.operationTip=this.nls.selectLayer;this.flcMap.placeAt(this.flcContainer);this.own(l(this.flcMap,"ok",q.hitch(this,function(u){u&&0<u.length&&this.emit("ok",u)})));this.own(l(this.flcMap,
"cancel",q.hitch(this,function(){this.emit("cancel")})))},_createFeaturelayerChooserFromPortal:function(){this.flcPortal=new c({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.flcPortal.operationTip=this.nls.chooseItem;this.flcPortal.placeAt(this.hflcContainer);this.own(l(this.flcPortal,"next",q.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(l(this.flcPortal,"back",
q.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(l(this.flcPortal,"ok",q.hitch(this,function(u){u&&0<u.length&&this.emit("ok",u)})));this.own(l(this.flcPortal,"cancel",q.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createFeaturelayerServiceChooserContent:function(){this.flcUrl=
new x({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.flcUrl.operationTip=this.nls.setServiceUrl;this.flcUrl.placeAt(this.flscContainer);this.own(l(this.flcUrl,"ok",q.hitch(this,function(u){u&&0<u.length&&this.emit("ok",u)})));this.own(l(this.flcUrl,"cancel",q.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var u="featureLayerSourceRadios_"+this._getRandomString(),f=q.hitch(this,this._onRadioClicked);this.mapRadio=new z({group:u,onStateChange:f,checked:!0});
this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new z({group:u,onStateChange:f,checked:!1});this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new z({group:u,onStateChange:f,checked:!1});this.urlRadio.placeAt(this.urlTd,"first");this.own(l(this.mapLabel,"click",q.hitch(this,function(){this.mapRadio.check()})));this.own(l(this.portalLabel,"click",q.hitch(this,function(){this.portalRadio.check()})));this.own(l(this.urlLabel,"click",q.hitch(this,function(){this.urlRadio.check()})))},
_getRandomString:function(){var u=Math.random().toString();return u=u.slice(2,u.length)},_onRadioClicked:function(){p.setStyle(this.flcContainer,"display","none");p.setStyle(this.hflcContainer,"display","none");p.setStyle(this.flscContainer,"display","none");this.mapRadio.checked?(p.setStyle(this.flcContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(p.setStyle(this.hflcContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):
this.urlRadio.checked&&(p.setStyle(this.flscContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.flcMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.flcPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.flcUrl.operationTip)}})})},"jimu/dijit/_FeaturelayerChooserWithButtons":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/FeaturelayerChooserFromMap".split(" "),
function(H,B,C,J,G,q,p,l,t){return G([q,p,l,B],{baseClass:"jimu-layer-chooser-with-buttons jimu-feature-layer-chooser-with-buttons",declaredClass:"jimu.dijit.FeaturelayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
layerChooserFromMap:null,constructor:function(z){this.options=z},postMixInProperties:function(){this.nls=C.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.layerChooser=this.layerChooserFromMap?this.layerChooserFromMap:new t(this.options);this.layerChooser.placeAt(this.chooserContainer);J.setStyle(this.layerChooser.domNode,{width:"100%",height:"100%"});this.own(H(this.layerChooser,"tree-click",C.hitch(this,function(){0<this.getSelectedItems().length?J.removeClass(this.btnOk,
"jimu-state-disabled"):J.addClass(this.btnOk,"jimu-state-disabled")})));this.own(H(this.btnOk,"click",C.hitch(this,function(){var z=this.getSelectedItems();0<z.length&&this.emit("ok",z)})));this.own(H(this.btnCancel,"click",C.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.layerChooser.getSelectedItems()},startup:function(){this.inherited(arguments);this.layerChooser.startup()}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare",
"dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(H,B,C,J,G){return H([G],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=J.hitch(this,
this.basicFilter);this.filter=G.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=G.andCombineFilters([this.filter,J.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);C.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(q){return q.getLayerType().then(function(p){return!("ArcGISDynamicMapServiceLayer"===p||"ArcGISTiledMapServiceLayer"===
p||"GroupLayer"===p)})},basicFilter:function(q){var p=new B;0<=this.ignoredFeaturelayerIds.indexOf(q.id)?p.resolve(!1):this.onlyShowVisible&&"Table"!==q.getLayerType()?p.resolve(q.isShowInMap()):p.resolve(!0);return p},getHandledItem:function(q){var p=this.inherited(arguments),l=q&&q.layerInfo;l=l&&l.layerObject;p.url=l&&l.url||"";return p}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g){var E=C([J,G,q,B],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);x.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new g({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=c.hitch(this,this.basicFilter);
this.filter=E.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(k){var b=new l;this.onlyShowVisible?b.resolve(k.isShowInMap()):b.resolve(!0);return b},filter:function(k){k=new l;k.resolve(!0);return k},getSelectedItems:function(){var k=this.tree.getSelectedItems();return y.map(k,c.hitch(this,function(b){return this.getHandledItem(b)}))},getAllItems:function(){var k=this.tree.getAllItems(),b=[];y.forEach(k,
c.hitch(this,function(e){"root"!==e.id&&(e=this.getHandledItem(e),b.push(e))}));return b},getHandledItem:function(k){return{name:k.name,layerInfo:k.layerInfo}},_isLeafItem:function(k){return k.isLeaf},setCreateMapResponse:function(k){this.createMapResponse=k;d.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(c.hitch(this,function(b){this.layerInfosObj=b;this.own(H(this.layerInfosObj,"layerInfosChanged",c.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(H(this.layerInfosObj,"layerInfosIsShowInMapChanged",c.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(k,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(k){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(k){this._clear();x.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=k.getLayerInfoArrayOfWebmap(),
b=b.concat(k.getTableInfoArrayOfWebmap())):(b=k.getLayerInfoArray(),b=b.concat(k.getTableInfoArray()));0!==b.length&&(x.setStyle(this.errorTipSection,"display","none"),y.forEach(b,c.hitch(this,function(e){this._addDirectLayerInfo(e)})))},_addDirectLayerInfo:function(k){k&&k.getLayerObject().then(c.hitch(this,function(){this._addItem("root",k)}),c.hitch(this,function(b){console.error(b)}))},_clear:function(){var k=this._store.query({parent:"root"});y.forEach(k,c.hitch(this,function(b){b&&"root"!==
b.id&&this._store.remove(b.id)}))},_addItem:function(k,b){var e=null,v=b.getLayerType(),F=this.filter(b);w({layerType:v,valid:F}).then(c.hitch(this,function(K){if(K.valid){var I=c.hitch(this,function(W,fa){this._id++;e={name:b.title||"",parent:k,layerInfo:b,type:K.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:W,hasChildren:fa};this._store.add(e)}),L=b.getSubLayers(),S=0===L.length,Z=!0;this.onlyFilterCurrentLayerWhenAddItem?(S&&(Z=!1),I(S,Z)):S?I(S,!1):(L=y.map(L,
c.hitch(this,function(W){return this.filter(W)})),w(L).then(c.hitch(this,function(W){(W=y.some(W,function(fa){return fa}))&&I(S,W)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var k=this._getRootItem();k=new p({data:[k],getChildren:function(b){return this.query({parent:b.id})}});this._store=new t(k);k=new z({store:this._store,query:{id:"root"},mayHaveChildren:c.hitch(this,this._mayHaveChildren)});this.tree=new f({multiple:this.multiple,
model:k,showRoot:!1,isLeafItem:c.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:c.hitch(this,function(b,e){"root"!==b.id&&this._onTreeOpen(b,e)}),onClick:c.hitch(this,function(b,e,v){this._onTreeClick(b,e,v);this.emit("tree-click",b,e,v)}),getIconStyle:c.hitch(this,function(b,e){var v=null;if(!b||"root"===b.id)return null;var F={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},K=window.location.protocol+"//"+window.location.host+
require.toUrl("jimu");if(b=this._getIconInfo(b,e).imageName)F.backgroundImage="url("+K+"/css/images/"+b+")",v=F;return v}),getIconClass:c.hitch(this,function(b,e){return this._getIconInfo(b,e).className}),getTooltip:c.hitch(this,function(b){return this.displayTooltipForTreeNode?b.layerInfo.title:""})});x.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(k){return k.hasChildren},_getIconInfo:function(k,b){var e="",v="";"ArcGISDynamicMapServiceLayer"===
k.type||"ArcGISTiledMapServiceLayer"===k.type?b?(e="mapserver_open.png",v="mapservice-layer-icon open"):(e="mapserver_close.png",v="mapservice-layer-icon close"):"GroupLayer"===k.type?b?(e="group_layer2.png",v="group-layer-icon open"):(e="group_layer1.png",v="group-layer-icon close"):"FeatureLayer"===k.type?(k=u.getTypeByGeometryType(k.layerInfo.layerObject.geometryType),"point"===k?(e="point_layer1.png",v="point-layer-icon"):"polyline"===k?(e="line_layer1.png",v="line-layer-icon"):"polygon"===k&&
(e="polygon_layer1.png",v="polygon-layer-icon")):"Table"===k.type?(e="table.png",v="table-icon"):"ArcGISImageServiceLayer"===k.type||"ArcGISImageServiceVectorLayer"===k.type?(e="image_layer.png",v="iamge-layer-icon"):b?(e="mapserver_open.png",v="mapservice-layer-icon open"):(e="mapserver_close.png",v="mapservice-layer-icon close");return{imageName:e,className:v}},_onTreeOpen:function(k,b){if("root"!==k.id){var e=[];b=[];e=k.layerInfo.getSubLayers();k.checked||(this.shelter.show(),b=y.map(e,c.hitch(this,
function(v){return v.getLayerObject()})),w(b).then(c.hitch(this,function(){this.domNode&&(y.forEach(e,c.hitch(this,function(v){this._addItem(k.id,v)})),k.checked=!0,this.shelter.hide())}),c.hitch(this,function(v){console.error(v);this.shelter.hide()})))}},_onTreeClick:function(k,b,e){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});E.createFilterByLayerType=function(k){c.isArrayLike(k)||(k=[]);return function(b){var e=
new l;if(0===k.length)e.resolve(!0);else{var v=[];b.traversal(function(F){v.push(F.getLayerType())});w(v).then(function(F){for(var K=0;K<F.length;K++)for(var I=0;I<k.length;I++)if(F[K]===k[I]){e.resolve(!0);return}e.resolve(!1)},function(F){console.error(F);e.reject(F)})}return e}};E.createFeaturelayerFilter=function(k,b,e,v){var F=["point","polyline","polygon"];k&&0<k.length?(k=y.filter(k,function(K){return 0<=F.indexOf(K)}),0===k.length&&(k=F)):k=F;return function(K){var I=K.getLayerType();K=K.getLayerObject();
return w({layerType:I,layerObject:K}).then(function(L){var S=L.layerType;L=L.layerObject;if("ArcGISDynamicMapServiceLayer"===S||"ArcGISTiledMapServiceLayer"===S||"GroupLayer"===S||"FeatureCollection"===S)return!0;if("FeatureLayer"===S){S=u.getTypeByGeometryType(L.geometryType);S=0<=y.indexOf(k,S);var Z=E._shouldPassStatisticsCheck(v,L);return L.url?(L=u.isFeaturelayerUrlSupportQuery(L.url,L.capabilities),S&&L&&Z):b&&S}return"Table"===S?(S=u.isFeaturelayerUrlSupportQuery(L.url,L.capabilities),L=E._shouldPassStatisticsCheck(v,
L),e&&S&&L):!1})}};E.createImageServiceLayerFilter=function(k,b){return function(e){var v=e.getLayerType();e=e.getLayerObject();return w({layerType:v,layerObject:e}).then(function(F){var K=F.layerType,I=F.layerObject;return"ArcGISImageServiceLayer"===K||"ArcGISImageServiceVectorLayer"===K?k?u.isImageServiceSupportQuery(F.layerObject.capabilities)?b?E._shouldPassStatisticsCheck(b,I):!0:!1:!0:!1})}};E._shouldPassStatisticsCheck=function(k,b){return k?(k=!1,k=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:
!!b.supportsStatistics):!0};E.createQueryableLayerFilter=function(k){var b=E.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,k);k=E.createImageServiceLayerFilter(!0,k);return E.orCombineFilters([b,k])};E.andCombineFilters=function(k){return E._combineFilters(k,!0)};E.orCombineFilters=function(k){return E._combineFilters(k,!1)};E._combineFilters=function(k,b){return function(e){var v=new l,F=y.map(k,function(K){return K(e)});w(F).then(function(K){var I=!1;I=b?y.every(K,function(L){return L}):
y.some(K,function(L){return L});v.resolve(I)},function(K){console.error(K);v.reject(K)});return v}};return E})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(H,B,C,J,G,q,p){return C("dijit.tree.ObjectStoreModel",p,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(l){G.mixin(this,l);this.childrenCache={}},getRoot:function(l,t){if(this.root)l(this.root);
else{var z=this.store.query(this.query);z.then&&this.own(z);q(z,G.hitch(this,function(w){if(1!=w.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+w.length+" items, but must return exactly one");this.root=w[0];l(this.root);z.observe&&z.observe(G.hitch(this,function(c){this.onChange(c)}),!0)}),t)}},mayHaveChildren:function(){return!0},getChildren:function(l,t,z){var w=this.store.getIdentity(l);if(this.childrenCache[w])q(this.childrenCache[w],t,z);else{var c=this.childrenCache[w]=
this.store.getChildren(l);c.then&&this.own(c);c.observe&&this.own(c.observe(G.hitch(this,function(x,y,u){this.onChange(x);y!=u&&q(c,G.hitch(this,"onChildrenChange",l))}),!0));q(c,t,z)}},isItem:function(){return!0},getIdentity:function(l){return this.store.getIdentity(l)},getLabel:function(l){return l[this.labelAttr]},newItem:function(l,t,z,w){return this.store.put(l,{parent:t,before:w})},pasteItem:function(l,t,z,w,c,x){var y=new J;if(t===z&&!w&&!x)return y.resolve(!0),y;t&&!w?this.getChildren(t,G.hitch(this,
function(u){u=[].concat(u);var f=H.indexOf(u,l);u.splice(f,1);this.onChildrenChange(t,u);y.resolve(this.store.put(l,{overwrite:!0,parent:z,oldParent:t,before:x,isCopy:!1}))})):y.resolve(this.store.put(l,{overwrite:!0,parent:z,oldParent:t,before:x,isCopy:!0}));return y},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f){var d=H([u._TreeNode,x],{templateString:J,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=q.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=q.toDom('\x3cinput type\x3d"checkbox" /\x3e');q.addClass(this.checkNode,"jimu-tree-check-node");q.place(this.checkNode,this.contentNode,
"first");this.own(w(this.checkNode,"click",G.hitch(this,this._onClick)));this.own(w(this.rowNode,"keydown",G.hitch(this,function(g,E){E.target=g;E.keyCode!==c.ENTER&&E.keyCode!==c.SPACE||this._onClick(E)},this.checkNode)));this.isLeaf?this.groupId?q.setStyle(this.checkNode,"display","none"):q.setStyle(this.checkNode,"display","inline"):q.setStyle(this.checkNode,"display","none");this.isLeaf?q.addClass(this.domNode,"jimu-tree-leaf-node"):q.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,q.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,q.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(g){(g.target||g.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,g):this.tree._onClick(this,g)},_onChange:function(){this.isLeaf&&setTimeout(G.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return H([u,x],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+f.getRandomString()},postCreate:function(){this.inherited(arguments);q.addClass(this.domNode,"jimu-tree");this.own(z.before(this,"onClick",G.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&q.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;q.setAttr(this.domNode,"tabindex",0)},removeItem:function(g){this.model.store.remove(g)},getAllItems:function(){var g=this.getAllTreeNodeWidgets();return p.map(g,G.hitch(this,function(E){var k=E.item;k.selected=E.checkNode.checked;return k}))},getSelectedItems:function(){var g=this.getAllTreeNodeWidgets();g=p.filter(g,G.hitch(this,function(E){return E.checkNode.checked}));return p.map(g,
G.hitch(this,function(E){return E.item}))},getFilteredItems:function(g){var E=this.getAllTreeNodeWidgets();E=p.map(E,G.hitch(this,function(k){var b=k.item;b.selected=k.checkNode.checked;return b}));return p.filter(E,G.hitch(this,function(k){return g(k)}))},getTreeNodeByItemId:function(g){for(var E=this._getAllTreeNodeDoms(),k=0;k<E.length;k++){var b=y.byNode(E[k]);if(b.item.id.toString()===g.toString())return b}return null},selectItem:function(g){(g=this.getTreeNodeByItemId(g))&&g.isLeaf&&this.selectNodeWidget(g)},
unselectItem:function(g){(g=this.getTreeNodeByItemId(g))&&g.isLeaf&&g.unselect()},getAllLeafTreeNodeWidgets:function(){var g=this.getAllTreeNodeWidgets();return p.filter(g,G.hitch(this,function(E){return E.isLeaf}))},getAllTreeNodeWidgets:function(){var g=this._getAllTreeNodeDoms();return p.map(g,G.hitch(this,function(E){return y.byNode(E)}))},isLeafItem:function(g){return g&&g.isLeaf},_getAllTreeNodeDoms:function(){return t(".dijitTreeNode",this.domNode)},_createTreeNode:function(g){g.isLeaf=this.isLeafItem(g.item);
this.multiple||(g.groupId=this.uniqueId);return new d(g)},_onTreeNodeSelect:function(g){this.emit("item-select",{item:g.item,treeNode:g})},_onTreeNodeUnselect:function(g){this.emit("item-unselect",{item:g.item,treeNode:g})},selectNodeWidget:function(g){this.multiple||this.unselectAllLeafNodeWidgets();g.select()},_jimuBeforeClick:function(g,E,k){E.isLeaf&&(q.hasClass(k.target||k.srcElement,"jimu-tree-check-node")||(this.multiple?E.toggleSelect():this.selectNodeWidget(E)));return arguments},_onCheckNodeClick:function(g,
E,k){!this.multiple&&E&&this.unselectAllLeafNodeWidgets();l.stop(k);this.focusNode(g);setTimeout(G.hitch(this,function(){E?this.selectNodeWidget(g):g.unselect();this.onClick(g.item,g,k)}),0)},unselectAllLeafNodeWidgets:function(){var g=this.getAllLeafTreeNodeWidgets();p.forEach(g,G.hitch(this,function(E){E.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E,k,b,e,v,F,K,I,L,S,Z,W,fa,ma,la,na,oa){function ca(n){return f.delegate(n.promise||n,{addCallback:function(A){this.then(A)},addErrback:function(A){this.otherwise(A)}})}var ja=J("dijit._TreeNode",[K,I,L,S,Z],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(n){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=n;this._set("label",n);x("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:fa,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(n){var A=Math.max(n,0)*this.tree._nodePixelIndent+"px";z.set(this.domNode,
"backgroundPosition",A+" 0px");z.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",A);H.forEach(this.getChildren(),function(N){N.set("indent",n+1)});this._set("indent",n)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(n){var A=this.tree,N=A.model;A._v10Compat&&n===N.root&&(n=null);this._applyClassAndStyle(n,"icon","Icon");this._applyClassAndStyle(n,"label","Label");this._applyClassAndStyle(n,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(n,A,N){var P="_"+A+"Class";A+="Node";var U=this[P];this[P]=this.tree["get"+N+"Class"](n,this.isExpanded);l.replace(this[A],this[P]||"",U||"");z.set(this[A],this.tree["get"+N+"Style"](n,this.isExpanded)||{})},_updateLayout:function(){var n=this.getParent();n=!n||!n.rowNode||"none"==n.rowNode.style.display;l.toggle(this.domNode,"dijitTreeIsRoot",n);l.toggle(this.domNode,"dijitTreeIsLast",!n&&!this.getNextSibling())},_setExpando:function(n){var A=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];n=n?0:this.isExpandable?this.isExpanded?1:2:3;l.replace(this.expandoNode,A[n],A);this.expandoNodeText.innerHTML=["*","-","+","*"][n]},expand:function(){if(this._expandDeferred)return ca(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");l.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var n=c.wipeIn({node:this.containerNode,duration:F.defaultDuration}),A=this._expandDeferred=new G(function(){n.stop()});B.after(n,"onEnd",function(){A.resolve(!0)},!0);n.play();return ca(A)},collapse:function(){if(this._collapseDeferred)return ca(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");l.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var n=c.wipeOut({node:this.containerNode,duration:F.defaultDuration}),A=this._collapseDeferred=new G(function(){n.stop()});B.after(n,"onEnd",
function(){A.resolve(!0)},!0);n.play();return ca(A)},indent:0,setChildItems:function(n){var A=this.tree,N=A.model,P=[],U=A.focusedChild,ka=this.getChildren();H.forEach(ka,function(aa){L.prototype.removeChild.call(this,aa)},this);this.defer(function(){H.forEach(ka,function(aa){if(!aa._destroyed&&!aa.getParent()){A.dndController.removeTreeNode(aa);(function D(m){var M=N.getIdentity(m.item),Q=A._itemNodesMap[M];1==Q.length?delete A._itemNodesMap[M]:(M=H.indexOf(Q,m),-1!=M&&Q.splice(M,1));H.forEach(m.getChildren(),
D)})(aa);if(A.persist){var a=H.map(aa.getTreePath(),function(m){return A.model.getIdentity(m)}).join("/"),h;for(h in A._openedNodes)h.substr(0,a.length)==a&&delete A._openedNodes[h];A._saveExpandedNodes()}A.lastFocusedChild&&!p.isDescendant(A.lastFocusedChild.domNode,A.domNode)&&delete A.lastFocusedChild;U&&!p.isDescendant(U.domNode,A.domNode)&&A.focus();aa.destroyRecursive()}})});this.state="Loaded";n&&0<n.length?(this.isExpandable=!0,H.forEach(n,function(aa){var a=N.getIdentity(aa),h=A._itemNodesMap[a];
if(h)for(var r=0;r<h.length;r++)if(h[r]&&!h[r].getParent()){var m=h[r];m.set("indent",this.indent+1);break}m||(m=this.tree._createTreeNode({item:aa,tree:A,isExpandable:N.mayHaveChildren(aa),label:A.getLabel(aa),labelType:A.model&&A.model.labelType||"text",tooltip:A.getTooltip(aa),ownerDocument:A.ownerDocument,dir:A.dir,lang:A.lang,textDir:A.textDir,indent:this.indent+1}),h?h.push(m):A._itemNodesMap[a]=[m]);this.addChild(m);(this.tree.autoExpand||this.tree._state(m))&&P.push(A._expandNode(m))},this),
H.forEach(this.getChildren(),function(aa){aa._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);n=q(P);this.tree._startPaint(n);return ca(n)},getTreePath:function(){for(var n=this,A=[];n&&n!==this.tree.rootNode;)A.unshift(n.item),n=n.getParent();A.unshift(this.tree.rootNode.item);return A},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(n){this.inherited(arguments);var A=this.getChildren();0==
A.length&&(this.isExpandable=!1,this.collapse());H.forEach(A,function(N){N._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(n){this.labelNode.setAttribute("aria-selected",n?"true":"false");l.toggle(this.rowNode,"dijitTreeRowSelected",n)},focus:function(){e.focus(this.focusNode)}});x("dojo-bidi")&&ja.extend({_setTextDirAttr:function(n){!n||this.textDir==n&&this._created||(this._set("textDir",n),this.applyTextDir(this.labelNode),H.forEach(this.getChildren(),
function(A){A.set("textDir",n)},this))}});var ha=J("dijit.Tree",[K,W,I,Z],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:ma,persist:!1,autoExpand:!1,dndController:oa,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,
checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(n,A){g.publish(this.id,f.mixin({tree:this,event:n},A||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new G;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var n=
this;this.own(d(this.containerNode,d.selector(".dijitTreeNode",E.enter),function(P){n._onNodeMouseEnter(v.byNode(this),P)}),d(this.containerNode,d.selector(".dijitTreeNode",E.leave),function(P){n._onNodeMouseLeave(v.byNode(this),P)}),d(this.containerNode,d.selector(".dijitTreeRow",b.press),function(P){n._onNodePress(v.getEnclosingWidget(this),P)}),d(this.containerNode,d.selector(".dijitTreeRow",b),function(P){n._onClick(v.getEnclosingWidget(this),P)}),d(this.containerNode,d.selector(".dijitTreeRow",
"dblclick"),function(P){n._onDblClick(v.getEnclosingWidget(this),P)}));this.model||this._store2model();this.own(B.after(this.model,"onChange",f.hitch(this,"_onItemChange"),!0),B.after(this.model,"onChildrenChange",f.hitch(this,"_onItemChildrenChange"),!0),B.after(this.model,"onDelete",f.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){f.isString(this.dndController)&&(this.dndController=f.getObject(this.dndController));for(var A={},N=0;N<this.dndParams.length;N++)this[this.dndParams[N]]&&
(A[this.dndParams[N]]=this[this.dndParams[N]]);this.dndController=new this.dndController(this,A)}this._load();this.onLoadDeferred=ca(this.pendingCommandsPromise);this.onLoadDeferred.then(f.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;y.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var n={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(n.mayHaveChildren=
f.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(n.getChildren=f.hitch(this,function(A,N,P){this.getItemChildren(this._v10Compat&&A===this.model.root?null:A,N,P)}));this.model=new na(n);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(f.hitch(this,function(n){var A=this.rootNode=this.tree._createTreeNode({item:n,tree:this,isExpandable:!0,label:this.label||this.getLabel(n),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?
0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(A.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(A.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(A.containerNode.setAttribute("aria-labelledby",
this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),A.labelNode.setAttribute("role","presentation"),A.labelNode.removeAttribute("aria-selected"),A.containerNode.setAttribute("role","tree"),A.containerNode.setAttribute("aria-expanded","true"),A.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(A.domNode);n=this.model.getIdentity(n);this._itemNodesMap[n]?this._itemNodesMap[n].push(A):this._itemNodesMap[n]=[A];A._updateLayout();
this._expandNode(A).then(f.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),f.hitch(this,function(n){console.error(this,": error loading root: ",n)}))},getNodesByItem:function(n){if(!n)return[];n=f.isString(n)?n:this.model.getIdentity(n);return[].concat(this._itemNodesMap[n])},_setSelectedItemAttr:function(n){this.set("selectedItems",[n])},_setSelectedItemsAttr:function(n){var A=this;return this.pendingCommandsPromise=
this.pendingCommandsPromise.always(f.hitch(this,function(){var N=H.map(n,function(U){return!U||f.isString(U)?U:A.model.getIdentity(U)}),P=[];H.forEach(N,function(U){P=P.concat(A._itemNodesMap[U]||[])});this.set("selectedNodes",P)}))},_setPathAttr:function(n){return n.length?ca(this.set("paths",[n]).then(function(A){return A[0]})):ca(this.set("paths",[]).then(function(A){return A[0]}))},_setPathsAttr:function(n){function A(P,U){var ka=P.shift(),aa=H.filter(U,function(a){return a.getIdentity()==ka})[0];
if(aa)return P.length?N._expandNode(aa).then(function(){return A(P,aa.getChildren())}):aa;throw new ha.PathError("Could not expand path at "+ka);}var N=this;return ca(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return q(H.map(n,function(P){P=H.map(P,function(U){return U&&f.isObject(U)?N.model.getIdentity(U):U});if(P.length)return A(P,[N.rootNode]);throw new ha.PathError("Empty path");}))}).then(function(P){N.set("selectedNodes",P);return N.paths}))},_setSelectedNodeAttr:function(n){this.set("selectedNodes",
[n])},_setSelectedNodesAttr:function(n){this.dndController.setSelection(n)},expandAll:function(){function n(N){return A._expandNode(N).then(function(){var P=H.filter(N.getChildren()||[],function(U){return U.isExpandable});return q(H.map(P,n))})}var A=this;return ca(n(this.rootNode))},collapseAll:function(){function n(N){var P=H.filter(N.getChildren()||[],function(U){return U.isExpandable});P=q(H.map(P,n));return!N.isExpanded||N==A.rootNode&&!A.showRoot?P:P.then(function(){return A._collapseNode(N)})}
var A=this;return ca(n(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(n){return this.model.getLabel(n)},getIconClass:function(n,A){return!n||this.model.mayHaveChildren(n)?A?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(n,A){(n=this._getNext(A))&&n.isTreeNode&&this.focusNode(n)},
_onUpArrow:function(n,A){if(n=A.getPreviousSibling())for(A=n;A.isExpandable&&A.isExpanded&&A.hasChildren();)A=A.getChildren(),A=A[A.length-1];else if(n=A.getParent(),this.showRoot||n!==this.rootNode)A=n;A&&A.isTreeNode&&this.focusNode(A)},_onRightArrow:function(n,A){A.isExpandable&&!A.isExpanded?this._expandNode(A):A.hasChildren()&&(A=A.getChildren()[0])&&A.isTreeNode&&this.focusNode(A)},_onLeftArrow:function(n,A){A.isExpandable&&A.isExpanded?this._collapseNode(A):(n=A.getParent())&&n.isTreeNode&&
(this.showRoot||n!==this.rootNode)&&this.focusNode(n)},focusLastChild:function(){var n=this._getLast();n&&n.isTreeNode&&this.focusNode(n)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var n=this.rootNode;n.isExpanded;){var A=n.getChildren();if(!A.length)break;n=A[A.length-1]}return n},_getNext:function(n){if(n.isExpandable&&n.isExpanded&&n.hasChildren())return n.getChildren()[0];for(;n&&n.isTreeNode;){var A=n.getNextSibling();if(A)return A;
n=n.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(n,A){return p.isDescendant(n,A.expandoNode)||p.isDescendant(n,A.expandoNodeText)},_onNodePress:function(n,A){this.focusNode(n)},__click:function(n,A,N,P){var U=this.isExpandoNode(A.target,n);n.isExpandable&&(N||U)?this._onExpandoClick({node:n}):(this._publish("execute",{item:n.item,node:n,evt:A}),this[P](n.item,n,A),this.focusNode(n));A.stopPropagation();A.preventDefault()},_onClick:function(n,A){this.__click(n,A,this.openOnClick,
"onClick")},_onDblClick:function(n,A){this.__click(n,A,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(n){n=n.node;this.focusNode(n);n.isExpanded?this._collapseNode(n):this._expandNode(n)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(n){y.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(n)},_getRootOrFirstNode:function(){y.deprecated(this.declaredClass+
"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(n){n._expandNodeDeferred&&delete n._expandNodeDeferred;if("Loading"!=n.state&&n.isExpanded){var A=n.collapse();this.onClose(n.item,n);this._state(n,!1);this._startPaint(A);return A}},_expandNode:function(n){if(n._expandNodeDeferred)return n._expandNodeDeferred;var A=this.model,N=n.item,P=this;n._loadDeferred||(n.markProcessing(),n._loadDeferred=new G,A.getChildren(N,function(U){n.unmarkProcessing();
n.setChildItems(U).then(function(){n._loadDeferred.resolve(U)})},function(U){console.error(P,": error loading "+n.label+" children: ",U);n._loadDeferred.reject(U)}));A=n._loadDeferred.then(f.hitch(this,function(){var U=n.expand();this.onOpen(n.item,n);this._state(n,!0);return U}));this._startPaint(A);return A},focusNode:function(n){for(var A=[],N=this.domNode;N&&N.tagName&&"IFRAME"!==N.tagName.toUpperCase();N=N.parentNode)A.push({domNode:N.contentWindow||N,scrollLeft:N.scrollLeft||0,scrollTop:N.scrollTop||
0});this.focusChild(n);this.defer(function(){for(var P=0,U=A.length;P<U;P++)A[P].domNode.scrollLeft=A[P].scrollLeft,A[P].domNode.scrollTop=A[P].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(n){var A=this.model.getIdentity(n);if(A=this._itemNodesMap[A]){var N=this.getLabel(n),P=this.getTooltip(n);H.forEach(A,function(U){U.set({item:n,label:N,tooltip:P});U._updateItemClasses(n)})}},_onItemChildrenChange:function(n,A){n=this.model.getIdentity(n);
(n=this._itemNodesMap[n])&&H.forEach(n,function(N){N.setChildItems(A)})},_onItemDelete:function(n){n=this.model.getIdentity(n);var A=this._itemNodesMap[n];A&&(H.forEach(A,function(N){this.dndController.removeTreeNode(N);var P=N.getParent();P&&P.removeChild(N);this.lastFocusedChild&&!p.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!p.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();N.destroyRecursive()},this),delete this._itemNodesMap[n])},
_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var n=C(this.cookieName);n&&H.forEach(n.split(","),function(A){this._openedNodes[A]=!0},this)}},_state:function(n,A){if(!this.persist)return!1;var N=H.map(n.getTreePath(),function(P){return this.model.getIdentity(P)},this).join("/");if(1===arguments.length)return this._openedNodes[N];A?this._openedNodes[N]=!0:delete this._openedNodes[N];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var n=
[],A;for(A in this._openedNodes)n.push(A);C(this.cookieName,n.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!f.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(n){n&&t.setMarginBox(this.domNode,n);this._nodePixelIndent=t.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(f.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(n){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var A=f.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});
k(n,A,A)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(n){return new ja(n)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});x("dojo-bidi")&&ha.extend({_setTextDirAttr:function(n){n&&this.textDir!=n&&(this._set("textDir",
n),this.rootNode.set("textDir",n))}});ha.PathError=w("TreePathError");ha._TreeNode=ja;return ha})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(H,B,C,J){return C("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(G){J.mixin(this,G);this.connects=[];G=this.store;if(!G.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
G.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([B.after(G,"onNew",J.hitch(this,"onNewItem"),!0),B.after(G,"onDelete",J.hitch(this,"onDeleteItem"),!0),B.after(G,"onSet",J.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var G;G=this.connects.pop();)G.remove()},getRoot:function(G,q){this.root?G(this.root):this.store.fetch({query:this.query,onComplete:J.hitch(this,function(p){if(1!=p.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+p.length+
" items, but must return exactly one");this.root=p[0];G(this.root)}),onError:q})},mayHaveChildren:function(G){return H.some(this.childrenAttrs,function(q){return this.store.hasAttribute(G,q)},this)},getChildren:function(G,q,p){var l=this.store;if(l.isItemLoaded(G)){for(var t=[],z=0;z<this.childrenAttrs.length;z++){var w=l.getValues(G,this.childrenAttrs[z]);t=t.concat(w)}var c=0;this.deferItemLoadingUntilExpand||H.forEach(t,function(y){l.isItemLoaded(y)||c++});0==c?q(t):H.forEach(t,function(y,u){l.isItemLoaded(y)||
l.loadItem({item:y,onItem:function(f){t[u]=f;0==--c&&q(t)},onError:p})})}else{var x=J.hitch(this,arguments.callee);l.loadItem({item:G,onItem:function(y){x(y,q,p)},onError:p})}},isItem:function(G){return this.store.isItem(G)},fetchItemByIdentity:function(G){this.store.fetchItemByIdentity(G)},getIdentity:function(G){return this.store.getIdentity(G)},getLabel:function(G){return this.labelAttr?this.store.getValue(G,this.labelAttr):this.store.getLabel(G)},newItem:function(G,q,p){var l={parent:q,attribute:this.childrenAttrs[0]},
t;this.newItemIdAttr&&G[this.newItemIdAttr]?this.fetchItemByIdentity({identity:G[this.newItemIdAttr],scope:this,onItem:function(z){z?this.pasteItem(z,null,q,!0,p):(t=this.store.newItem(G,l))&&void 0!=p&&this.pasteItem(t,q,q,!1,p)}}):(t=this.store.newItem(G,l))&&void 0!=p&&this.pasteItem(t,q,q,!1,p)},pasteItem:function(G,q,p,l,t){var z=this.store,w=this.childrenAttrs[0];q&&H.forEach(this.childrenAttrs,function(x){if(z.containsValue(q,x,G)){if(!l){var y=H.filter(z.getValues(q,x),function(u){return u!=
G});z.setValues(q,x,y)}w=x}});if(p)if("number"==typeof t){var c=z.getValues(p,w).slice();c.splice(t,0,G);z.setValues(p,w,c)}else z.setValues(p,w,z.getValues(p,w).concat(G))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(G,q){q&&this.getChildren(q.item,J.hitch(this,function(p){this.onChildrenChange(q.item,p)}))},onDeleteItem:function(G){this.onDelete(G)},onSetItem:function(G,q){if(-1!=H.indexOf(this.childrenAttrs,q))this.getChildren(G,J.hitch(this,function(p){this.onChildrenChange(G,
p)}));else this.onChange(G)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(H,B,C,J,G){return B("dijit.tree.ForestStoreModel",G,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(q){this.root={store:this,root:!0,id:q.rootId,label:q.rootLabel,children:q.rootChildren}},mayHaveChildren:function(q){return q===this.root||this.inherited(arguments)},getChildren:function(q,p,l){q===
this.root?this.root.children?p(this.root.children):this.store.fetch({query:this.query,onComplete:J.hitch(this,function(t){this.root.children=t;p(t)}),onError:l}):this.inherited(arguments)},isItem:function(q){return q===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(q){if(q.identity==this.root.id){var p=q.scope||C.global;q.onItem&&q.onItem.call(p,this.root)}else this.inherited(arguments)},getIdentity:function(q){return q===this.root?this.root.id:this.inherited(arguments)},getLabel:function(q){return q===
this.root?this.root.label:this.inherited(arguments)},newItem:function(q,p,l){return p===this.root?(this.onNewRootItem(q),this.store.newItem(q)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(q,p,l,t,z){if(p===this.root&&!t)this.onLeaveRoot(q);this.inherited(arguments,[q,p===this.root?null:p,l===this.root?null:l,t,z]);if(l===this.root)this.onAddToRoot(q)},onAddToRoot:function(q){console.log(this,": item ",q," added to root")},onLeaveRoot:function(q){console.log(this,": item ",
q," removed from root")},_requeryTop:function(){var q=this.root.children||[];this.store.fetch({query:this.query,onComplete:J.hitch(this,function(p){this.root.children=p;if(q.length!=p.length||H.some(q,function(l,t){return p[t]!=l}))this.onChildrenChange(this.root,p)})})},onNewItem:function(q,p){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(q){-1!=H.indexOf(this.root.children,q)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(q,p,l,t){this._requeryTop();this.inherited(arguments)}})})},
"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(H,B,C,J,G,q,p,l,t,z,w){return B("dijit.tree._dndSelector",w,{constructor:function(){this.selection={};this.anchor=null;this.events.push(l(this.tree.domNode,t.press,J.hitch(this,"onMouseDown")),l(this.tree.domNode,t.release,J.hitch(this,"onMouseUp")),l(this.tree.domNode,t.move,J.hitch(this,
"onMouseMove")),l(this.tree.domNode,z.press,J.hitch(this,"onClickPress")),l(this.tree.domNode,z.release,J.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var c=[],x=this.selection,y;for(y in x)c.push(x[y]);return c},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(c,x){this.setSelection(this.getSelectedTreeNodes().concat([c]));x&&(this.anchor=c);return c},removeTreeNode:function(c){var x=
H.filter(this.getSelectedTreeNodes(),function(y){return!q.isDescendant(y.domNode,c.domNode)});this.setSelection(x);return c},isTreeNodeSelected:function(c){return c.id&&!!this.selection[c.id]},setSelection:function(c){var x=this.getSelectedTreeNodes();H.forEach(this._setDifference(x,c),J.hitch(this,function(y){y.setSelected(!1);this.anchor==y&&delete this.anchor;delete this.selection[y.id]}));H.forEach(this._setDifference(c,x),J.hitch(this,function(y){y.setSelected(!0);this.selection[y.id]=y}));this._updateSelectionProperties()},
_setDifference:function(c,x){H.forEach(x,function(y){y.__exclude__=!0});c=H.filter(c,function(y){return!y.__exclude__});H.forEach(x,function(y){delete y.__exclude__});return c},_updateSelectionProperties:function(){var c=this.getSelectedTreeNodes(),x=[],y=[];H.forEach(c,function(u){var f=u.getTreePath();y.push(u);x.push(f)},this);c=H.map(y,function(u){return u.item});this.tree._set("paths",x);this.tree._set("path",x[0]||[]);this.tree._set("selectedNodes",y);this.tree._set("selectedNode",y[0]||null);
this.tree._set("selectedItems",c);this.tree._set("selectedItem",c[0]||null)},onClickPress:function(c){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(c.target,this.current))){"mousedown"==c.type&&p.isLeft(c)&&c.preventDefault();var x="keydown"==c.type?this.tree.focusedChild:this.current;if(x){var y=G.getCopyKeyState(c),u=x.id;this.singular||c.shiftKey||!this.selection[u]?(this._doDeselect=!1,this.userSelect(x,y,c.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(c){this._doDeselect&&
(this._doDeselect=!1,this.userSelect("keyup"==c.type?this.tree.focusedChild:this.current,G.getCopyKeyState(c),c.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(c,x){if(c===x)return 0;if("sourceIndex"in document.documentElement)return c.sourceIndex-x.sourceIndex;if("compareDocumentPosition"in document.documentElement)return c.compareDocumentPosition(x)&2?1:-1;if(document.createRange){var y=doc.createRange();y.setStartBefore(c);
c=doc.createRange();c.setStartBefore(x);return y.compareBoundaryPoints(y.END_TO_END,c)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(c,x,y){if(this.singular)this.anchor==c&&x?this.selectNone():(this.setSelection([c]),this.anchor=c);else if(y&&this.anchor){x=this._compareNodes(this.anchor.rowNode,c.rowNode);y=this.anchor;0>x?x=y:(x=c,c=y);for(y=[];x!=c;)y.push(x),x=this.tree._getNext(x);y.push(c);this.setSelection(y)}else this.selection[c.id]&&
x?this.removeTreeNode(c):x?this.addTreeNode(c,!0):(this.setSelection([c]),this.anchor=c)},getItem:function(c){return{data:this.selection[c],type:["treeNode"]}},forInSelectedItems:function(c,x){x=x||C.global;for(var y in this.selection)c.call(x,this.getItem(y),y,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(H,B,C,J,G,q){return B("dijit.tree._dndContainer",null,{constructor:function(p,l){this.tree=
p;this.node=p.domNode;J.mixin(this,l);this.containerState="";C.add(this.node,"dojoDndContainer");this.events=[G(this.node,q.enter,J.hitch(this,"onOverEvent")),G(this.node,q.leave,J.hitch(this,"onOutEvent")),H.after(this.tree,"_onNodeMouseEnter",J.hitch(this,"onMouseOver"),!0),H.after(this.tree,"_onNodeMouseLeave",J.hitch(this,"onMouseOut"),!0),G(this.node,"dragstart, selectstart",function(t){t.preventDefault()})]},destroy:function(){for(var p;p=this.events.pop();)p.remove();this.node=this.parent=
null},onMouseOver:function(p){this.current=p},onMouseOut:function(){this.current=null},_changeState:function(p,l){var t="dojoDnd"+p;p=p.toLowerCase()+"State";C.replace(this.node,t+l,t+this[p]);this[p]=l},_addItemClass:function(p,l){C.add(p,"dojoDndItem"+l)},_removeItemClass:function(p,l){C.remove(p,"dojoDndItem"+l)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/FeaturelayerChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/FeaturelayerServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d){return H([B,C,J,c],{templateString:G,declaredClass:"jimu.dijit.FeaturelayerChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-featurelayer-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=q.mixin({},window.jimuNls.common);this.nls=q.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=f.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new y({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service"],onlyShowOnlineFeaturedItems:!1});this.own(t(this.selector,"item-selected",q.hitch(this,this._onItemSelected)));this.own(t(this.selector,"none-item-selected",q.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new u({multiple:this.multiple});this.own(t(this.serviceBrowser,"tree-click",q.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){p.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){p.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();p.setStyle(this.btnOk,"display","none");p.setStyle(this.btnNext,"display","block");p.setStyle(this.btnBack,"display","none");p.addClass(this.btnOk,"jimu-state-disabled");p.setStyle(this.selectorContainer,"display","block");p.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var g=this.getSelectedItems();0<g.length&&this.emit("ok",g)},_onBtnNextClicked:function(){var g=this.selector.getSelectedItem();
g&&(p.setStyle(this.btnNext,"display","none"),p.setStyle(this.btnBack,"display","block"),p.setStyle(this.btnOk,"display","block"),p.addClass(this.btnOk,"jimu-state-disabled"),p.setStyle(this.selectorContainer,"display","none"),p.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(g.url||g.item),this._serviceBrowserDef.then(q.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),q.hitch(this,
function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?p.removeClass(this.btnOk,"jimu-state-disabled"):p.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E,k,b,e,v,F,K){return H([C,J,G,K,p],{templateString:q,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=k.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";z.forEach(this.itemTypes,l.hitch(this,function(I,L){this._itemTypes+=
'"'+I+'"';L!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";z.forEach(this.typeKeywords,l.hitch(this,function(I,L){this._typeKeywords+='"'+I+'"';L!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var I=this._getPortalUrl();
this.portal=g.getPortal(I);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=d.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=d.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var I={title:this.nls.myContent,content:this.mycontentTabNode},L={title:this.nls.myOrganization,content:this.organizationTabNode},
S={title:this.nls.myGroup,content:this.groupTabNode},Z={title:this.nls.publicMap,content:this.publicTabNode};f.set(this.mycontentTabNode,"display","none");f.set(this.organizationTabNode,"display","none");f.set(this.groupTabNode,"display","none");f.set(this.publicTabNode,"display","none");var W=[];this.showMyContent&&(W.push(I),f.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(W.push(L),f.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(W.push(S),f.set(this.groupTabNode,
"display","block"));this.showPublic&&(W.push(Z),f.set(this.publicTabNode,"display","block"));this.tab=new v({tabs:W},this.tabNode);this.own(u(this.tab,"tabChanged",l.hitch(this,function(fa){w.setStyle(this.signinSection,"display","none");fa!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){w.setStyle(this.signinSection,"display","none");var I=y(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);E.userHaveSignInPortal(this._getPortalUrl())?I.style("display","block"):(I.style("display","none"),this._isPublicTabShow||w.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var I=this._getPortalUrl();I=k.getServerByUrl(I);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var L=!1;k.isArcGIScom(I)?(L=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
I,L=this.showOnlineItems?!1:!0);L&&(this.onlinePublicRaido.set("disabled",!0),w.setStyle(this.onlinePublicRaido,"display","none"),w.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var I="esri_"+(t.locale&&t.locale.slice(0,2)||"en").toLowerCase(),L=z.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
l.hitch(this,function(Z){return Z!==I})),S="";z.forEach(L,l.hitch(this,function(Z){S+=" -owner:"+Z+" "}));L=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(L=" orgid:"+this.portal.user.orgId+" ");L=L+this._itemTypeQueryString+" AND access:public "+S+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:L});this._filterPublicPortalQuery=this._getQuery({q:L,basicQ:L});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(I){return l.mixin({start:1,num:16,f:"json"},I||{})},_getPortalUrl:function(){return k.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(u(this.publicPortalItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(u(this.publicOnlineItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(u(this.organizationItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(u(this.groupItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));
this.own(u(this.mycontentItemTable,"item-dom-clicked",l.hitch(this,this._onItemDomClicked)));this.own(u(this.publicPortalItemTable,"update",l.hitch(this,this._onItemTableUpdate)));this.own(u(this.publicOnlineItemTable,"update",l.hitch(this,this._onItemTableUpdate)));this.own(u(this.organizationItemTable,"update",l.hitch(this,this._onItemTableUpdate)));this.own(u(this.groupItemTable,"update",l.hitch(this,this._onItemTableUpdate)));this.own(u(this.mycontentItemTable,"update",l.hitch(this,this._onItemTableUpdate)));
var I=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",I),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(u(this.portalPublicRaido,"click",l.hitch(this,this._onPublicRaidoClicked)));this.own(u(this.onlinePublicRaido,"click",l.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(I){(I=I&&l.trim(I))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=I+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=I+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(u(this.groupsSelect,"change",l.hitch(this,this._onGroupsSelectChange)));var I=k.getServerByUrl(this._getPortalUrl());k.isArcGIScom(I)&&(I="ArcGIS.com");E.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(I){if(I=I&&l.trim(I)){if(this._allOrganizationQuery){var L=this._allOrganizationQuery.q;L&&(this._filterOrganizationQuery.q=I+" "+L,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(I){if(I=I&&l.trim(I)){if(this._allMyContentQuery){var L=this._allMyContentQuery.q;L&&(this._filterMyContentQuery.q=I+" "+
L,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(I){if(I=I&&l.trim(I)){if(this._allGroupQuery){var L=this._allGroupQuery.q;L&&(this._filterGroupQuery.q=I+" "+L,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var I=this._getPortalUrl();g.getPortal(I).getUser().then(l.hitch(this,function(L){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(L),this._searchMyContent(L),this._searchGroups(L))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(I){this.organizationItemTable.clear();I=" orgid:"+I.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var L=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:I});this._filterOrganizationQuery=this._getQuery({q:I});this.organizationItemTable.set("portalUrl",L);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(I){this.mycontentItemTable.clear();var L=this._getPortalUrl();I="owner:"+I.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:I});this._filterMyContentQuery=this._getQuery({q:I});this.mycontentItemTable.set("portalUrl",L);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(I){this._resetGroupsSection();w.setStyle(this.groupsSection,"display","flex");I=I.getGroups();if(0<I.length){w.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();w.empty(this.groupsSelect);for(var L=0;L<I.length;L++){var S=I[L];w.create("option",
{value:S.id,innerHTML:S.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(I.length)},_resetGroupsSection:function(){w.setStyle(this.groupsSection,"display","none");w.empty(this.groupsSelect);w.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();w.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(I){0===I?w.setStyle(this.groupsSection,
"top","15px"):w.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var I=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===I)w.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{w.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var L=this._getPortalUrl();I="group:"+I+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:I});this._filterGroupQuery=this._getQuery({q:I});
this.groupItemTable.set("portalUrl",L);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(I){var L=w.hasClass(I,"jimu-state-active");y(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");L&&w.addClass(I,"jimu-state-active");(I=this.getSelectedItem())?this.emit("item-selected",I):this.emit("none-item-selected")},getSelectedItem:function(){var I=null,L=y(".item.jimu-state-active",this.domNode);
0<L.length&&(I=l.mixin({},L[0].item));return I}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f){return H([B,C,J,q],{templateString:G,declaredClass:"jimu.dijit.ItemTable",
baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=u.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){t.setStyle(this.domNode,"display","block")},hide:function(){t.setStyle(this.domNode,"display","none")},searchAllItems:function(d){this.showAllItemsSection();d&&(this.query=p.mixin({},d),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),y.getPortal(this.portalUrl).queryItems(this.query).then(p.hitch(this,function(g){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=g.nextStart,this._createItems(g,this.allItemTbody))}),p.hitch(this,function(g){console.error(g);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(d){this.showFilterItemsSection();d&&(this.filteredQuery=p.clone(d),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),y.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(p.hitch(this,function(g){this.domNode&&
(this.showFilterItemsSection(),d&&this.clearFilteredItemsSection(),this.filteredQuery.start=g.nextStart,this._createItems(g,this.filteredItemsTbody),this._filterItemCallback())}),p.hitch(this,function(g){console.error(g);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(t.setStyle(this.filteredItemsTableDiv,"display","block"),t.setStyle(this.searchNoneTipSection,"display","none")):(t.setStyle(this.filteredItemsTableDiv,
"display","none"),t.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){t.empty(this.allItemTbody)},clearFilteredItemsSection:function(){t.empty(this.filteredItemsTbody)},showAllItemsSection:function(){t.setStyle(this.allItemsSection,"display","block");t.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){t.setStyle(this.allItemsSection,"display","none");
t.setStyle(this.filteredItemsSection,"display","block");t.setStyle(this.filteredItemsTableDiv,"display","block");t.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(d){return x.isScrollToBottom(d)},_createItems:function(d,g){d=d.results;var E=
l.map(this.types,p.hitch(this,function(I){return I.toLowerCase()}));d=l.filter(d,p.hitch(this,function(I){I=I.type&&I.type.toLowerCase()||"";return 0<=l.indexOf(E,I)}));if(0!==d.length){var k=w("td.empty",g),b;if(0<k.length){var e=Math.min(d.length,k.length),v=d.splice(0,e);for(b=0;b<e;b++){var F=k[b];var K=this._createItem(v[b]);t.place(K,F);t.removeClass(F,"empty")}}if(0!==d.length){k=Math.ceil(d.length/2);for(b=0;b<k;b++)for(K=t.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
t.place(K,g),e=w("td",K),v=0;v<e.length;v++)F=e[v],(K=d[2*b+v])?(K=this._createItem(K),t.place(K,F)):t.addClass(F,"empty");this.emit("update")}}},_getItemCount:function(d){return w(".item",d).length},_createItem:function(d){var g=t.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
g.item=d;var E=w(".item-thumbnail",g)[0],k=w(".item-name",g)[0],b=w(".item-type-owner",g)[0],e=w(".item-date",g)[0],v=w(".item-details",g)[0],F=w(".none-thumbnail-tip",g)[0];if(!d.thumbnailUrl){var K=this._defaultThumbnail[d.type];K&&(d.thumbnailUrl=require.toUrl("jimu")+"/images/"+K)}d.thumbnailUrl?t.setStyle(E,"backgroundImage","url("+d.thumbnailUrl+")"):F.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(e=w(".item-info",g)[0],this.onCreateItemContent(d,e)):(k.innerHTML=
d.title,k.title=k.innerHTML,b.innerHTML=d.type+" by "+d.owner,b.title=b.innerHTML,E=new Date,E.setTime(d.modified),e.innerHTML=E.toLocaleString(),e.title=e.innerHTML,v.innerHTML=this.nls.moreDetails,v.href=d.detailsPageUrl||"#");return g},_onItemsTableClicked:function(d){var g=d.target||d.srcElement;d=null;t.hasClass(g,"item-thumbnail")?d=g.parentNode:t.hasClass(g,"none-thumbnail-tip")&&(d=g.parentNode.parentNode);d&&(g=t.hasClass(d,"jimu-state-active"),w(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
g?t.removeClass(d,"jimu-state-active"):t.addClass(d,"jimu-state-active"),this.emit("item-dom-clicked",d))},getSelectedItem:function(){var d=null,g=w(".item.jimu-state-active",this.domNode);0<g.length&&(d=p.mixin({},g[0].item));return d}})})},"jimu/dijit/FeaturelayerServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(H,B,C,J,G){return H([B],{baseClass:"jimu-featurelayer-service-browser",declaredClass:"jimu.dijit.FeaturelayerServiceBrowser",
url:"",multiple:!1,types:null,isSupportQuery:!0,postMixInProperties:function(){this.inherited(arguments);this.rule=G.getFeaturelayerServiceBrowserRule(this.types,this.isSupportQuery)},getSelectedItems:function(){var q=this.inherited(arguments);return q=J.map(q,C.hitch(this,function(p){return{name:p.name,url:p.url,definition:p.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u){return H([B,C,J,G],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(f){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new t;f&&"string"===typeof f&&f.replace(/\/*$/g,"")||this._def.reject();f=f.replace(/\/*$/g,"");f=q.trim(f);var d=f.match(/^http(s?):\/\//gi);d&&0<d.length||
(f="http://"+f);if(!(0>=f.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=f))return f=this._getRootItem(),f=y.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,f):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,f):this._searchFolderServiceUrl(this._currentUrl,f),this.shelter.show(),f.then(q.hitch(this,function(g){this.domNode&&this.shelter.hide();var E=this.tree.getAllLeafTreeNodeWidgets();1===E.length&&
E[0].select();this._def.resolve(g)}),q.hitch(this,function(g){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(g)})),this._def;this._def.reject()},_getItem:function(f){return this.rule.getItem(f)},_getSubItemUrls:function(f){return this.rule.getSubItemUrls(f)},_getSubItems:function(f){var d=new t;this._getSubItemUrls(f).then(q.hitch(this,function(g){g=l.map(g,q.hitch(this,function(E){return this._getItem(E)}));z(g).then(q.hitch(this,function(E){E=l.filter(E,q.hitch(this,
function(k){return k&&"object"===typeof k}));d.resolve(E)}),q.hitch(this,function(E){d.reject(E)}))}),q.hitch(this,function(g){d.reject(g)}));return d},_selectFirstLeafTreeNodeWidget:function(){var f=this.tree.getAllLeafTreeNodeWidgets();1===f.length&&f[0].select()},isLeafItem:function(f){return 0<=this.rule.leafTypes.indexOf(f.type)},isServiceTypeSupported:function(f){return this.rule.isServiceTypeSupported(f)},_getStringEndWith:function(f,d){var g="",E=f.indexOf(d);0<=E&&(g=f.slice(0,E+d.length));
return g},_isUrlContainsServiceType:function(f){return this.rule.isUrlContainsServiceType(f)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(f){var d="";f=f.split("/");return d=f[f.length-1]},_searchBaseServiceUrl:function(f,d){var g=new t;this._getRestInfo(f).then(q.hitch(this,function(E){if(this.domNode){var k=[];l.map(E.folders,q.hitch(this,function(b){var e={name:b,type:"folder",url:f+"/"+b,parent:d.id};this._addItem(e);
var v=new t;this._doSearchFolderServiceUrl(e.url,e.id).then(q.hitch(this,function(F){0<F.length?l.forEach(F,q.hitch(this,function(K){K.parent=e.id;this._addItem(K)})):this._removeItem(e.id);v.resolve()}),q.hitch(this,function(F){v.reject(F)}));k.push(v);return v}));l.forEach(E.services,q.hitch(this,function(b){if(this.isServiceTypeSupported(b.type)){b=f+"/"+b.name+"/"+b.type;var e=new t;this.rule.getItem(b).then(q.hitch(this,function(v){v&&(v.parent=d.id,this._addItem(v));e.resolve()}),q.hitch(this,
function(v){console.error(v);e.reject(v)}));k.push(e)}}));z(k).then(q.hitch(this,function(){this.domNode&&g.resolve()}),q.hitch(this,function(b){console.error(b);this.domNode&&g.reject(b)}))}}),q.hitch(this,function(E){console.error(E);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:E})}));return g},_searchFolderServiceUrl:function(f,d){var g=new t;this._doSearchFolderServiceUrl(f,d).then(q.hitch(this,function(E){this.domNode&&(l.forEach(E,q.hitch(this,function(k){k.parent=d.id;this._addItem(k)})),
g.resolve())}),q.hitch(this,function(E){console.error(E);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:E})}));return g},_doSearchFolderServiceUrl:function(f){var d=new t,g=this._getBaseServiceUrl();this._getRestInfo(f).then(q.hitch(this,function(E){E=E.services;var k=[];E&&0<E.length&&l.forEach(E,q.hitch(this,function(b){this.isServiceTypeSupported(b.type)&&(b=this.rule.getItem(g+"/"+b.name+"/"+b.type),k.push(b))}));z(k).then(q.hitch(this,function(b){b=l.filter(b,q.hitch(this,function(e){return e}));
d.resolve(b)}),q.hitch(this,function(b){console.error(b);d.reject(b)}))}),q.hitch(this,function(E){console.error(E);d.reject(E)}));return d},_searchServiceUrl:function(f,d){var g=new t;this._getSubItems(f).then(q.hitch(this,function(E){E&&0<E.length?(l.forEach(E,q.hitch(this,function(k){k.parent=d.id;this._addItem(k)})),g.resolve()):this._getItem(f).then(q.hitch(this,function(k){k&&(k.parent=d.id,this._addItem(k));g.resolve()}),q.hitch(this,function(k){g.reject(k)}))}),q.hitch(this,function(E){g.reject(E)}));
return g},_getRestInfo:function(f){var d=new t;this.rule.getRestInfo(f).then(q.hitch(this,function(g){this.domNode&&d.resolve(g)}),q.hitch(this,function(g){this.domNode&&d.reject(g)}));return d},_clear:function(){var f=this._store.query({parent:"root"});l.forEach(f,q.hitch(this,function(d){d&&"root"!==d.id&&this._store.remove(d.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(f){this._id++;f.id=this._id.toString();this._store.add(f);return f},_removeItem:function(f){this._store.remove(f)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var f=this._getRootItem();f=new w({data:[f],getChildren:function(d){return this.query({parent:d.id})}});this._store=new c(f);f=new x({store:this._store,query:{id:"root"},mayHaveChildren:q.hitch(this,this._mayHaveChildren)});this.tree=new u({multiple:this.multiple,model:f,showRoot:!1,style:{width:"100%"},isLeafItem:q.hitch(this,this.isLeafItem),onOpen:q.hitch(this,function(d,g){this._onTreeOpen(d,g);
this.emit("tree-open",d,g)}),onClick:q.hitch(this,function(d,g,E){this._onTreeClick(d,g,E);this.emit("tree-click",d,g,E)}),getIconStyle:q.hitch(this,function(d,g){var E=null;if(!d)return null;var k={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},b=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),e=this._getIconImageName(d,g);e||("folder"===d.type?e=g?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(d.type)&&
(e=g?"folder_open_default.png":"folder_close_default.png"));e&&(k.backgroundImage="url("+b+"/css/images/"+e+")",E=k);return E})});p.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(f,d){var g="";"function"===typeof this.rule.getIconImageName&&(g=this.rule.getIconImageName(f,d));return g},_mayHaveChildren:function(f){return"root"===f.type?!0:!this.isLeafItem(f)},_onTreeOpen:function(f,d){"root"===f.id||0<this._store.query({parent:f.id}).length||
f.checking||f.checked||(f.checking=!0,this._getSubItems(f.url).then(q.hitch(this,function(g){l.forEach(g,q.hitch(this,function(E){E.parent=f.id;this._addItem(E)}));f.checking=!1;f.checked=!0}),q.hitch(this,function(g){console.error(g);f.checking=!1;f.checked=!0})))},_onTreeClick:function(f,d,g){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(H,B,C,J,G){var q={combineRules:function(p){var l=new G;B.forEach(p,function(t){B.forEach(t.leafTypes,function(z){0>l.leafTypes.indexOf(z)&&l.leafTypes.push(z)});B.forEach(t.serviceTypes,function(z){0>l.serviceTypes.indexOf(z)&&l.serviceTypes.push(z)})});l.getMatchedRule=function(t){var z=null;B.some(p,function(w){return w.isUrlContainsServiceType(t)?(z=w,!0):!1});return z};l.getItem=function(t){var z=null;return z=(z=l.getMatchedRule(t))?z.getItem(t):
l.defaultGetItem(t)};l.getSubItemUrls=function(t){var z=null;return z=(z=l.getMatchedRule(t))?z.getSubItemUrls(t):l.defaultGetSubItemUrls(t)};l.getIconImageName=function(t,z){var w="";if(t.url){var c=l.getMatchedRule(t.url);c&&"function"===typeof c.getIconImageName&&(w=c.getIconImageName(t,z))}return w};return l},getFeaturelayerServiceBrowserRule:function(p,l,t){p=H.clone(p);var z=["point","polyline","polygon"];H.isArrayLike(p)&&0<p.length?(p=B.filter(p,function(w){return 0<=z.indexOf(w)}),0===p.length&&
(p=z)):p=z;return q._getFeaturelayerServiceBrowserRule(p,l,t)},_getFeaturelayerServiceBrowserRule:function(p,l,t){return new G({types:p,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(z){var w=new C;this.isUrlEndWithServiceType(z,this.serviceTypes)?w=this.defaultGetItem(z):this.getRestInfo(z).then(H.hitch(this,function(c){c=this._getItemByLayerDefinition(z,c);w.resolve(c)}),
H.hitch(this,function(c){w.reject(c)}));return w},getSubItemUrls:function(z){var w=new C;return w=this.isUrlEndWithServiceType(z)?this._getSubUrlsByServiceUrl(z):this._getSubUrlsByGroupUrl(z)},getIconImageName:function(z,w){var c="";"MapServer"===z.type||"FeatureServer"===z.type?c=w?"mapserver_open.png":"mapserver_close.png":z.type===this._groupLayerType?c=w?"group_layer2.png":"group_layer1.png":z.type===this._featureLayerType?(z=J.getTypeByGeometryType(z.definition&&z.definition.geometryType),"point"===
z?c="point_layer1.png":"polyline"===z?c="line_layer1.png":"polygon"===z&&(c="polygon_layer1.png")):z.type===this._tableType?c="table.png":"root"===z.type&&this._currentUrl&&B.some(this.serviceTypes,H.hitch(this,function(x){return J.isStringEndWith(this._currentUrl,"/"+x)}))&&(c=w?"mapserver_open.png":"mapserver_close.png");return c},_getSubUrlsByServiceUrl:function(z){var w=new C;this.getRestInfo(z).then(H.hitch(this,function(c){var x=[];B.forEach(c.layers,H.hitch(this,function(y){0<=y.parentLayerId||
x.push(z+"/"+y.id)}));t&&B.forEach(c.tables,H.hitch(this,function(y){0<=y.parentLayerId||x.push(z+"/"+y.id)}));w.resolve(x)}),H.hitch(this,function(c){w.reject(c)}));return w},_getSubUrlsByGroupUrl:function(z){var w=new C;this.getRestInfo(z).then(H.hitch(this,function(c){var x=[];if(c.type===this._groupLayerType){var y=this._getServiceUrlByLayerUrl(z);x=B.map(c.subLayers||[],H.hitch(this,function(u){return y+"/"+u.id}))}w.resolve(x)}),H.hitch(this,function(c){w.reject(c)}));return w},_getItemByLayerDefinition:function(z,
w){var c=null,x=w.type;if(x===this._groupLayerType)c={name:w.name,type:x,url:z,definition:w};else if(x===this._featureLayerType||x===this._tableType){var y=!1;x===this._featureLayerType?y=this._validateEsriGeometryType(w.geometryType):x===this._tableType&&(y=!0);y&&(y=!1,(y=l?J.isFeaturelayerUrlSupportQuery(z,w.capabilities):!0)&&(c={name:w.name,type:x,url:z,definition:w}))}return c},_validateEsriGeometryType:function(z){z=J.getTypeByGeometryType(z);return 0<=this.types.indexOf(z)},_getServiceUrlByLayerUrl:function(z){for(var w=
"",c=0;c<this.serviceTypes.length;c++){var x=this.serviceTypes[c].toLowerCase(),y=z.toLowerCase().lastIndexOf("/"+x+"/");if(0<=y){w=z.slice(0,y+x.length+1);break}}return w}})},getGeocodeServiceBrowserRule:function(){return new G({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new G({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(p){var l=new C;this.isUrlEndWithServiceType(p)?l=this.defaultGetItem(p):this.getRestInfo(p).then(H.hitch(this,
function(t){l.resolve({name:t.displayName||t.name,type:"GPTask",url:p,definition:t})}),H.hitch(this,function(t){l.reject(t)}));return l},getSubItemUrls:function(p){var l=new C;this.isUrlEndWithServiceType(p)?this.getRestInfo(p).then(H.hitch(this,function(t){t=B.map(t.tasks||[],H.hitch(this,function(z){return p+"/"+z}));l.resolve(t)}),H.hitch(this,function(t){l.reject(t)})):l.resolve([]);return l},getIconImageName:function(p,l){l="";"GPServer"===p.type?l="toolbox.png":"GPTask"===p.type&&(l="tool.png");
return l}})},getImageServiceBrowserRule:function(p){return new G({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(l){var t=new C;this.isUrlEndWithServiceType(l)?this.defaultGetItem(l).then(H.hitch(this,function(z){p?J.isImageServiceSupportQuery(z.definition.capabilities)?t.resolve(z):t.resolve(null):t.resolve(z)}),H.hitch(this,function(z){t.reject(z)})):t.resolve(null);return t},getIconImageName:function(l,t){t="";"ImageServer"===l.type&&(t="image_layer.png");return t}})},
getQueryableServiceBrowserRule:function(){var p=q.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),l=q.getImageServiceBrowserRule(!0);return q.combineRules([p,l])}};return q})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(H,B,C,J,G,q,p){return H([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(l){B.mixin(this,l);B.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);B.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(l){return this.defaultGetItem(l)},getSubItemUrls:function(l){return this.defaultGetSubItemUrls(l)},getIconImageName:function(l,t){return""},defaultGetItem:function(l){var t=new J;l=l.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(l)){var z=l.split("/"),w=z[z.length-1],c=z[z.length-2];this.getRestInfo(l).then(B.hitch(this,function(x){t.resolve({name:c,type:w,url:l,definition:x})}),B.hitch(this,function(x){console.error(x);
t.reject({errorCode:"NETWORK_ERROR",error:x})}))}else t.resolve(null);return t},defaultGetSubItemUrls:function(l){l=new J;l.resolve([]);return l},getRestInfo:function(l){var t=new J;l=l.replace(/\/*$/g,"");var z=this._restInfoCache[l];if(z)t.resolve(z);else{z={url:l,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4};var w=p.findCredential(l);w&&w.token&&(z.content.token=w.token);q(z).then(B.hitch(this,function(c){this._restInfoCache[l]=c;t.resolve(c)}),function(c){t.reject(c)})}return t},
isServiceTypeSupported:function(l){l=l.toLowerCase();return C.some(this.serviceTypes,B.hitch(this,function(t){return t.toLowerCase()===l}))},isUrlEndWithServiceType:function(l){return C.some(this.serviceTypes,B.hitch(this,function(t){return G.isStringEndWith(l,"/"+t)}))},isUrlContainsServiceType:function(l){l=l.toLowerCase();return C.some(this.serviceTypes,B.hitch(this,function(t){t=t.toLowerCase();return 0<=l.indexOf("/"+t)}))}})})},"jimu/dijit/_FeaturelayerServiceChooserContent":function(){define(["dojo/_base/declare",
"./_BasicServiceChooserContent","./FeaturelayerServiceBrowser"],function(H,B,C){return H([B],{baseClass:"jimu-featurelayer-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer"],_createServiceBrowser:function(J){return new C(J)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u){return H([B,C,J,q],{templateString:G,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=z.mixin({},window.jimuNls.common);this.nls=z.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
l.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(f){var d=new p;(this.url=f)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),d=this._onBtnValidateClick()):d.reject();return d},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?t.forEach(this._examples,z.hitch(this,function(d){l.create("div",{innerHTML:d,
"class":"example-url"},this.exampleTd)})):l.setStyle(this.exampleTr,"display","none");var f={multiple:this.multiple,_onTreeClick:z.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(f);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(c.after(this.urlInput,"validator",z.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(w(this.serviceBrowser,"error",z.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(f){},_validateUrl:function(f){f=f.replace(/\/*$/g,"");if((f=f.match(/\/rest\/services\/*(.*)/gi))&&0<f.length)if(f=f[0].replace(/\/rest\/services\/*/,"")){var d=f.split("/");if(1===d.length)return!0;if(2===d.length)return this.serviceBrowser.isServiceTypeSupported(d[1]);if(3<=d.length)return f=this.serviceBrowser.isServiceTypeSupported(d[1]),d=this.serviceBrowser.isServiceTypeSupported(d[2]),f||d}else return!0;else return!1},_afterUrlValidate:function(f){f&&
(f=this.urlInput.get("value"),f=this._validateUrl(f));f?l.removeClass(this.btnValidate,"jimu-state-disabled"):l.addClass(this.btnValidate,"jimu-state-disabled");return f},_onServiceBrowserError:function(f){this._showErrorMessage(f)},_showErrorMessage:function(f){f&&"string"===typeof f?(this.errorNode.innerHTML=f,l.addClass(this.errorSection,"visible")):l.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";l.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var f=new p;if(this.urlInput.validate()){var d=this.urlInput.get("value");this.serviceBrowser.setUrl(d).then(z.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();f.resolve()}),z.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();f.reject()}));this.emit("validate-click")}else f.reject();return f},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?l.removeClass(this.btnOk,"jimu-state-disabled"):
l.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var f=this.getSelectedItems();0<f.length&&this.emit("ok",f)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(H,B,C,J,G){var q=B.NodeList,p={},l=0,t=function(c){var x=G.get(c,"data-dojo-dataid");x||(x="pid"+l++,G.set(c,"data-dojo-dataid",x));return x},
z=H._nodeData=function(c,x,y){var u=t(c),f;p[u]||(p[u]={});if(1==arguments.length)return p[u];"string"==typeof x?2<arguments.length?p[u][x]=y:f=p[u][x]:f=C.mixin(p[u],x);return f},w=H._removeNodeData=function(c,x){c=t(c);p[c]&&(x?delete p[c][x]:delete p[c])};q._gcNodeData=H._gcNodeData=function(){var c=B("[data-dojo-dataid]").map(t),x;for(x in p)0>J.indexOf(c,x)&&delete p[x]};C.extend(q,{data:q._adaptWithCondition(z,function(c){return 0===c.length||1==c.length&&"string"==typeof c[0]}),removeData:q._adaptAsForEach(w)});
return q})},"widgets/Directions/setting/SearchConfig/LocatorSourceSetting":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/portalUrlUtils jimu/dijit/Message jimu/dijit/_GeocodeServiceChooserContent jimu/dijit/Popup jimu/dijit/LoadingShelter esri/request esri/lang ../../searchUtil jimu/utils dojo/text!./LocatorSourceSetting.html jimu/dijit/CheckBox dijit/form/ValidationTextBox dijit/form/NumberTextBox".split(" "),
function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,f,d,g,E,k){return H([p,l,t,G],{baseClass:"jimu-widget-search-locator-source-setting",tr:null,nls:null,config:null,singleLineFieldName:null,templateString:E,_suggestible:!1,_locatorDefinition:null,_esriLocatorRegExp:/http(s)?:\/\/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,serviceChooserContent:null,geocoderPopup:null,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exampleHint=this.nls.locatorExample+": http://\x26lt;myServerName\x26gt;/arcgis/rest/services/World/GeocodeServer";
this.searchInCurrentMapExtent=new k({checked:!1,label:this.nls.searchInCurrentMapExtent},this.searchInCurrentMapExtent);this.enableLocalSearch=new k({checked:!1,label:this.nls.enableLocalSearch},this.enableLocalSearch);this._processlocalSearchTable(!1);this.own(J(this.enableLocalSearch,"change",B.hitch(this,function(){this._processlocalSearchTable(this.enableLocalSearch.getValue())})));C.setStyle(this.enableLocalSearch.domNode,"display","none");this._setMessageNodeContent(this.exampleHint);this.autoComplete=
new k({checked:!1,label:this.nls.autoComplete},this.autoComplete);this.config=this.config?this.config:{};this.setConfig(this.config)},setRelatedTr:function(b){this.tr=b},getRelatedTr:function(){return this.tr},setDefinition:function(b){this._locatorDefinition=b||{}},getDefinition:function(){return this._locatorDefinition},setConfig:function(b){if("[object Object]"===Object.prototype.toString.call(b)){var e=b.url;e&&(this.config=b,this.shelter.show(),this._locatorDefinition.url!==e?this._getDefinitionFromRemote(e).then(B.hitch(this,
function(v){e&&v&&"error"!==v.type?(this._locatorDefinition=v,this._locatorDefinition.url=e,this._setSourceItems(),this._setMessageNodeContent(this.exampleHint)):e&&v&&"error"===v.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(f.substitute({URL:v.url},B.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setSourceItems(),this._setMessageNodeContent(this.exampleHint),this.shelter.hide()))}},isValidConfig:function(){var b=this.getConfig();return b.url&&
b.name&&b.singleLineFieldName?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.locatorUrl);this._showValidationErrorTip(this.locatorName)},getConfig:function(){var b={url:this.locatorUrl.get("value"),name:g.stripHTML(this.locatorName.get("value")),singleLineFieldName:this.singleLineFieldName,placeholder:g.stripHTML(this.placeholder.get("value")),countryCode:g.stripHTML(this.countryCode.get("value")),maxSuggestions:this.maxSuggestions.get("value")||6,searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
enableLocalSearch:this.enableLocalSearch.getValue(),localSearchMinScale:this.localSearchMinScale.get("value"),localSearchDistance:this.localSearchDistance.get("value"),type:"locator",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(b._isUpgrade=!0);return b},_onLocatorNameBlur:function(){this.locatorName.set("value",g.stripHTML(this.locatorName.get("value")))},
_onPlaceholderBlur:function(){this.placeholder.set("value",g.stripHTML(this.placeholder.get("value")))},_onCountryCodeBlur:function(){this.countryCode.set("value",g.stripHTML(this.countryCode.get("value")))},_disableSourceItems:function(){this.locatorName.set("disabled",!0);this.placeholder.set("disabled",!0);this.countryCode.set("disabled",!0);this.maxSuggestions.set("disabled",!0)},_enableSourceItems:function(){this.locatorName.set("disabled",!1);this.placeholder.set("disabled",!1);this.countryCode.set("disabled",
!1);this.maxSuggestions.set("disabled",!1)},_setSourceItems:function(){var b=this.config;b.url&&(this.locatorUrl.set("value",b.url),this._processCountryCodeRow(b.url));b.name&&this.locatorName.set("value",g.stripHTML(b.name));b.singleLineFieldName&&(this.singleLineFieldName=b.singleLineFieldName);b.placeholder&&this.placeholder.set("value",g.stripHTML(b.placeholder));this.maxSuggestions.set("value",b.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:
!0);this.searchDelay.set("value",b.searchDelay||350);this.minCharacters.set("value",b.minCharacters||3);b._oldConfig&&!b._isUpgrade&&(b._oldConfig.placeholder&&this.placeholder.set("value",g.stripHTML(b._oldConfig.placeholder)),b._oldConfig.maxLocations&&this.maxSuggestions.set("value",b._oldConfig.maxLocations),b._oldConfig.autoComplete&&this.autoComplete.setValue(b._oldConfig.autoComplete),b._oldConfig.searchDelay&&this.searchDelay.set("value",b._oldConfig.searchDelay),b._oldConfig.minCharacters&&
this.minCharacters.set("value",b._oldConfig.minCharacters),b._isUpgrade=!0);b.countryCode&&this.countryCode.set("value",g.stripHTML(b.countryCode));"capabilities"in this._locatorDefinition?(C.setStyle(this.enableLocalSearch.domNode,"display",""),this._processlocalSearchTable(b.enableLocalSearch),this.enableLocalSearch.setValue(b.enableLocalSearch),b.localSearchMinScale&&b.enableLocalSearch&&this.localSearchMinScale.set("value",b.localSearchMinScale),b.localSearchDistance&&b.enableLocalSearch&&this.localSearchDistance.set("value",
b.localSearchDistance)):(this.enableLocalSearch.setValue(!1),C.setStyle(this.enableLocalSearch.domNode,"display","none"));(this._suggestible=this._locatorDefinition&&this._locatorDefinition.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips();this.searchInCurrentMapExtent.setValue(!!b.searchInCurrentMapExtent);this._enableSourceItems()},_isEsriLocator:function(b){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(b)},
_getDefinitionFromRemote:function(b){var e=new q;if(this._isEsriLocator(b))e.resolve({singleLineAddressField:{name:"SingleLine",type:"esriFieldTypeString",alias:"Single Line Input",required:!1,length:200,localizedNames:{},recognizedNames:{}},capabilities:"Geocode,ReverseGeocode,Suggest"});else{var v=u({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(v);v.then(B.hitch(this,function(F){e.resolve(F)}),B.hitch(this,function(F){console.error(F);e.resolve({type:"error",
url:this._getRequestUrl(b)})}))}return e.promise},_setMessageNodeContent:function(b,e){C.empty(this.messageNode);b.nodeType||(b=C.toDom(b));C.place(b,this.messageNode);e?C.addClass(this.messageNode,"error-message"):C.removeClass(this.messageNode,"error-message")},_getRequestUrl:function(b){var e=window.location.protocol;return"http:"===e?z.setHttpProtocol(b):"https:"===e?z.setHttpsProtocol(b):b},_onSetLocatorUrlClick:function(){this._clickSet=!0;this._openServiceChooser()},_openLocatorChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){this.serviceChooserContent=new c({url:this.locatorUrl.get("value")||""});this.shelter=new y({hidden:!0});this.geocoderPopup=new x({titleLabel:this.nls.setGeocoderURL,autoHeight:!0,content:this.serviceChooserContent.domNode,container:window.jimuConfig.layoutId,width:640});this.shelter.placeAt(this.geocoderPopup.domNode);C.setStyle(this.serviceChooserContent.domNode,"width","580px");C.addClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content");
this.serviceChooserContent.own(J(this.serviceChooserContent,"validate-click",B.hitch(this,function(){C.removeClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content")})));this.serviceChooserContent.own(J(this.serviceChooserContent,"ok",B.hitch(this,"_onSelectLocatorUrlOk")));this.serviceChooserContent.own(J(this.serviceChooserContent,"cancel",B.hitch(this,"_onSelectLocatorUrlCancel")))},_onSelectLocatorUrlOk:function(b){b&&b[0]&&b[0].url&&this.domNode&&(this.shelter.show(),
u({url:b[0].url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(B.hitch(this,function(e){this.shelter.hide();e&&e.singleLineAddressField&&e.singleLineAddressField.name?(this._enableSourceItems(),this.locatorUrl.set("value",b[0].url),this.locatorName.get("value")||this.locatorName.set("value",d.getGeocoderName(b[0].url)),"capabilities"in e?(C.setStyle(this.enableLocalSearch.domNode,"display",""),this._isEsriLocator(b[0].url)?this.enableLocalSearch.setValue(!0):this.enableLocalSearch.setValue(!1)):
(this.enableLocalSearch.setValue(!1),C.setStyle(this.enableLocalSearch.domNode,"display","none")),this.singleLineFieldName=e.singleLineAddressField.name,this._processCountryCodeRow(b[0].url),this._locatorDefinition=e,this._locatorDefinition.url=b[0].url,(this._suggestible=e.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips(),this._clickSet?this.emit("reselect-locator-url-ok",this.getConfig()):this.emit("select-locator-url-ok",
this.getConfig()),this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null),this._setMessageNodeContent(this.exampleHint)):new w({message:this.nls.locatorWarning})}),B.hitch(this,function(e){console.error(e);this.shelter.hide();new w({message:f.substitute({URL:this._getRequestUrl(b[0].url)},B.clone(this.nls.invalidUrlTip))})})))},_onSelectLocatorUrlCancel:function(){this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null,this.emit("select-locator-url-cancel"))},_processlocalSearchTable:function(b){b?
(C.removeClass(this.minScaleNode,"hide-local-search-table"),C.removeClass(this.radiusNode,"hide-local-search-table"),b=C.getMarginBox(this.radiusHintNode),C.setStyle(this.radiusHintNode.parentNode,"paddingBottom",(45<b.h?b.h+10:45)+"px")):(C.addClass(this.minScaleNode,"hide-local-search-table"),C.addClass(this.radiusNode,"hide-local-search-table"))},_processCountryCodeRow:function(b){this._isEsriLocator(b)?(this.countryCode.set("value",""),C.removeClass(this.countryCodeRow,"hide-country-code-row")):
C.addClass(this.countryCodeRow,"hide-country-code-row")},_showSuggestibleTips:function(){C.addClass(this.tipsNode,"source-tips-show");C.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){C.removeClass(this.tipsNode,"source-tips-show");C.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(b){if(!b.validate()&&b.domNode&&b.focusNode){var e=b.get("disabled");e&&b.set("disabled",!1);b.focusNode.focus();setTimeout(B.hitch(this,
function(){b.focusNode.blur();e&&b.set("disabled",!0);b=null}),100)}}})})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(H,B,C){return H([B],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],_createServiceBrowser:function(J){return new C(J)}})})},
"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(H,B,C,J,G){return H([B],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=G.getGeocodeServiceBrowserRule()},getSelectedItems:function(){var q=this.inherited(arguments);return q=J.map(q,C.hitch(this,
function(p){return{name:p.name,url:p.url}}))}})})},"widgets/Directions/setting/BarrierLayers":function(){define("dojo/_base/declare dojo/_base/lang jimu/LayerInfos/LayerInfos dijit/form/Select dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./BarrierLayers.html".split(" "),function(H,B,C,J,G,q,p,l){return H([G,q,p],{templateString:l,constructor:function(t){t&&(this.nls=t.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this.layerInfosObj=C.getInstanceSync();
var t=[],z=[],w=[];this.layerInfosObj.traversal(B.hitch(this,function(c){"esriGeometryPoint"===c.layerObject.geometryType&&this._isLayerInMap(c)&&t.push(c);"esriGeometryPolyline"===c.layerObject.geometryType&&this._isLayerInMap(c)&&z.push(c);"esriGeometryPolygon"===c.layerObject.geometryType&&this._isLayerInMap(c)&&w.push(c)}));this.pointLayers=(new J({name:"pointLayers",options:this._getOptionsByLayers(t,this.nls.noPointBarrier)})).placeAt(this.pointLayersNode);this.pointLayers.startup();this.polylineLayers=
(new J({name:"polylineLayers",options:this._getOptionsByLayers(z,this.nls.noLineBarrier)})).placeAt(this.polylineLayersNode);this.polylineLayers.startup();this.polygonLayers=(new J({name:"polygonLayers",options:this._getOptionsByLayers(w,this.nls.noPolygonBarrier)})).placeAt(this.polygonLayersNode);this.polygonLayers.startup();this.inherited(arguments)},destroy:function(){this.pointLayers&&this.pointLayers.destroy&&(this.pointLayers.closeDropDown(),this.pointLayers.destroy());this.polylineLayers&&
this.polylineLayers.destroy&&(this.polylineLayers.closeDropDown(),this.polylineLayers.destroy());this.polygonLayers&&this.polygonLayers.destroy&&(this.polygonLayers.closeDropDown(),this.polygonLayers.destroy())},_getOptionsByLayers:function(t,z){var w=[];w.push({label:z||"",value:"",selected:"true"});z=0;for(var c=t.length;z<c;z++){var x=t[z];w.push({label:x.title||x.id,value:x.layerObject.id})}return w},validate:function(){return!0},getValue:function(){var t={pointLayers:[],polylineLayers:[],polygonLayers:[]};
t.pointLayers.push(this.pointLayers.getValue());t.polylineLayers.push(this.polylineLayers.getValue());t.polygonLayers.push(this.polygonLayers.getValue());return t},setValue:function(t){this._selectItem(this.pointLayers,t.pointLayers||[]);this._selectItem(this.polylineLayers,t.polylineLayers||[]);this._selectItem(this.polygonLayers,t.polygonLayers||[])},_selectItem:function(t,z){for(var w=t.getOptions(),c=0,x=w.length;c<x;c++)w[c].value===z[0]&&t.setValue(z[0])},_isLayerInMap:function(t){for(var z=
this.layerInfosObj.getLayerInfoArrayOfWebmap(),w=t.getRootLayerInfo(),c=0,x=z.length;c<x;c++){var y=z[c];if(y.id===t.id||w&&w.id===y.id)return!0}return!1}})})},"jimu/dijit/ServiceURLComboBox":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ComboBox","jimu/dijit/ServiceURLInput"],function(H,B,C,J){return H([J,C],{declaredClass:"jimu.dijit.ServiceURLComboBox",postCreate:function(){this.inherited(arguments);B.addClass(this.domNode,"jimu-dijit-ServiceURLComboBox")},setProcessFunction:function(){this.inherited(arguments)}})})},
"widgets/Directions/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Directions/setting/PresetDestinations.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.presetDestinations}\x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd style\x3d"width:50%;"\x3e\r\n        \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n          \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.startPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"startSearchDom" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"startSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"startSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.endPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"endSearchDom" class\x3d"end-search" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"endSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"endSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/SearchConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-config"\x3e\r\n    \x3cdiv class\x3d"dropdown-button" role\x3d"button"\x3e\r\n      \x3cdiv class\x3d"button"\x3e\r\n        \x3cspan class\x3d"button-text"\x3e${nls.add}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cul class\x3d"dropdown-menu" role\x3d"menu" data-dojo-attach-event\x3d"click:_onMenuItemClick"\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"query"\x3e${nls.searchableLayer}\x3c/li\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"locator"\x3e${nls.geocoder}\x3c/li\x3e\r\n      \x3c/ul\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sources"\x3e\r\n      \x3cdiv class\x3d"source-list jimu-float-leading"\x3e\r\n        \x3cdiv class\x3d"source-list-table" data-dojo-attach-point\x3d"sourceList"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"source-setting jimu-float-trailing" data-dojo-attach-point\x3d"sourceSettingNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/QuerySourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.layerSource}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetSourceClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"messageTr"\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second" colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip error-message"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.name}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"sourceName" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onSourceNameBlur" data-dojo-props\x3d"trim:true,required:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.placeholderText}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"placeholder" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onPlaceholderBlur" data-dojo-props\x3d"trim:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.searchFields}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"search-fields"\x3e\r\n            \x3c!-- \x3cspan class\x3d"fields jimu-float-leading" data-dojo-attach-point\x3d"fieldsNode"\x3e\x3c/span\x3e --\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchFields" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'95%\'}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"search-fields-selector jimu-float-trailing" data-dojo-attach-point\x3d"fieldsSelectorNode" data-dojo-attach-event\x3d"click:_onFieldsSelectorClick"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.displayField}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"displayField" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d\'style:{width:"100%"}\'\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"source-tips" title\x3d"${nls.searchLayerTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n            \x3cem\x3e${nls.searchLayerTips}\x3c/em\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"exactMatch"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/FeaturelayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flcContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"hflcContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flscContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/FeaturelayerChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/LocatorSourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.locatorUrl}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"locatorUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetLocatorUrlClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section" data-dojo-attach-point\x3d"detailsSection"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.locatorName}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"locatorName" data-dojo-attach-event\x3d"Blur: _onLocatorNameBlur"\r\n            placeHolder\x3d"${nls.locatorName}"\r\n            required\x3d"true" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.placeholderText}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"placeholder"\r\n            data-dojo-attach-event\x3d"Blur: _onPlaceholderBlur"\r\n            placeHolder\x3d"${nls.placeholderText}" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"hide-country-code-row country-code-row" data-dojo-attach-point\x3d"countryCodeRow"\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.countryCode}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"countryCode"\r\n            data-dojo-attach-event\x3d"Blur:_onCountryCodeBlur"\r\n            placeHolder\x3d"${nls.countryCodeEg} USA,CHN" data-dojo-props\x3d\'style:{width:"96%"}\'/\x3e\r\n            \x3ca class\x3d"jimu-float-trailing" target\x3d"_blank" href\x3d"https://developers.arcgis.com/rest/geocode/api-reference/geocode-coverage.htm" style\x3d"line-height:30px;"\x3e\r\n              \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n            \x3c/a\x3e\r\n            \x3cspan class\x3d"example"\x3e${nls.countryCodeHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"source-tips" title\x3d"${nls.locatorTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n              ${nls.locatorTips}\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first" colspan\x3d"2"\x3e\r\n            \x3cspan class\x3d"source-label" data-dojo-attach-point\x3d"enableLocalSearch"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"minScaleNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.minScale}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan class\x3d"jimu-float-leading" style\x3d"line-height:30px;"\x3e1: \x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-float-trailing" data-dojo-attach-point\x3d"localSearchMinScale" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'96%\'},value:300000"\x3e\x3c/div\x3e\r\n            \x3cspan class\x3d"example" title\x3d"${nls.minScaleHint}"\x3e${nls.minScaleHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"radiusNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.radius}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"jimu-float-leading" style\x3d"width:100%;"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading" data-dojo-attach-point\x3d"localSearchDistance" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'75%\'},value:50000"\x3e\x3c/div\x3e\r\n              \x3cspan class\x3d"jimu-float-trailing" style\x3d"line-height:30px;"\x3e${nls.meters}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cspan class\x3d"example" data-dojo-attach-point\x3d"radiusHintNode" title\x3d"${nls.radiusHint}"\x3e${nls.radiusHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \r\n    \x3ctable class\x3d"source-table" style\x3d"margin-left: -2px;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Directions/setting/BarrierLayers.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.barrierLayers}\x3c/span\x3e\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.pointBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"pointLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.lineBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polylineLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.polygonBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polygonLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:auto;"\x3e\r\n\t\x3cdiv class\x3d"query-setting-content" data-dojo-attach-point\x3d"content"\x3e\r\n\t\t\x3c!-- search tab --\x3e\r\n\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"searchTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"searchConfigNode"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3c!-- route tab --\x3e\r\n\t\t\x3cdiv class\x3d"route-section" data-dojo-attach-point\x3d"routeTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"200px" /\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"auto" /\x3e\r\n\t\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.routeUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"route-td"\x3e\r\n\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"routeUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLComboBox" data-dojo-attach-props\x3d"trim:true;hasDownArrow:false;autoComplete:true"\r\n\t\t\t\t\t\t\t id\x3d"routeLayer" name\x3d"routeLayer" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.travelModesUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"travelmodes-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"travelModesUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.trafficLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"trafficlayer-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"trafficLayerUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.barrierLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\x3cspan class\x3d"title"\x3e${nls.routeOptions}\x3c/span\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsLanguage}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"directionsLanguage" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n\t\t\t\t\t\t\t\t\t\t\t data-dojo-props\x3d\'required:true\' style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"length-units jimu-ellipsis"\x3e${nls.directionsLengthUnits}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsLengthUnits" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriFeet"\x3e${nls.feet}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriKilometers" selected\x3e${nls.kilometers}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMeters"\x3e${nls.meters}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriNauticalMiles"\x3e${nls.nauticalMiles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriYards"\x3e${nls.yards}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;display: none;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsOutputType}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsOutputType" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"standard"\x3e${nls.standard}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete" selected\x3e${nls.complete}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete-no-events"\x3e${nls.completeNoEvents}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"instructions-only"\x3e${nls.instructionsOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"summary-only"\x3e${nls.summaryOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.impedanceAttribute}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"impedanceAttribute" data-dojo-type\x3d"dijit/form/ValidationTextBox" style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\r\n\t\t\x3c!-- preset destinations --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"presetDestinations"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3c!-- BarrierLayers --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"barrierLayersNode"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/css/style.css":".jimu-widget-directions-setting{font-size: 14px; margin-bottom: 20px;}.jimu-widget-directions-setting .title{display:inline-block; font-size: 16px; font-weight:bold; margin:10px 0 5px 0px;}.jimu-widget-directions-setting .route-section table \x3e tbody \x3e tr \x3e td{padding:5px 0;}.jimu-widget-directions-setting .route-td{padding-left: 10px;}.jimu-widget-directions-setting .jimu-ellipsis{white-space: normal;}.jimu-rtl .jimu-widget-directions-setting .route-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .locator-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .locator-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .travelmodes-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .travelmodes-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .trafficlayer-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .trafficlayer-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .auto-complete-td span{margin-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .auto-complete-td span{margin-left: 0px; margin-right: 10px;}.jimu-widget-directions-setting .searchResults.arcgisSearch{position: relative;}.jimu-widget-directions-setting .arcgisSearch{width: 220px;}.jimu-widget-directions-setting .arcgisSearch .searchMenu {position: absolute;}.jimu-widget-directions-setting .arcgisSearch .searchMenu.searchResultsMenu{width: 220px !important;}.jimu-widget-directions-setting .arcgisSearch .showNoResults .noResultsMenu{height: 122px;}.jimu-widget-directions-setting .arcgisSearch .hasValue.showNoResults .noResultsMenu{display: block !important;}.jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{width:168px; padding: 6px; border-radius: 0; border-left: 6px green solid; overflow: hidden; text-overflow:ellipsis; white-space: nowrap;}.jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: 6px red solid;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px green solid;}.jimu-rtl .jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px red solid;}.jimu-widget-directions-setting .arcgisSearch .searchBtn{border-radius: 0; border-left: 0; padding: 6px;}.jimu-widget-directions-setting .searchGroup .searchExpandContainer .searchBtn.searchToggle{display: none;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchBtn{border-right: 0; border-left: 1px solid #57585A;}.jimu-widget-directions-setting .arcgisSearch .searchClear{display: none;}.jimu-widget-directions-setting .hide{display: none;}.jimu-widget-directions-setting .preset-des-error{color:red;}.jimu-widget-directions-setting .barrierLayersNode{padding: 5px 0;}.jimu-widget-directions-setting .barrierLayersNode \x3e table{background-color: transparent; width: 100%;}.search-config .group-label{display: inline-block; margin-bottom: 10px; font-weight: bold;}.search-config .instruction{font-size: 12px;}.search-config .dropdown-button {margin: 8px 0; display: inline-block; position: relative; padding-left: 16px; color: #518dca; background: url(images/add_icon.png) no-repeat left; cursor: pointer;}.jimu-rtl .search-config .dropdown-button{padding-left: 0; padding-right: 16px; background-position: right;}.search-config .dropdown-button .dropdown-menu{position: absolute; display: none; list-style-type: none; top: 16px; left: 0; margin: 0; padding: 0; background: #fafafa; color: #7989a0; z-index: 999;}.jimu-rtl .search-config .dropdown-button .dropdown-menu{right: 0; left: auto;}.search-config .dropdown-button:hover .dropdown-menu{display: inline-block;}.search-config .dropdown-menu .dropdown-item{white-space: nowrap; height: 30px; padding: 0 25px; line-height: 30px;}.search-config .dropdown-menu .dropdown-item:hover{background: #edf2f5; color: #15a4fa;}.search-config .sources{height: 366px;}.search-config .source-list{width: 270px; height: 100%;}.search-config .source-setting{width: 660px; position: relative; overflow: auto; padding-right: 5px;}.search-config .source-setting .source-tips{display: none; font-size: 12px; color: #999;}.search-config .source-setting .source-tips-show{display: block;}.search-config .source-table,.search-config .general-setting-table{width: 100%;}.search-config .search-fields-selector {display: inline-block; margin: 6px 0; width: 18px; height: 18px; background: url(images/selector.png) no-repeat center;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row td,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row td{padding-bottom: 35px; position: relative;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .first{padding-left: 20px;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row a{text-decoration: none;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{color: #485566; font-style: normal;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{transform: rotateY(180deg); display: inline-block;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .example{position: absolute; top: 35px; left: 0; font-size: 12px; color: #999;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example{left: auto; right: 0;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .hide-country-code-row,.search-config .jimu-widget-search-locator-source-setting .hide-local-search-table {display: none;}.search-config .source-url-section .source-table \x3e tbody \x3e tr:first-child \x3e td {padding-bottom: 5px;}.search-config .source-table \x3e tbody \x3e tr \x3e td{padding-bottom: 10px;}.search-config .source-table \x3e tbody \x3e tr \x3e .first{width: auto; text-align: left; padding-right: 10px; white-space: nowrap;}.search-config .source-table \x3e tbody \x3e tr \x3e .second{width:550px;}.search-config .source-table \x3e tbody \x3e tr \x3e .third{width: 70px; padding-left: 10px;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{padding-left: 10px; padding-right: 0;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{text-align: right; padding-left: 10px; padding-right: auto;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .third{padding-left: 0; padding-right: 10px;}.jimu-widget-query-source-setting .source-url-section .source-table \x3e tbody \x3e tr \x3e .second {width: 455px;}.search-config .source-table .jimu-btn{padding: 0; line-height: 30px; width: 60px;}.search-config .source-table \x3e tbody \x3e tr \x3e .second .tip{font-size: 12px; color: #999; width: 100%; display: inline-block;}.search-config .source-table .error-message{color: #e84b4b !important;}.search-config .jimu-basic-service-chooser {width: auto;}.search-config .override-geocode-service-chooser-content {width: 580px !important; min-height: 150px !important;}.search-config .override-geocode-service-chooser-content .service-browser-container{display: none;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{width: 167px; margin-bottom: 20px; color: #596679; font-size: 14px; margin-left: 30px;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox .label{width: 140px;}.jimu-rtl .direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{margin-right: 30px; margin-left: auto;}",
"*now":function(H){H(['dojo/i18n!*preload*widgets/Directions/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/_base/config dojo/Deferred dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils jimu/portalUtils ./PresetDestinations ./SearchConfig/SearchConfig jimu/dijit/Message ../searchUtil ./BarrierLayers jimu/dijit/TabContainer jimu/dijit/CheckBox jimu/dijit/ServiceURLComboBox jimu/dijit/ServiceURLInput dijit/form/NumberSpinner dijit/form/ValidationTextBox dijit/form/Select".split(" "),function(H,B,C,J,G,q,p,l,t,z,w,c,x,y,u,
f){return H([l,p],{baseClass:"jimu-widget-directions-setting",_ROUTE_WORLD:"Route_World",_serviceUrlInputInvalidClass:"jimu-serviceurl-input-invalid",_routeTaskUrl:"http://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/",_locatorUrl:"http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",_travelModesUrl:"http://logistics.arcgis.com/arcgis/rest/services/World/Utilities/GPServer",_trafficLayerUrl:"http://traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",postMixInProperties:function(){this.nls.complete||
(this.nls.complete="Complete");this.nls.completeNoEvents||(this.nls.completeNoEvents="Complete No Events");this.nls.instructionsOnly||(this.nls.instructionsOnly="Instructions Only");this.nls.standard||(this.nls.standard="Standard");this.nls.summaryOnly||(this.nls.summaryOnly="Summary Only");this.nls.travelModesUrl||(this.nls.travelModesUrl="Travel Modes URL");this.nls.example||(this.nls.example=this.nls.optional+" "+window.jimuNls.basicServiceChooser.example+" : ")},postCreate:function(){this.inherited(arguments);
this.portal=z.getPortal(this.appConfig.portalUrl);this.routeUrl.setProcessFunction(B.hitch(this,function(d){var g=!1;d&&d.data&&(g="esriNAServerRouteLayer"===d.data.layerType);if(!0===g)return g;this._setRouteUrl(d);d=this._getHandledUrlFromServiceUrlInput(this.routeUrl);return/\/rest\/services\/.+\/NAServer/i.test(d)}));this.travelModesUrl.setProcessFunction(B.hitch(this,function(){var d=this._getHandledUrlFromServiceUrlInput(this.travelModesUrl);return/\/rest\/services\/.+\/GPServer/gi.test(d)}),
B.hitch(this,function(){this.travelModesUrl.get("value")||J.removeClass(this.travelModesUrl.domNode,this._serviceUrlInputInvalidClass)}));this.trafficLayerUrl.setProcessFunction(B.hitch(this,function(){var d=this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl);return/\/rest\/services\/.+\/MapServer/gi.test(d)}),B.hitch(this,function(){this.trafficLayerUrl.get("value")||J.removeClass(this.trafficLayerUrl.domNode,this._serviceUrlInputInvalidClass)}));this.portal.loadSelfInfo().then(B.hitch(this,
function(d){var g=this._getRouteUrlFromPortalSelf(d);g&&this.routeUrl.set("placeHolder",g);(g=this._getTravelModesUrlFromPortalSelf(d))?this.travelModesUrl.set("placeHolder",this.nls.example+g):this.travelModesUrl.set("placeHolder",this.nls.example+this._travelModesUrl);(d=this._getTrafficLayerUrlFromPortalSelf(d))?this.trafficLayerUrl.set("placeHolder",this.nls.example+d):this.trafficLayerUrl.set("placeHolder",this.nls.example+this._trafficLayerUrl)}));this.barrierLayers=new u({nls:this.nls,map:this.map,
barrierLayers:this.config.barrierLayers},this.barrierLayersNode);this.barrierLayers.startup();this.presetDestinations=new w({nls:this.nls,map:this.map,defaultLocations:this.config.defaultLocations||[]},this.presetDestinations);this.presetDestinations.startup()},_getHandledUrlFromServiceUrlInput:function(d){d=d.get("value");return t.removeSuffixSlashes(d)},startup:function(){this.inherited(arguments);this.tabContainer=new f({tabs:[{title:this.nls.searchTabTitle,content:this.searchTabNode},{title:this.nls.routeTabTitle,
content:this.routeTabNode}],isNested:!0},this.content);this.tabContainer.startup();this.own(C(this.tabContainer,"tabChanged",B.hitch(this,function(d){d===this.nls.routeTabTitle&&this._setPresetDestinationsSources()})));this.searchConfig=new c({nls:this.nls,map:this.map,appConfig:this.appConfig,config:this.config},this.searchConfigNode);this.searchConfig.startup();this.own(C(this.searchConfig,"isConfigValid",B.hitch(this,function(d){"true"===d?this.settingPagePopup.enableButton(0):this.settingPagePopup.disableButton(0)})));
this.setConfig(this.config)},destroy:function(){this.directionsLengthUnits&&this.directionsLengthUnits.destroy&&(this.directionsLengthUnits.closeDropDown(),this.directionsLengthUnits.destroy());this.barrierLayers&&this.barrierLayers.destroy&&this.barrierLayers.destroy();this.inherited(arguments)},setConfig:function(d){if(this.config=d)(d=this.config.routeOptions)&&"object"===typeof d&&(this.directionsLanguage.set("value",d.directionsLanguage||G.locale||"en_us"),this.directionsLengthUnits.set("value",
d.directionsLengthUnits),this.impedanceAttribute.set("value",d.impedanceAttribute)),this._getRouteTaskUrl().then(B.hitch(this,function(g){this.routeUrl.set("value",g)})),this.config.travelModesUrl&&this.travelModesUrl.set("value",this.config.travelModesUrl),this.config.trafficLayerUrl&&this.trafficLayerUrl.set("value",this.config.trafficLayerUrl),this.config.barrierLayers&&this.barrierLayers.setValue(this.config.barrierLayers)},_getRouteTaskUrl:function(){var d=new q;this.config.routeTaskUrl?d.resolve(this.config.routeTaskUrl):
this.portal.loadSelfInfo().then(B.hitch(this,function(g){(g=this._getRouteUrlFromPortalSelf(g))?d.resolve(g):d.resolve(this._routeTaskUrl)}),B.hitch(this,function(g){console.error(g);d.resolve(this._routeTaskUrl)}));return d},_suffixWithSlant:function(d,g){return d=this._endsWith(d,"/")?d+g:d+("/"+g)},_endsWith:function(d,g){return-1!==d.indexOf(g,d.length-g.length)},_getRouteUrlFromPortalSelf:function(d){var g="";d&&d.helperServices&&(d=d.helperServices.route)&&d.url&&(g=d.url);return g},_getTravelModesUrlFromPortalSelf:function(d){var g=
"";d&&d.helperServices&&(d=d.helperServices.routingUtilities)&&d.url&&(g=d.url);return g},_getTrafficLayerUrlFromPortalSelf:function(d){var g="";d&&d.helperServices&&(d=d.helperServices.traffic)&&d.url&&(g=d.url);return g},getConfig:function(){if("valid"!==this.routeUrl.getStatus())return this._showValidationErrorTip(this.routeUrl),this._showParametersTip(),!1;if(this.travelModesUrl.get("value")&&"valid"!==this.travelModesUrl.getStatus())return this._showValidationErrorTip(this.travelModesUrl),this._showParametersTip(),
!1;if(this.trafficLayerUrl.get("value")&&"valid"!==this.trafficLayerUrl.getStatus())return this._showValidationErrorTip(this.trafficLayerUrl),this._showParametersTip(),!1;if(!this.directionsLanguage.validate())return this._showValidationErrorTip(this.directionsLanguage),this._showParametersTip(),!1;if(!this.barrierLayers.validate())return this._showValidationErrorTip(this.barrierLayers),this._showParametersTip(),!1;if(this.presetDestinations&&!1===this.presetDestinations.validate()||!1===this.searchConfig.validate())return!1;
var d=this.searchConfig.getConfig();this.config={routeTaskUrl:this._getHandledUrlFromServiceUrlInput(this.routeUrl),travelModesUrl:this._getHandledUrlFromServiceUrlInput(this.travelModesUrl),trafficLayerUrl:this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl),routeOptions:{directionsLanguage:this.directionsLanguage.get("value"),directionsLengthUnits:this.directionsLengthUnits.get("value"),impedanceAttribute:this.impedanceAttribute.get("value")},searchOptions:d,defaultLocations:this.presetDestinations.getValue(),
barrierLayers:this.barrierLayers.getValue()};y.version.upgradeConfig(this.config);return this.config},_showValidationErrorTip:function(d){!d.validate()&&d.domNode&&d.focusNode&&(d.focusNode.focus(),setTimeout(B.hitch(this,function(){d.focusNode.blur()}),100))},_showParametersTip:function(){new x({message:this.nls.parametersTip})},_setRouteUrl:function(d){if(d&&d.data&&d.data.routeLayers){for(var g=this.routeUrl.getValue(),E=!1,k=0,b=d.data.routeLayers.length;k<b;k++){var e=d.data.routeLayers[k],v=
{id:e,name:this._suffixWithSlant(g,e),value:this._suffixWithSlant(g,e)};e===this._ROUTE_WORLD&&(E=!0);this.routeUrl.store.put(v)}E&&this.routeUrl.setValue(this._suffixWithSlant(g,this._ROUTE_WORLD))}},_setPresetDestinationsSources:function(){var d=this.searchConfig.getConfig();this.presetDestinations.setSources(d)}})});