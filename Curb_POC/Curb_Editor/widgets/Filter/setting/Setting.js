// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Filter/setting/SingleFilterSetting":function(){define("dojo/on dojo/query dojo/Evented dojo/_base/lang dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleFilterSetting.html jimu/utils jimu/dijit/Filter jimu/dijit/Message jimu/dijit/CheckBox jimu/dijit/TabContainer3 jimu/dijit/LayerChooserFromMapWithDropbox ../CustomFeaturelayerChooserFromMap esri/symbols/PictureMarkerSymbol esri/symbols/jsonUtils jimu/dijit/ImageChooser jimu/dijit/SymbolPicker dijit/form/ValidationTextBox".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D,e,c,g,t,y,I,q){return h([f,k,l,A],{baseClass:"jimu-widget-singlefilter-setting",templateString:v,jimuNls:null,_defaultTaskIcon:null,map:null,nls:null,target:null,layerInfosObj:null,folderUrl:"",appConfig:null,postMixInProperties:function(){this.inherited(arguments);this._defaultTaskIcon=this.folderUrl+"css/images/default_task_icon.png";this.jimuNls=window.jimuNls},postCreate:function(){this.inherited(arguments);this._initOptions();this._recreateLayerChooserSelect(!0);
this.filter=new D({enableAskForValues:!0,noFilterTip:this.nls.noFilterTip,style:"width:100%;"});this.filter.placeAt(this.filterDiv);this._setDefaultTaskIcon();this.own(p(this.filter,"filter-number-change",r.hitch(this,this.calculateExpsBoxMaxHeight)));this.calculateExpsBoxMaxHeight();this._initTabs()},_initOptions:function(){this.cbxRemoveMapFilter=new c({label:this.nls.enableMapFilter||""});this.cbxRemoveMapFilter.placeAt(this.useMapFilterNode);this.cbxRemoveMapFilter.setValue(!1);this.cbxAutoApplyWhenWidgetOpen=
new c({label:this.nls.autoApplyWhenWidgetOpen||""});this.cbxAutoApplyWhenWidgetOpen.placeAt(this.autoApplyWhenWidgetOpenNode);this.cbxAutoApplyWhenWidgetOpen.setValue(!1);this.cbxCollapseFilter=new c({label:this.nls.collapseFiltersTip||""});this.cbxCollapseFilter.placeAt(this.collapseFilterNode);this.cbxCollapseFilter.setValue(!1)},_initTabs:function(){this.tab=new g({tabs:[{title:this.nls.info,content:this.infoTabNode},{title:this.nls.expressions,content:this.expressionsTabNode},{title:this.jimuNls.common.options,
content:this.optionsTabNode}]});this.tab.placeAt(this.tabsNode);this.own(p(this.tab,"tabChanged",r.hitch(this,function(){})))},_recreateLayerChooserSelect:function(m){this.layerChooserSelect&&this.layerChooserSelect.destroy();this.layerChooserSelect=null;var d=new y({showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,onlyShowWebMapLayers:!0,createMapResponse:this.map.webMapResponse});this.layerChooserSelect=new t({layerChooser:d});this.layerChooserSelect.placeAt(this.layerTd);m&&this._bindEventForLayerChooserSelect(this.layerChooserSelect)},
showLayerChooserPopup:function(){this.layerChooserSelect.showLayerChooser()},destroy:function(){this.target=null;this.emit("before-destroy");this.inherited(arguments)},setConfig:function(m){var d=r.clone(m);this._showLoading();this.reset();this._recreateLayerChooserSelect(!1);var n=r.hitch(this,function(){this.domNode&&(this._bindEventForLayerChooserSelect(this.layerChooserSelect),this._hideLoading())});this.layerInfosObj.getLayerInfoById(d.layerId).getLayerObject().then(r.hitch(this,function(w){this.domNode&&
this.layerChooserSelect.setSelectedLayer(w).then(r.hitch(this,function(z){this.domNode&&(this._hideLoading(),z&&(z=d.icon?d.icon:this._defaultTaskIcon,z=d.symbol?q.fromJson(d.symbol):new I({yoffset:16,type:"picturemarkersymbol",url:z,width:24,height:24,size:16,xoffset:0}),this.symbolPicker.showBySymbol(z),this.cbxRemoveMapFilter.setValue(!d.enableMapFilter),this.cbxAutoApplyWhenWidgetOpen.setValue(d.autoApplyWhenWidgetOpen),this.cbxCollapseFilter.setValue(d.collapse),this.nameTextBox.set("value",
d.name),this.filter.featureLayerId=w.id,this.filter.buildByFilterObj(w.url,d.filter,w),this._bindEventForLayerChooserSelect(this.layerChooserSelect)))}),r.hitch(this,function(z){console.error(z);n()}))}),r.hitch(this,function(w){console.error(w);n()}))},getConfig:function(){var m={layerId:null,url:null,name:null,filter:null,icon:null,enableMapFilter:!this.cbxRemoveMapFilter.getValue(),autoApplyWhenWidgetOpen:this.cbxAutoApplyWhenWidgetOpen.getValue(),collapse:this.cbxCollapseFilter.getValue()},d=
this.layerChooserSelect.getSelectedItem();if(!d)return this._showMessage(this.nls.selectLayerTip),!1;d=d.layerInfo.layerObject;m.layerId=d.id;m.url=d.url;m.name=this.nameTextBox.get("value");if(!m.name)return this._showMessage(this.nls.setTitleTip),!1;m.symbol=this.symbolPicker.getSymbol().toJson();m.filter=this.filter.toJson();return m.filter?this.target.singleConfig=m:(this._showMessage(window.jimuNls.filterBuilder.setFilterTip),!1)},calculateExpsBoxMaxHeight:function(){},reset:function(){this._setDefaultTaskIcon();
this.cbxRemoveMapFilter.setValue(!1);this.nameTextBox.set("value","");this.filter.reset()},_setDefaultTaskIcon:function(){this.symbolPicker.showByType("marker")},_onNameTextBoxChanged:function(){var m=C(".label",this.target)[0],d=this.nameTextBox.get("value");m.innerHTML=d;m.title=d},_bindEventForLayerChooserSelect:function(m){m.isBindEvent||(this.own(p(m,"selection-change",r.hitch(this,this._onLayerChanged))),m.isBindEvent=!0)},_showMessage:function(m){new e({message:m})},_onLayerChanged:function(){this.reset();
var m=this.layerChooserSelect.getSelectedItem();if(m){m=m.layerInfo;var d=m.layerObject;this.nameTextBox.set("value",m.title);this.filter.featureLayerId=d.id;this.filter.buildByExpr(d.url,"1\x3d1",d)}},_getLayerDefinitionForFilterDijit:function(m){var d=null;"esri.layers.FeatureLayer"===m.declaredClass&&(d=B.getFeatureLayerDefinition(m));d||(d={currentVersion:m.currentVersion,fields:r.clone(m.fields)});return d},_showLoading:function(){this.emit("loading")},_hideLoading:function(){this.emit("unloading")}})})},
"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),function(p,C,A,r,h,f,k,l,v,B,D,e){return p([v,B,f],{templateString:D,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,
_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource;this.nls.customSelectLayer=this.label?this.label:this.nls.selectLayer},postCreate:function(){this.inherited(arguments);this.layerInfosObj=e.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(r(this.layerChooser,
"tree-click",C.hitch(this,this._onTreeClick)));this.own(r(this.layerChooser,"update",C.hitch(this,this._onLayerChooserUpdate)));this.own(r(document.body,"click",C.hitch(this,this._onBodyClicked)));this.own(r(document.body,"keydown",C.hitch(this,function(c){c.keyCode===h.ENTER&&this._onBodyClicked(c)})));this.own(r(this.layerChooser.domNode,"keydown",C.hitch(this,function(c){c.keyCode===h.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();
this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(c){var g=new k;if(c){var t=this.layerInfosObj.getLayerOrTableInfoById(c.id);t?this.layerChooser.filter(t).then(C.hitch(this,function(y){y?(this._onSelectNewItem({layerInfo:t,name:t.title,url:c.url}),g.resolve(!0)):g.resolve(!1)}),C.hitch(this,function(){g.resolve(!1)})):g.resolve(!1)}else this._onSelectNewItem(null),g.resolve(!0);return g},getSelectedItem:function(){return this._selectedItem},
getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(c){c=c.target||c.srcElement;c===this.domNode||A.isDescendant(c,this.domNode)||c===this.layerChooser.domNode||A.isDescendant(c,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(c){c.stopPropagation();c.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(c){c.keyCode===h.ENTER&&this._onDropDownClick(c)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},
showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";l.open({parent:this,popup:this.layerChooser,around:this.domNode});var c=this.layerChooser.domNode.parentNode;c&&(A.addClass(c,"jimu-layer-chooser-from-map-withdropbox-popup"),this.customClass&&A.addClass(c,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){l.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),
this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(c){var g=C.getObject("layerInfo.id",!1,this._selectedItem)||-1,t=C.getObject("layerInfo.id",!1,c)||-1;g=g!==t;this._selectedItem=c;this.hideLayerChooser();c=C.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=c;A.setAttr(this.layerNameNode,
"title",c);c=C.getObject("layerInfo.layerObject",!1,this._selectedItem);g&&this.emit("selection-change",[c])},_onTreeClick:function(){var c=this._getSelectedItems();this._onSelectNewItem(0<c.length?c[0]:null)}})})},"widgets/Filter/CustomFeaturelayerChooserFromMap":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","jimu/dijit/LayerChooserFromMap","jimu/dijit/QueryableLayerChooserFromMap"],function(p,C,A,r,h){return p([h],{postMixInProperties:function(){this.inherited(arguments);
this.filter=C.hitch(this,r.andCombineFilters([this.filter,C.hitch(this,this._customFilter)]));this.displayTooltipForTreeNode=!0},_customFilter:function(f){var k=new A;f.isTable?k.resolve(!1):f.getLayerObject().then(C.hitch(this,function(l){"esri.layers.ArcGISDynamicMapServiceLayer"===l.declaredClass?k.resolve(10<=l.version):"esri.layers.ArcGISTiledMapServiceLayer"===l.declaredClass?k.resolve(!1):k.resolve(!0)}),C.hitch(this,function(l){console.error(l);k.resolve(!1)}));return k}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D,e,c,g,t,y,I,q){var m=A([r,h,f,C],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new q({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=e.hitch(this,this.basicFilter);
this.filter=m.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(d){var n=new l;this.onlyShowVisible?n.resolve(d.isShowInMap()):n.resolve(!0);return n},filter:function(d){d=new l;d.resolve(!0);return d},getSelectedItems:function(){var d=this.tree.getSelectedItems();return g.map(d,e.hitch(this,function(n){return this.getHandledItem(n)}))},getAllItems:function(){var d=this.tree.getAllItems(),n=[];g.forEach(d,
e.hitch(this,function(w){"root"!==w.id&&(w=this.getHandledItem(w),n.push(w))}));return n},getHandledItem:function(d){return{name:d.name,layerInfo:d.layerInfo}},_isLeafItem:function(d){return d.isLeaf},setCreateMapResponse:function(d){this.createMapResponse=d;I.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(e.hitch(this,function(n){this.layerInfosObj=n;this.own(p(this.layerInfosObj,"layerInfosChanged",e.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(p(this.layerInfosObj,"layerInfosIsShowInMapChanged",e.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(d,n){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(d){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(d){this._clear();c.setStyle(this.errorTipSection,"display","block");var n=[];this.onlyShowWebMapLayers?(n=d.getLayerInfoArrayOfWebmap(),
n=n.concat(d.getTableInfoArrayOfWebmap())):(n=d.getLayerInfoArray(),n=n.concat(d.getTableInfoArray()));0!==n.length&&(c.setStyle(this.errorTipSection,"display","none"),g.forEach(n,e.hitch(this,function(w){this._addDirectLayerInfo(w)})))},_addDirectLayerInfo:function(d){d&&d.getLayerObject().then(e.hitch(this,function(){this._addItem("root",d)}),e.hitch(this,function(n){console.error(n)}))},_clear:function(){var d=this._store.query({parent:"root"});g.forEach(d,e.hitch(this,function(n){n&&"root"!==
n.id&&this._store.remove(n.id)}))},_addItem:function(d,n){var w=null,z=n.getLayerType(),H=this.filter(n);D({layerType:z,valid:H}).then(e.hitch(this,function(F){if(F.valid){var L=e.hitch(this,function(P,T){this._id++;w={name:n.title||"",parent:d,layerInfo:n,type:F.layerType,layerClass:n.layerObject.declaredClass,id:this._id.toString(),isLeaf:P,hasChildren:T};this._store.add(w)}),G=n.getSubLayers(),J=0===G.length,Q=!0;this.onlyFilterCurrentLayerWhenAddItem?(J&&(Q=!1),L(J,Q)):J?L(J,!1):(G=g.map(G,e.hitch(this,
function(P){return this.filter(P)})),D(G).then(e.hitch(this,function(P){(P=g.some(P,function(T){return T}))&&L(J,P)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var d=this._getRootItem();d=new k({data:[d],getChildren:function(n){return this.query({parent:n.id})}});this._store=new v(d);d=new B({store:this._store,query:{id:"root"},mayHaveChildren:e.hitch(this,this._mayHaveChildren)});this.tree=new y({multiple:this.multiple,
model:d,showRoot:!1,isLeafItem:e.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:e.hitch(this,function(n,w){"root"!==n.id&&this._onTreeOpen(n,w)}),onClick:e.hitch(this,function(n,w,z){this._onTreeClick(n,w,z);this.emit("tree-click",n,w,z)}),getIconStyle:e.hitch(this,function(n,w){var z=null;if(!n||"root"===n.id)return null;var H={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},F=window.location.protocol+"//"+window.location.host+
require.toUrl("jimu");if(n=this._getIconInfo(n,w).imageName)H.backgroundImage="url("+F+"/css/images/"+n+")",z=H;return z}),getIconClass:e.hitch(this,function(n,w){return this._getIconInfo(n,w).className}),getTooltip:e.hitch(this,function(n){return this.displayTooltipForTreeNode?n.layerInfo.title:""})});c.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(d){return d.hasChildren},_getIconInfo:function(d,n){var w="",z="";"ArcGISDynamicMapServiceLayer"===
d.type||"ArcGISTiledMapServiceLayer"===d.type?n?(w="mapserver_open.png",z="mapservice-layer-icon open"):(w="mapserver_close.png",z="mapservice-layer-icon close"):"GroupLayer"===d.type?n?(w="group_layer2.png",z="group-layer-icon open"):(w="group_layer1.png",z="group-layer-icon close"):"FeatureLayer"===d.type?(d=t.getTypeByGeometryType(d.layerInfo.layerObject.geometryType),"point"===d?(w="point_layer1.png",z="point-layer-icon"):"polyline"===d?(w="line_layer1.png",z="line-layer-icon"):"polygon"===d&&
(w="polygon_layer1.png",z="polygon-layer-icon")):"Table"===d.type?(w="table.png",z="table-icon"):"ArcGISImageServiceLayer"===d.type||"ArcGISImageServiceVectorLayer"===d.type?(w="image_layer.png",z="iamge-layer-icon"):n?(w="mapserver_open.png",z="mapservice-layer-icon open"):(w="mapserver_close.png",z="mapservice-layer-icon close");return{imageName:w,className:z}},_onTreeOpen:function(d,n){if("root"!==d.id){var w=[];n=[];w=d.layerInfo.getSubLayers();d.checked||(this.shelter.show(),n=g.map(w,e.hitch(this,
function(z){return z.getLayerObject()})),D(n).then(e.hitch(this,function(){this.domNode&&(g.forEach(w,e.hitch(this,function(z){this._addItem(d.id,z)})),d.checked=!0,this.shelter.hide())}),e.hitch(this,function(z){console.error(z);this.shelter.hide()})))}},_onTreeClick:function(d,n,w){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});m.createFilterByLayerType=function(d){e.isArrayLike(d)||(d=[]);return function(n){var w=
new l;if(0===d.length)w.resolve(!0);else{var z=[];n.traversal(function(H){z.push(H.getLayerType())});D(z).then(function(H){for(var F=0;F<H.length;F++)for(var L=0;L<d.length;L++)if(H[F]===d[L]){w.resolve(!0);return}w.resolve(!1)},function(H){console.error(H);w.reject(H)})}return w}};m.createFeaturelayerFilter=function(d,n,w,z){var H=["point","polyline","polygon"];d&&0<d.length?(d=g.filter(d,function(F){return 0<=H.indexOf(F)}),0===d.length&&(d=H)):d=H;return function(F){var L=F.getLayerType();F=F.getLayerObject();
return D({layerType:L,layerObject:F}).then(function(G){var J=G.layerType;G=G.layerObject;if("ArcGISDynamicMapServiceLayer"===J||"ArcGISTiledMapServiceLayer"===J||"GroupLayer"===J||"FeatureCollection"===J)return!0;if("FeatureLayer"===J){J=t.getTypeByGeometryType(G.geometryType);J=0<=g.indexOf(d,J);var Q=m._shouldPassStatisticsCheck(z,G);return G.url?(G=t.isFeaturelayerUrlSupportQuery(G.url,G.capabilities),J&&G&&Q):n&&J}return"Table"===J?(J=t.isFeaturelayerUrlSupportQuery(G.url,G.capabilities),G=m._shouldPassStatisticsCheck(z,
G),w&&J&&G):!1})}};m.createImageServiceLayerFilter=function(d,n){return function(w){var z=w.getLayerType();w=w.getLayerObject();return D({layerType:z,layerObject:w}).then(function(H){var F=H.layerType,L=H.layerObject;return"ArcGISImageServiceLayer"===F||"ArcGISImageServiceVectorLayer"===F?d?t.isImageServiceSupportQuery(H.layerObject.capabilities)?n?m._shouldPassStatisticsCheck(n,L):!0:!1:!0:!1})}};m._shouldPassStatisticsCheck=function(d,n){return d?(d=!1,d=n.advancedQueryCapabilities?!!n.advancedQueryCapabilities.supportsStatistics:
!!n.supportsStatistics):!0};m.createQueryableLayerFilter=function(d){var n=m.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,d);d=m.createImageServiceLayerFilter(!0,d);return m.orCombineFilters([n,d])};m.andCombineFilters=function(d){return m._combineFilters(d,!0)};m.orCombineFilters=function(d){return m._combineFilters(d,!1)};m._combineFilters=function(d,n){return function(w){var z=new l,H=g.map(d,function(F){return F(w)});D(H).then(function(F){var L=!1;L=n?g.every(F,function(G){return G}):
g.some(F,function(G){return G});z.resolve(L)},function(F){console.error(F);z.reject(F)});return z}};return m})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,C,A,r,h,f,k){return A("dijit.tree.ObjectStoreModel",k,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(l){h.mixin(this,l);this.childrenCache={}},getRoot:function(l,v){if(this.root)l(this.root);
else{var B=this.store.query(this.query);B.then&&this.own(B);f(B,h.hitch(this,function(D){if(1!=D.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+D.length+" items, but must return exactly one");this.root=D[0];l(this.root);B.observe&&B.observe(h.hitch(this,function(e){this.onChange(e)}),!0)}),v)}},mayHaveChildren:function(){return!0},getChildren:function(l,v,B){var D=this.store.getIdentity(l);if(this.childrenCache[D])f(this.childrenCache[D],v,B);else{var e=this.childrenCache[D]=
this.store.getChildren(l);e.then&&this.own(e);e.observe&&this.own(e.observe(h.hitch(this,function(c,g,t){this.onChange(c);g!=t&&f(e,h.hitch(this,"onChildrenChange",l))}),!0));f(e,v,B)}},isItem:function(){return!0},getIdentity:function(l){return this.store.getIdentity(l)},getLabel:function(l){return l[this.labelAttr]},newItem:function(l,v,B,D){return this.store.put(l,{parent:v,before:D})},pasteItem:function(l,v,B,D,e,c){var g=new r;if(v===B&&!D&&!c)return g.resolve(!0),g;v&&!D?this.getChildren(v,h.hitch(this,
function(t){t=[].concat(t);var y=p.indexOf(t,l);t.splice(y,1);this.onChildrenChange(v,t);g.resolve(this.store.put(l,{overwrite:!0,parent:B,oldParent:v,before:c,isCopy:!1}))})):g.resolve(this.store.put(l,{overwrite:!0,parent:B,oldParent:v,before:c,isCopy:!0}));return g},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D,e,c,g,t,y){var I=p([t._TreeNode,c],{templateString:r,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=f.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=f.toDom('\x3cinput type\x3d"checkbox" /\x3e');f.addClass(this.checkNode,"jimu-tree-check-node");f.place(this.checkNode,this.contentNode,
"first");this.own(D(this.checkNode,"click",h.hitch(this,this._onClick)));this.own(D(this.rowNode,"keydown",h.hitch(this,function(q,m){m.target=q;m.keyCode!==e.ENTER&&m.keyCode!==e.SPACE||this._onClick(m)},this.checkNode)));this.isLeaf?this.groupId?f.setStyle(this.checkNode,"display","none"):f.setStyle(this.checkNode,"display","inline"):f.setStyle(this.checkNode,"display","none");this.isLeaf?f.addClass(this.domNode,"jimu-tree-leaf-node"):f.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,f.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,f.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(q){(q.target||q.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,q):this.tree._onClick(this,q)},_onChange:function(){this.isLeaf&&setTimeout(h.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return p([t,c],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+y.getRandomString()},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-tree");this.own(B.before(this,"onClick",h.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&f.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;f.setAttr(this.domNode,"tabindex",0)},removeItem:function(q){this.model.store.remove(q)},getAllItems:function(){var q=this.getAllTreeNodeWidgets();return k.map(q,h.hitch(this,function(m){var d=m.item;d.selected=m.checkNode.checked;return d}))},getSelectedItems:function(){var q=this.getAllTreeNodeWidgets();q=k.filter(q,h.hitch(this,function(m){return m.checkNode.checked}));return k.map(q,
h.hitch(this,function(m){return m.item}))},getFilteredItems:function(q){var m=this.getAllTreeNodeWidgets();m=k.map(m,h.hitch(this,function(d){var n=d.item;n.selected=d.checkNode.checked;return n}));return k.filter(m,h.hitch(this,function(d){return q(d)}))},getTreeNodeByItemId:function(q){for(var m=this._getAllTreeNodeDoms(),d=0;d<m.length;d++){var n=g.byNode(m[d]);if(n.item.id.toString()===q.toString())return n}return null},selectItem:function(q){(q=this.getTreeNodeByItemId(q))&&q.isLeaf&&this.selectNodeWidget(q)},
unselectItem:function(q){(q=this.getTreeNodeByItemId(q))&&q.isLeaf&&q.unselect()},getAllLeafTreeNodeWidgets:function(){var q=this.getAllTreeNodeWidgets();return k.filter(q,h.hitch(this,function(m){return m.isLeaf}))},getAllTreeNodeWidgets:function(){var q=this._getAllTreeNodeDoms();return k.map(q,h.hitch(this,function(m){return g.byNode(m)}))},isLeafItem:function(q){return q&&q.isLeaf},_getAllTreeNodeDoms:function(){return v(".dijitTreeNode",this.domNode)},_createTreeNode:function(q){q.isLeaf=this.isLeafItem(q.item);
this.multiple||(q.groupId=this.uniqueId);return new I(q)},_onTreeNodeSelect:function(q){this.emit("item-select",{item:q.item,treeNode:q})},_onTreeNodeUnselect:function(q){this.emit("item-unselect",{item:q.item,treeNode:q})},selectNodeWidget:function(q){this.multiple||this.unselectAllLeafNodeWidgets();q.select()},_jimuBeforeClick:function(q,m,d){m.isLeaf&&(f.hasClass(d.target||d.srcElement,"jimu-tree-check-node")||(this.multiple?m.toggleSelect():this.selectNodeWidget(m)));return arguments},_onCheckNodeClick:function(q,
m,d){!this.multiple&&m&&this.unselectAllLeafNodeWidgets();l.stop(d);this.focusNode(q);setTimeout(h.hitch(this,function(){m?this.selectNodeWidget(q):q.unselect();this.onClick(q.item,q,d)}),0)},unselectAllLeafNodeWidgets:function(){var q=this.getAllLeafTreeNodeWidgets();k.forEach(q,h.hitch(this,function(m){m.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D,e,c,g,t,y,I,q,m,d,n,w,z,H,F,L,G,J,Q,P,T,Z,da,aa,ba){function N(a){return y.delegate(a.promise||a,{addCallback:function(b){this.then(b)},addErrback:function(b){this.otherwise(b)}})}var Y=r("dijit._TreeNode",[F,L,G,J,Q],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);c("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:T,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";B.set(this.domNode,
"backgroundPosition",b+" 0px");B.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);p.forEach(this.getChildren(),function(u){u.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,u=b.model;b._v10Compat&&a===u.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,u){var x="_"+b+"Class";b+="Node";var E=this[x];this[x]=this.tree["get"+u+"Class"](a,this.isExpanded);l.replace(this[b],this[x]||"",E||"");B.set(this[b],this.tree["get"+u+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent();a=!a||!a.rowNode||"none"==a.rowNode.style.display;l.toggle(this.domNode,"dijitTreeIsRoot",a);l.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;l.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return N(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");l.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=e.wipeIn({node:this.containerNode,duration:H.defaultDuration}),b=this._expandDeferred=new h(function(){a.stop()});C.after(a,"onEnd",function(){b.resolve(!0)},!0);a.play();return N(b)},collapse:function(){if(this._collapseDeferred)return N(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");l.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=e.wipeOut({node:this.containerNode,duration:H.defaultDuration}),b=this._collapseDeferred=new h(function(){a.stop()});C.after(a,"onEnd",
function(){b.resolve(!0)},!0);a.play();return N(b)},indent:0,setChildItems:function(a){var b=this.tree,u=b.model,x=[],E=b.focusedChild,U=this.getChildren();p.forEach(U,function(K){G.prototype.removeChild.call(this,K)},this);this.defer(function(){p.forEach(U,function(K){if(!K._destroyed&&!K.getParent()){b.dndController.removeTreeNode(K);(function ca(M){var V=u.getIdentity(M.item),X=b._itemNodesMap[V];1==X.length?delete b._itemNodesMap[V]:(V=p.indexOf(X,M),-1!=V&&X.splice(V,1));p.forEach(M.getChildren(),
ca)})(K);if(b.persist){var R=p.map(K.getTreePath(),function(M){return b.model.getIdentity(M)}).join("/"),O;for(O in b._openedNodes)O.substr(0,R.length)==R&&delete b._openedNodes[O];b._saveExpandedNodes()}b.lastFocusedChild&&!k.isDescendant(b.lastFocusedChild.domNode,b.domNode)&&delete b.lastFocusedChild;E&&!k.isDescendant(E.domNode,b.domNode)&&b.focus();K.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,p.forEach(a,function(K){var R=u.getIdentity(K),O=b._itemNodesMap[R];
if(O)for(var W=0;W<O.length;W++)if(O[W]&&!O[W].getParent()){var M=O[W];M.set("indent",this.indent+1);break}M||(M=this.tree._createTreeNode({item:K,tree:b,isExpandable:u.mayHaveChildren(K),label:b.getLabel(K),labelType:b.model&&b.model.labelType||"text",tooltip:b.getTooltip(K),ownerDocument:b.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir,indent:this.indent+1}),O?O.push(M):b._itemNodesMap[R]=[M]);this.addChild(M);(this.tree.autoExpand||this.tree._state(M))&&x.push(b._expandNode(M))},this),p.forEach(this.getChildren(),
function(K){K._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=f(x);this.tree._startPaint(a);return N(a)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());p.forEach(b,function(u){u._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");l.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){w.focus(this.focusNode)}});c("dojo-bidi")&&Y.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var S=r("dijit.Tree",[F,P,L,Q],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:Z,persist:!1,autoExpand:!1,dndController:ba,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){q.publish(this.id,y.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new h;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(I(this.containerNode,
I.selector(".dijitTreeNode",m.enter),function(x){a._onNodeMouseEnter(z.byNode(this),x)}),I(this.containerNode,I.selector(".dijitTreeNode",m.leave),function(x){a._onNodeMouseLeave(z.byNode(this),x)}),I(this.containerNode,I.selector(".dijitTreeRow",n.press),function(x){a._onNodePress(z.getEnclosingWidget(this),x)}),I(this.containerNode,I.selector(".dijitTreeRow",n),function(x){a._onClick(z.getEnclosingWidget(this),x)}),I(this.containerNode,I.selector(".dijitTreeRow","dblclick"),function(x){a._onDblClick(z.getEnclosingWidget(this),
x)}));this.model||this._store2model();this.own(C.after(this.model,"onChange",y.hitch(this,"_onItemChange"),!0),C.after(this.model,"onChildrenChange",y.hitch(this,"_onItemChildrenChange"),!0),C.after(this.model,"onDelete",y.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){y.isString(this.dndController)&&(this.dndController=y.getObject(this.dndController));for(var b={},u=0;u<this.dndParams.length;u++)this[this.dndParams[u]]&&(b[this.dndParams[u]]=this[this.dndParams[u]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=N(this.pendingCommandsPromise);this.onLoadDeferred.then(y.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;g.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=y.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=y.hitch(this,function(b,u,x){this.getItemChildren(this._v10Compat&&b===this.model.root?null:b,u,x)}));this.model=new aa(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(y.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(y.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),y.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=y.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(y.hitch(this,function(){var u=
p.map(a,function(E){return!E||y.isString(E)?E:b.model.getIdentity(E)}),x=[];p.forEach(u,function(E){x=x.concat(b._itemNodesMap[E]||[])});this.set("selectedNodes",x)}))},_setPathAttr:function(a){return a.length?N(this.set("paths",[a]).then(function(b){return b[0]})):N(this.set("paths",[]).then(function(b){return b[0]}))},_setPathsAttr:function(a){function b(x,E){var U=x.shift(),K=p.filter(E,function(R){return R.getIdentity()==U})[0];if(K)return x.length?u._expandNode(K).then(function(){return b(x,
K.getChildren())}):K;throw new S.PathError("Could not expand path at "+U);}var u=this;return N(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return f(p.map(a,function(x){x=p.map(x,function(E){return E&&y.isObject(E)?u.model.getIdentity(E):E});if(x.length)return b(x,[u.rootNode]);throw new S.PathError("Empty path");}))}).then(function(x){u.set("selectedNodes",x);return u.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(u){return b._expandNode(u).then(function(){var x=p.filter(u.getChildren()||[],function(E){return E.isExpandable});return f(p.map(x,a))})}var b=this;return N(a(this.rootNode))},collapseAll:function(){function a(u){var x=p.filter(u.getChildren()||[],function(E){return E.isExpandable});x=f(p.map(x,a));return!u.isExpanded||u==b.rootNode&&!b.showRoot?x:x.then(function(){return b._collapseNode(u)})}var b=this;return N(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return k.isDescendant(a,
b.expandoNode)||k.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,u,x){var E=this.isExpandoNode(b.target,a);a.isExpandable&&(u||E)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[x](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){g.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){g.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var b=this.model,u=a.item,x=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new h,b.getChildren(u,function(E){a.unmarkProcessing();a.setChildItems(E).then(function(){a._loadDeferred.resolve(E)})},function(E){console.error(x,": error loading "+a.label+" children: ",
E);a._loadDeferred.reject(E)}));b=a._loadDeferred.then(y.hitch(this,function(){var E=a.expand();this.onOpen(a.item,a);this._state(a,!0);return E}));this._startPaint(b);return b},focusNode:function(a){for(var b=[],u=this.domNode;u&&u.tagName&&"IFRAME"!==u.tagName.toUpperCase();u=u.parentNode)b.push({domNode:u.contentWindow||u,scrollLeft:u.scrollLeft||0,scrollTop:u.scrollTop||0});this.focusChild(a);this.defer(function(){for(var x=0,E=b.length;x<E;x++)b[x].domNode.scrollLeft=b[x].scrollLeft,b[x].domNode.scrollTop=
b[x].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var u=this.getLabel(a),x=this.getTooltip(a);p.forEach(b,function(E){E.set({item:a,label:u,tooltip:x});E._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&p.forEach(a,function(u){u.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];
b&&(p.forEach(b,function(u){this.dndController.removeTreeNode(u);var x=u.getParent();x&&x.removeChild(u);this.lastFocusedChild&&!k.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!k.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();u.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=A(this.cookieName);a&&p.forEach(a.split(","),function(b){this._openedNodes[b]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var u=p.map(a.getTreePath(),function(x){return this.model.getIdentity(x)},this).join("/");if(1===arguments.length)return this._openedNodes[u];b?this._openedNodes[u]=!0:delete this._openedNodes[u];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);A(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!y.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&v.setMarginBox(this.domNode,a);this._nodePixelIndent=v.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(y.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=y.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});d(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new Y(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});c("dojo-bidi")&&S.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});S.PathError=D("TreePathError");S._TreeNode=Y;return S})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,C,A,r){return A("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(h){r.mixin(this,h);this.connects=[];h=this.store;if(!h.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");h.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([C.after(h,
"onNew",r.hitch(this,"onNewItem"),!0),C.after(h,"onDelete",r.hitch(this,"onDeleteItem"),!0),C.after(h,"onSet",r.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var h;h=this.connects.pop();)h.remove()},getRoot:function(h,f){this.root?h(this.root):this.store.fetch({query:this.query,onComplete:r.hitch(this,function(k){if(1!=k.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+k.length+" items, but must return exactly one");this.root=k[0];h(this.root)}),onError:f})},mayHaveChildren:function(h){return p.some(this.childrenAttrs,
function(f){return this.store.hasAttribute(h,f)},this)},getChildren:function(h,f,k){var l=this.store;if(l.isItemLoaded(h)){for(var v=[],B=0;B<this.childrenAttrs.length;B++){var D=l.getValues(h,this.childrenAttrs[B]);v=v.concat(D)}var e=0;this.deferItemLoadingUntilExpand||p.forEach(v,function(g){l.isItemLoaded(g)||e++});0==e?f(v):p.forEach(v,function(g,t){l.isItemLoaded(g)||l.loadItem({item:g,onItem:function(y){v[t]=y;0==--e&&f(v)},onError:k})})}else{var c=r.hitch(this,arguments.callee);l.loadItem({item:h,
onItem:function(g){c(g,f,k)},onError:k})}},isItem:function(h){return this.store.isItem(h)},fetchItemByIdentity:function(h){this.store.fetchItemByIdentity(h)},getIdentity:function(h){return this.store.getIdentity(h)},getLabel:function(h){return this.labelAttr?this.store.getValue(h,this.labelAttr):this.store.getLabel(h)},newItem:function(h,f,k){var l={parent:f,attribute:this.childrenAttrs[0]},v;this.newItemIdAttr&&h[this.newItemIdAttr]?this.fetchItemByIdentity({identity:h[this.newItemIdAttr],scope:this,
onItem:function(B){B?this.pasteItem(B,null,f,!0,k):(v=this.store.newItem(h,l))&&void 0!=k&&this.pasteItem(v,f,f,!1,k)}}):(v=this.store.newItem(h,l))&&void 0!=k&&this.pasteItem(v,f,f,!1,k)},pasteItem:function(h,f,k,l,v){var B=this.store,D=this.childrenAttrs[0];f&&p.forEach(this.childrenAttrs,function(c){if(B.containsValue(f,c,h)){if(!l){var g=p.filter(B.getValues(f,c),function(t){return t!=h});B.setValues(f,c,g)}D=c}});if(k)if("number"==typeof v){var e=B.getValues(k,D).slice();e.splice(v,0,h);B.setValues(k,
D,e)}else B.setValues(k,D,B.getValues(k,D).concat(h))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(h,f){f&&this.getChildren(f.item,r.hitch(this,function(k){this.onChildrenChange(f.item,k)}))},onDeleteItem:function(h){this.onDelete(h)},onSetItem:function(h,f){if(-1!=p.indexOf(this.childrenAttrs,f))this.getChildren(h,r.hitch(this,function(k){this.onChildrenChange(h,k)}));else this.onChange(h)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,C,A,r,h){return C("dijit.tree.ForestStoreModel",h,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(f){this.root={store:this,root:!0,id:f.rootId,label:f.rootLabel,children:f.rootChildren}},mayHaveChildren:function(f){return f===this.root||this.inherited(arguments)},getChildren:function(f,k,l){f===this.root?this.root.children?k(this.root.children):this.store.fetch({query:this.query,onComplete:r.hitch(this,
function(v){this.root.children=v;k(v)}),onError:l}):this.inherited(arguments)},isItem:function(f){return f===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(f){if(f.identity==this.root.id){var k=f.scope||A.global;f.onItem&&f.onItem.call(k,this.root)}else this.inherited(arguments)},getIdentity:function(f){return f===this.root?this.root.id:this.inherited(arguments)},getLabel:function(f){return f===this.root?this.root.label:this.inherited(arguments)},newItem:function(f,k,l){return k===
this.root?(this.onNewRootItem(f),this.store.newItem(f)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(f,k,l,v,B){if(k===this.root&&!v)this.onLeaveRoot(f);this.inherited(arguments,[f,k===this.root?null:k,l===this.root?null:l,v,B]);if(l===this.root)this.onAddToRoot(f)},onAddToRoot:function(f){console.log(this,": item ",f," added to root")},onLeaveRoot:function(f){console.log(this,": item ",f," removed from root")},_requeryTop:function(){var f=this.root.children||[];this.store.fetch({query:this.query,
onComplete:r.hitch(this,function(k){this.root.children=k;if(f.length!=k.length||p.some(f,function(l,v){return k[v]!=l}))this.onChildrenChange(this.root,k)})})},onNewItem:function(f,k){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(f){-1!=p.indexOf(this.root.children,f)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(f,k,l,v){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D){return C("dijit.tree._dndSelector",D,{constructor:function(){this.selection={};this.anchor=null;this.events.push(l(this.tree.domNode,v.press,r.hitch(this,"onMouseDown")),l(this.tree.domNode,v.release,r.hitch(this,"onMouseUp")),l(this.tree.domNode,v.move,r.hitch(this,"onMouseMove")),l(this.tree.domNode,B.press,r.hitch(this,"onClickPress")),l(this.tree.domNode,B.release,r.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var e=[],c=this.selection,
g;for(g in c)e.push(c[g]);return e},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(e,c){this.setSelection(this.getSelectedTreeNodes().concat([e]));c&&(this.anchor=e);return e},removeTreeNode:function(e){var c=p.filter(this.getSelectedTreeNodes(),function(g){return!f.isDescendant(g.domNode,e.domNode)});this.setSelection(c);return e},isTreeNodeSelected:function(e){return e.id&&!!this.selection[e.id]},
setSelection:function(e){var c=this.getSelectedTreeNodes();p.forEach(this._setDifference(c,e),r.hitch(this,function(g){g.setSelected(!1);this.anchor==g&&delete this.anchor;delete this.selection[g.id]}));p.forEach(this._setDifference(e,c),r.hitch(this,function(g){g.setSelected(!0);this.selection[g.id]=g}));this._updateSelectionProperties()},_setDifference:function(e,c){p.forEach(c,function(g){g.__exclude__=!0});e=p.filter(e,function(g){return!g.__exclude__});p.forEach(c,function(g){delete g.__exclude__});
return e},_updateSelectionProperties:function(){var e=this.getSelectedTreeNodes(),c=[],g=[];p.forEach(e,function(t){var y=t.getTreePath();g.push(t);c.push(y)},this);e=p.map(g,function(t){return t.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",g);this.tree._set("selectedNode",g[0]||null);this.tree._set("selectedItems",e);this.tree._set("selectedItem",e[0]||null)},onClickPress:function(e){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(e.target,
this.current))){"mousedown"==e.type&&k.isLeft(e)&&e.preventDefault();var c="keydown"==e.type?this.tree.focusedChild:this.current;if(c){var g=h.getCopyKeyState(e),t=c.id;this.singular||e.shiftKey||!this.selection[t]?(this._doDeselect=!1,this.userSelect(c,g,e.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(e){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==e.type?this.tree.focusedChild:this.current,h.getCopyKeyState(e),e.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(e,c){if(e===c)return 0;if("sourceIndex"in document.documentElement)return e.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return e.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var g=doc.createRange();g.setStartBefore(e);e=doc.createRange();e.setStartBefore(c);return g.compareBoundaryPoints(g.END_TO_END,e)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(e,c,g){if(this.singular)this.anchor==e&&c?this.selectNone():(this.setSelection([e]),this.anchor=e);else if(g&&this.anchor){c=this._compareNodes(this.anchor.rowNode,e.rowNode);g=this.anchor;0>c?c=g:(c=e,e=g);for(g=[];c!=e;)g.push(c),c=this.tree._getNext(c);g.push(e);this.setSelection(g)}else this.selection[e.id]&&c?this.removeTreeNode(e):c?this.addTreeNode(e,!0):(this.setSelection([e]),this.anchor=e)},getItem:function(e){return{data:this.selection[e],type:["treeNode"]}},forInSelectedItems:function(e,
c){c=c||A.global;for(var g in this.selection)e.call(c,this.getItem(g),g,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,C,A,r,h,f){return C("dijit.tree._dndContainer",null,{constructor:function(k,l){this.tree=k;this.node=k.domNode;r.mixin(this,l);this.containerState="";A.add(this.node,"dojoDndContainer");this.events=[h(this.node,f.enter,r.hitch(this,"onOverEvent")),h(this.node,f.leave,
r.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",r.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",r.hitch(this,"onMouseOut"),!0),h(this.node,"dragstart, selectstart",function(v){v.preventDefault()})]},destroy:function(){for(var k;k=this.events.pop();)k.remove();this.node=this.parent=null},onMouseOver:function(k){this.current=k},onMouseOut:function(){this.current=null},_changeState:function(k,l){var v="dojoDnd"+k;k=k.toLowerCase()+"State";A.replace(this.node,v+
l,v+this[k]);this[k]=l},_addItemClass:function(k,l){A.add(k,"dojoDndItem"+l)},_removeItemClass:function(k,l){A.remove(k,"dojoDndItem"+l)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/lang","dojo/_base/html","dojo/_base/declare","./LayerChooserFromMap"],function(p,C,A,r){return A([r],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",
showImageLayer:!0,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.filter=this.showImageLayer?r.createQueryableLayerFilter(this.mustSupportStatistics):r.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=r.andCombineFilters([this.filter,p.hitch(this,this._ignoreVirtualLayerFilter)]))},_ignoreVirtualLayerFilter:function(h){return h.getLayerType().then(function(f){return!("ArcGISDynamicMapServiceLayer"===
f||"ArcGISTiledMapServiceLayer"===f||"GroupLayer"===f)})},postCreate:function(){this.inherited(arguments);C.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(h){var f=this.inherited(arguments),k=h&&h.layerInfo;k=k&&k.layerObject;f.url=k&&k.url||"";return f}})})},"jimu/dijit/SymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/TooltipDialog dijit/popup dijit/registry jimu/dijit/SymbolChooser jimu/symbolUtils".split(" "),
function(p,C,A,r,h,f,k,l,v,B,D,e,c,g){return p([C,A,r],{baseClass:"jimu-symbol-picker",declaredClass:"jimu.dijit.SymbolPicker",templateString:'\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d"symbolNode" class\x3d"symbol-node jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8 jimu-float-leading"\x3e\x3c/div\x3e\x3c/div\x3e',tooltipDialog:null,_isTooltipDialogOpened:!1,symbol:null,type:null,cropImage:!1,
customZIndex:null,postCreate:function(){this.inherited(arguments);this._createTooltipDialog();this._hideTooltipDialog();var t=this.symbolChooser.getSymbol();t&&this._drawSymbol(t)},destroy:function(){this._hideTooltipDialog();this.symbolChooser&&this.symbolChooser.destroy();this.symbolChooser=null;this.inherited(arguments)},_createTooltipDialog:function(){var t=f.create("div");this.tooltipDialog=new B({content:t});this.symbolChooser=new c({cropImage:this.cropImage,customZIndex:this.customZIndex,symbol:this.symbol,
type:this.type});this.symbolChooser.placeAt(t);this.symbolChooser.startup();this.own(l(this.symbolChooser,"change",h.hitch(this,function(y){this._drawSymbol(y);this.emit("change",y)})));this.own(l(this.domNode,"click",h.hitch(this,function(y){y.stopPropagation();y.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(l(document.body,"click",h.hitch(this,function(y){var I=y.target||y.srcElement;y=this._getColorPickers();if(!(0<y.length&&k.some(y,
function(d){return d.isPartOfPopup(I)})))if(y=this.tooltipDialog.domNode,y=I===y||f.isDescendant(I,y),this.cropImage&&this.symbolChooser._isCustomImageOptionSelected()){var q=this.symbolChooser.imageChooser,m=q.msgPopupOpen;q.cropPopupOpen||m||y||this._hideTooltipDialog();q.cropPopup&&q.cropPopup.domNode||(q.cropPopupOpen=!1);q.msgPopup&&q.msgPopup.domNode||(q.msgPopupOpen=!1)}else y||this._hideTooltipDialog()})));this.own(l(this.symbolChooser,"resize",h.hitch(this,function(){this._isTooltipDialogOpened&&
(this._hideTooltipDialog(),this._showTooltipDialog())})))},_getColorPickers:function(){var t=v(".jimu-color-picker",this.symbolChooser.domNode);return k.map(t,h.hitch(this,function(y){return e.byNode(y)}))},reset:function(){this.symbol=this.type=null;f.empty(this.symbolNode);this.symbolChooser.reset()},showBySymbol:function(t){this.reset();t&&(this._drawSymbol(t),this.symbolChooser.showBySymbol(t))},showByType:function(t){this.reset();this.symbolChooser.showByType(t);(t=this.symbolChooser.getSymbol())&&
this._drawSymbol(t)},getSymbol:function(){return this.symbolChooser.getSymbol()},_drawSymbol:function(t){f.empty(this.symbolNode);t&&(t=g.createSymbolNode(t,{width:16,height:16}))&&f.place(t,this.symbolNode)},_showTooltipDialog:function(){this.tooltipDialog&&(D.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode}),this._isTooltipDialogOpened=!0)},_hideTooltipDialog:function(){this.tooltipDialog&&(D.close(this.tooltipDialog),this._isTooltipDialogOpened=!1)}})})},"widgets/Filter/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Filter/setting/SingleFilterSetting.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"layer-part"\x3e\r\n\t\t\x3cdiv class\x3d"title"\x3e${jimuNls.common.layer}\x3c/div\x3e\r\n\t\t\x3cdiv style\x3d"margin-top: 5px" data-dojo-attach-point\x3d"layerTd"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"tab-part" style\x3d"margin-top: 20px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabsNode" class\x3d"tabs-node"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"infoTabNode"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"title" style\x3d"margin-top: 30px"\x3e${jimuNls.common.label}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 5px"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"nameTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"change:_onNameTextBoxChanged" data-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\x3cdiv class\x3d"title" style\x3d"margin-top: 20px"\x3e${jimuNls.common.icon}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"symbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" data-dojo-props\x3d"cropImage:true,customZIndex:2000"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"expressionsTabNode"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"filterDiv" class\x3d"filter-div" style\x3d"height: 100%"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"optionsTabNode"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"option-div" data-dojo-attach-point\x3d"useMapFilterNode"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"option-div" data-dojo-attach-point\x3d"autoApplyWhenWidgetOpenNode"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"option-div" data-dojo-attach-point\x3d"collapseFilterNode"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable role\x3d"listbox" aria-haspopup\x3d"true" data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.customSelectLayer}" aria-label\x3d"${nls.customSelectLayer}"\x3e\r\n    \x3ccaption class\x3d"screen-readers-only-no-position"\x3e${nls.customSelectLayer}\x3c/caption\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Filter/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.addTaskTip}\x3c/div\x3e\r\n\t\x3cdiv class\x3d"content"\x3e\r\n\t\t\x3cdiv class\x3d"items-list jimu-not-selectable"\x3e\r\n\t\t\t\x3cdiv class\x3d"add-btn" data-dojo-attach-event\x3d"click:_onBtnAddItemClicked"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"icon"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"tip"\x3e${nls.newFilter}\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"matchMsgTask" class\x3d"match-msg"\x3e\r\n\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnyTaskSelect" class\x3d"items-list-operSelect"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.matchMsgSetAll}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.matchMsgSetAny}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"items-list-content" data-dojo-attach-point\x3d"listContent" data-dojo-attach-event\x3d"click:_onListContentClicked"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"separator not-visible" data-dojo-attach-point\x3d"separator"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"single-setting-content" data-dojo-attach-point\x3d"singleSettingContent"\x3e\r\n\t\t\t\x3cdiv class\x3d"no-task-tip" data-dojo-attach-point\x3d"noTaskTip"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"cbx-options-container"\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxGroupByLayer"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"groupByLayerTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxZoomto"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"zoomtoTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxZoomBackto"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"zoombacktoTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-title"\x3e${nls.filterActions}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAllowCustom"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"allowCustomTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAllowResetAll"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"resetAllTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"cbx-option"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading cbx-input" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAllowTurnOffAll"\x3e\x3c/div\x3e\r\n\t\t\t\x3cspan class\x3d"jimu-float-leading cbx-tip" data-dojo-attach-point\x3d"turnOffAllTip"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Filter/setting/css/style.css":'.jimu-widget-filter-setting{width: 100%; height: 100%;}.jimu-widget-filter-setting .not-visible{display: none;}.jimu-widget-filter-setting .content{min-height: 350px; position: absolute; left: 0; right: 2px; top: 40px; bottom: 65px;}.jimu-rtl .jimu-widget-filter-setting .content{right: 0; left: 2px;}.jimu-widget-filter-setting .content \x3e div{position: absolute; top: 0; bottom: 0; height: 100%;}.jimu-widget-filter-setting .items-list{left: 0; width: 300px;}.jimu-widget-filter-setting .items-list .match-msg{display: none;}.jimu-widget-filter-setting \x3e .content \x3e .separator{left: 320px; width: 1px; background-color: #ccc;}.jimu-widget-filter-setting .single-setting-content{right: 0; width: 610px;}.jimu-rtl .jimu-widget-filter-setting .items-list{left: auto; right: 0;}.jimu-rtl .jimu-widget-filter-setting \x3e .content \x3e .separator{left: auto; right: 320px;}.jimu-rtl .jimu-widget-filter-setting .single-setting-content{right: auto; left: 0;}.jimu-widget-filter-setting .items-list-operSelect{margin-top:2px; max-width: 100%; width: 99%;}.jimu-widget-filter-setting .items-list-content{position: absolute; left: 0; right: 0; top: 55px; bottom: 0; overflow: auto;}.jimu-widget-filter-setting .items-list-content .item{position: relative; width: 100%; height: 40px; border-top: 1px solid #F3F3F3; cursor: pointer;}.jimu-widget-filter-setting .items-list-content .item:hover{background-color: #F9F9F9;}.jimu-widget-filter-setting .items-list-content .item.selected{background-color: #F3F3F3 !important; border-left: 4px solid #24B5CC;}.jimu-rtl .jimu-widget-filter-setting .items-list-content .item.selected{border-left: 0; border-right: 4px solid #24B5CC;}.jimu-widget-filter-setting .items-list-content .item \x3e *{cursor: pointer;}.jimu-widget-filter-setting .items-list-content .item:first-child{border-top: 0;}.jimu-widget-filter-setting .items-list-content .item .label{position: absolute; left: 8px; right: 8px; top: 0; bottom: 0; line-height: 40px; font-size: 12px; color: #353535;}.jimu-widget-filter-setting .items-list-content .item.selected .label{font-weight: bold; color: #000;}.jimu-widget-filter-setting .items-list-content .item .actions{position: relative; display: none; height: 100%; overflow: hidden; background-color: #F9F9F9;}.jimu-widget-filter-setting .items-list-content .item:hover .actions{display: block;}.jimu-widget-filter-setting .items-list-content .item.selected .actions{background-color: #F3F3F3 !important;}.jimu-widget-filter-setting .items-list-content .item .action{width: 12px; height: 12px; background-repeat: no-repeat; background-position: center center; position: relative; top: 14px; cursor: pointer; margin: 0 5px;}.jimu-widget-filter-setting .items-list-content .item .action.up{background-image: url("images/up_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.up:hover{background-image: url("images/up_hover.png");}.jimu-widget-filter-setting .items-list-content .item .action.down{background-image: url("images/down_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.down:hover{background-image: url("images/down_hover.png");}.jimu-widget-filter-setting .items-list-content .item .action.delete{background-image: url("images/delete_normal.png");}.jimu-widget-filter-setting .items-list-content .item .action.delete:hover{background-image: url("images/delete_hover.png");}.jimu-widget-filter-setting .items-list-content .item:first-child .action.up{display: none;}.jimu-widget-filter-setting .items-list-content .item:last-child .action.down{display: none;}.jimu-widget-filter-setting .add-btn{display: inline-block; width: 100%; height: 32px; background-color: #24B5CC; color: #ffffff; text-align: center; cursor: pointer;}.jimu-widget-filter-setting .add-btn:hover{background-color: #0090A7;}.jimu-widget-filter-setting .add-btn \x3e div{display: inline-block; cursor: pointer; height: 32px; line-height: 32px; font-size: 12px;}.jimu-widget-filter-setting .add-btn .icon{position: relative; top: 1px; width: 12px; height: 12px; background: url("images/add.png") center center no-repeat; background-size: contain;}.jimu-widget-filter-setting .add-btn .tip{max-width: 190px;}.jimu-rtl .jimu-widget-filter-setting .add-btn .tip{margin-left: 0; margin-right: 8px;}.jimu-widget-filter-setting{font-size: 12px;}.jimu-widget-filter-setting .collapse-option{position: absolute; left: 0; right: 0; bottom: 55px; height: auto;}.jimu-widget-filter-setting .add-task-tip{font-size: 12px;}.jimu-widget-filter-setting .collapse-option .collapse-tip{margin-left: 5px;}.jimu-rtl .jimu-widget-filter-setting .collapse-option .collapse-tip{margin-left: 0; margin-right: 5px;}.jimu-widget-filter-setting .cbx-options-container{position: absolute; top: 547px;}.jimu-widget-filter-setting .cbx-option{height: 25px; display: block;}.jimu-widget-filter-setting .cbx-title{margin-left: 2px; line-height: 25px; height: 30px; font-size: 14px; color: #000000; font-family: "Avenir Medium";}.jimu-rtl .jimu-widget-filter-setting .cbx-title{margin-left: 0; margin-right: 2px;}.jimu-widget-filter-setting .cbx-option .cbx-input{margin-left: 2px;}.jimu-widget-filter-setting .cbx-option .cbx-tip{margin-left: 5px; margin-right: 10px;}.jimu-rtl .jimu-widget-filter-setting .cbx-option .cbx-input{margin-left: 0; margin-right: 2px;}.jimu-rtl .jimu-widget-filter-setting .cbx-option .cbx-tip{margin-left: 10px; margin-right: 5px;}html.hr .jimu-widget-filter-setting .items-list{width: 280px;}html.hr .jimu-widget-filter-setting \x3e .content \x3e .separator{left: 295px;}html.hr .jimu-widget-filter-setting .single-setting-content{width: 650px;}.jimu-widget-singlefilter-setting{position: absolute; left: 0; right: 0; top: 0; bottom: 0;}.jimu-widget-singlefilter-setting .tab-part{height: calc(100% - 75px);}.jimu-widget-singlefilter-setting .tabs-node, .jimu-widget-singlefilter-setting .tabs-node .jimu-tab3{height: 100%;}.jimu-widget-singlefilter-setting .tabs-node .jimu-tab3 .container-node{height: calc(100% - 40px);}.jimu-widget-singlefilter-setting .title{font-size: 14px; font-weight: bold; color: #000;}.jimu-widget-singlefilter-setting .option-div{margin-top: 20px;}.jimu-widget-singlefilter-setting .jimu-filter .allExpsBox{}.jimu-widget-singlefilter-setting .click-picker{display: inline-block; border: 1px solid #D7D7D7; height: 24px; overflow: hidden; padding: 0 4px; cursor: pointer;}.jimu-widget-singlefilter-setting .click-picker .jimu-image-chooser{position: relative; top: 4px;}.jimu-widget-singlefilter-setting .click-picker .separator{position: relative; top: 4px; width: 1px; height: 16px; background-color: #D7D7D7; margin: 0 5px;}.jimu-widget-singlefilter-setting .click-picker .jimu-icon{position: relative; top: 8px;}.jimu-widget-filter-setting .single-setting-content .no-task-tip{position: relative; top: 50%; margin-top: -10px;}.jimu-widget-filter-setting .single-setting-content .no-task-tip span{font-weight: bold;}.jimu-widget-filter-setting .jimu-image-chooser .hint .display-image{width: 100% !important; height: 100% !important;}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/Filter/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/on dojo/query dojo/_base/html dojo/_base/lang dojo/_base/array dojo/_base/declare dijit/_WidgetsInTemplateMixin esri/lang jimu/utils jimu/BaseWidgetSetting ./SingleFilterSetting jimu/LayerInfos/LayerInfos jimu/dijit/CheckBox jimu/dijit/LoadingShelter".split(" "),function(p,C,A,r,h,f,k,l,v,B,D,e){return f([B,k],{baseClass:"jimu-widget-filter-setting",singleSetting:null,layerChooserSelect:null,layerInfosObj:null,postMixInProperties:function(){this.jimuNls=window.jimuNls;this.layerInfosObj=
e.getInstanceSync();this.config&&(this.config=this._getConfigWithValidDataSource(this.config));this.noTaskNls=this.nls.noTasksTip;this.noTaskNls=l.substitute({newFilter:"\x3cspan\x3e"+this.nls.newFilter+"\x3c/span\x3e"},this.noTaskNls)},_getConfigWithValidDataSource:function(c){var g={collapse:c.collapse,taskOper:c.taskOper,groupByLayer:c.groupByLayer,zoomto:c.zoomto,zoombackto:c.zoombackto,allowCustom:c.allowCustom,allowResetAll:c.allowResetAll,allowTurnOffAll:c.allowTurnOffAll,filters:[]};g.filters=
h.filter(c.filters,r.hitch(this,function(t){return t.layerId?!!this.layerInfosObj.getLayerInfoById(t.layerId):!0}));return g},postCreate:function(){this.inherited(arguments);this.noTaskTip.innerHTML=this.noTaskNls;this.groupByLayerTip.innerHTML=this.nls.groupByLayerTip||"";this.zoomtoTip.innerHTML=this.nls.zoomtoTip||"";this.zoombacktoTip.innerHTML=this.nls.zoombacktoTip||"";this.allowCustomTip.innerHTML=this.nls.custom||"";this.resetAllTip.innerHTML=this.nls.resetAll||"";this.turnOffAllTip.innerHTML=
this.nls.turnOffAll||"";this.config&&this.setConfig(this.config)},_onListContentClicked:function(c){c=c.target||c.srcElement;var g=v.getAncestorDom(c,function(t){return A.hasClass(t,"item")},3);g&&(A.hasClass(c,"action")?A.hasClass(c,"up")?g.previousElementSibling&&A.place(g,g.previousElementSibling,"before"):A.hasClass(c,"down")?g.nextElementSibling&&A.place(g,g.nextElementSibling,"after"):A.hasClass(c,"delete")&&(this.singleSetting&&this.singleSetting.target===g&&(this.singleSetting.destroy(),this.singleSetting=
null),A.destroy(g),c=C(".item",this.listContent),0<c.length&&this._createSingleSetting(c[0]),this._updateNoQueryTip()):this.singleSetting?this.singleSetting.target!==g&&this.singleSetting.getConfig()&&(this.singleSetting.destroy(),this.singleSetting=null,this._createSingleSetting(g)):this._createSingleSetting(g))},_onBtnAddItemClicked:function(){if(this.singleSetting)if(this.singleSetting.getConfig())this.singleSetting.destroy(),this.singleSetting=null;else return;var c=this._createTarget();this._createSingleSetting(c,
null)},_createSingleSetting:function(c){2<=this.listContent.childNodes.length?A.setStyle(this.matchMsgTask,"display","block"):(A.setStyle(this.matchMsgTask,"display","none"),this.allAnyTaskSelect.value="OR");C(".item",this.listContent).removeClass("selected");this.singleSetting&&this.singleSetting.destroy();this.singleSetting=null;this.singleSetting=new D({map:this.map,nls:this.nls,target:c,folderUrl:this.folderUrl,layerInfosObj:this.layerInfosObj});this.singleSetting.placeAt(this.singleSettingContent);
this.own(p(this.singleSetting,"loading",r.hitch(this,function(){this.shelter.show()})));this.own(p(this.singleSetting,"unloading",r.hitch(this,function(){this.shelter.hide()})));this.own(p(this.singleSetting,"before-destroy",r.hitch(this,function(){A.addClass(this.separator,"not-visible")})));A.addClass(c,"selected");c.singleConfig?this.singleSetting.setConfig(c.singleConfig):setTimeout(r.hitch(this,function(){this.singleSetting.showLayerChooserPopup()}),50);A.removeClass(this.separator,"not-visible");
A.addClass(this.noTaskTip,"not-visible")},_createTarget:function(c){c=c||"";return A.create("div",{"class":"item",innerHTML:'\x3cdiv class\x3d"label jimu-ellipsis" title\x3d"'+c+'"\x3e'+c+'\x3c/div\x3e\x3cdiv class\x3d"actions jimu-float-trailing"\x3e\x3cdiv class\x3d"delete action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"down action jimu-float-trailing"\x3e\x3c/div\x3e\x3cdiv class\x3d"up action jimu-float-trailing"\x3e\x3c/div\x3e\x3c/div\x3e'},this.listContent)},_updateNoQueryTip:function(){0<
C(".item",this.listContent).length?A.addClass(this.noTaskTip,"not-visible"):A.removeClass(this.noTaskTip,"not-visible")},setConfig:function(c){c.taskOper&&2<=c.filters.length&&(A.setStyle(this.matchMsgTask,"display","block"),this.allAnyTaskSelect.value=c.taskOper);this.cbxGroupByLayer.setValue(!!c.groupByLayer);this.cbxZoomto.setValue(!!c.zoomto);this.cbxZoomBackto.setValue(!!c.zoombackto);this.cbxAllowCustom.setValue(!!c.allowCustom);this.cbxAllowResetAll.setValue(!!c.allowResetAll);this.cbxAllowTurnOffAll.setValue(!!c.allowTurnOffAll);
var g=null;h.forEach(c.filters,r.hitch(this,function(t,y){var I=this._createTarget(t.name);I.singleConfig=t;0===y&&(g=I)}));g&&this._createSingleSetting(g);this._updateNoQueryTip()},getConfig:function(){if(this.singleSetting&&!this.singleSetting.getConfig())return!1;var c=C(".item",this.listContent),g={taskOper:this.allAnyTaskSelect.value,groupByLayer:this.cbxGroupByLayer.getValue(),zoomto:this.cbxZoomto.getValue(),zoombackto:this.cbxZoomBackto.getValue(),allowCustom:this.cbxAllowCustom.getValue(),
allowResetAll:this.cbxAllowResetAll.getValue(),allowTurnOffAll:this.cbxAllowTurnOffAll.getValue(),filters:[]};g.filters=h.map(c,r.hitch(this,function(t){return t.singleConfig}));return g},destroy:function(){this.singleSetting&&this.singleSetting.destroy();this.singleSetting=null;this.inherited(arguments)}})});