// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/IncidentAnalysis/setting/FeaturelayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/Message dojo/text!./FeaturelayerSource.html dojo/_base/lang dojo/_base/array dojox/form/CheckedMultiSelect dojo/on dojo/Evented".split(" "),function(v,w,g,n,h,p,m,q,x,y,z){return v([w,g,n,z],{templateString:p,baseClass:"imt-featurelayer-source",postCreate:function(){this.inherited(arguments);this._initUI()},_initUI:function(){var l=
this.map.itemInfo.itemData.operationalLayers,r=[];0===l.length&&new h({message:this.nls.missingLayerInWebMap});this.weatherLayersSelect=(new x({name:"selectLayers",multiple:!0,style:"width:100%;"})).placeAt(this.selectLayers);for(var t=0;t<l.length;t++){var c=q.filter(r,function(e){return e.label===l[t].title});null!==c&&0!==c.length||this.weatherLayersSelect.addOption({label:l[t].title,value:l[t].title})}if(this.weatherTabAdditionalLayers){r=this.weatherTabAdditionalLayers.split(",");var d=[];q.forEach(r,
m.hitch(this,function(e){d.push(m.trim(e))}));this.weatherLayersSelect.set("value",d)}this.own(y(this.btnOk,"click",m.hitch(this,function(){var e=this._getSelectedLayers();this.emit("ok",e)})));this.own(y(this.btnCancel,"click",m.hitch(this,function(){this.emit("cancel")})))},_getSelectedLayers:function(){var l="";q.forEach(this.weatherLayersSelect.options,m.hitch(this,function(r){r.selected&&(0<l.length&&(l+=","),l+=r.value)}));return l}})})},"widgets/IncidentAnalysis/setting/FieldPicker":function(){define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Select dojo/_base/array dojo/_base/lang dojo/_base/html dojo/dom-style dojo/on dojo/query jimu/BaseWidget jimu/dijit/Message esri/layers/FeatureLayer dojo/text!./FieldPicker.html dojo/Evented jimu/dijit/SimpleTable".split(" "),
function(v,w,g,n,h,p,m,q,x,y,z,l,r,t){return v([y,w,t],{templateString:r,baseClass:"jimu-widget-IMT-setting",advConfig:{},fieldsList:null,callerLayer:null,callerTab:null,callerOpLayers:null,layerList:null,constructor:function(c){this.map=c.map},postCreate:function(){this.inherited(arguments);this.startup()},startup:function(){this.operationsList=[{value:"sum",label:this.nls.sum},{value:"avg",label:this.nls.avg},{value:"min",label:this.nls.min},{value:"max",label:this.nls.max}];var c="";"summary"===
this.callerTab.type?(m.set(this.chk_summary,"display","block"),c="Type"):m.set(this.chk_summary,"display","none");var d=x("th",this.domNode);1<d.length&&(d[1].innerHTML=c);this.own(q(this.btnCancel,"click",h.hitch(this,function(){this.emit("cancel")})));this.own(q(this.btnOk,"click",h.hitch(this,function(){this.updateAdvConfig();this.emit("ok",this.advConfig)})));this.layerTables=[];this.summaryLayers=[];this.advConfig={};this._getAllValidLayers();this.own(q(this.btnAddField,"click",h.hitch(this,
this._addTabRow)))},_updateGeomOptions:function(c){c&&(this.chk_area.set("disabled","esriGeometryPolygon"!==c),this.chk_length.set("disabled","esriGeometryPolyline"!==c))},_getAllValidLayers:function(){n.forEach(this.callerOpLayers,h.hitch(this,function(d){0<d.newSubLayers.length?this._recurseOpLayers(d.newSubLayers):d.id===this.callerLayer&&(this.layerList=d)}));if(this.layerList.layerObject.empty){var c=new l(this.layerList.layerObject.url);q(c,"load",h.hitch(this,function(){this._completeMapLayers(c)}))}else this._completeMapLayers(this.layerList)},
_recurseOpLayers:function(c){n.forEach(c,h.hitch(this,function(d){0<d.newSubLayers.length?this._recurseOpLayers(d.newSubLayers):d.id===this.callerLayer&&(this.layerList=d)}))},_completeMapLayers:function(c){if(c){console.log(c);if("undefined"===typeof c.layerObject){var d=c.geometryType;this.objectIdField=c.objectIdField;var e={url:c.url,fields:[]};c=h.clone(c.fields)}else d=c.layerObject.geometryType,this.objectIdField=c.layerObject.objectIdField,e={url:c.layerObject.url,fields:[]},c=h.clone(c.layerObject.fields);
this.advConfig=e;this._updateGeomOptions(d);this.advConfig.url&&(this._setFields(c),this.callerTab.advConfig&&this.callerTab.advConfig.fields&&0<this.callerTab.advConfig.fields.length&&n.forEach(this.callerTab.advConfig.fields,h.hitch(this,function(k){"count"===k.type?this.chk_count.set("value",!0):"area"===k.type?this.chk_area.set("value",!0):"length"===k.type?this.chk_length.set("value",!0):(console.log(k.type,k.expression),this._populateTabTableRow(k.type,k.expression))})))}},_setFields:function(c){var d=
["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeDouble"];"summary"!==this.callerTab.type&&(d.push("esriFieldTypeString"),d.push("esriFieldTypeDate"));var e=[];n.forEach(c,h.hitch(this,function(k){-1<d.indexOf(k.type)&&e.push({label:k.alias,value:k.name})}));1>e.length&&m.set(this.btnAddField,"display","none");this.fieldsList=h.clone(e)},_populateTabTableRow:function(c,d){var e=this.fieldTable.addRow({});e.success&&e.tr&&(e=e.tr,this._addTabFields(e),this._addTabTypes(e),e.selectFields.set("value",
d),"summary"===this.callerTab.type&&e.selectTypes.set("value",c))},_addTabRow:function(){if("summary"!==this.callerTab.type&&3<=this.fieldTable.getRows().length)new z({message:this.nls.max_records});else{var c=this.fieldTable.addRow({});c.success&&c.tr&&(c=c.tr,this._addTabFields(c),this._addTabTypes(c))}},_addTabFields:function(c){var d=h.clone(this.fieldsList),e=x(".simple-table-cell",c)[0];e&&(p.setStyle(e,"verticalAlign","middle"),d=new g({style:{width:"100%",height:"30px"},options:d}),d.placeAt(e),
d.startup(),c.selectFields=d)},_addTabTypes:function(c){if("summary"===this.callerTab.type){var d=h.clone(this.operationsList),e=x(".simple-table-cell",c)[1];e&&(p.setStyle(e,"verticalAlign","middle"),d=new g({style:{width:"100%",height:"30px"},options:d}),d.placeAt(e),d.startup(),c.selectTypes=d)}},updateAdvConfig:function(){var c=this.fieldTable.getRows(),d=[];"summary"!==this.callerTab.type?n.forEach(c,function(e){d.push({value:0,type:"out",expression:e.selectFields.value,label:e.selectFields.textDirNode.innerText})}):
(this.chk_count.checked&&d.push({value:0,type:"count",expression:this.objectIdField,label:this.nls.count}),this.chk_area.checked&&d.push({value:0,type:"area",expression:this.objectIdField,label:this.nls.area}),this.chk_length.checked&&d.push({value:0,type:"length",expression:this.objectIdField,label:this.nls.length}),n.forEach(c,h.hitch(this,function(e){d.push({value:0,type:e.selectTypes.value,expression:e.selectFields.value,label:e.selectFields.textDirNode.innerText})})));0<d.length?this.advConfig.fields=
d:this.advConfig=null;console.log("ADVCONFIG",this.advConfig)},destroy:function(){this.advConfig=null}})})},"widgets/IncidentAnalysis/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/IncidentAnalysis/setting/FeaturelayerSource.html":'\x3cdiv\x3e\r\n  \x3cdiv\x3e\r\n    \x3cspan class\x3d"label"\x3e${nls.selectLayers}: \x3c/span\x3e\r\n    \x3cdiv class\x3d"layerSelect" data-dojo-attach-point\x3d"selectLayers"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"footer"\x3e\r\n      \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\r\n      \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/IncidentAnalysis/setting/FieldPicker.html":'\x3cdiv style\x3d"height:100%;width:100%;overflow:auto"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tableArea" class\x3d"tableArea"\x3e\r\n    \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddField"\x3e\r\n        \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"btn-add-label" id\x3d"divLayerTitle" data-dojo-attach-point\x3d"divLayerTitle"\x3e${nls.addField}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"fieldTable" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-props\x3d\'fields:[{name:"layer",title:"Field","class":"label",type:"empty",width:"400px"},{name:"type",title:"Type","class":"sumlabel",type:"empty"},{name:"actions",title:"Actions","class":"actions",type:"actions",actions:["up","down","delete"],width:"150px"}]\'\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:20px" data-dojo-attach-point\x3d"chk_summary"\x3e\r\n    \x3cdiv class\x3d"col-1-3" data-dojo-attach-point\x3d"div_chkCount"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_count" title\x3d"${nls.count_checkBox}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.count_checkBox}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"  data-dojo-attach-point\x3d"div_chkArea"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_area" title\x3d"${nls.area_checkBox}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.area_checkBox}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"col-1-3"  data-dojo-attach-point\x3d"div_chkLength"\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_length" title\x3d"${nls.length_checkBox}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.length_checkBox}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"footer"\x3e\r\n    \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/IncidentAnalysis/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:100%;"\x3e\r\n  \x3c!-- Tabs --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"label" style\x3d"font-weight: bold;"\x3e\r\n        ${nls.tabs_section_Label}\r\n      \x3c/div\x3e\r\n      \x3chr/\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row"\x3e\r\n      \x3cdiv class\x3d"label"\x3e${nls.optional_lbl}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:10px"\x3e\r\n      \x3cdiv class\x3d"col-1-2"\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.incident_lbl}: \x3c/span\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"incident_lbl" /\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-2"\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.locate_lbl}: \x3c/span\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"locate_lbl" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddTab"\x3e\r\n      \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"btn-add-label"\x3e${nls.addTab}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"tabTable" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-props\x3d\'fields:[{name:"layer",title:"${nls.layerName}","class":"label",type:"empty",width:"400px"},{name:"type",title:"${nls.layerType}","class":"label",type:"empty"},{name:"label",title:"${nls.layerLabel}","class":"label",type:"empty"},{name:"actions",title:"${nls.actions}","class":"actions",type:"actions",actions:["up","down","edit","delete"],width:"100px"}]\'\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- General Settings: Distances --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"label" style\x3d"padding-top:15px;font-weight: bold;"\x3e\r\n      ${nls.general_setting_Label}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.units_text_lbl}: \x3c/span\x3e\r\n        \x3cselect style\x3d"margin-left: 10px;" data-dojo-attach-point\x3d"selectUnits" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n          \x3coption value\x3d"miles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n          \x3coption value\x3d"kilometers"\x3e${nls.kilometers}\x3c/option\x3e\r\n          \x3coption value\x3d"feet"\x3e${nls.feet}\x3c/option\x3e\r\n          \x3coption value\x3d"meters"\x3e${nls.meters}\x3c/option\x3e\r\n          \x3coption value\x3d"yards"\x3e${nls.yards}\x3c/option\x3e\r\n          \x3coption value\x3d"nauticalMiles"\x3e${nls.nauticalMiles}\x3c/option\x3e\r\n        \x3c/select\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-4"\x3e\r\n        \x3c!-- \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_routing" title\x3d"${nls.routing_checkBox}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.routing_checkBox}\x3c/span\x3e --\x3e\r\n         \x3cdiv data-dojo-attach-point\x3d"chk_routing_node"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-2-4"\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.maximum_distance_lbl}: \x3c/span\x3e\r\n        \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" style\x3d"width:60px" data-dojo-attach-point\x3d"txt_maximumDistance" title\x3d"${nls.maximum_distance_lbl}" /\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.buffer_text_lbl}: \x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.buffer_min_lbl}: \x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cspan class\x3d"label"\x3e${nls.buffer_max_lbl}: \x3c/span\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:0px"\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"buffer_lbl" /\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"buffer_min" /\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"col-1-3"\x3e\r\n            \x3cinput data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-point\x3d"buffer_max" /\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cbr/\x3e\r\n  \x3c!-- Weather Settings --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row" data-dojo-attach-point\x3d"div_special_tab"\x3e\r\n    \x3cdiv class\x3d"label" style\x3d"padding-top:15px;font-weight: bold;"\x3e\r\n      ${nls.weather_Label}\r\n    \x3c/div\x3e\r\n    \x3chr /\x3e\r\n    \x3cdiv class\x3d"jimu-r-row" style\x3d"padding-top:15px"\x3e\r\n      \x3cdiv class\x3d"col-1-3"\x3e\r\n       \x3c!--  \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_weather" title\x3d"${nls.weather_checkBox}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.weather_checkBox}\x3c/span\x3e --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"chk_weather_node"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-3"\x3e\r\n        \x3c!-- \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_celsius" title\x3d"${nls.weather_celsius}" /\x3e\r\n        \x3cspan class\x3d"label"\x3e${nls.weather_celsius}\x3c/span\x3e --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"chk_celsius_node"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"col-1-3"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"btnSource" data-dojo-attach-event\x3d"onclick:_onBtnSelectLayersClicked" class\x3d\'jimu-btn\'\x3e\r\n          ${nls.selectLayers}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"padding-top:15px; padding-left:15px"\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.currentlySelectedLayer}:\x3c/span\x3e\r\n      \x3cspan class\x3d"label" data-dojo-attach-point\x3d"currentlySelectedLayer"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!-- Layer Visibility Settings --\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv style\x3d"padding-top:15px; padding-bottom: 10px"\x3e\r\n      \x3c!-- \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chk_disable" title\x3d"${nls.disable_checkBox}" /\x3e\r\n      \x3cspan class\x3d"label"\x3e${nls.disable_checkBox}\x3c/span\x3e --\x3e\r\n       \x3cdiv data-dojo-attach-point\x3d"chk_disable_node"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/IncidentAnalysis/setting/css/style.css":'.jimu-widget-IMT-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; margin-top: 8px;}.jimu-widget-IMT-setting .btn-add-section .btn-add-icon {height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png); display: inline-block; vertical-align: top;}.jimu-widget-IMT-setting .btn-add-section .btn-add-label {height: 100%; line-height: 24px; vertical-align: middle; margin-left: 7px; text-decoration: underline; display: inline-block; vertical-align: top;}.claro .dojoxCheckedMultiSelect .dojoxCheckedMultiSelectWrapper {border: none !important; background-color: transparent !important;}.footer {text-align: right;}.removeButtonWithIcon {background-image: url("../images/filterdialog_icons.png"); background-repeat: no-repeat; background-position: -30px 0; width: 15px; height: 15px; margin: 0px 0px; display: block;}.upButton {background-image: url("../../../../jimu.js/css/images/up_enabled.png"); background-repeat: no-repeat; width: 15px; height: 15px; margin: 0px 0px; display: block;}.downButton {background-image: url("../../../../jimu.js/css/images/down_enabled.png"); background-repeat: no-repeat; width: 15px; height: 15px; margin: 0px 0px; display: block;}.colorButton {width: 15px; height: 15px; margin: 0px 0px; display: block; background-color: #00ff00;}.footer {padding-top: 5px; width: 100%; height: 30px;}.dojoxCheckedMultiSelect .dojoxCheckedMultiSelectWrapper {height: 400px;}.dojoxMultiSelectItem {padding-bottom: 5px; padding-top: 5px;}.dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden;}.layer .dijitSelectLabel {max-width:350px;}.type .dijitSelectLabel {max-width:180px;}',
"*now":function(v){v(['dojo/i18n!*preload*widgets/IncidentAnalysis/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dojo/dom-style dojo/on dojo/query dijit/form/Select dijit/form/ValidationTextBox dijit/_WidgetsInTemplateMixin ./FeaturelayerSource ./FieldPicker jimu/BaseWidgetSetting jimu/dijit/Message jimu/dijit/Popup jimu/LayerInfos/LayerInfos jimu/utils jimu/dijit/CheckBox jimu/dijit/SimpleTable".split(" "),function(v,w,g,n,h,p,m,q,x,y,z,l,r,t,c,d,e,k){return v([r,y],{baseClass:"jimu-widget-IMT-setting",opLayers:[],curRow:null,postCreate:function(){this.inherited(arguments);
this.chk_routing=new k({label:this.nls.routing_checkBox},this.chk_routing_node);this.chk_routing.startup();this.chk_weather=new k({label:this.nls.weather_checkBox},this.chk_weather_node);this.chk_weather.startup();this.chk_celsius=new k({label:this.nls.weather_celsius},this.chk_celsius_node);this.chk_celsius.startup();this.chk_disable=new k({label:this.nls.disable_checkBox},this.chk_disable_node);this.chk_disable.startup();this._getAllLayers();this.own(p(this.btnAddTab,"click",g.hitch(this,this._addTabRow)));
this.own(p(this.tabTable,"actions-edit",g.hitch(this,function(b){this._onEditLayerClicked(b)})))},startup:function(){this.inherited(arguments)},setConfig:function(b){this.config=b;this.config.distanceUnits&&this.selectUnits.set("value",this.config.distanceUnits);this.config.maxDistance&&this.txt_maximumDistance.set("value",this.config.maxDistance);this.config.enableRouting&&this.chk_routing.setValue(!0);this.config.incidentLabel&&this.incident_lbl.set("value",this.config.incidentLabel);this.config.locateLabel&&
this.locate_lbl.set("value",this.config.locateLabel);this.tabTable.clear();for(b=0;b<this.config.tabs.length;b++){var a=this.config.tabs[b];a.type===this.config.special_layer.value?(this.chk_weather.setValue(!0),this.weatherTabAdditionalLayers=a.layers,this.currentlySelectedLayer.innerHTML=e.sanitizeHTML(this.weatherTabAdditionalLayers?this.weatherTabAdditionalLayers:"")):this._populateTabTableRow(a)}this.config.celsius&&this.chk_celsius.setValue(!0);this.buffer_lbl.set("value",this.config.bufferLabel?
this.config.bufferLabel:this.nls.buffer_lbl);this.buffer_max.set("value",this.config.bufferRange.maximum);this.buffer_min.set("value",this.config.bufferRange.minimum);this.config.disableLayerManagement&&this.chk_disable.setValue(!0)},getConfig:function(){this.config.distanceUnits=this.selectUnits.value;this.txt_maximumDistance.value&&(this.config.maxDistance=this.txt_maximumDistance.value);this.config.enableRouting=this.chk_routing.checked?!0:!1;this.config.incidentLabel=this.incident_lbl.value;this.config.locateLabel=
this.locate_lbl.value;var b=[],a={};this.chk_weather.checked&&(a.label=this.config.special_layer.label,a.type=this.config.special_layer.value,a.layers=this.weatherTabAdditionalLayers,a.url=this.config.special_layer.url,b.push(a));this.config.celsius=this.chk_celsius.checked?!0:!1;var f=this.tabTable.getRows();w.forEach(f,g.hitch(this,function(u){var A=u.selectLayers,B=u.selectTypes,C=u.labelText;a={};a.label=C.value;a.type=B.value;a.layers=A.value;a.title=A.attr("displayedValue");u.tabInfo&&u.tabInfo.advConfig&&
(a.advConfig=u.tabInfo.advConfig);b.push(a)}));this.config.tabs=b;this.config.bufferLabel=this.buffer_lbl.value;this.config.bufferRange.maximum=this.buffer_max.value;this.config.bufferRange.minimum=this.buffer_min.value;this.config.disableLayerManagement=this.chk_disable.checked?!0:!1;return this.config},_getAllLayers:function(){this.map.itemId&&d.getInstance(this.map,this.map.itemInfo).then(g.hitch(this,function(b){this.opLayers=b;this._setLayers();this._setTypes();this.setConfig(this.config)}))},
_setLayers:function(){var b=[];w.forEach(this.opLayers._layerInfos,g.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers,b):this._validateLayer(a)&&b.push({label:a.title,value:a.id})}));0===b.length?(h.set(this.btnAddTab,"display","none"),new t({message:this.nls.missingLayerInWebMap})):this.layer_options=g.clone(b)},_recurseOpLayers:function(b,a){w.forEach(b,g.hitch(this,function(f){0<f.newSubLayers.length?this._recurseOpLayers(f.newSubLayers,a):this._validateLayer(f)&&
a.push({label:f.title,value:f.id})}))},_validateLayer:function(b){var a=null;b.layerObject&&b.layerObject.url&&(b=b.layerObject.url,-1<b.indexOf("MapServer")||-1<b.indexOf("FeatureServer"))&&(a=b);return a},_setTypes:function(){this.analysis_options=[{value:"closest",label:this.nls.closest},{value:"proximity",label:this.nls.proximity},{value:"summary",label:this.nls.summary}]},_populateTabTableRow:function(b){var a=this.tabTable.addRow({});a.success&&a.tr&&(a=a.tr,this._addTabLayers(a),this._addTabTypes(a),
this._addTabLabel(a),a.selectLayers.set("value",b.layers),a.selectTypes.set("value",b.type),a.labelText.set("value",b.label),a.tabInfo=b)},_addTabRow:function(){var b=this.tabTable.addRow({});b.success&&b.tr&&(b=b.tr,this._addTabLayers(b),this._addTabTypes(b),this._addTabLabel(b))},_addTabLayers:function(b){var a=g.clone(this.layer_options),f=m(".simple-table-cell",b)[0];f&&(n.setStyle(f,"verticalAlign","middle"),a=new q({style:{width:"100%",height:"30px"},options:a}),a.placeAt(f),a.startup(),b.selectLayers=
a)},_addTabTypes:function(b){var a=g.clone(this.analysis_options),f=m(".simple-table-cell",b)[1];f&&(n.setStyle(f,"verticalAlign","middle"),a=new q({style:{width:"100%",height:"30px"},options:a}),a.placeAt(f),a.startup(),b.selectTypes=a)},_addTabLabel:function(b){var a=m(".simple-table-cell",b)[2];n.setStyle(a,"verticalAlign","middle");var f=new x({style:{width:"100%",height:"30px"}});f.placeAt(a);f.startup();b.labelText=f},_onBtnSelectLayersClicked:function(){var b=new z({nls:this.nls,map:this.map,
config:this.config,weatherTabAdditionalLayers:this.weatherTabAdditionalLayers,appConfig:this.appConfig}),a=new c({width:830,height:560,content:b,titleLabel:this.nls.selectLayers});this.own(p(b,"ok",g.hitch(this,function(f){this.weatherTabAdditionalLayers=f;this.currentlySelectedLayer.innerHTML=e.sanitizeHTML(this.weatherTabAdditionalLayers?this.weatherTabAdditionalLayers:"");b.destroy();b=null;a.close()})));this.own(p(b,"cancel",g.hitch(this,function(){b.destroy();b=null;a.close()})))},_onEditLayerClicked:function(b){this.curRow=
b;var a=b.tabInfo;a||(a={},a.label=b.labelText.value,a.type=b.selectTypes.value,a.layers=b.selectLayers.value,a.advConfig={},b.tabInfo=a);if(a.type!==b.selectTypes.value||a.layers!==b.selectLayers.value)a.type=b.selectTypes.value,a.layers=b.selectLayers.value,a.advConfig={};var f=new l({nls:this.nls,callerLayer:b.selectLayers.value,callerTab:a,callerOpLayers:this.opLayers._layerInfos}),u=new c({width:830,height:560,content:f,titleLabel:this.nls.selectFields+": "+b.selectLayers.value});this.own(p(f,
"ok",g.hitch(this,function(A){this.curRow.tabInfo.advConfig=A;this.curRow=null;f.destroy();f=null;u.close()})));this.own(p(f,"cancel",g.hitch(this,function(){this.curRow=null;f.destroy();f=null;u.close()})))}})});