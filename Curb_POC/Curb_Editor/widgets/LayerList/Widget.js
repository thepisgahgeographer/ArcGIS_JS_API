// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-construct dojo/on dojo/keys dijit/focus dojo/query jimu/dijit/CheckBox jimu/dijit/DropMenu jimu/dijit/LoadingShelter jimu/utils ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html dojo/dom-class dojo/dom-style ./NlsStrings".split(" "),function(D,B,h,v,x,g,k,r,q,l,t,m,n,y,z,A,E,G,w,e){return B([D,A],{templateString:E,_currentSelectedLayerRowNode:null,
operationsDropMenu:null,_layerNodeHandles:null,_layerDomNodeStorage:null,_firstLayerNode:!1,_lastLayerNode:null,_eventHandlers:null,_layerIndexs:null,postMixInProperties:function(){this.inherited(arguments);this.nls=e.value;this._layerDomNodeStorage={};this._eventHandlers=[];this._initLayerIndexs()},postCreate:function(){this.refresh();this._initOperations()},_initLayerIndexs:function(){var a=2;this._layerIndexs={};this.operLayerInfos.traversalAll(h.hitch(this,function(c){this._layerIndexs[c.id]=
a++}))},refresh:function(){this._removeLayerNodes();v.forEach(this.operLayerInfos.getLayerInfoArray(),function(a){this.drawListNode(a,0,this.layerListTable)},this);this.config.showBasemap&&v.forEach(this.operLayerInfos.getBasemapLayerInfoArray(),function(a){this.drawListNode(a,0,this.layerListTable)},this);v.forEach(this.operLayerInfos.getTableInfoArray(),function(a){this.drawListNode(a,0,this.tableListTable)},this);v.forEach(this._eventHandlers,function(a){a.remove&&a.remove()});this._supports508Accessibility()},
drawListNode:function(a,c,f,p){if(!this.isLayerHiddenInWidget(a)&&this.layerFilter.isValidLayerInfo(a)){var b=this._layerDomNodeStorage[a.getObjectId()];(a.isRootLayer()||a.isTable)&&b?(g.place(b.layerTrNode,f,p),g.place(b.layerContentTrNode,f,p)):0===a.newSubLayers.length?(b=this.addLayerNode(a,c,f,p),this.config.showLegend?this.addLegendNode(a,c,b.subNode):(a=l(".showLegend-div",b.layerTrNode)[0])&&G.add(a,"hidden-showLegend-div")):(b=this.addLayerNode(a,c,f,p),v.forEach(a.newSubLayers,h.hitch(this,
function(d,u){this.drawListNode(u,d+1,b.subNode)},c)))}},addLayerNode:function(a,c,f,p){var b=this._layerIndexs[a.id],d,u=a.getRootLayerInfo();this._layerDomNodeStorage[a.getObjectId()]={layerTrNode:null,layerContentTrNode:null,layerNodeEventHandles:[],layerNodeReferredDijits:[],layerInfo:a};var C=g.create("tr",{"class":"jimu-widget-row layer-row layer-tr-node-"+a.id,tabindex:0,"aria-label":(a.isTable?window.jimuNls.common.table:window.jimuNls.common.layer)+" "+a.title,layerTrNodeId:a.id});g.place(C,
f,p);this._firstLayerNode||(this._firstLayerNode=C);this._lastLayerNode=C;this._lastLayerInfo=a;var F=g.create("td",{"class":"col col1"},C);for(d=0;d<c;d++)g.create("div",{"class":"begin-blank-div jimu-float-leading",innerHTML:""},F);var H=g.create("div",{"class":"showLegend-div jimu-float-leading ",tabindex:b,role:"button","aria-label":this.nls.expandLayer,"aria-expanded":"false",imageShowLegendDivId:a.id},F);d=g.create("div",{"class":"div-select jimu-float-leading"},F);var J=new t({checked:a.isVisible(),
"class":"visible-checkbox-"+a.id});g.place(J.domNode,d);x.setAttr(J.domNode,"tabindex",b);var I=g.create("div",{"class":"noLegend-div jimu-float-leading"},F);var L=a.isTable?"images/table.png":a.isBasemap()?"images/basemap.png":"images/noLegend.png";g.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+L,alt:"l"},I);if(a.isTiled||a.isTable)w.set(H,"display","none"),w.set(d,"display","none"),w.set(I,"display","block");a.isBasemap()&&(w.set(H,"display","block"),w.set(d,"display",
"none"),w.set(I,"display","block"),w.set(I,"width","auto"),w.set(I,"margin-left","2px"));w.set(F,"width",12*c+40+"px");c=g.create("td",{"class":"col col2"},C);F="";try{a.isInScale()||(F="grayed-title")}catch(K){console.warn(K.message)}I="layer-title-div-"+a.id;g.create("div",{innerHTML:y.sanitizeHTML(a.title),"class":I+" div-content jimu-float-leading "+F},c);F=g.create("td",{"class":"col col3"},C);I=this.hasContentMenu()?"display: block":"display: none";b=g.create("div",{"class":"layers-list-popupMenu-div ",
tabindex:b,role:"button","aria-haspopup":"true","aria-expanded":"false","aria-label":this.nls.tipLayerOperation,style:I},F);F=g.create("tr",{"class":"",layerContentTrNodeId:a.id});g.place(F,f,p);f=g.create("td",{"class":"",colspan:"3"},F);f=g.create("table",{"class":"layer-sub-node",subNodeId:a.id},f);p=this.own(k(c,"click",h.hitch(this,this._onRowTrClick,a,H,C,f)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(H,"click",h.hitch(this,this._onRowTrClick,a,H,C,f)));this._storeLayerNodeEventHandle(u,
p[0]);p=this.own(k(J.domNode,"click",h.hitch(this,this._onCkSelectNodeClick,a,J)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(b,"click",h.hitch(this,this._onPopupMenuClick,a,b,C)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(C,"keydown",h.hitch(this,this._onLayerNodeKey,H,b)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(H,"keydown",h.hitch(this,this._onImageShowLegendKey,a,H,C,f,b)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(d,"keydown",h.hitch(this,this._onCkSelectDivKey,
a,J,C)));this._storeLayerNodeEventHandle(u,p[0]);p=this.own(k(b,"keydown",h.hitch(this,this._onPopupMenuNodeKey,a,b,C,H)));this._storeLayerNodeEventHandle(u,p[0]);this._layerDomNodeStorage[a.getObjectId()].layerTrNode=C;this._layerDomNodeStorage[a.getObjectId()].layerContentTrNode=F;this.layerFilter.isExpanded(a)&&this._foldOrUnfoldLayer(a,!1,H,f);return{layerTrNode:C,subNode:f}},hasContentMenu:function(){var a=!1,c;if(this.config.contextMenu)for(c in this.config.contextMenu)this.config.contextMenu.hasOwnProperty(c)&&
"function"!==typeof this.config.contextMenu[c]&&(a=a||this.config.contextMenu[c]);else a=!0;return a},addLegendNode:function(a,c,f){f=g.create("tr",{"class":"legend-node-tr",tabindex:0},f);g.create("td",{"aria-label":window.jimuNls.common.layer+" "+window.jimuNls.statisticsChart.legend},f);f=g.create("td",{"class":"legend-node-td"},f);try{var p=a.createLegendsNode();w.set(p,"font-size",12*(c+1)+"px");g.place(p,f)}catch(b){console.error(b)}},redrawLegends:function(a){var c=l("div[legendsDivId\x3d'"+
a.id+"']",this.layerListTable)[0];c&&(c._legendDijit&&c._legendDijit.destroy&&c._legendDijit.destroy(),a.drawLegends(c,this.layerListWidget.appConfig.portalUrl))},_storeLayerNodeEventHandle:function(a,c){(a=this._layerDomNodeStorage[a.getObjectId()])&&a.layerNodeEventHandles.push(c)},_storeLayerNodeDijit:function(a,c){(a=this._layerDomNodeStorage[a.getObjectId()])&&a.layerNodeReferredDijits.push(c)},_clearLayerDomNodeStorage:function(){var a=[];this.operLayerInfos.traversalAll(function(p){a.push(p)});
for(var c in this._layerDomNodeStorage)if(this._layerDomNodeStorage.hasOwnProperty(c)&&"function"!==typeof this._layerDomNodeStorage[c]){var f=v.some(a,function(p){if(p.getObjectId().toString()===c)return!0},this);f||(v.forEach(this._layerDomNodeStorage[c].layerNodeEventHandles,function(p){p.remove()},this),v.forEach(this._layerDomNodeStorage[c].layerNodeReferredDijits,function(p){p.destroy()},this),g.destroy(this._layerDomNodeStorage[c].layerTrNode),g.destroy(this._layerDomNodeStorage[c].layerContentTrNode),
delete this._layerDomNodeStorage[c])}},_removeLayerNodes:function(){var a,c;this._clearLayerDomNodeStorage();for(var f in this._layerDomNodeStorage)this._layerDomNodeStorage.hasOwnProperty(f)&&"function"!==typeof this._layerDomNodeStorage[f]&&(a=this._layerDomNodeStorage[f])&&a.layerInfo&&a.layerInfo.isRootLayer()&&a.layerContentTrNode&&a.layerTrNode&&((c=a.layerTrNode.parentNode)&&c.removeChild(a.layerTrNode),(c=a.layerContentTrNode.parentNode)&&c.removeChild(a.layerContentTrNode))},_foldSwitch:function(a,
c,f){return"none"===w.get(f,"display")?this._foldOrUnfoldLayer(a,!1,c,f):this._foldOrUnfoldLayer(a,!0,c,f)},_foldOrUnfoldLayer:function(a,c,f,p){var b=b?f:l("div[imageShowLegendDivId\x3d'"+a.id+"']",this.layerListTable)[0],d=d?p:l("table[subNodeId\x3d'"+a.id+"']",this.layerListTable)[0];f=null;b&&d&&(c?(w.set(d,"display","none"),G.remove(b,"unfold"),f=!0,x.setAttr(b,"aria-label",this.nls.expandLayer),x.setAttr(b,"aria-expanded","false")):(w.set(d,"display","table"),G.add(b,"unfold"),f=!1,x.setAttr(b,
"aria-label",this.nls.collapseLayer),x.setAttr(b,"aria-expanded","true"),a.isLeaf()&&(c=l(".legends-div",d)[0],b=l(".legends-loading-img",c)[0],c&&b&&a.drawLegends(c,this.layerListWidget.appConfig.portalUrl))));return f},_foldOrUnfoldLayers:function(a,c){v.forEach(a,function(f){this._foldOrUnfoldLayer(f,c)},this)},_onCkSelectNodeClick:function(a,c,f){f.ctrlKey||f.metaKey?a.isRootLayer()?this.turnAllRootLayers(c.checked):this.turnAllSameLevelLayers(a,c.checked):(this.layerListWidget._denyLayerInfosIsVisibleChangedResponseOneTime=
!0,a.setTopLayerVisible(c.checked));f.stopPropagation()},_onPopupMenuClick:function(a,c,f,p){var b=a.getRootLayerInfo(),d=c.popupMenu;if(!d){d=(new z({_layerInfo:a,box:this.layerListWidget.domNode.parentNode,popupMenuNode:c,layerListWidget:this.layerListWidget,_config:this.config})).placeAt(c);c.popupMenu=d;this._storeLayerNodeDijit(b,d);var u=this.own(k(d,"onMenuClick",h.hitch(this,this._onPopupMenuItemClick,a,d)));this._storeLayerNodeEventHandle(b,u[0]);u=this.own(c.popupMenu.on("onOpenMenu",h.hitch(this,
this._onPopupMenuOpen,a,c,b)));this._storeLayerNodeEventHandle(b,u[0])}this._changeSelectedLayerRow(f);d&&"opened"===d.state?d.closeDropMenu():(this._hideCurrentPopupMenu(),d&&(this.currentPopupMenu=d,d.openDropMenu()));this.operationsDropMenu&&"opened"===this.operationsDropMenu.state&&this.operationsDropMenu.closeDropMenu();p.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerListWidgetPaneClick:function(){this.operationsDropMenu&&
this.operationsDropMenu.closeDropMenu()},_onRowTrClick:function(a,c,f,p,b){this._changeSelectedLayerRow(f);c=this._foldSwitch(a,c,p);f._expanded=!c;if(b.ctrlKey||b.metaKey)a.isRootLayer()?this.foldOrUnfoldAllRootLayers(c):this.foldOrUnfoldSameLevelLayers(a,c)},_changeSelectedLayerRow:function(a){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===a||(this._currentSelectedLayerRowNode&&G.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),G.add(a,"jimu-widget-row-selected"),
this._currentSelectedLayerRowNode=a)},_onPopupMenuItemClick:function(a,c,f,p){p={itemKey:f.key,extraData:p,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===f.key?"none"===w.get(c.transparencyDiv,"display")?c.showTransNode(a.getOpacity(),f):c.hideTransNode():"setVisibilityRange"===f.key?"none"===w.get(c.setVisibilityRangeNode,"display")?c.showSetVisibilityRangeNode(a,f):c.hideSetVisibilityRangeNode():(a=c.popupMenuInfo.onPopupMenuClick(p),a.closeMenu&&c.closeDropMenu())},_exchangeLayerTrNode:function(a,
c){a=l("tr[layerTrNodeId\x3d'"+a.id+"']",this.layerListTable)[0];var f=l("tr[layerTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];c=l("tr[layerContentTrNodeId\x3d'"+c.id+"']",this.layerListTable)[0];a&&f&&c&&(this.layerListTable.removeChild(f),this.layerListTable.insertBefore(f,a),this.layerListTable.removeChild(c),this.layerListTable.insertBefore(c,a))},_getMovedSteps:function(a,c){var f=1,p,b=this.operLayerInfos.getLayerInfoArray();v.forEach(b,function(d,u){a.id===d.id&&(p=u)},this);if("moveup"===
c)for(;!b[p].isFirst&&!(p--,!this.isLayerHiddenInWidget(b[p])&&this.layerFilter.isValidLayerInfo(b[p])||b[p].isFirst);)f++;else for(;!b[p].isLast&&!(p++,!this.isLayerHiddenInWidget(b[p])&&this.layerFilter.isValidLayerInfo(b[p])||b[p].isLast);)f++;return f},moveUpLayer:function(a){var c=this._getMovedSteps(a,"moveup");this.operLayerInfos.moveUpLayer(a,c)},moveDownLayer:function(a){var c=this._getMovedSteps(a,"movedown");this.operLayerInfos.moveDownLayer(a,c)},isLayerHiddenInWidget:function(a){var c=
!1,f=a;if(a&&this.config.layerOptions&&void 0!==this.config.layerOptions[a.id])for(;f&&!(c=c||!this.config.layerOptions[f.id].display);)f=f.parentLayerInfo;else c=!1;return c},isFirstDisplayedLayerInfo:function(a){if(a.isFirst||!a.isRootLayer()||a.isBasemap())var c=!0;else{c=this._getMovedSteps(a,"moveup");var f=this.operLayerInfos.getLayerInfoArray();a=this.operLayerInfos._getTopLayerInfoIndexById(a.id);c=this.isLayerHiddenInWidget(f[a-c])||!this.layerFilter.isValidLayerInfo(f[a-c])?!0:!1}return c},
isLastDisplayedLayerInfo:function(a){if(a.isLast||!a.isRootLayer()||a.isBasemap())var c=!0;else{c=this._getMovedSteps(a,"movedown");var f=this.operLayerInfos.getLayerInfoArray();a=this.operLayerInfos._getTopLayerInfoIndexById(a.id);c=this.isLayerHiddenInWidget(f[a+c])||!this.layerFilter.isValidLayerInfo(f[a+c])?!0:!1}return c},_initOperations:function(){this.operationsDropMenu=(new m({items:[{key:"turnAllLayersOn",label:this.nls.turnAllLayersOn},{key:"turnAllLayersOff",label:this.nls.turnAllLayersOff},
{key:"separator"},{key:"expandAllLayers",label:this.nls.expandAllLayers},{key:"collapseAlllayers",label:this.nls.collapseAlllayers}],box:this.layerListWidget.domNode.parentNode})).placeAt(this.layerListOperations);var a=l("div.jimu-dropmenu \x3e div:first-child",this.layerListOperations)[0];a&&(G.remove(a,["jimu-icon-btn","popup-menu-button"]),G.add(a,["feature-action","icon-operation"]));this.operationsDropMenu.btnNode&&this.own(k(this.operationsDropMenu.btnNode,"click",h.hitch(this,this._onLayerListOperationsClick)));
this.own(k(this.operationsDropMenu,"onMenuClick",h.hitch(this,this._onOperationsMenuItemClick)));this.operationsDropMenuLoading=(new n({hidden:!0})).placeAt(this.operationsDropMenu.domNode);this.own(k(this.layerListOperations,"keydown",h.hitch(this,this._onLayerListOperationsKey)));this.own(k(this.operationsDropMenu,"onOpenMenu",h.hitch(this,this._onOperationsDropMenuOpen)))},_onLayerListOperationsClick:function(){this._hideCurrentPopupMenu()},_onOperationsMenuItemClick:function(a){switch(a.key){case "turnAllLayersOn":this.turnAllRootLayers(!0);
break;case "turnAllLayersOff":this.turnAllRootLayers(!1);break;case "expandAllLayers":this.foldOrUnfoldAllLayers(!1);break;case "collapseAlllayers":this.foldOrUnfoldAllLayers(!0)}},turnAllRootLayers:function(a){var c=this.operLayerInfos.getLayerInfoArray();v.forEach(c,function(f){this.isLayerHiddenInWidget(f)||f.setTopLayerVisible(a)},this)},turnAllSameLevelLayers:function(a,c){var f={},p=a.getRootLayerInfo();p.traversal(h.hitch(this,function(b){b.parentLayerInfo&&b.parentLayerInfo.id===a.parentLayerInfo.id&&
!this.isLayerHiddenInWidget(b)?f[b.id]={visible:c}:f[b.id]={visible:b.isVisible()}}));p.resetLayerObjectVisibility(f)},foldOrUnfoldAllRootLayers:function(a){var c=v.filter(this.operLayerInfos.getLayerInfoArray(),function(f){return!this.isLayerHiddenInWidget(f)},this);this._foldOrUnfoldLayers(c,a)},foldOrUnfoldSameLevelLayers:function(a,c){a.parentLayerInfo&&(a=v.filter(a.parentLayerInfo.getSubLayers(),function(f){return!this.isLayerHiddenInWidget(f)},this),this._foldOrUnfoldLayers(a,c))},foldOrUnfoldAllLayers:function(a){var c=
[],f=[];this.operationsDropMenuLoading.show();this.operLayerInfos.traversal(h.hitch(this,function(d){this.isLayerHiddenInWidget(d)||(d.isRootLayer()?f.push(d):c.push(d))}));c=f.concat(c);var p=0,b=c.length;setTimeout(h.hitch(this,function(){if(p<b){var d=c.slice(p,p+50);this._foldOrUnfoldLayers(d,a);p+=50;setTimeout(h.hitch(this,arguments.callee),60)}else this.operationsDropMenuLoading.hide()}),60)},_supports508Accessibility:function(){if(this._lastLayerNode){var a=k(this.layerListWidget.layerFilter.searchButton,
"keydown",h.hitch(this,"_onSearchButtonKey"));this._eventHandlers.push(a);a=k(this.supports508Node,"focus",h.hitch(this,"_onLastNodeFocus"));this._eventHandlers.push(a);y.initLastFocusNode(this.layerListWidget.domNode,this.supports508Node)}else y.initLastFocusNode(this.layerListWidget.domNode,this.layerListOperations),a=k(this.supports508Node,"focus",h.hitch(this,"_onLastNodeFocus")),this._eventHandlers.push(a)},_onSearchButtonKey:function(a){a.keyCode===r.TAB&&a.shiftKey&&(a.stopPropagation(),a.preventDefault(),
this._backToLastNodeFlag=!0)},_getLastExpandedLayerNode:function(){for(var a=this._lastLayerNode,c=null,f=this._lastLayerInfo;f;){var p=f.parentLayerInfo;if(p){if((c=this._layerDomNodeStorage[p.getObjectId()].layerTrNode)&&c._expanded){a=this._layerDomNodeStorage[f.getObjectId()].layerTrNode;break}}else{a=this._layerDomNodeStorage[f.getObjectId()].layerTrNode;break}f=p}return a},_onLastNodeFocus:function(){if(this._backToLastNodeFlag){var a=this._getLastExpandedLayerNode();a&&q.focus(a);this._backToLastNodeFlag=
!1}else q.focus(this.layerListWidget.layerFilter.searchButton)},_onLastLayerNodeKey:function(a){a.keyCode!==r.TAB||a.shiftKey||(a.stopPropagation(),a.preventDefault(),q.focus(this.layerListWidget.layerFilter.searchButton))},_onLayerNodeKey:function(a,c,f){f.keyCode===r.ENTER&&(f.stopPropagation(),f.preventDefault(),"none"===x.getStyle(a,"display")?q.focus(c):q.focus(a))},_onImageShowLegendKey:function(a,c,f,p,b,d){d.keyCode===r.TAB&&d.stopPropagation();d.keyCode===r.TAB&&d.shiftKey?(d.stopPropagation(),
d.preventDefault(),q.focus(b)):d.keyCode===r.ESCAPE?(d.stopPropagation(),d.preventDefault(),q.focus(f)):d.keyCode===r.ENTER&&(d.stopPropagation(),d.preventDefault(),this._onRowTrClick(a,c,f,p,d))},_onCkSelectDivKey:function(a,c,f,p){p.keyCode===r.TAB&&p.stopPropagation();if(p.keyCode===r.ESCAPE)p.stopPropagation(),p.preventDefault(),q.focus(f);else if(p.keyCode===r.SPACE||p.keyCode===r.ENTER)p.stopPropagation(),p.preventDefault(),c.checked?c.uncheck(!0):c.check(!0),this._onCkSelectNodeClick(a,c,p)},
_onPopupMenuNodeKey:function(a,c,f,p,b){b.keyCode===r.TAB&&b.stopPropagation();if(b.keyCode===r.TAB&&!b.shiftKey)b.stopPropagation(),b.preventDefault(),q.focus(p);else if(b.keyCode===r.ESCAPE)b.stopPropagation(),b.preventDefault(),q.focus(f);else if(b.keyCode===r.ENTER||b.keyCode===r.DOWN_ARROW||b.keyCode===r.UP_ARROW)b.stopPropagation(),b.preventDefault(),this._onPopupMenuClick(a,c,f,b)},_onPopupMenuOpen:function(a,c,f){var p=l(".menu-item",c.popupMenu.dropMenuNode);p=p.filter(function(u){return x.hasClass(u,
"menu-item-hidden")?!1:!0});var b=p[0],d=p[p.length-1];p.forEach(function(u,C){var F=!1,H=!1,J=p[C-1],I=p[C+1];0===C?(q.focus(u),F=!0):C===p.length-1&&(H=!0);u.hasBeenOpened||(C=this.own(k(u,"keydown",h.hitch(this,this._onPopupMenuItemKey,c,J,I,b,d,F,H))),this._storeLayerNodeEventHandle(f,C[0]),u.hasBeenOpened=!0)},this)},_onPopupMenuItemKey:function(a,c,f,p,b,d,u,C){if(C.keyCode===r.DOWN_ARROW)C.stopPropagation(),C.preventDefault(),f&&q.focus(f);else if(C.keyCode===r.UP_ARROW)C.stopPropagation(),
C.preventDefault(),c&&q.focus(c);else if(C.keyCode===r.HOME)C.stopPropagation(),C.preventDefault(),p&&q.focus(p);else if(C.keyCode===r.END)C.stopPropagation(),C.preventDefault(),b&&q.focus(b);else if(C.keyCode===r.ESCAPE||C.keyCode===r.TAB)C.stopPropagation(),C.preventDefault(),q.focus(a),a.popupMenu.closeDropMenu()},_enableNavMode:function(a){a.keyCode!==r.TAB||y.isInNavMode()||x.addClass(document.body,"jimu-nav-mode")},_onLayerListOperationsKey:function(a){a.keyCode===r.ENTER&&this.operationsDropMenu._onBtnClick(a)},
_onOperationsDropMenuOpen:function(){var a=l(".menu-item",this.operationsDropMenu.domNode);a=a.filter(function(p){return x.hasClass(p,"menu-item-hidden")?!1:!0});var c=a[0],f=a[a.length-1];a.forEach(function(p,b){var d=!1,u=!1,C=a[b-1],F=a[b+1];0===b?(q.focus(p),d=!0):b===a.length-1&&(u=!0);p.hasBeenOpened||(this.own(k(p,"keydown",h.hitch(this,this._onLayerListOperationsMenuItemKey,C,F,c,f,d,u))),p.hasBeenOpened=!0)},this)},_onLayerListOperationsMenuItemKey:function(a,c,f,p,b,d,u){if(u.keyCode===
r.DOWN_ARROW)u.stopPropagation(),u.preventDefault(),c&&q.focus(c);else if(u.keyCode===r.UP_ARROW)u.stopPropagation(),u.preventDefault(),a&&q.focus(a);else if(u.keyCode===r.HOME)u.stopPropagation(),u.preventDefault(),f&&q.focus(f);else if(u.keyCode===r.END)u.stopPropagation(),u.preventDefault(),p&&q.focus(p);else if(u.keyCode===r.ESCAPE||u.keyCode===r.TAB)u.stopPropagation(),u.preventDefault(),q.focus(this.layerListOperations),this.operationsDropMenu.closeDropMenu()}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/query dojo/on dijit/focus dojo/keys dojo/Evented ../utils".split(" "),
function(D,B,h,v,x,g,k,r,q,l,t){return D([B,l],{baseClass:"jimu-dropmenu",declaredClass:"jimu.dijit.DropMenu",focusNodeWhenLeave:null,constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=x.create("div",{"class":"popup-menu-button"},this.domNode);this.own(k(this.btnNode,"click",h.hitch(this,this._onBtnClick)));this.box||(this.box=this.domNode.parentNode);this.own(k(this.box,"click",h.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(m){m.stopPropagation();
this.dropMenuNode||this._createDropMenuNode();"closed"===this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=x.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);v.forEach(this.items,function(m){if(m.key&&"separator"===m.key)x.create("hr",{"class":"menu-item-identification menu-item-line",itemId:m.key},this.dropMenuNode);else if(m.key){var n=x.create("div",{"class":"menu-item-identification menu-item",
tabindex:"0",itemId:m.key,role:"button",innerHTML:t.sanitizeHTML(m.label)},this.dropMenuNode);this.own(k(n,"click",h.hitch(this,function(y){this.selectItem(m,y)})));this.own(k(n,"keydown",h.hitch(this,function(y){if(y.keyCode===q.ENTER){y.stopPropagation();y.preventDefault();var z=g("a",n)[0];z?(y=document.createEvent("MouseEvents"),y.initEvent("click",!0,!0),z.dispatchEvent(y)):this.selectItem(m,y)}})))}},this);this.focusNodeWhenLeave||(this.focusNodeWhenLeave=this.domNode.parentNode)},_getDropMenuPosition:function(){var m=
x.getContentBox(this.box),n=x.getMarginBox(this.domNode),y=x.getMarginBox(this.btnNode),z=x.getMarginBox(this.dropMenuNode),A={};A.l=n.l;A.t=n.t+y.h;if(A.t+z.h>m.h){var E=n.t;var G=m.h-n.t-y.h;G=Math.max(E,G);G===E&&(A.t=0-z.h)}A.l+z.w>m.w&&(z=n.l,m=m.w-n.l-y.w,G=Math.max(z,m),G===z&&(A.l="",A.r=0));A.left=A.l;A.top=A.t;A.right=A.r;return A},getMenuItemNodeByItemKey:function(m){var n;g(".menu-item",this.dropMenuNode).some(function(y){return x.getAttr(y,"itemId")===m?(n=y,!0):!1},this);return n},selectItem:function(m){this.closeDropMenu();
this.emit("onMenuClick",m)},openDropMenu:function(){this.state="opened";x.setStyle(this.dropMenuNode,"display","");x.setStyle(this.dropMenuNode,t.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){"opened"===this.state&&r.focus(this.focusNodeWhenLeave);this.state="closed";x.setStyle(this.dropMenuNode,"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on dojo/keys dijit/focus dojo/Deferred jimu/dijit/DropMenu jimu/utils dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style esri/dijit/VisibleScaleRangeSlider ./NlsStrings ./PopupMenuInfo".split(" "),
function(D,B,h,v,x,g,k,r,q,l,t,m,n,y,z,A,E,G,w){return D([l,m],{templateString:z,popupMenuInfo:null,loading:null,_deniedItems:null,_deniedItemsFromConfig:null,_layerInfo:null,constructor:function(){this.nls=G.value},postCreate:function(){this.inherited(arguments);this._initDeniedItems();this.loading=h.create("div",{"class":"popup-menu-loading"},this.popupMenuNode)},_initDeniedItems:function(){var e=[],a={ZoomTo:"zoomto",Transparency:"transparency",SetVisibilityRange:"setVisibilityRange",EnableOrDisablePopup:"controlPopup",
ControlLabels:"controlLabels",MoveupOrMovedown:"moveup movedown",OpenAttributeTable:"table",DescriptionOrShowItemDetailsOrDownload:"url"};this._deniedItems=[];this._deniedItemsFromConfig=[];for(var c in this._config.contextMenu)this._config.contextMenu.hasOwnProperty(c)&&"function"!==typeof this._config.contextMenu[c]&&!1===this._config.contextMenu[c]&&(e=e.concat(a[c].split(" ")));B.forEach(e,v.hitch(this,function(f){this._deniedItemsFromConfig.push({key:f,denyType:"hidden"})}))},_getDropMenuPosition:function(){return{top:"40px",
right:"0px",zIndex:1}},_getTransNodePosition:function(){return{top:"28px",right:"2px"}},_onBtnClick:function(){},_refresh:function(){this._denyItems();this._changeItemsUI()},_denyItems:function(){var e=x("[class~\x3d'menu-item-identification']",this.dropMenuNode);e.forEach(function(f){h.removeClass(f,"menu-item-dissable");h.removeClass(f,"menu-item-hidden")},this);h.removeClass(this.dropMenuNode,"no-border");B.forEach(this._deniedItems,function(f){var p=x("div[itemId\x3d'"+f.key+"']",this.dropMenuNode)[0];
p&&("disable"===f.denyType?(h.addClass(p,"menu-item-dissable"),h.setAttr(p,"aria-disabled","true"),"url"===f.key&&x(".menu-item-description",p).forEach(function(b){h.setAttr(b,"href","#");h.removeAttr(b,"target")})):(h.removeAttr(p,"aria-disabled"),h.addClass(p,"menu-item-hidden")))},this);for(var a=-1,c=0;c<e.length;c++)h.hasClass(e[c],"menu-item-line")&&(-1===a||h.hasClass(e[a],"menu-item-line"))&&h.addClass(e[c],"menu-item-hidden"),h.hasClass(e[c],"menu-item-hidden")||(a=c);e=B.filter(e,function(f){return!h.hasClass(f,
"menu-item-hidden")});0===e.length?h.addClass(this.dropMenuNode,"no-border"):(h.removeClass(this.dropMenuNode,"no-border"),h.hasClass(e[e.length-1],"menu-item-line")&&h.addClass(e[e.length-1],"menu-item-hidden"))},_changeItemsUI:function(){var e=x("[itemid\x3dcontrolPopup]",this.dropMenuNode)[0];e&&(this._layerInfo.isPopupNestedEnabled()?h.setAttr(e,"innerHTML",this.nls.removePopup):h.setAttr(e,"innerHTML",this.nls.enablePopup));(e=x("[itemid\x3dcontrolLabels]",this.dropMenuNode)[0])&&this._layerInfo.canShowLabel()&&
(this._layerInfo.isShowLabels()?h.setAttr(e,"innerHTML",this.nls.hideLables):h.setAttr(e,"innerHTML",this.nls.showLabels));(e=x("[itemid\x3durl] a",this.dropMenuNode)[0])&&h.setAttr(e,"target","_blank")},_switchLoadingState:function(e){e?h.setStyle(this.loading,"display","block"):h.setStyle(this.loading,"display","none")},selectItem:function(e,a){for(var c=!1,f=0;f<this._deniedItems.length;f++)if(this._deniedItems[f].key===e.key){c=!0;break}c||this.emit("onMenuClick",e);a.stopPropagation(a)},openDropMenu:function(){var e=
v.hitch(this,this.inherited,arguments),a=new q;this._switchLoadingState(!0);this.dropMenuNode?a.resolve(this.popupMenuInfo):w.create(this._layerInfo,this.layerListWidget).then(v.hitch(this,function(c){this.items=c.getDisplayItems();this.popupMenuInfo=c;this._createDropMenuNode();a.resolve(this.popupMenuInfo)}));a.then(v.hitch(this,function(){this.popupMenuInfo.getDeniedItems().then(v.hitch(this,function(c){this._deniedItems=this._deniedItemsFromConfig.concat(c);this._refresh();e(arguments);this._switchLoadingState(!1)}),
v.hitch(this,function(){this._switchLoadingState(!1)}))}),v.hitch(this,function(){this._switchLoadingState(!1)}))},closeDropMenu:function(){this.inherited(arguments);this.hideTransNode();this.hideSetVisibilityRangeNode()},_onTransparencyDivClick:function(e){e.stopPropagation()},showTransNode:function(e,a){this.hideSetVisibilityRangeNode();this.transHorizSlider||this._createTransparencyWidget(a);this.transHorizSlider.set("value",1-e);A.set(this.transparencyDiv,"top",this._getTransNodePosition().top);
isRTL?A.set(this.transparencyDiv,"left",this._getTransNodePosition().right):A.set(this.transparencyDiv,"right",this._getTransNodePosition().right);A.set(this.transparencyDiv,"display","block");this.transHorizSlider.focus()},hideTransNode:function(){A.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(e){this.transHorizSlider=new n({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",v.hitch(this,function(a){this.emit("onMenuClick",
{key:"transparencyChanged"},{newTransValue:a})})));this.own(g(this.transHorizSlider.domNode,"keydown",v.hitch(this,function(a){a.keyCode===k.ESCAPE?(a.stopPropagation(),a.preventDefault(),this.hideTransNode(),(a=this.getMenuItemNodeByItemKey(e.key))&&r.focus(a)):a.keyCode===k.TAB&&(a.stopPropagation(),a.preventDefault(),this._enableNavMode(a))})));new y({container:"bottomDecoration"},this.transparencyRule)},_onSetVisibilityRangeNode:function(e){e.stopPropagation()},showSetVisibilityRangeNode:function(e,
a){this.hideTransNode();if(!this.visibleScaleRangeSlider){var c=e.getScaleRange();this.visibleScaleRangeSlider=(new E({map:e.map,minScale:c.minScale,maxScale:c.maxScale})).placeAt(this.setVisibilityRangeNode);this.visibleScaleRangeSlider.startup();this._supportsVisibilityRange508Accessibility(a)}this.own(this.visibleScaleRangeSlider.on("scale-range-change",v.hitch(this,function(f){e.setScaleRange(f.minScale,f.maxScale)})));A.set(this.setVisibilityRangeNode,"top",this._getTransNodePosition().top);
isRTL?A.set(this.setVisibilityRangeNode,"left",this._getTransNodePosition().right):A.set(this.setVisibilityRangeNode,"right",this._getTransNodePosition().right);A.set(this.setVisibilityRangeNode,"display","block");this.visibleScaleRangeSlider._slider.focus();this.visibleScaleRangeSlider._slider.focus()},hideSetVisibilityRangeNode:function(){A.set(this.setVisibilityRangeNode,"display","none")},hide:function(){A.set(this.domNode,"display","none")},show:function(){A.set(this.domNode,"display","block")},
_enableNavMode:function(e){e.keyCode!==k.TAB||t.isInNavMode()||h.addClass(document.body,"jimu-nav-mode")},_supportsVisibilityRange508Accessibility:function(e){var a=x(".dijitSliderImageHandle",this.setVisibilityRangeNode)[0],c=x(".dijitDownArrowButton",this.setVisibilityRangeNode),f=c[1],p=c[0],b=c[1];this.own(g(a,"keydown",v.hitch(this,function(d){d.keyCode===k.TAB&&d.shiftKey&&(d.stopPropagation(),d.preventDefault())})));this.own(g(f,"keydown",v.hitch(this,function(d){d.keyCode!==k.TAB||d.shiftKey?
d.keyCode===k.ENTER&&(d.stopPropagation(),d.preventDefault(),setTimeout(v.hitch(this,function(){this._bindEsriScaleMenuPopupKey(b)}),200)):(d.stopPropagation(),d.preventDefault())})));this.own(g(p,"keydown",v.hitch(this,function(d){d.keyCode===k.ENTER&&(d.stopPropagation(),d.preventDefault(),setTimeout(v.hitch(this,function(){this._bindEsriScaleMenuPopupKey(p)}),200))})));this.own(g(p,"click",v.hitch(this,function(d){d.stopPropagation();d.preventDefault();setTimeout(v.hitch(this,function(){this._bindEsriScaleMenuPopupKey(p)}),
200)})));this.own(g(b,"click",v.hitch(this,function(d){d.stopPropagation();d.preventDefault();setTimeout(v.hitch(this,function(){this._bindEsriScaleMenuPopupKey(b)}),200)})));this.own(g(this.setVisibilityRangeNode,"keydown",v.hitch(this,function(d){d.keyCode===k.ESCAPE?(d.stopPropagation(),d.preventDefault(),this.hideSetVisibilityRangeNode(),(d=this.getMenuItemNodeByItemKey(e.key))&&r.focus(d)):d.keyCode===k.TAB?(d.stopPropagation(),this._enableNavMode(d)):d.keyCode===k.ENTER&&d.stopPropagation()})))},
_bindEsriScaleMenuPopupKey:function(e){var a=this._getEsriScaleMenuPopup();if(a){var c=x(".dijitInputInner",a)[0];h.setAttr(c,"tabindex","0");var f=x(".esriHeader",a);var p=x(".esriCurrent",a)[0];f[0]&&p&&h.setAttr(c,"aria-label",f[0].innerText+" "+p.innerText);r.focus(c)}if(a&&!a._hasBeenBoundKey){var b=x(".esriContent",a)[1];h.setAttr(b,"tabindex","0");f[1]&&h.setAttr(b,"aria-label",f[1].innerText+" ");f=x("li.esriItem",a);B.forEach(f,function(d){h.setAttr(d,"tabindex","0");this.own(g(d,"keydown",
v.hitch(this,function(u){var C=this._getMenuItemInfo(a,d);u.keyCode===k.TAB?(u.stopPropagation(),u.preventDefault(),b&&r.focus(b)):u.keyCode===k.DOWN_ARROW?(u.stopPropagation(),u.preventDefault(),C.nextMenuItem&&r.focus(C.nextMenuItem)):u.keyCode===k.UP_ARROW?(u.stopPropagation(),u.preventDefault(),C.previousMenuItem&&r.focus(C.previousMenuItem)):u.keyCode===k.ESCAPE?(u.stopPropagation(),u.preventDefault(),b&&r.focus(b)):u.keyCode===k.ENTER&&(u.stopPropagation(),u.preventDefault(),u=document.createEvent("MouseEvents"),
u.initEvent("click",!0,!0),d.dispatchEvent(u),e&&r.focus(e))})))},this);this.own(g(c,"keydown",v.hitch(this,function(d){d.keyCode===k.TAB?(d.stopPropagation(),d.preventDefault(),this._enableNavMode(d),r.focus(b)):d.keyCode===k.ESCAPE?e&&r.focus(e):d.keyCode===k.ENTER&&e&&r.focus(e)})));b&&this.own(g(b,"keydown",v.hitch(this,function(d){var u=this._getMenuItemInfo(a);d.keyCode===k.TAB?(d.stopPropagation(),d.preventDefault(),this._enableNavMode(d),r.focus(c)):d.keyCode===k.ENTER?(d.stopPropagation(),
d.preventDefault(),u.firstMenuItem&&r.focus(u.firstMenuItem)):d.keyCode===k.ESCAPE&&e&&r.focus(e)})));a._hasBeenBoundKey=!0}},_getMenuItemInfo:function(e,a){var c={firstMenuItem:null,lastMenuItem:null,previousMenuItem:null,nextMenuItem:null},f=x("li.esriItem",e);f=B.filter(f,v.hitch(this,function(p){return h.hasClass(p,"esriHidden")?!1:!0}));a&&B.some(f,function(p,b){return p===a?(c.previousMenuItem=f[b-1],c.nextMenuItem=f[b+1],!0):!1},this);c.firstMenuItem=f[0];c.lastMenuItem=f[f.length-1];return c},
_getEsriScaleMenuPopup:function(){var e=null;x(".esriScaleMenuPopup",document.body).some(function(a){return"block"===h.getStyle(a,"display")?(e=a,!0):!1});return e}})})},"esri/dijit/VisibleScaleRangeSlider":function(){define("../kernel ./_EventedWidget ./_Tooltip ./VisibleScaleRangeSlider/_RecommendedScaleRangeBounds ./VisibleScaleRangeSlider/_SlideEvent ./VisibleScaleRangeSlider/ScaleMenu ./VisibleScaleRangeSlider/ScalePreview ./VisibleScaleRangeSlider/ScaleRanges dijit/form/DropDownButton dijit/popup dojo/_base/array dojo/_base/lang dojo/aspect dojo/debounce dojo/Deferred dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/has dojo/on dojo/string dojox/form/HorizontalRangeSlider dojo/i18n!../nls/jsapi".split(" "),
function(D,B,h,v,x,g,k,r,q,l,t,m,n,y,z,A,E,G,w,e,a,c,f,p){B=B.createSubclass([h],{declaredClass:"esri.dijit.VisibleScaleRangeSlider",baseClass:"esriVisibleScaleRangeSlider",css:{currentScaleIndicator:"esriCurrentScaleIndicator",currentScaleIndicatorContainer:"esriCurrentScaleIndicatorContainer",scaleIndicator:"esriScaleIndicator",scaleIndicatorContainer:"esriScaleIndicatorContainer"},disabled:!1,map:null,layer:null,region:"en-US",minScale:0,maxScale:0,intermediateChanges:!1,labels:p.widgets.visibleScaleRangeSlider,
_slider:null,_currentScaleIndicator:null,_scalePreview:null,_maxScaleButton:null,_minScaleButton:null,_mapUpdateHandler:null,_scaleRanges:null,_scheduleScaleRangeChangeEmit:null,_getSliderIndexRange:function(b){b=Math.floor(b);return{min:b,max:b+.99999}},_setDisabledAttr:function(b){this._slider.set("disabled",b);this._maxScaleButton.set("disabled",b);this._minScaleButton.set("disabled",b);this._set("disabled",b)},_setMapAttr:function(b){this._set("map",b);this._mapUpdateHandler&&this._mapUpdateHandler.remove();
this._slider.set("disabled",!0);this._ensureMap().then(this._updateFromMap)},_setConstraintsAttr:function(b){this._set("constraints",b);this._setUpSlider({minScale:b.minScale,maxScale:b.maxScale})},_updateFromMap:function(b){var d=b.getMinScale(),u=b.getMaxScale();this._setUpSlider({minScale:d,maxScale:u});this._updateCurrentScaleIndicator();b=b.on("zoom-end",m.hitch(this,this._updateCurrentScaleIndicator));this.own(b);this._mapUpdateHandler=b},_setUpSlider:function(b){var d=b.maxScale;b=b.minScale;
this._slider.set("disabled",this.get("disabled"));this._scaleRanges.set("scaleRangeBounds",{minScale:b,maxScale:d});var u=this._getSliderIndexRange(this._scaleRanges.length-1);this._slider.set("maximum",u.max);this._silentSliderUpdate({maxScale:d,minScale:b})},_ensureMap:function(){return this._untilLoaded(this.map)},_untilLoaded:function(b){var d=new z;if(b)if(b.loaded)d.resolve(b);else b.on("load",function(){d.resolve(b)});else d.reject(Error("could not load resource"));return d.promise},_updateCurrentScaleIndicator:function(){var b=
this._scaleRanges.clampScale(this.map.getScale());b=this._mapScaleToSlider(b)/this._slider.maximum;this.isLeftToRight()||(b=1-b);w.set(this._currentScaleIndicator,{left:100*b+"%"})},_setLayerAttr:function(b){this._set("layer",b);this._ensureScaleRangeProvider().then(this._ensureLayer).then(this._updateMinMaxScaleFromLayer)},_ensureLayer:function(){return this._untilLoaded(this.layer)},_updateMinMaxScaleFromLayer:function(b){this.set({minScale:b.minScale,maxScale:b.maxScale})},_mapSliderToScale:function(b){var d=
this._getSliderIndexRange(b),u=this._scaleRanges.findScaleRangeByIndex(b);return this._mapToRange(b,d.min,d.max,u.minScale,u.maxScale)},_mapToRange:function(b,d,u,C,F){return C+(b-d)*(F-C)/(u-d)},_setRegionAttr:function(b){this._set("region",b);this._scalePreview.set("source",r.getScalePreviewSource(b))},_getMinimumAttr:function(){return this._mapSliderToScale(this._slider.minimum)},_getMaximumAttr:function(){return this._mapSliderToScale(this._slider.maximum)},_getActualMaxScaleAttr:function(){return this._scaleRanges.clampMaxScale(this.maxScale)},
_setMaxScaleAttr:function(b){this._set("maxScale",b);this._ensureScaleRangeProvider().then(m.hitch(this,function(){b=this._scaleRanges.clampMaxScale(b);this._set("maxScale",this._layerConstrainedMaxScale(b));this._silentSliderUpdate({maxScale:b});this._scheduleScaleRangeChangeEmit()}))},_silentSliderUpdate:function(b){var d=b.minScale,u=b.maxScale,C=this._scaleRanges;b=this._slider;void 0!==d&&(d=this._mapScaleToSlider(C.clampMinScale(d)),b.set("value",d,!1,!1));void 0!==u&&(d=this._mapScaleToSlider(C.clampMaxScale(u)),
b.set("value",d,!1,!0))},_mapScaleToSlider:function(b){var d=this._scaleRanges.scaleToRangeIndex(b),u=this._getSliderIndexRange(d);d=this._scaleRanges.findScaleRangeByIndex(d);return this._mapToRange(b,d.minScale,d.maxScale,u.min,u.max)},_getActualMinScaleAttr:function(){return this._scaleRanges.clampMinScale(this.minScale)},_setMinScaleAttr:function(b){this._set("minScale",b);this._ensureScaleRangeProvider().then(m.hitch(this,function(){b=this._scaleRanges.clampMinScale(b);this._set("minScale",this._layerConstrainedMinScale(b));
this._silentSliderUpdate({minScale:b});this._scheduleScaleRangeChangeEmit()}))},_ensureScaleRangeProvider:function(){if(this.map)return this._ensureMap();var b=new z;this.constraints&&b.resolve();return b.promise},_emitScaleRangeChange:function(){this.emit("scale-range-change",{minScale:this.minScale,maxScale:this.maxScale})},_layerConstrainedMinScale:function(b){var d=m.getObject("tileInfo.lods",!1,this.layer)||[];var u=this.layer&&("esri.layers.RasterXLayer"===this.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===
this.layer.declaredClass);return 0<d.length&&!u?(d=d[0].scale,u=this._scaleRanges.get("firstRange"),(u=.85<this._mapToRange(b,u.maxScale,u.minScale,0,1))?d:b>d?d:b):this._scaleRanges.beyondMinScale(b)?0:b},_layerConstrainedMaxScale:function(b){var d=m.getObject("tileInfo.lods",!1,this.layer)||[],u=this.layer&&("esri.layers.RasterXLayer"===this.layer.declaredClass||"esri.layers.ArcGISImageServiceLayer"===this.layer.declaredClass);return 0<d.length&&!u?(d=d[d.length-1].scale,b<d?d:b):this._scaleRanges.beyondMaxScale(b)?
0:b},constructor:function(){this._scaleRanges=new (r.createSubclass([v]));this._scheduleScaleRangeChangeEmit=y(m.hitch(this,this._emitScaleRangeChange),0);this._ensureMap=m.hitch(this,this._ensureMap);this._ensureScaleRangeProvider=m.hitch(this,this._ensureScaleRangeProvider);this._ensureLayer=m.hitch(this,this._ensureLayer);this._updateMinMaxScaleFromLayer=m.hitch(this,this._updateMinMaxScaleFromLayer);this._updateFromMap=m.hitch(this,this._updateFromMap)},buildRendering:function(){this.inherited(arguments);
this._initSlider();this._initScalePreview();this._initCurrentScaleIndicator();this._initScaleMenus()},_initSlider:function(){var b=new (f.createSubclass([x]))({baseClass:"esriHorizontalSlider",showButtons:!1,intermediateChanges:this.intermediateChanges,disabled:!0});this._slider=b;b.placeAt(this.domNode);b.startup();this.own(b.on("slide-onmousemove, slidemax-onmousemove",m.hitch(this,function(d){this._updateScalePreview(d.movable.handle)})),b.on("slide-onmovestop, slidemax-onmovestop",m.hitch(this,
function(d){A.contains(d.movable.handle,"dijitSliderThumbHover")||this._closeScalePreview()})),b.on("change",m.hitch(this,function(){var d=Math.round(this._mapSliderToScale(this._getSliderMin())),u=Math.round(this._mapSliderToScale(this._getSliderMax()));this.set({minScale:d,maxScale:u})})),n.after(b,"_setValueAttr",m.hitch(this,this._updateLabelMenus)))},_getSliderMin:function(){return this._slider.get("value")[0]},_getSliderMax:function(){return this._slider.get("value")[1]},_updateLabelMenus:function(){var b=
this._maxScaleButton;this._minScaleButton.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMin()));b.set("label",this._scaleRanges.getScaleRangeLabel(this._getSliderMax()))},_initScalePreview:function(){var b=new k;b.startup();l.moveOffScreen(b);t.forEach([this._slider._movable.handle,this._slider._movableMax.handle],function(d){d.onmouseenter=m.hitch(this,this._updateScalePreview,d);d.onmouseleave=m.hitch(this,this._closeScalePreview)},this);this.own(b);this._scalePreview=b},_closeScalePreview:function(){l.close(this._scalePreview)},
_updateScalePreview:function(b){if(!this.disabled){var d=this._scalePreview;l.moveOffScreen(d);var u=this._slider,C=b===u.sliderHandle?this._getSliderMin():this._getSliderMax(),F=G.position(b),H=G.position(d.domNode);u=G.position(u.sliderBarContainer);var J=this.isLeftToRight();C=this._scaleRanges.getScalePreviewSpriteBackgroundPosition(C);d.set("backgroundPosition",C);F=F.x-u.x;H=.5*H.w;l.open({parent:this,popup:d,around:b,orient:F<H?J?["above","below"]:["above-alt","below-alt"]:F<u.w-H?["above-centered",
"below-centered"]:J?["above-alt","below-alt"]:["above","below"]})}},_initCurrentScaleIndicator:function(){if(this.map){var b=E.create("div",{className:this.css.scaleIndicatorContainer+" "+this.css.currentScaleIndicatorContainer},this._slider.sliderBarContainer),d=E.create("div",{className:this.css.scaleIndicator+" "+this.css.currentScaleIndicator},b);this._currentScaleIndicator=d;this.createTooltip(d);b=a(d,"mouseover",m.hitch(this,function(){var u=c.substitute(this.labels.currentScaleTooltip,{scaleLabel:this._scaleRanges.getScaleRangeLabel(this._mapScaleToSlider(this.map.getScale()))});
this.findTooltip(d).set("label",u)}));this.own(b)}},_initScaleMenus:function(){var b=new g,d=new g;this.own(b.on("scale-selected",m.hitch(this,function(F){u.closeDropDown();this.set("minScale",F.scale)})));this.own(d.on("scale-selected",m.hitch(this,function(F){C.closeDropDown();this.set("maxScale",F.scale)})));var u=new q({baseClass:"esriScaleMenuButton esriMinScaleMenuButton",dropDown:b,dropDownPosition:["below","above"]});u.toggleDropDown();u.toggleDropDown();var C=new q({baseClass:"esriScaleMenuButton esriMaxScaleMenuButton",
dropDown:d,dropDownPosition:["below","above"]});C.toggleDropDown();C.toggleDropDown();this.own(n.before(u,"openDropDown",m.hitch(this,function(){var F=this._scaleRanges.findScaleRange(this.get("actualMaxScale")).minScale;b.set("options",{label:u.label,scale:{current:this.get("actualMinScale"),map:this._getMapScale(),min:this.get("minimum"),max:F}})})));this.own(n.before(C,"openDropDown",m.hitch(this,function(){var F=this._scaleRanges.findScaleRange(this.get("actualMinScale")).maxScale;d.set("options",
{label:C.label,scale:{current:this.get("actualMaxScale"),map:this._getMapScale(),min:F,max:this.get("maximum")}})})));u.placeAt(this.domNode);C.placeAt(this.domNode);b.startup();d.startup();u.startup();C.startup();this._minScaleButton=u;this._maxScaleButton=C},_getMapScale:function(){return this.map?this.map.getScale():-1},startup:function(){this.inherited(arguments);this.watch("intermediateChanges",function(b,d,u){this._slider.set(b,u)})}});e("extend-esri")&&m.setObject("dijit.VisibleScaleRangeSlider",
B,D);return B})},"esri/dijit/_Tooltip":function(){define(["dijit/Tooltip","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom"],function(D,B,h,v,x){return h(null,{declaredClass:"esri.dijit._Tooltip",_tooltips:null,constructor:function(){this._tooltips=[]},startup:function(){this.inherited(arguments);this._started||B.forEach(this._tooltips,function(g){g.startup()})},destroy:function(){this.inherited(arguments);B.forEach(this._tooltips,function(g){g.destroy()});this._tooltips=null},
createTooltips:function(g){B.forEach(g,function(k){this.createTooltip(k.node,k.label)},this)},createTooltip:function(g,k){if(g=this._getConnectId(g))k="object"===typeof k?v.mixin({},k,{connectId:g}):{connectId:g,label:k},k=new D(k),this._started&&k.startup(),this._tooltips.push(k)},_getConnectId:function(g){var k;if(g){if(v.isArray(g)){var r=[];B.forEach(g,function(q){(k=this._getNode(q))&&r.push(k)});if(0===r.length)return}else if(r=this._getNode(g),!r)return;return r}},_getNode:function(g){return x.byId(g.domNode||
g)},findTooltip:function(g){var k=this._getNode(g),r;if(g){g=this._tooltips;var q=g.length;for(var l=0;l<q;l++){var t=g[l];if(r=v.isArray(t.connectId)?-1<B.indexOf(t.connectId,k):t.connectId===k)return t}}}})})},"esri/dijit/VisibleScaleRangeSlider/_RecommendedScaleRangeBounds":function(){define(["./recommendedScales","dojo/_base/declare"],function(D,B){return B(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._RecommendedScaleRangeBounds",beyondMinScale:function(h){var v=this.get("firstRange"),
x=v.minScale;v=D.getRecommendedScale(v.id)||v.maxScale;return h<=x&&h>v},beyondMaxScale:function(h){var v=this.get("lastRange"),x=v.maxScale;v=D.getRecommendedScale(v.id)||v.minScale;return h<v&&h>=x}})})},"esri/dijit/VisibleScaleRangeSlider/recommendedScales":function(){define(["dojo/_base/lang"],function(D){var B={_recommendedScales:{world:1E8,continent:5E7,countriesBig:25E6,countriesSmall:12E6,statesProvinces:6E6,stateProvince:3E6,counties:15E5,county:75E4,metropolitanArea:32E4,cities:16E4,city:8E4,
town:4E4,neighborhood:2E4,streets:1E4,street:5E3,buildings:2500,building:1250,smallBuilding:800,rooms:400,room:100},getRecommendedScale:function(h){return B._recommendedScales[h]},all:function(){return D.clone(B._recommendedScales)}};return B})},"esri/dijit/VisibleScaleRangeSlider/_SlideEvent":function(){define(["dojo/_base/array","dojo/_base/declare"],function(D,B){return B(null,{declaredClass:"esri.dijit.VisibleScaleRangeSlider._SlideEvent",_events:["onMouseMove","onFirstMove",{name:"onMoveStop",
hookTo:"destroy"}],postCreate:function(){this.inherited(arguments);this._extendMover(this._movable);this._extendMover(this._movableBar,"rangebar");this._extendMover(this._movableMax,"max")},_extendMover:function(h,v){if(h){var x=h.mover,g={};D.forEach(this._events,function(k){if("object"===typeof k){var r=k.name;var q=k.hookTo}else r=k;var l=x.prototype[r]||function(){};var t="slide"+(v||"")+"-"+r.toLowerCase();var m=function(){l.apply(this,arguments);this.widget.emit(t,{movable:h})};if(q){var n=
x.prototype[q];g[q]=function(){n.apply(this,arguments);m.apply(this,arguments)}}g[r]=m});x.extend(g)}}})})},"esri/dijit/VisibleScaleRangeSlider/ScaleMenu":function(){define("../../kernel ../_EventedWidget ../_Tooltip ./recommendedScales ./ScaleRanges dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-prop dojo/dom-style dojo/has dojo/keys dojo/number dojo/on dojo/query dojo/string dojox/html/entities dojox/lang/functional/object dojo/i18n!../../nls/jsapi dojo/text!./templates/ScaleMenu.html dijit/form/TextBox".split(" "),
function(D,B,h,v,x,g,k,r,q,l,t,m,n,y,z,A,E,G,w,e,a,c,f,p){B=r([B,g,k,h],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScaleMenu",templateString:p,baseClass:"esriScaleMenu",labels:f.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",section:"esriSection",content:"esriContent",current:"esriCurrent",input:"esriInput",list:"esriList",item:"esriItem",inline:"esriInline",selectable:"esriSelectable",hidden:"esriHidden"},_elementValueMap:null,_elements:null,_scaleRangeCategories:null,_scaleRanges:null,
_rangeToScaleAndNodeLookup:null,constructor:function(){this._scaleRanges=new x},buildRendering:function(){this.inherited(arguments);this._rangeToScaleAndNodeLookup={map:{scale:null,node:this.dap_mapScaleItem}};var b=this.labels,d=b.featuredScaleLabels,u=v.all(),C=this.css.item+" "+this.css.selectable,F;q.forEach(c.keys(u),function(I){F=d[I];var L=u[I],K=e.substitute(F,{scaleLabel:this._formatScale(L)});K=m.create("li",{innerHTML:K,className:C},this.dap_recommendedScales);this._rangeToScaleAndNodeLookup[I]=
{scale:L,node:K}},this);var H=m.create("span",{innerHTML:b.setTo,className:this.css.inline}),J=m.create("span",{innerHTML:b.selectOne,className:this.css.inline});n.set(this.dap_scaleListHeader,"innerHTML",e.substitute(b.setToSelectOne,{setTo:H.outerHTML,selectOne:J.outerHTML}))},_formatScale:function(b){return"1:"+E.format(b)},postCreate:function(){this.inherited(arguments);this.own(G(this.domNode,G.selector("."+this.css.item+"."+this.css.selectable,"click"),l.hitch(this,function(b){b=b.target===
this.dap_mapScaleItem?this.options.scale.map:this._parseScale(b.target.innerHTML);this._emitScaleSelected(b)})));this.dap_scaleInput.on("keyDown",l.hitch(this,function(b){b.keyCode===A.ENTER&&this._handleCustomScaleInput()}));this.createTooltip(this.dap_scaleInput,this.labels.customScaleInputTooltip)},_emitScaleSelected:function(b){this.emit("scale-selected",{scale:b})},_handleCustomScaleInput:function(){var b=this._parseScale(this.dap_scaleInput.get("value"));isNaN(b)||this._emitScaleSelected(this._scaleRanges.clampScale(b))},
_parseScale:function(b){b=a.decode(b).replace(/.*\(/,"").replace(/\).*$/,"").replace(/.*1:/,"").replace(/[^0-9.\s]/g,"");return E.parse(b)},_setOptionsAttr:function(b){var d=b.scale,u=this._formatScale(d.current);n.set(this.dap_currentScaleLabel,"innerHTML",b.label);this.dap_scaleInput.set("value",u,!1);u=e.substitute(this.labels.featuredScaleLabels.current,{scaleLabel:this._formatScale(d.map)});this._rangeToScaleAndNodeLookup.map.scale=d.map;n.set(this.dap_mapScaleItem,"innerHTML",u);t.toggle(this.dap_mapScaleItem,
this.css.hidden,-1===d.map);this._scaleRanges.set("scaleRangeBounds",{minScale:d.min,maxScale:d.max});this._hideOutOfScaleRanges();this._set("options",b)},_hideOutOfScaleRanges:function(){var b=w("."+this.css.item+"."+this.css.selectable,this.dap_recommendedScales),d=this._scaleRanges;q.forEach(c.keys(this._rangeToScaleAndNodeLookup),function(u){u=this._rangeToScaleAndNodeLookup[u];t.toggle(u.node,this.css.hidden,!d.contains(u.scale))},this);b=b.every(function(u){return"none"===y.get(u,"display")});
t.toggle(this.dap_recommendedScaleSection,this.css.hidden,b)}});z("extend-esri")&&l.setObject("dijit.ScaleMenu",B,D);return B})},"esri/dijit/VisibleScaleRangeSlider/ScaleRanges":function(){define(["./scalePreviewUtil","dojo/_base/array","dojo/_base/declare","dojo/Stateful","dojo/i18n!../../nls/jsapi"],function(D,B,h,v,x){h=h(v,{_scaleRangeStops:[{id:"room",minScale:100},{id:"rooms",minScale:400},{id:"smallBuilding",minScale:800},{id:"building",minScale:1999},{id:"buildings",minScale:3999},{id:"street",
minScale:7499},{id:"streets",minScale:14999},{id:"neighborhood",minScale:29999},{id:"town",minScale:59999},{id:"city",minScale:119999},{id:"cities",minScale:249999},{id:"metropolitanArea",minScale:499999},{id:"county",minScale:999999},{id:"counties",minScale:1999999},{id:"state",minScale:3999999},{id:"states",minScale:6999999},{id:"country",minScale:14999999},{id:"countries",minScale:34999999},{id:"continent",minScale:99999999},{id:"world",minScale:147914382}],_allRanges:null,_ranges:null,length:0,
constructor:function(){this._allRanges=this.getScaleRanges()},_scaleRangeBoundsSetter:function(g){this._ranges=g=this.getScaleRanges(g.maxScale,g.minScale);this.length=g.length},getScaleRanges:function(g,k){var r=this._scaleRangeStops,q=r.length;g=0<=g?g:0;k=0<k?k:r[q-1].minScale;var l=g;var t=[];for(var m=0;m<q;m++){var n=Math.min(r[m].minScale,k);var y=Math.min(n,k);g<=n&&l<k&&t.push({id:r[m].id,maxScale:Math.max(l,g),minScale:y});l=y+1}t.reverse();return this._ensureValidBoundaryRanges(t)},_ensureValidBoundaryRanges:function(g){var k=
g[0];k.minScale===k.maxScale&&(g.shift(),g[0].minScale+=1);k=g[g.length-1];k.minScale===k.maxScale&&(g.pop(),--g[g.length-1].maxScale);return g},getScalePreviewSpriteBackgroundPosition:function(g){g=this._toFullRangeIndex(g);return D.getScalePreviewSpriteBackgroundPosition(g)},_toFullRangeIndex:function(g){g=this.findScaleRangeByIndex(Math.floor(g));for(var k=this._allRanges,r=k.length,q=0,l=0;l<r;l++)if(k[l].id===g.id){q=l;break}return q},getScaleRangeLabel:function(g){g=this._ranges[this._clampScaleRangeIndex(g)];
return x.widgets.visibleScaleRangeSlider.scaleRangeLabels[g.id]},findScaleRange:function(g){var k=this._ranges;if(g>=k[0].maxScale)return k[0];if(g<=k[k.length-1].minScale)return k[k.length-1];for(var r=0;r<k.length;r++){var q=k[r];if(g>=q.maxScale&&g<=q.minScale){var l=q;break}}return l},findScaleRangeByIndex:function(g){g=this._clampScaleRangeIndex(g);return this._ranges[g]},clampScale:function(g){return Math.min(this.get("minScale"),Math.max(this.get("maxScale"),g))},_minScaleGetter:function(){return this.get("firstRange").minScale},
_maxScaleGetter:function(){return this.get("lastRange").maxScale},_firstRangeGetter:function(){return this._ranges[0]},_lastRangeGetter:function(){var g=this._ranges;return g[g.length-1]},clampMinScale:function(g){return 0===g?this.get("minScale"):this.clampScale(g)},clampMaxScale:function(g){return this.clampScale(g)},_clampScaleRangeIndex:function(g){if(0>=g)return 0;var k=this._ranges.length-1;return g>k?k:Math.floor(g)},scaleToRangeIndex:function(g){return B.indexOf(this._ranges,this.findScaleRange(g))},
contains:function(g){for(var k=this._ranges,r=!1,q,l=0;l<k.length;l++)if(q=k[l],g>=q.maxScale&&g<=q.minScale){r=!0;break}return r}});h.getScalePreviewSource=function(g){return D.getScalePreviewSource(g)};return h})},"esri/dijit/VisibleScaleRangeSlider/scalePreviewUtil":function(){define(["dojo/_base/array","require"],function(D,B){var h={_supportedRegions:"ar-iq ar-kw bg-bg cs-cz da-dk da-gl da-gl de-at de-ch de-de de-li el-gr en-ae en-au en-ca en-ca en-eg en-gb en-hk en-id en-ie en-ie en-il en-in en-iq en-ke en-lu en-mo en-my en-nz en-rw en-sg en-us en-us en-vi en-vi en-wo en-za es-ar es-ar es-bo es-bo es-cl es-cl es-co es-co es-cr es-cr es-es es-gt es-gt es-mx es-mx es-ni es-ni es-pe es-pe es-pr es-pr es-sv es-sv es-ve et-ee fi-fi fi-fi fr-ci fr-fr fr-ma fr-mg fr-ml fr-tn is-is is-is it-it ja-jp ja-jp ko-kr lt-lt lv-lv nl-be nl-nl nl-sr nl-sr nn-no nn-no pl-pl pt-br pt-br pt-pt ro-ro ru-ru sk-sk sv-se sv-se th-th zh-cn zh-tw".split(" "),
_defaultRegion:"en-us",_getSupportedRegion:function(v){v=v?v.toLowerCase():"";return-1<D.indexOf(h._supportedRegions,v)?v:h._defaultRegion},getScalePreviewSource:function(v){v="./images/scalePreview/"+h._getSupportedRegion(v)+".jpg";return"url("+B.toUrl(v)+")"},getScalePreviewSpriteBackgroundPosition:function(v){return"-"+v%5*128+"px -"+128*Math.floor(v/5)+"px"}};return h})},"dojox/lang/functional/object":function(){define(["dojo/_base/kernel","dojo/_base/lang","./lambda"],function(D,B,h){var v={};
B.mixin(h,{keys:function(x){var g=[],k;for(k in x)k in v||g.push(k);return g},values:function(x){var g=[],k;for(k in x)k in v||g.push(x[k]);return g},filterIn:function(x,g,k){k=k||D.global;g=h.lambda(g);var r={},q;for(q in x)if(!(q in v)){var l=x[q];g.call(k,l,q,x)&&(r[q]=l)}return r},forIn:function(x,g,k){k=k||D.global;g=h.lambda(g);for(var r in x)r in v||g.call(k,x[r],r,x);return k},mapIn:function(x,g,k){k=k||D.global;g=h.lambda(g);var r={},q;for(q in x)q in v||(r[q]=g.call(k,x[q],q,x));return r}});
return h})},"dojox/lang/functional/lambda":function(){define(["../..","dojo/_base/lang","dojo/_base/array"],function(D,B,h){var v=B.getObject("lang.functional",!0,D),x={},g=1<"ab".split(/a*/).length?String.prototype.split:function(q){var l=this.split.call(this,q);(q=q.exec(this))&&0==q.index&&l.unshift("");return l},k=function(q){var l=[],t=g.call(q,/\s*->\s*/m);if(1<t.length)for(;t.length;)q=t.pop(),l=t.pop().split(/\s*,\s*|\s+/m),t.length&&t.push("(function("+l.join(", ")+"){ return ("+q+"); })");
else if(q.match(/\b_\b/))l=["_"];else{t=q.match(/^\s*(?:[+*\/%&|\^\.=<>]|!=)/m);var m=q.match(/[+\-*\/%&|\^\.=<>!]\s*$/m);if(t||m)t&&(l.push("$1"),q="$1"+q),m&&(l.push("$2"),q+="$2");else{t=q.replace(/(?:\b[A-Z]|\.[a-zA-Z_$])[a-zA-Z_$\d]*|[a-zA-Z_$][a-zA-Z_$\d]*:|this|true|false|null|undefined|typeof|instanceof|in|delete|new|void|arguments|decodeURI|decodeURIComponent|encodeURI|encodeURIComponent|escape|eval|isFinite|isNaN|parseFloat|parseInt|unescape|dojo|dijit|dojox|window|document|'(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"/g,
"").match(/([a-z_$][a-z_$\d]*)/gi)||[];var n={};h.forEach(t,function(y){n.hasOwnProperty(y)||(l.push(y),n[y]=1)})}}return{args:l,body:q}},r=function(q){return q.length?function(){var l=q.length-1,t=v.lambda(q[l]).apply(this,arguments);for(--l;0<=l;--l)t=v.lambda(q[l]).call(this,t);return t}:function(l){return l}};B.mixin(v,{rawLambda:function(q){return k(q)},buildLambda:function(q){q=k(q);return"function("+q.args.join(",")+"){return ("+q.body+");}"},lambda:function(q){if("function"==typeof q)return q;
if(q instanceof Array)return r(q);if(x.hasOwnProperty(q))return x[q];var l=k(q);return x[q]=new Function(l.args,"return ("+l.body+");")},clearLambdaCache:function(){x={}}});return v})},"esri/dijit/VisibleScaleRangeSlider/ScalePreview":function(){define("../../kernel dijit/_TemplatedMixin dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/dom-style dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/ScalePreview.html".split(" "),function(D,B,h,v,x,g,k,r,q){B=v([h,B],{declaredClass:"esri.dijit.VisibleScaleRangeSlider.ScalePreview",
baseClass:"esriScalePreview",templateString:q,labels:r.widgets.visibleScaleRangeSlider,css:{header:"esriHeader",thumbnail:"esriThumbnail"},source:null,_setSourceAttr:function(l){this.source!==l&&(this._set("source",l),g.set(this.dap_scalePreviewThumbnail,"backgroundImage",l))},backgroundPosition:null,_setBackgroundPositionAttr:function(l){this.backgroundPosition!==l&&(this._set("backgroundPosition",l),g.set(this.dap_scalePreviewThumbnail,"backgroundPosition",l))}});k("extend-esri")&&x.setObject("dijit.ScalePreview",
B,D);return B})},"dojox/form/HorizontalRangeSlider":function(){define(["dojo/_base/declare","dojox/form/_RangeSliderMixin","dojo/text!./resources/HorizontalRangeSlider.html","dijit/form/HorizontalSlider"],function(D,B,h,v){return D("dojox.form.HorizontalRangeSlider",[v,B],{templateString:h})})},"dojox/form/_RangeSliderMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/fx dojo/_base/event dojo/_base/sniff dojo/dom-style dojo/dom-geometry dojo/keys dijit dojo/dnd/Mover dojo/dnd/Moveable dijit/form/_FormValueWidget dijit/focus dojo/fx dojox/fx".split(" "),
function(D,B,h,v,x,g,k,r,q,l,t,m,n,y,z){var A=function(w,e){return w-e};l=D("dojox.form._RangeSliderMixin",null,{_setTabIndexAttr:["sliderHandle","sliderHandleMax"],value:[0,100],postMixInProperties:function(){this.inherited(arguments);this.value=h.map(this.value,function(w){return parseInt(w,10)})},postCreate:function(){this.inherited(arguments);this.value.sort(A);var w=this,e=D(E,{constructor:function(){this.widget=w}});this._movableMax=new m(this.sliderHandleMax,{mover:e});this.sliderHandle.setAttribute("aria-valuemin",
this.minimum);this.sliderHandle.setAttribute("aria-valuemax",this.maximum);this.sliderHandleMax.setAttribute("aria-valuemin",this.minimum);this.sliderHandleMax.setAttribute("aria-valuemax",this.maximum);e=D(G,{constructor:function(){this.widget=w}});this._movableBar=new m(this.progressBar,{mover:e});this.focusNode.removeAttribute("aria-valuemin");this.focusNode.removeAttribute("aria-valuemax");this.focusNode.removeAttribute("aria-valuenow")},destroy:function(){this.inherited(arguments);this._movableMax.destroy();
this._movableBar.destroy()},_onKeyPress:function(w){if(!(this.disabled||this.readOnly||w.altKey||w.ctrlKey)){var e=w.target===this.sliderHandleMax,a=w.target===this.progressBar,c=B.delegate(q,this.isLeftToRight()?{PREV_ARROW:q.LEFT_ARROW,NEXT_ARROW:q.RIGHT_ARROW}:{PREV_ARROW:q.RIGHT_ARROW,NEXT_ARROW:q.LEFT_ARROW}),f=0,p=!1;switch(w.keyCode){case c.HOME:this._setValueAttr(this.minimum,!0,e);x.stop(w);return;case c.END:this._setValueAttr(this.maximum,!0,e);x.stop(w);return;case c.PREV_ARROW:case c.DOWN_ARROW:p=
!0;case c.NEXT_ARROW:case c.UP_ARROW:f=1;break;case c.PAGE_DOWN:p=!0;case c.PAGE_UP:f=this.pageIncrement;break;default:this.inherited(arguments);return}p&&(f=-f);f&&(a?this._bumpValue([{change:f,useMaxValue:!1},{change:f,useMaxValue:!0}]):this._bumpValue(f,e),x.stop(w))}},_onHandleClickMax:function(w){this.disabled||this.readOnly||(g("ie")||y.focus(this.sliderHandleMax),x.stop(w))},_onClkIncBumper:function(){this._setValueAttr(!1===this._descending?this.minimum:this.maximum,!0,!0)},_bumpValue:function(w,
e){w=B.isArray(w)?[this._getBumpValue(w[0].change,w[0].useMaxValue),this._getBumpValue(w[1].change,w[1].useMaxValue)]:this._getBumpValue(w,e);this._setValueAttr(w,!0,e)},_getBumpValue:function(w,e){var a=e?1:0;e=k.getComputedStyle(this.sliderBarContainer);var c=r.getContentBox(this.sliderBarContainer,e);e=this.discreteValues;a=this.value[a];if(1>=e||Infinity==e)e=c[this._pixelCount];e--;w=this.maximum>this.minimum?(a-this.minimum)*e/(this.maximum-this.minimum)+w:0;0>w&&(w=0);w>e&&(w=e);return w*(this.maximum-
this.minimum)/e+this.minimum},_onBarClick:function(w){this.disabled||this.readOnly||(g("ie")||y.focus(this.progressBar),x.stop(w))},_onRemainingBarClick:function(w){if(!this.disabled&&!this.readOnly){g("ie")||y.focus(this.progressBar);var e=r.position(this.sliderBarContainer,!0),a=r.position(this.progressBar,!0),c=w[this._mousePixelCoord],f=a[this._startingPixelCoord];a=f+a[this._pixelCount];f=this._isReversed()?c<=f:c>=a;c=this._isReversed()?e[this._pixelCount]-c+e[this._startingPixelCoord]:c-e[this._startingPixelCoord];
this._setPixelValue(c,e[this._pixelCount],!0,f);x.stop(w)}},_setPixelValue:function(w,e,a,c){this.disabled||this.readOnly||(w=this._getValueByPixelValue(w,e),this._setValueAttr(w,a,c))},_getValueByPixelValue:function(w,e){var a=this.discreteValues;if(1>=a||Infinity==a)a=e;a--;return(this.maximum-this.minimum)*Math.round((0>w?0:e<w?e:w)/(e/a))/a+this.minimum},_setValueAttr:function(w,e,a){var c=B.clone(this.value);B.isArray(w)?c=w:c[a?1:0]=w;this._lastValueReported="";this.valueNode.value=w=c;c.sort(A);
this.sliderHandle.setAttribute("aria-valuenow",c[0]);this.sliderHandleMax.setAttribute("aria-valuenow",c[1]);n.prototype._setValueAttr.apply(this,arguments);this._printSliderBar(e,a)},_printSliderBar:function(w,e){e=this.maximum>this.minimum?(this.value[0]-this.minimum)/(this.maximum-this.minimum):0;var a=this.maximum>this.minimum?(this.value[1]-this.minimum)/(this.maximum-this.minimum):0,c=e;e>a&&(e=a,a=c);var f=this._isReversed()?100*(1-e):100*e,p=this._isReversed()?100*(1-a):100*a,b=this._isReversed()?
100*(1-a):100*e;if(w&&0<this.slideDuration&&this.progressBar.style[this._progressPixelSize]){if(parseFloat(this.progressBar.style[this._handleOffsetCoord]),w=this.slideDuration/10,0!==w){0>w&&(w=0-w);var d={},u={};c={};d[this._handleOffsetCoord]={start:this.sliderHandle.parentNode.style[this._handleOffsetCoord],end:f,units:"%"};u[this._handleOffsetCoord]={start:this.sliderHandleMax.parentNode.style[this._handleOffsetCoord],end:p,units:"%"};c[this._handleOffsetCoord]={start:this.progressBar.style[this._handleOffsetCoord],
end:b,units:"%"};c[this._progressPixelSize]={start:this.progressBar.style[this._progressPixelSize],end:100*(a-e),units:"%"};e=v.animateProperty({node:this.sliderHandle.parentNode,duration:w,properties:d});a=v.animateProperty({node:this.sliderHandleMax.parentNode,duration:w,properties:u});w=v.animateProperty({node:this.progressBar,duration:w,properties:c});z.combine([e,a,w]).play()}}else this.sliderHandle.parentNode.style[this._handleOffsetCoord]=f+"%",this.sliderHandleMax.parentNode.style[this._handleOffsetCoord]=
p+"%",this.progressBar.style[this._handleOffsetCoord]=b+"%",this.progressBar.style[this._progressPixelSize]=100*(a-e)+"%"}});var E=D("dijit.form._SliderMoverMax",t,{onMouseMove:function(w){var e=this.widget,a=e._abspos;a||(a=e._abspos=r.position(e.sliderBarContainer,!0),e._setPixelValue_=B.hitch(e,"_setPixelValue"),e._isReversed_=e._isReversed());w=w[e._mousePixelCoord]-a[e._startingPixelCoord];e._setPixelValue_(e._isReversed_?a[e._pixelCount]-w:w,a[e._pixelCount],!1,!0)},destroy:function(w){t.prototype.destroy.apply(this,
arguments);var e=this.widget;e._abspos=null;e._setValueAttr(e.value,!0)}}),G=D("dijit.form._SliderBarMover",t,{onMouseMove:function(w){var e=this.widget;if(!e.disabled&&!e.readOnly){var a=e._abspos,c=e._bar,f=e._mouseOffset;a||(a=e._abspos=r.position(e.sliderBarContainer,!0),e._setPixelValue_=B.hitch(e,"_setPixelValue"),e._getValueByPixelValue_=B.hitch(e,"_getValueByPixelValue"),e._isReversed_=e._isReversed());c||(c=e._bar=r.position(e.progressBar,!0));f||(f=e._mouseOffset=w[e._mousePixelCoord]-c[e._startingPixelCoord]);
w=w[e._mousePixelCoord]-a[e._startingPixelCoord]-f;pixelValues=[w,w+c[e._pixelCount]];pixelValues.sort(A);0>=pixelValues[0]&&(pixelValues[0]=0,pixelValues[1]=c[e._pixelCount]);pixelValues[1]>=a[e._pixelCount]&&(pixelValues[1]=a[e._pixelCount],pixelValues[0]=a[e._pixelCount]-c[e._pixelCount]);a=[e._getValueByPixelValue(e._isReversed_?a[e._pixelCount]-pixelValues[0]:pixelValues[0],a[e._pixelCount]),e._getValueByPixelValue(e._isReversed_?a[e._pixelCount]-pixelValues[1]:pixelValues[1],a[e._pixelCount])];
e._setValueAttr(a,!1,!1)}},destroy:function(){t.prototype.destroy.apply(this,arguments);var w=this.widget;w._abspos=null;w._bar=null;w._mouseOffset=null;w._setValueAttr(w.value,!0)}});return l})},"dojox/fx":function(){define(["./fx/_base"],function(D){return D})},"dojox/fx/_base":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/fx dojo/fx dojo/dom dojo/dom-style dojo/dom-geometry dojo/_base/connect dojo/_base/html".split(" "),function(D,B,h,v,x,g,k,r,q){D=B.getObject("dojox.fx",!0);
B.mixin(D,{anim:h.anim,animateProperty:h.animateProperty,fadeTo:h._fade,fadeIn:h.fadeIn,fadeOut:h.fadeOut,combine:v.combine,chain:v.chain,slideTo:v.slideTo,wipeIn:v.wipeIn,wipeOut:v.wipeOut});D.sizeTo=function(l){var t=l.node=x.byId(l.node),m=l.method||"chain";l.duration||(l.duration=500);"chain"==m&&(l.duration=Math.floor(l.duration/2));var n,y,z,A,E,G=null,w=function(e){return function(){var a=g.getComputedStyle(e),c=a.position,f=a.width,p=a.height;n="absolute"==c?e.offsetTop:parseInt(a.top)||0;
z="absolute"==c?e.offsetLeft:parseInt(a.left)||0;E="auto"==f?0:parseInt(f);G="auto"==p?0:parseInt(p);A=z-Math.floor((l.width-E)/2);y=n-Math.floor((l.height-G)/2);"absolute"!=c&&"relative"!=c&&(a=g.coords(e,!0),n=a.y,z=a.x,e.style.position="absolute",e.style.top=n+"px",e.style.left=z+"px")}}(t);t=h.animateProperty(B.mixin({properties:{height:function(){w();return{end:l.height||0,start:G}},top:function(){return{start:n,end:y}}}},l));m=h.animateProperty(B.mixin({properties:{width:function(){return{start:E,
end:l.width||0}},left:function(){return{start:z,end:A}}}},l));return v["combine"==l.method?"combine":"chain"]([t,m])};D.slideBy=function(l){var t,m,n=function(y){return function(){var z=g.getComputedStyle(y),A=z.position;t="absolute"==A?y.offsetTop:parseInt(z.top)||0;m="absolute"==A?y.offsetLeft:parseInt(z.left)||0;"absolute"!=A&&"relative"!=A&&(z=k.coords(y,!0),t=z.y,m=z.x,y.style.position="absolute",y.style.top=t+"px",y.style.left=m+"px")}}(l.node=x.byId(l.node));n();l=h.animateProperty(B.mixin({properties:{top:t+
(l.top||0),left:m+(l.left||0)}},l));r.connect(l,"beforeBegin",l,n);return l};D.crossFade=function(l){var t=l.nodes[0]=x.byId(l.nodes[0]),m=q.style(t,"opacity"),n=l.nodes[1]=x.byId(l.nodes[1]);q.style(n,"opacity");return v.combine([h[0==m?"fadeIn":"fadeOut"](B.mixin({node:t},l)),h[0==m?"fadeOut":"fadeIn"](B.mixin({node:n},l))])};D.highlight=function(l){var t=l.node=x.byId(l.node);l.duration=l.duration||400;var m=l.color||"#ffff99",n=q.style(t,"backgroundColor");"rgba(0, 0, 0, 0)"==n&&(n="transparent");
l=h.animateProperty(B.mixin({properties:{backgroundColor:{start:m,end:n}}},l));"transparent"==n&&r.connect(l,"onEnd",l,function(){t.style.backgroundColor=n});return l};D.wipeTo=function(l){l.node=x.byId(l.node);var t=l.node,m=t.style,n=l.width?"width":"height",y={};y[n]={start:function(){m.overflow="hidden";if("hidden"==m.visibility||"none"==m.display)return m[n]="1px",m.display="",m.visibility="",1;var z=q.style(t,n);return Math.max(z,1)},end:l[n]};return h.animateProperty(B.mixin({properties:y},
l))};return D})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"widgets/LayerList/PopupMenuInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/promise/all jimu/WidgetManager jimu/portalUrlUtils esri/lang ./NlsStrings".split(" "),function(D,B,h,v,x,g,k,r,q){var l=D([],{_candidateMenuItems:null,_displayItems:null,_layerInfo:null,_layerType:null,_appConfig:null,constructor:function(t,m,n,y){this.nls=q.value;this._layerInfo=
t;this._layerType=n;this.layerListWidget=y;this._initCandidateMenuItems();this._initDisplayItems(m)},_getATagLabel:function(){var t;var m=this._layerInfo.getUrl();(t=this._layerInfo.isItemLayer())?(m=this._getItemDetailsPageUrl(t)||m,t=this.nls.itemShowItemDetails):!m||"CSVLayer"!==this._layerType&&"KMLLayer"!==this._layerType?(m=m&&"WMSLayer"===this._layerType?m+(-1<m.indexOf("?")?"\x26":"?")+"SERVICE\x3dWMS\x26REQUEST\x3dGetCapabilities":m&&"WFSLayer"===this._layerType?m+(-1<m.indexOf("?")?"\x26":
"?")+"SERVICE\x3dWFS\x26REQUEST\x3dGetCapabilities":m?m:"",t=this.nls.itemDesc):t=this.nls.itemDownload;this._ATagLabelUrl=m;return'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d"'+m+'"\x3e'+t+"\x3c/a\x3e"},_getItemDetailsPageUrl:function(t){var m="";return m=k.getItemDetailsPageUrl(t.portalUrl,t.itemId)},_initCandidateMenuItems:function(){this._candidateMenuItems=[{key:"separator",label:""},{key:"empty",label:this.nls.empty},{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",
label:this.nls.itemTransparency},{key:"setVisibilityRange",label:this.nls.itemSetVisibilityRange},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:"table",label:this.nls.itemToAttributeTable},{key:"controlPopup",label:this.nls.removePopup},{key:"controlLabels",label:this.nls.showLabels},{key:"url",label:this._getATagLabel()}]},_initDisplayItems:function(t){this._displayItems=[];B.forEach(t,function(m){B.forEach(this._candidateMenuItems,function(n){m.key===
n.key&&(this._displayItems.push(h.clone(n)),m.onClick&&(this._displayItem.onClick=m.onClick))},this)},this)},_getSupportTableInfoForAllSublayers:function(t){var m=[];t.traversal(function(n){var y=new v;n.getSupportTableInfo().then(function(z){z.layerInfo=n;y.resolve(z)});m.push(y)});return x(m)},_isSupportedByAT:function(t,m){return B.some(m,function(n){return n.isSupportedLayer&&n.isSupportQuery&&!n.otherReasonCanNotSupport?!0:!1})},getDeniedItems:function(){var t=new v,m=[];this.layerListWidget.layerListView.isFirstDisplayedLayerInfo(this._layerInfo)&&
m.push({key:"moveup",denyType:"disable"});this.layerListWidget.layerListView.isLastDisplayedLayerInfo(this._layerInfo)&&m.push({key:"movedown",denyType:"disable"});this._ATagLabelUrl||m.push({key:"url",denyType:"disable"});this._layerInfo.canShowLabel()||m.push({key:"controlLabels",denyType:"hidden"});this._layerInfo.originOperLayer.featureCollection?m.push({key:"setVisibilityRange",denyType:"hidden"}):this._layerInfo.isRootLayer()||"esri.layers.ArcGISTiledMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass?
this._layerInfo.isRootLayer()||"esri.layers.ArcGISDynamicMapServiceLayer"!==this._layerInfo.getRootLayerInfo().layerObject.declaredClass||this._layerInfo.getRootLayerInfo().layerObject.supportsDynamicLayers||m.push({key:"setVisibilityRange",denyType:"disable"}):m.push({key:"setVisibilityRange",denyType:"hidden"});var n=this._layerInfo.isSupportPopupNested(),y=this._getSupportTableInfoForAllSublayers(this._layerInfo);x({isPopupSupported:n,supportTableInfo:y}).then(h.hitch(this,function(z){z.isPopupSupported||
m.push({key:"controlPopup",denyType:"hidden"});z=z.supportTableInfo;var A=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];A&&A.visible?this._isSupportedByAT(A,z)||(m.push({key:"table",denyType:"disable"}),this._layerInfo.isMapNotesLayerInfo()||this._layerInfo.parentLayerInfo&&this._layerInfo.parentLayerInfo.isMapNotesLayerInfo()?m.push({key:"table",denyType:"hidden"}):m.push({key:"table",denyType:"disable"})):m.push({key:"table",denyType:"hidden"});t.resolve(m)}),function(){t.resolve(m)});
return t},getDisplayItems:function(){return this._displayItems},onPopupMenuClick:function(t){var m={closeMenu:!0};switch(t.itemKey){case "zoomto":this._onItemZoomToClick(t);break;case "moveup":this._onMoveUpItemClick(t);break;case "movedown":this._onMoveDownItemClick(t);break;case "table":this._onTableItemClick(t);break;case "transparencyChanged":this._onTransparencyChanged(t);m.closeMenu=!1;break;case "controlPopup":this._onControlPopup();break;case "controlLabels":this._onControlLabels()}return m},
_onItemZoomToClick:function(t){this._layerInfo.zoomTo()},_isValidExtent:function(t){var m=!1;r.isDefined(t)&&r.isDefined(t.xmin)&&isFinite(t.xmin)&&r.isDefined(t.ymin)&&isFinite(t.ymin)&&r.isDefined(t.xmax)&&isFinite(t.xmax)&&r.isDefined(t.ymax)&&isFinite(t.ymax)&&(m=!0);return m},_onMoveUpItemClick:function(t){this._layerInfo.isFirst||t.layerListView.moveUpLayer(this._layerInfo)},_onMoveDownItemClick:function(t){this._layerInfo.isLast||t.layerListView.moveDownLayer(this._layerInfo)},_onTableItemClick:function(t){this._getSupportTableInfoForAllSublayers(this._layerInfo).then(h.hitch(this,
function(m){var n=this.layerListWidget.appConfig.getConfigElementsByName("AttributeTable")[0];if(this._isSupportedByAT(n,m)){var y=g.getInstance();B.forEach(m,function(z){z.isSupportedLayer&&y.triggerWidgetOpen(n.id).then(h.hitch(this,function(A){A&&y.activateWidget(A);t.layerListWidget.publishData({target:"AttributeTable",layer:z.layerInfo})}))},this)}}))},_onTransparencyChanged:function(t){this.layerListWidget._denyLayerInfosOpacityResponseOneTime=!0;this._layerInfo.setOpacity(1-t.extraData.newTransValue)},
_onControlPopup:function(t){this._layerInfo.isPopupNestedEnabled()?this._layerInfo.disablePopupNested():this._layerInfo.enablePopupNested();this._layerInfo.map.infoWindow.hide()},_onControlLabels:function(t){this._layerInfo.canShowLabel()&&(this._layerInfo.isShowLabels()?this._layerInfo.hideLabels():this._layerInfo.showLabels())}});l.create=function(t,m){var n=new v,y=t.isRootLayer(),z={RootLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},
{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],RootLayerAndFeatureLayer:[{key:"zoomto"},{key:"transparency"},{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"controlLabels"},{key:"separator"},{key:"moveup"},{key:"movedown"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],FeatureLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},
{key:"separator"},{key:"url"}],SublayerOfDynamicMapserviceLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"url"}],GroupLayer:[{key:"setVisibilityRange"},{key:"separator"},{key:"controlPopup"},{key:"separator"},{key:"table"},{key:"separator"},{key:"url"}],Table:[{key:"table"},{key:"separator"},{key:"url"}],BasemapLayer:[{key:"zoomto"},{key:"transparency"},{key:"separator"},{key:"url"}],"default":[{key:"controlPopup"},{key:"separator"},{key:"url",onClick:null}]};t.getLayerType().then(h.hitch(this,
function(A){var E="";E=t.isBasemap()&&t.isRootLayer()?"BasemapLayer":t.isBasemap()?"default":!y||"FeatureLayer"!==A&&"CSVLayer"!==A&&"ArcGISImageServiceLayer"!==A&&"StreamLayer"!==A&&"ArcGISImageServiceVectorLayer"!==A?y?"RootLayer":"FeatureLayer"===A||"CSVLayer"===A?"FeatureLayer":t.isLeaf()&&t.getRootLayerInfo()&&t.getRootLayerInfo().layerObject&&"esri.layers.ArcGISDynamicMapServiceLayer"===t.getRootLayerInfo().layerObject.declaredClass?"SublayerOfDynamicMapserviceLayer":"GroupLayer"===A?"GroupLayer":
"Table"===A?"Table":"default":"RootLayerAndFeatureLayer";n.resolve(new l(t,z[E],A,m))}),h.hitch(this,function(){n.resolve(new l(t,[{key:"empty"}]))}));return n};return l})},"widgets/LayerList/LayerFilter":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dijit/_TemplatedMixin dojo/text!./LayerFilter.html dojo/dom dojo/on dojo/keys dojo/dom-class dijit/focus jimu/utils jimu/dijit/Search".split(" "),function(D,B,h,v,x,g,k,r,q,l,t,m){return B([D,v],{templateString:x,baseClass:"layer-filter",
layerFilterInput:null,isValid:!1,layerListWidget:null,layerInfoIsValidStatus:null,layerInfoIsExpandStatus:null,postMixInProperties:function(){this.inherited(arguments);this.nls=h.mixin(h.clone(this.layerListWidget.nls),window.jimuNls.common)},constructor:function(){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={}},startup:function(){this.layerFilterInput=(new m({placeholder:this.nls.typeAKeywork,onSearch:h.hitch(this,this._onFilter),searchWhenInput:!0})).placeAt(this.searchInputNode);
g.setSelectable(this.cancelButton,!1);this.own(k(this.searchButton,"keydown",h.hitch(this,"_onSearchButtonKey")));this.own(k(this.layerFilterInput.inputSearch,"keydown",h.hitch(this,"_onLayerFilterInputKey")));this.own(k(this.clearInputButton,"keydown",h.hitch(this,"_onClearInputButtonKey")));this.own(k(this.cancelButton,"keydown",h.hitch(this,"_onCancelButtonKey")))},_updateLayerInfoStatus:function(n){this.layerInfoIsValidStatus={};this.layerInfoIsExpandStatus={};this.layerListWidget.operLayerInfos.traversalAll(h.hitch(this,
function(y){if(n){var z;if(0<=y.title.toLowerCase().indexOf(n.toLowerCase()))for(z=y;z;)this.layerInfoIsValidStatus[z.id]=!0,(z=z.parentLayerInfo)&&(this.layerInfoIsExpandStatus[z.id]=!0);else for(z=y.parentLayerInfo;z;){if(0<=z.title.toLowerCase().indexOf(n.toLowerCase())){this.layerInfoIsValidStatus[y.id]=!0;break}z=z.parentLayerInfo}}else this.layerInfoIsValidStatus[y.id]=!0}))},isValidLayerInfo:function(n){return!this.isValid||this.layerInfoIsValidStatus[n.id]},isExpanded:function(n){return this.isValid&&
this.layerInfoIsExpandStatus[n.id]},cancelFilter:function(){this.isValid=!1;this.layerFilterInput.inputSearch.value&&(this.layerFilterInput.inputSearch.value="",this.layerListWidget._refresh());q.remove(this.searchButton,"invalid");q.add(this.searchInputNode,"invalid");q.add(this.cancelButton,"invalid");l.focus(this.searchButton)},hideFilter:function(){q.remove(this.searchButton,"invalid");q.add(this.searchInputNode,"invalid");q.add(this.cancelButton,"invalid");l.focus(this.searchButton)},_onFilter:function(n){n?
q.remove(this.clearInputButton,"disable"):q.add(this.clearInputButton,"disable");this._updateLayerInfoStatus(n);this.layerListWidget._refresh()},_onSearchBtnClick:function(){this.isValid=!0;q.add(this.searchButton,"invalid");q.remove(this.searchInputNode,"invalid");q.remove(this.cancelButton,"invalid");this.layerFilterInput.inputSearch.focus()},_onCancelBtnClick:function(){this.cancelFilter()},_onClearInputButton:function(){this.layerFilterInput.inputSearch.value&&(q.add(this.clearInputButton,"disable"),
this.layerFilterInput.inputSearch.focus(),this.layerFilterInput.inputSearch.value="",this._updateLayerInfoStatus(""),this.layerListWidget._refresh())},_onSearchButtonKey:function(n){n.keyCode===r.ENTER&&this._onSearchBtnClick()},_onLayerFilterInputKey:function(n){n.keyCode===r.TAB&&n.shiftKey?(n.stopPropagation(),n.preventDefault(),this._enableNavMode(n)):n.keyCode!==r.TAB||n.shiftKey?n.keyCode===r.ESCAPE&&(n.stopPropagation(),n.preventDefault(),this.hideFilter()):(n.stopPropagation(),n.preventDefault(),
this._enableNavMode(n),q.contains(this.clearInputButton,"disable")?l.focus(this.cancelButton):l.focus(this.clearInputButton))},_onClearInputButtonKey:function(n){n.keyCode===r.TAB&&n.shiftKey?(n.stopPropagation(),n.preventDefault(),this._enableNavMode(n),l.focus(this.layerFilterInput.inputSearch)):n.keyCode!==r.TAB||n.shiftKey?n.keyCode===r.ENTER?(n.stopPropagation(),n.preventDefault(),this._onClearInputButton()):n.keyCode===r.ESCAPE&&(n.stopPropagation(),n.preventDefault(),this.hideFilter()):(n.stopPropagation(),
n.preventDefault(),l.focus(this.cancelButton))},_onCancelButtonKey:function(n){n.keyCode===r.TAB&&n.shiftKey?(n.stopPropagation(),n.preventDefault(),this._enableNavMode(n),l.focus(this.layerFilterInput.inputSearch)):n.keyCode!==r.TAB||n.shiftKey?n.keyCode===r.ENTER?(n.stopPropagation(),n.preventDefault(),this._onCancelBtnClick()):n.keyCode===r.ESCAPE&&(n.stopPropagation(),n.preventDefault(),this.hideFilter()):(n.stopPropagation(),n.preventDefault(),this._enableNavMode(n))},_enableNavMode:function(n){n.keyCode!==
r.TAB||t.isInNavMode()||q.add(document.body,"jimu-nav-mode")}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left jimu-float-leading"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right jimu-float-trailing"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"popup-menu-visible-scale-range-body" data-dojo-attach-point\x3d"setVisibilityRangeNode" data-dojo-attach-event\x3d"onclick:_onSetVisibilityRangeNode"\x3e \r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScaleMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.section}"\x3e\r\n    \x3cdiv class\x3d"${css.header}"\x3e${labels.current}\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_currentScaleLabel" class\x3d"${css.item} ${css.current}"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"dap_scaleInput" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"${css.input}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"${css.section}" data-dojo-attach-point\x3d"dap_recommendedScaleSection"\x3e\r\n    \x3cdiv class\x3d"${css.header}" data-dojo-attach-point\x3d"dap_scaleListHeader"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.content}"\x3e\r\n      \x3col data-dojo-attach-point\x3d"dap_recommendedScales" class\x3d"${css.list}"\x3e\r\n        \x3cli data-dojo-attach-point\x3d"dap_mapScaleItem" class\x3d"${css.item} ${css.selectable}"\x3e\x3c/li\x3e\r\n        \x3c!--additional list items added dynamically--\x3e\r\n      \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/VisibleScaleRangeSlider/templates/ScalePreview.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"${css.header}"\x3e${labels.preview}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"dap_scalePreviewThumbnail" class\x3d"${css.thumbnail}"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:dojox/form/resources/HorizontalRangeSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH dojoxRangeSlider" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" dojoAttachEvent\x3d"onkeypress:_onKeyPress,onkeyup:_onKeyUp" role\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" dojoAttachEvent\x3d"onmousedown:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput dojoAttachPoint\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv role\x3d"presentation" class\x3d"dojoxRangeSliderBarContainer" dojoAttachPoint\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandle,focusNode" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" dojoAttachEvent\x3d"onmousedown:_onBarClick"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" dojoAttachPoint\x3d"sliderHandleMax" tabIndex\x3d"${tabIndex}" dojoAttachEvent\x3d"onmousedown:_onHandleClickMax" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" dojoAttachPoint\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" dojoAttachEvent\x3d"onmousedown:_onRemainingBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" dojoAttachEvent\x3d"onmousedown:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" tabIndex\x3d"-1" style\x3d"display:none" dojoAttachPoint\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd dojoAttachPoint\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layer-list-operations" role\x3d\'button\' aria-haspopup\x3d\'true\' aria-label\x3d"${nls.tipLayerListOperation}" aria-expanded\x3d"false" tabindex\x3d"0" data-dojo-attach-point\x3d"layerListOperations"\x3e\r\n    \x3c!--div class\x3d"setting-image jimu-icon jimu-icon-setting jimu-state-disabled"\x3e\x3c/div--\x3e\r\n  \x3c/div\x3e\r\n  \x3ctable class\x3d"layer-list-table"\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e\r\n    \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"tableListTable"\x3e\x3c/tbody\x3e       \r\n  \x3c/table\x3e\r\n  \x3cdiv class\x3d"supports-508-node" tabindex\x3d"0" data-dojo-attach-point\x3d"supports508Node"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/LayerFilter.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-input-node invalid" data-dojo-attach-point\x3d"searchInputNode"\x3e\r\n    \x3cdiv class\x3d"clear-input-button disable" tabindex\x3d"0" role\x3d"button" aria-label\x3d\'${nls.tipClearText}\' data-dojo-attach-point\x3d"clearInputButton" data-dojo-attach-event\x3d"click:_onClearInputButton"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-button" data-dojo-attach-point\x3d"searchButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onSearchBtnClick"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"cancel-button invalid" data-dojo-attach-point\x3d"cancelButton" role\x3d"button" tabindex\x3d"0" data-dojo-attach-event\x3d"click:_onCancelBtnClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d"layer-list-title" data-dojo-attach-point\x3d"layerListTitle"\x3e${nls.layers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-filter-node" data-dojo-attach-point\x3d"layerFilterNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/LayerList/css/style.css":'.jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px; z-index: 0; position: relative;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; margin-bottom: 14px; font-family: "Avenir Heavy"; margin-left: 8px; margin-right: 8px;}.jimu-widget-layerList .layers-section .layer-list-title.disable{margin-bottom: 2px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{height: 40px;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus{outline: none !important;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col1{border-left: 2px solid #24b5cc; border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col2{border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-nav-mode .jimu-widget-layerList .layer-row:focus .col3{border-right: 2px solid #24b5cc; border-top: 2px solid #24b5cc; border-bottom: 2px solid #24b5cc;}.jimu-widget-layerList .layer-row:hover{background-color: #e3ecf2;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word; cursor: pointer;}.jimu-widget-layerList .col3{width: 24px;}.jimu-widget-layerList .begin-blank-div{width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 12px; height: 12px; cursor: pointer; margin-left: 3px; margin-top: 2px; background-image: url("../images/v_right.png"); background-repeat: no-repeat; background-position: center;}.jimu-rtl .jimu-widget-layerList .showLegend-div{background-image: url("../images/v_left.png"); margin-left: 0; margin-right: 3px;} .jimu-widget-layerList .showLegend-div.unfold{background-image: url("../images/v.png");}.jimu-widget-layerList .showLegend-div.hidden-showLegend-div{background-image: none; cursor: auto;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{width: 33px; text-align: right; display: none;}.jimu-widget-layerList .noLegend-image{display: block; margin: 0 auto;}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{position: relative; font-size: 2px;}.jimu-widget-layerList .div-select .checkbox{cursor: auto;}.jimu-widget-layerList .image-group-div {width: 14px; height: 14px; background-image: url("../images/group_layer.svg"); background-repeat: no-repeat; background-position: center center; background-size: 14px; margin: 1px 0 0 2px; cursor: auto;}.jimu-rtl .jimu-widget-layerList .image-group-div {margin-left: 4px; margin-right: auto;}.jimu-widget-layerList .image-group-div.disable{display: none;}.jimu-widget-layerList .div-content{position: relative; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .div-content.grayed-title{opacity: 0.3;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden; font-size: 11px;}.jimu-widget-layerList .legend-symbol{}.jimu-widget-layerList .legend-label{margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .esriLegendService {padding-bottom: 0;}.jimu-widget-layerList .esriLegendLayerLabel {padding-top: 0; height: 0; display: none;}.jimu-widget-layerList .esriLegendServiceLabel {display: none;}.jimu-widget-layerList .esriLegendLayer{font-size: 12px;}.jimu-widget-layerList .esriLegendMsg{display: none;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 22px; height: 40px; cursor: pointer; border-radius: 2px; float: right; background-image: url("../images/more_normal.svg"); background-repeat: no-repeat; background-position: center 19px;}.jimu-widget-layerList .layers-list-popupMenu-div:hover{background-image: url("../images/more_hover.svg");}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-button:hover{background: none;}.jimu-widget-layerList .layers-list-popupMenu-div .loading-section {width: 17px; height: 17px; top: 14px; left: 2px; z-index: 1; margin: 0;} .jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .loading-section {left: auto; right: 2px;}.jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{width: 17px; height: 17px; margin: -9px 0 0 2px; border-radius: 25px; background-image: url("../images/loading.gif"); background-repeat: no-repeat; background-position: center center; background-size: contain;}.jimu-rtl .jimu-widget-layerList .layers-list-popupMenu-div .popup-menu-loading{}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderImageHandleH{background: url(./images/slider-handle.png); width: 10px; border: none; height: 14px;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderBar {background: #ddd none; border-color: #999;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderDecrementIconH, .jimu-widget-layerList .popup-menu-transparency-body .dijitSlider .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderDecrementIconH,.jimu-widget-layerList .popup-menu-transparency-body .dijitSliderHover .dijitSliderIncrementIconH {background-color: #ddd; border: solid 1px #b5bcc7;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-visible-scale-range-body {position: absolute; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-width:1px; width: 290px; height:50px; padding-left: 5px; padding-right: 5px; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-visible-scale-range-body .esriVisibleScaleRangeSlider{margin-top: 15px;}.jimu-widget-layerList .jimu-dropmenu .popup-menu-button{width: 22px; height: 22px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 22px; height: 22px; min-width: 13px; background-image: url("../images/more_normal.svg"); background-color: rgba(255, 255, 255, 0); border: 0 solid;}.jimu-widget-layerList .layers-list-popupMenu-div:hover .jimu-icon-btn{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-image: url("../images/more_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{min-width: 180px; max-width: 330px; outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; font-size: 12px; z-index: 2; right: 0px; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none;}.jimu-widget-layerList .jimu-dropmenu .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .jimu-dropmenu .drop-menu.no-border{outline-style: none; border: none; box-shadow: none;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .drop-menu{left: 0px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{position: relative; height: 40px; line-height: 40px; white-space: nowrap; padding: 0px 24px; margin: 0 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .jimu-dropmenu .menu-item:focus{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{opacity: 0.4;}.jimu-widget-layerList .jimu-dropmenu .menu-item-hidden{display: none;}.jimu-widget-layerList .jimu-dropmenu .menu-item a{width: 100%;}.jimu-rtl .jimu-widget-layerList .jimu-dropmenu .menu-item a{right: auto; left: 0;}.jimu-widget-layerList .legends-loading-img{width: 45px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}.jimu-widget-layerList .layer-list-operations{position: absolute; right: 0; top: 0;}.jimu-rtl .jimu-widget-layerList .layer-list-operations{right: auto; left: 0;}.jimu-widget-layerList .layer-list-operations .setting-image{position: relative; right: 11px; top: -1px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .setting-image{right: auto; left: 11px;}.jimu-widget-layerList .layer-list-operations .jimu-icon-btn{background-image: url("../images/operation_normal.svg"); background-color: rgba(255, 255, 255, 0);}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-icon-btn{left: auto; right: -8px;}.jimu-widget-layerList .layer-list-operations:hover .jimu-icon-btn{background-image: url("../images/operation_hover.svg"); border: 0 solid; box-shadow: none;}.jimu-widget-layerList .layer-list-operations .drop-menu{min-width:147px !important; top: 21px !important; right: 0 !important; left: auto !important; z-index: 1 !important; background-color: #ffffff; box-shadow: 0px 0px 4px 2px rgba(177, 177, 177, 0.5); outline-style: none !important;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .drop-menu{right: auto !important; left: 0 !important;}.jimu-widget-layerList .layer-list-operations .drop-menu hr{border-bottom: 1px solid #d7dbde !important;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item{margin: 0; padding: 0 7px; font-size: 12px; padding: 0 20px; margin: 2px 2px 2px 2px;}.jimu-widget-layerList .layer-list-operations .drop-menu .menu-item:hover{text-decoration: initial; background-color: #f3f3f3;}.jimu-widget-layerList .layer-list-operations .jimu-loading{font-size: 5px; top: 45px; left: 20px;}.jimu-rtl .jimu-widget-layerList .layer-list-operations .jimu-loading{left: auto; right: 20px;}.jimu-widget-layerList .layer-filter-node{position: absolute; width: 100%; top: 0;}.jimu-widget-layerList .layer-filter{position: relative;}.jimu-widget-layerList .layer-filter .search-input-node{position: absolute; top: -10px; left: 0; right: 74px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node{left: 70px; right: 0;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input-wrapper{border: 1px solid #cccccc; background-color: #ffffff;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{border: none; padding-left: 32px; padding-right: 30px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input{padding-left: 30px; padding-right: 32px;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .jimu-input:focus{box-shadow: none;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{left: 10px;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn{right: 10px; left: auto;}.jimu-widget-layerList .layer-filter .search-input-node .jimu-search .search-btn:hover{cursor: auto; background-position: 0 -291px;}.jimu-widget-layerList .layer-filter .search-input-node.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-button{width: 20px; height: 20px; position: absolute; top: -2px; right: 23px; background-image: url("../images/search_normal.svg"); background-repeat: no-repeat; background-position: center; cursor: pointer;}.jimu-rtl .jimu-widget-layerList .layer-filter .search-button{left: 23px; right: auto;}.jimu-widget-layerList .layer-filter .search-button:focus{}.jimu-widget-layerList .layer-filter .search-button:hover{background-image: url("../images/search_hover.svg");}.jimu-widget-layerList .layer-filter .search-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .cancel-button{width: 69px; height: 30px; line-height: 30px; border: 1px solid #cccccc; position: absolute; top: -5px; right: 0; z-index: 1; background-color: #ffffff; text-align: center; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 2px 0 2px;}.jimu-widget-layerList .layer-filter .cancel-button:hover{border: 1px solid #000; font-family: "Avenir Medium";}.jimu-rtl .jimu-widget-layerList .layer-filter .cancel-button{left: 0; right: auto;}.jimu-widget-layerList .layer-filter .cancel-button.invalid{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{width: 15px; height: 25px; position: absolute; top: 7px; right: 10px; z-index: 1; background-image: url("../images/clear.svg"); background-repeat: no-repeat; background-position: center; background-size: 10px 10px;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button.disable{display: none;}.jimu-widget-layerList .layer-filter .search-input-node .clear-input-button:hover{background-image: url("../images/clear_hover.svg");}.jimu-rtl .jimu-widget-layerList .layer-filter .search-input-node .clear-input-button{left: 10px; right: auto;}',
"*now":function(D){D(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom dojo/on dojo/query dijit/registry ./LayerListView ./LayerFilter ./NlsStrings jimu/LayerInfos/LayerInfos".split(" "),function(D,B,h,v,x,g,k,r,q,l,t,m,n){return B([D],{baseClass:"jimu-widget-layerList",name:"layerList",layerFilter:null,_denyLayerInfosOpacityResponseOneTime:null,_denyLayerInfosIsVisibleChangedResponseOneTime:null,layerListView:null,operLayerInfos:null,postCreate:function(){!1===this.config.showTitle&&
(this.layerListTitle.innerHTML="",x.addClass(this.layerListTitle,"disable"))},startup:function(){this.inherited(arguments);this._createLayerFilter();m.value=this.nls;this._denyLayerInfosIsVisibleChangedResponseOneTime=this._denyLayerInfosOpacityResponseOneTime=!1;if(this.map.itemId)n.getInstance(this.map,this.map.itemInfo).then(h.hitch(this,function(z){this.operLayerInfos=z;this.showLayers();this.bindEvents();g.setSelectable(this.layerListBody,!1);g.setSelectable(this.layerListTitle,!1)}));else{var y=
this._obtainMapLayers();n.getInstance(this.map,y).then(h.hitch(this,function(z){this.operLayerInfos=z;this.showLayers();this.bindEvents();g.setSelectable(this.layerListBody,!1);g.setSelectable(this.layerListTitle,!1)}))}},_createLayerFilter:function(){this.layerFilter=(new t({layerListWidget:this})).placeAt(this.layerFilterNode);x.setAttr(this.layerFilter.searchButton,"tabindex",0);x.setAttr(this.layerFilter.searchButton,"aria-label",this.nls.layers+" "+window.jimuNls.common.search);x.addClass(this.layerFilter.searchButton,
"firstFocusNode")},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var y=[],z=[],A={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};v.forEach(this.map.graphicsLayerIds,function(E){E=this.map.getLayer(E);E.isOperationalLayer&&z.push({layerObject:E,title:E.label||E.title||E.name||E.id||" ",id:E.id||" "})},this);v.forEach(this.map.layerIds,function(E){E=this.map.getLayer(E);E.isOperationalLayer?z.push({layerObject:E,title:E.label||E.title||E.name||
E.id||" ",id:E.id||" "}):y.push({layerObject:E,id:E.id||" "})},this);A.itemData.baseMap.baseMapLayers=y;A.itemData.operationalLayers=z;return A},showLayers:function(){this.layerListView=(new l({operLayerInfos:this.operLayerInfos,layerListWidget:this,layerFilter:this.layerFilter,config:this.config})).placeAt(this.layerListBody);this.config.expandAllLayersByDefault&&this.layerListView.foldOrUnfoldAllLayers(!1)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},
_refresh:function(){this._clearLayers();this.showLayers()},bindEvents:function(){this.own(k(this.operLayerInfos,"layerInfosChanged",h.hitch(this,this._onLayerInfosChanged)));this.config.showBasemap&&this.own(k(this.operLayerInfos,"basemapLayerInfosChanged",h.hitch(this,this._onLayerInfosChanged)));this.own(k(this.operLayerInfos,"tableInfosChanged",h.hitch(this,this._onTableInfosChanged)));this.own(this.operLayerInfos.on("layerInfosIsVisibleChanged",h.hitch(this,this._onLayerInfosIsVisibleChanged)));
this.own(k(this.operLayerInfos,"layerInfosReorder",h.hitch(this,this._onLayerInfosReorder)));this.own(k(this.map,"zoom-end",h.hitch(this,this._onZoomEnd)));this.own(k(this.operLayerInfos,"layerInfosRendererChanged",h.hitch(this,this._onLayerInfosRendererChanged)));this.own(k(this.operLayerInfos,"layerInfosOpacityChanged",h.hitch(this,this._onLayerInfosOpacityChanged)));this.own(k(this.operLayerInfos,"layerInfosScaleRangeChanged",h.hitch(this,this._onLayerInfosScaleRangeChanged)))},_onLayerInfosChanged:function(){this.layerFilter.cancelFilter();
this.layerListView.refresh()},_onTableInfosChanged:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onLayerInfosIsVisibleChanged:function(y){this._denyLayerInfosIsVisibleChangedResponseOneTime?this._denyLayerInfosIsVisibleChangedResponseOneTime=!1:v.forEach(y,function(z){r("[class~\x3d'visible-checkbox-"+z.id+"']",this.domNode).forEach(function(A){A=q.byNode(A);z.isVisible()?A.check():A.uncheck()},this)},this)},_onZoomEnd:function(){var y=[];this.operLayerInfos.traversal(h.hitch(this,
function(A){y.push(A)}));var z=this;setTimeout(function(){var A=y.shift();r("[class~\x3d'layer-title-div-"+A.id+"']",this.domNode).forEach(function(E){try{A.isInScale()?x.removeClass(E,"grayed-title"):x.addClass(E,"grayed-title")}catch(G){console.warn(G.message)}},z);0<y.length&&setTimeout(arguments.callee,30)},30)},_onLayerInfosReorder:function(){this.layerFilter.cancelFilter();this.layerListView.refresh()},_onLayerInfosRendererChanged:function(y){try{v.forEach(y,function(z){this.layerListView.redrawLegends(z)},
this)}catch(z){this._refresh()}},_onLayerInfosOpacityChanged:function(y){v.forEach(y,function(z){var A=void 0===z.layerObject.opacity?1:z.layerObject.opacity;z=r("[layercontenttrnodeid\x3d'"+z.id+"']",this.domNode)[0];r(".legends-div.jimu-legends-div-flag img",z).style("opacity",A)},this);this._denyLayerInfosOpacityResponseOneTime?this._denyLayerInfosOpacityResponseOneTime=!1:this.layerListView._hideCurrentPopupMenu()},_onLayerInfosScaleRangeChanged:function(y){v.forEach(y,function(z){var A=[];z.traversal(h.hitch(this,
function(w){A.push(w)}));var E=this,G=0;setTimeout(function(){var w=A.slice(G,G+10);G+=10;v.forEach(w,function(e){r("[class~\x3d'layer-title-div-"+e.id+"']",this.domNode).forEach(function(a){try{e.isInScale()?x.removeClass(a,"grayed-title"):x.addClass(a,"grayed-title")}catch(c){console.warn(c.message)}},E)});A.length>G&&setTimeout(arguments.callee,30)},30)},this)},onAppConfigChanged:function(y,z,A){this.appConfig=y}})});