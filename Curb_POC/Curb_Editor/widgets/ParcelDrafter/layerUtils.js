// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/array","dojo/_base/lang"],function(l,m,e,f){return l([m],{map:null,getPopupInfo:!0,getRenderer:!0,postCreate:function(){},getLayerDetailsFromMap:function(g,h,d){var c={},k;this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.operationalLayers&&e.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,f.hitch(this,function(a){a.layerObject&&
("ArcGISMapServiceLayer"===a.layerType||"ArcGISTiledMapServiceLayer"===a.layerType?(k=d&&d.substring(0,d.lastIndexOf("_")),k&&a.id!==k||(c.isMapServer=!0,g.substring(0,g.length-1)===a.url&&(e.forEach(a.resourceInfo.layers,f.hitch(this,function(b){b.id===parseInt(h,10)&&(c.title=b.name)})),e.forEach(a.layers,f.hitch(this,function(b){b.id===parseInt(h,10)&&(b.name&&(c.title=b.name),this.getPopupInfo&&(c.popupInfo=b.popupInfo),b.layerDefinition&&(b.layerDefinition.definitionExpression&&(c.definitionExpression=
b.layerDefinition.definitionExpression),this.getRenderer&&b.layerDefinition.drawingInfo&&b.layerDefinition.drawingInfo.renderer&&(c.renderer=b.layerDefinition.drawingInfo.renderer)))}))))):d&&a.id!==d||a.url.replace(/.*?:\/\//g,"").toLowerCase()!==(g+h).replace(/.*?:\/\//g,"").toLowerCase()||a.id!==d||(c.isMapServer=!1,c.title=a.title,this.getPopupInfo&&(c.popupInfo=a.popupInfo),a.layerDefinition&&(a.layerDefinition.definitionExpression&&(c.definitionExpression=a.layerDefinition.definitionExpression),
this.getRenderer&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(c.renderer=a.layerDefinition.drawingInfo.renderer))))}));return c}})});