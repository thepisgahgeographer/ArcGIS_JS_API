// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),function(p,D,H,w,f,g,l,n,r,u,d,b,e,h,A,B,E,q){var x=H([w,f,g,D],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',
_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new q({hidden:!0});this.shelter.placeAt(this.domNode);
this.shelter.startup();this._createTree();this.basicFilter=b.hitch(this,this.basicFilter);this.filter=x.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(k){var m=new n;this.onlyShowVisible?m.resolve(k.isShowInMap()):m.resolve(!0);return m},filter:function(k){k=new n;k.resolve(!0);return k},getSelectedItems:function(){var k=this.tree.getSelectedItems();return h.map(k,b.hitch(this,function(m){return this.getHandledItem(m)}))},
getAllItems:function(){var k=this.tree.getAllItems(),m=[];h.forEach(k,b.hitch(this,function(y){"root"!==y.id&&(y=this.getHandledItem(y),m.push(y))}));return m},getHandledItem:function(k){return{name:k.name,layerInfo:k.layerInfo}},_isLeafItem:function(k){return k.isLeaf},setCreateMapResponse:function(k){this.createMapResponse=k;E.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(b.hitch(this,function(m){this.layerInfosObj=m;this.own(p(this.layerInfosObj,"layerInfosChanged",
b.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(p(this.layerInfosObj,"layerInfosIsShowInMapChanged",b.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(k,m){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(k){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(k){this._clear();e.setStyle(this.errorTipSection,
"display","block");var m=[];this.onlyShowWebMapLayers?(m=k.getLayerInfoArrayOfWebmap(),m=m.concat(k.getTableInfoArrayOfWebmap())):(m=k.getLayerInfoArray(),m=m.concat(k.getTableInfoArray()));0!==m.length&&(e.setStyle(this.errorTipSection,"display","none"),h.forEach(m,b.hitch(this,function(y){this._addDirectLayerInfo(y)})))},_addDirectLayerInfo:function(k){k&&k.getLayerObject().then(b.hitch(this,function(){this._addItem("root",k)}),b.hitch(this,function(m){console.error(m)}))},_clear:function(){var k=
this._store.query({parent:"root"});h.forEach(k,b.hitch(this,function(m){m&&"root"!==m.id&&this._store.remove(m.id)}))},_addItem:function(k,m){var y=null,z=m.getLayerType(),I=this.filter(m);d({layerType:z,valid:I}).then(b.hitch(this,function(F){if(F.valid){var L=b.hitch(this,function(P,T){this._id++;y={name:m.title||"",parent:k,layerInfo:m,type:F.layerType,layerClass:m.layerObject.declaredClass,id:this._id.toString(),isLeaf:P,hasChildren:T};this._store.add(y)}),G=m.getSubLayers(),J=0===G.length,Q=
!0;this.onlyFilterCurrentLayerWhenAddItem?(J&&(Q=!1),L(J,Q)):J?L(J,!1):(G=h.map(G,b.hitch(this,function(P){return this.filter(P)})),d(G).then(b.hitch(this,function(P){(P=h.some(P,function(T){return T}))&&L(J,P)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var k=this._getRootItem();k=new l({data:[k],getChildren:function(m){return this.query({parent:m.id})}});this._store=new r(k);k=new u({store:this._store,query:{id:"root"},
mayHaveChildren:b.hitch(this,this._mayHaveChildren)});this.tree=new B({multiple:this.multiple,model:k,showRoot:!1,isLeafItem:b.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:b.hitch(this,function(m,y){"root"!==m.id&&this._onTreeOpen(m,y)}),onClick:b.hitch(this,function(m,y,z){this._onTreeClick(m,y,z);this.emit("tree-click",m,y,z)}),getIconStyle:b.hitch(this,function(m,y){var z=null;if(!m||"root"===m.id)return null;var I={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",
backgroundImage:""},F=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(m=this._getIconInfo(m,y).imageName)I.backgroundImage="url("+F+"/css/images/"+m+")",z=I;return z}),getIconClass:b.hitch(this,function(m,y){return this._getIconInfo(m,y).className}),getTooltip:b.hitch(this,function(m){return this.displayTooltipForTreeNode?m.layerInfo.title:""})});e.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(k){return k.hasChildren},
_getIconInfo:function(k,m){var y="",z="";"ArcGISDynamicMapServiceLayer"===k.type||"ArcGISTiledMapServiceLayer"===k.type?m?(y="mapserver_open.png",z="mapservice-layer-icon open"):(y="mapserver_close.png",z="mapservice-layer-icon close"):"GroupLayer"===k.type?m?(y="group_layer2.png",z="group-layer-icon open"):(y="group_layer1.png",z="group-layer-icon close"):"FeatureLayer"===k.type?(k=A.getTypeByGeometryType(k.layerInfo.layerObject.geometryType),"point"===k?(y="point_layer1.png",z="point-layer-icon"):
"polyline"===k?(y="line_layer1.png",z="line-layer-icon"):"polygon"===k&&(y="polygon_layer1.png",z="polygon-layer-icon")):"Table"===k.type?(y="table.png",z="table-icon"):"ArcGISImageServiceLayer"===k.type||"ArcGISImageServiceVectorLayer"===k.type?(y="image_layer.png",z="iamge-layer-icon"):m?(y="mapserver_open.png",z="mapservice-layer-icon open"):(y="mapserver_close.png",z="mapservice-layer-icon close");return{imageName:y,className:z}},_onTreeOpen:function(k,m){if("root"!==k.id){var y=[];m=[];y=k.layerInfo.getSubLayers();
k.checked||(this.shelter.show(),m=h.map(y,b.hitch(this,function(z){return z.getLayerObject()})),d(m).then(b.hitch(this,function(){this.domNode&&(h.forEach(y,b.hitch(this,function(z){this._addItem(k.id,z)})),k.checked=!0,this.shelter.hide())}),b.hitch(this,function(z){console.error(z);this.shelter.hide()})))}},_onTreeClick:function(k,m,y){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});x.createFilterByLayerType=
function(k){b.isArrayLike(k)||(k=[]);return function(m){var y=new n;if(0===k.length)y.resolve(!0);else{var z=[];m.traversal(function(I){z.push(I.getLayerType())});d(z).then(function(I){for(var F=0;F<I.length;F++)for(var L=0;L<k.length;L++)if(I[F]===k[L]){y.resolve(!0);return}y.resolve(!1)},function(I){console.error(I);y.reject(I)})}return y}};x.createFeaturelayerFilter=function(k,m,y,z){var I=["point","polyline","polygon"];k&&0<k.length?(k=h.filter(k,function(F){return 0<=I.indexOf(F)}),0===k.length&&
(k=I)):k=I;return function(F){var L=F.getLayerType();F=F.getLayerObject();return d({layerType:L,layerObject:F}).then(function(G){var J=G.layerType;G=G.layerObject;if("ArcGISDynamicMapServiceLayer"===J||"ArcGISTiledMapServiceLayer"===J||"GroupLayer"===J||"FeatureCollection"===J)return!0;if("FeatureLayer"===J){J=A.getTypeByGeometryType(G.geometryType);J=0<=h.indexOf(k,J);var Q=x._shouldPassStatisticsCheck(z,G);return G.url?(G=A.isFeaturelayerUrlSupportQuery(G.url,G.capabilities),J&&G&&Q):m&&J}return"Table"===
J?(J=A.isFeaturelayerUrlSupportQuery(G.url,G.capabilities),G=x._shouldPassStatisticsCheck(z,G),y&&J&&G):!1})}};x.createImageServiceLayerFilter=function(k,m){return function(y){var z=y.getLayerType();y=y.getLayerObject();return d({layerType:z,layerObject:y}).then(function(I){var F=I.layerType,L=I.layerObject;return"ArcGISImageServiceLayer"===F||"ArcGISImageServiceVectorLayer"===F?k?A.isImageServiceSupportQuery(I.layerObject.capabilities)?m?x._shouldPassStatisticsCheck(m,L):!0:!1:!0:!1})}};x._shouldPassStatisticsCheck=
function(k,m){return k?(k=!1,k=m.advancedQueryCapabilities?!!m.advancedQueryCapabilities.supportsStatistics:!!m.supportsStatistics):!0};x.createQueryableLayerFilter=function(k){var m=x.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,k);k=x.createImageServiceLayerFilter(!0,k);return x.orCombineFilters([m,k])};x.andCombineFilters=function(k){return x._combineFilters(k,!0)};x.orCombineFilters=function(k){return x._combineFilters(k,!1)};x._combineFilters=function(k,m){return function(y){var z=
new n,I=h.map(k,function(F){return F(y)});d(I).then(function(F){var L=!1;L=m?h.every(F,function(G){return G}):h.some(F,function(G){return G});z.resolve(L)},function(F){console.error(F);z.reject(F)});return z}};return x})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(p,D,H,w,f,g,l){return H("dijit.tree.ObjectStoreModel",l,{store:null,labelAttr:"name",labelType:"text",root:null,
query:null,constructor:function(n){f.mixin(this,n);this.childrenCache={}},getRoot:function(n,r){if(this.root)n(this.root);else{var u=this.store.query(this.query);u.then&&this.own(u);g(u,f.hitch(this,function(d){if(1!=d.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+d.length+" items, but must return exactly one");this.root=d[0];n(this.root);u.observe&&u.observe(f.hitch(this,function(b){this.onChange(b)}),!0)}),r)}},mayHaveChildren:function(){return!0},getChildren:function(n,
r,u){var d=this.store.getIdentity(n);if(this.childrenCache[d])g(this.childrenCache[d],r,u);else{var b=this.childrenCache[d]=this.store.getChildren(n);b.then&&this.own(b);b.observe&&this.own(b.observe(f.hitch(this,function(e,h,A){this.onChange(e);h!=A&&g(b,f.hitch(this,"onChildrenChange",n))}),!0));g(b,r,u)}},isItem:function(){return!0},getIdentity:function(n){return this.store.getIdentity(n)},getLabel:function(n){return n[this.labelAttr]},newItem:function(n,r,u,d){return this.store.put(n,{parent:r,
before:d})},pasteItem:function(n,r,u,d,b,e){var h=new w;if(r===u&&!d&&!e)return h.resolve(!0),h;r&&!d?this.getChildren(r,f.hitch(this,function(A){A=[].concat(A);var B=p.indexOf(A,n);A.splice(B,1);this.onChildrenChange(r,A);h.resolve(this.store.put(n,{overwrite:!0,parent:u,oldParent:r,before:e,isCopy:!1}))})):h.resolve(this.store.put(n,{overwrite:!0,parent:u,oldParent:r,before:e,isCopy:!0}));return h},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(p,D,H,w,f,g,l,n,r,u,d,b,e,h,A,B){var E=p([A._TreeNode,e],{templateString:w,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=g.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=g.toDom('\x3cinput type\x3d"checkbox" /\x3e');g.addClass(this.checkNode,"jimu-tree-check-node");g.place(this.checkNode,this.contentNode,
"first");this.own(d(this.checkNode,"click",f.hitch(this,this._onClick)));this.own(d(this.rowNode,"keydown",f.hitch(this,function(q,x){x.target=q;x.keyCode!==b.ENTER&&x.keyCode!==b.SPACE||this._onClick(x)},this.checkNode)));this.isLeaf?this.groupId?g.setStyle(this.checkNode,"display","none"):g.setStyle(this.checkNode,"display","inline"):g.setStyle(this.checkNode,"display","none");this.isLeaf?g.addClass(this.domNode,"jimu-tree-leaf-node"):g.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,g.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,g.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(q){(q.target||q.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,q):this.tree._onClick(this,q)},_onChange:function(){this.isLeaf&&setTimeout(f.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return p([A,e],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+B.getRandomString()},postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-tree");this.own(u.before(this,"onClick",f.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&g.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;g.setAttr(this.domNode,"tabindex",0)},removeItem:function(q){this.model.store.remove(q)},getAllItems:function(){var q=this.getAllTreeNodeWidgets();return l.map(q,f.hitch(this,function(x){var k=x.item;k.selected=x.checkNode.checked;return k}))},getSelectedItems:function(){var q=this.getAllTreeNodeWidgets();q=l.filter(q,f.hitch(this,function(x){return x.checkNode.checked}));return l.map(q,
f.hitch(this,function(x){return x.item}))},getFilteredItems:function(q){var x=this.getAllTreeNodeWidgets();x=l.map(x,f.hitch(this,function(k){var m=k.item;m.selected=k.checkNode.checked;return m}));return l.filter(x,f.hitch(this,function(k){return q(k)}))},getTreeNodeByItemId:function(q){for(var x=this._getAllTreeNodeDoms(),k=0;k<x.length;k++){var m=h.byNode(x[k]);if(m.item.id.toString()===q.toString())return m}return null},selectItem:function(q){(q=this.getTreeNodeByItemId(q))&&q.isLeaf&&this.selectNodeWidget(q)},
unselectItem:function(q){(q=this.getTreeNodeByItemId(q))&&q.isLeaf&&q.unselect()},getAllLeafTreeNodeWidgets:function(){var q=this.getAllTreeNodeWidgets();return l.filter(q,f.hitch(this,function(x){return x.isLeaf}))},getAllTreeNodeWidgets:function(){var q=this._getAllTreeNodeDoms();return l.map(q,f.hitch(this,function(x){return h.byNode(x)}))},isLeafItem:function(q){return q&&q.isLeaf},_getAllTreeNodeDoms:function(){return r(".dijitTreeNode",this.domNode)},_createTreeNode:function(q){q.isLeaf=this.isLeafItem(q.item);
this.multiple||(q.groupId=this.uniqueId);return new E(q)},_onTreeNodeSelect:function(q){this.emit("item-select",{item:q.item,treeNode:q})},_onTreeNodeUnselect:function(q){this.emit("item-unselect",{item:q.item,treeNode:q})},selectNodeWidget:function(q){this.multiple||this.unselectAllLeafNodeWidgets();q.select()},_jimuBeforeClick:function(q,x,k){x.isLeaf&&(g.hasClass(k.target||k.srcElement,"jimu-tree-check-node")||(this.multiple?x.toggleSelect():this.selectNodeWidget(x)));return arguments},_onCheckNodeClick:function(q,
x,k){!this.multiple&&x&&this.unselectAllLeafNodeWidgets();n.stop(k);this.focusNode(q);setTimeout(f.hitch(this,function(){x?this.selectNodeWidget(q):q.unselect();this.onClick(q.item,q,k)}),0)},unselectAllLeafNodeWidgets:function(){var q=this.getAllLeafTreeNodeWidgets();l.forEach(q,f.hitch(this,function(x){x.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(p,D,H,w,f,g,l,n,r,u,d,b,e,h,A,B,E,q,x,k,m,y,z,I,F,L,G,J,Q,P,T,Z,da,aa,ba){function N(a){return B.delegate(a.promise||a,{addCallback:function(c){this.then(c)},addErrback:function(c){this.otherwise(c)}})}var Y=w("dijit._TreeNode",[F,L,G,J,Q],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);e("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:T,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var c=Math.max(a,0)*this.tree._nodePixelIndent+"px";u.set(this.domNode,
"backgroundPosition",c+" 0px");u.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",c);p.forEach(this.getChildren(),function(t){t.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var c=this.tree,t=c.model;c._v10Compat&&a===t.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,c,t){var v="_"+c+"Class";c+="Node";var C=this[v];this[v]=this.tree["get"+t+"Class"](a,this.isExpanded);n.replace(this[c],this[v]||"",C||"");u.set(this[c],this.tree["get"+t+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent();a=!a||!a.rowNode||"none"==a.rowNode.style.display;n.toggle(this.domNode,"dijitTreeIsRoot",a);n.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var c=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;n.replace(this.expandoNode,c[a],c);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return N(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");n.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=b.wipeIn({node:this.containerNode,duration:I.defaultDuration}),c=this._expandDeferred=new f(function(){a.stop()});D.after(a,"onEnd",function(){c.resolve(!0)},!0);a.play();return N(c)},collapse:function(){if(this._collapseDeferred)return N(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");n.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=b.wipeOut({node:this.containerNode,duration:I.defaultDuration}),c=this._collapseDeferred=new f(function(){a.stop()});D.after(a,"onEnd",
function(){c.resolve(!0)},!0);a.play();return N(c)},indent:0,setChildItems:function(a){var c=this.tree,t=c.model,v=[],C=c.focusedChild,U=this.getChildren();p.forEach(U,function(K){G.prototype.removeChild.call(this,K)},this);this.defer(function(){p.forEach(U,function(K){if(!K._destroyed&&!K.getParent()){c.dndController.removeTreeNode(K);(function ca(M){var V=t.getIdentity(M.item),X=c._itemNodesMap[V];1==X.length?delete c._itemNodesMap[V]:(V=p.indexOf(X,M),-1!=V&&X.splice(V,1));p.forEach(M.getChildren(),
ca)})(K);if(c.persist){var R=p.map(K.getTreePath(),function(M){return c.model.getIdentity(M)}).join("/"),O;for(O in c._openedNodes)O.substr(0,R.length)==R&&delete c._openedNodes[O];c._saveExpandedNodes()}c.lastFocusedChild&&!l.isDescendant(c.lastFocusedChild.domNode,c.domNode)&&delete c.lastFocusedChild;C&&!l.isDescendant(C.domNode,c.domNode)&&c.focus();K.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,p.forEach(a,function(K){var R=t.getIdentity(K),O=c._itemNodesMap[R];
if(O)for(var W=0;W<O.length;W++)if(O[W]&&!O[W].getParent()){var M=O[W];M.set("indent",this.indent+1);break}M||(M=this.tree._createTreeNode({item:K,tree:c,isExpandable:t.mayHaveChildren(K),label:c.getLabel(K),labelType:c.model&&c.model.labelType||"text",tooltip:c.getTooltip(K),ownerDocument:c.ownerDocument,dir:c.dir,lang:c.lang,textDir:c.textDir,indent:this.indent+1}),O?O.push(M):c._itemNodesMap[R]=[M]);this.addChild(M);(this.tree.autoExpand||this.tree._state(M))&&v.push(c._expandNode(M))},this),p.forEach(this.getChildren(),
function(K){K._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=g(v);this.tree._startPaint(a);return N(a)},getTreePath:function(){for(var a=this,c=[];a&&a!==this.tree.rootNode;)c.unshift(a.item),a=a.getParent();c.unshift(this.tree.rootNode.item);return c},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var c=this.getChildren();0==c.length&&(this.isExpandable=!1,
this.collapse());p.forEach(c,function(t){t._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");n.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){y.focus(this.focusNode)}});e("dojo-bidi")&&Y.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),p.forEach(this.getChildren(),function(c){c.set("textDir",
a)},this))}});var S=w("dijit.Tree",[F,P,L,Q],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:Z,persist:!1,autoExpand:!1,dndController:ba,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,c){q.publish(this.id,B.mixin({tree:this,event:a},c||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new f;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(E(this.containerNode,
E.selector(".dijitTreeNode",x.enter),function(v){a._onNodeMouseEnter(z.byNode(this),v)}),E(this.containerNode,E.selector(".dijitTreeNode",x.leave),function(v){a._onNodeMouseLeave(z.byNode(this),v)}),E(this.containerNode,E.selector(".dijitTreeRow",m.press),function(v){a._onNodePress(z.getEnclosingWidget(this),v)}),E(this.containerNode,E.selector(".dijitTreeRow",m),function(v){a._onClick(z.getEnclosingWidget(this),v)}),E(this.containerNode,E.selector(".dijitTreeRow","dblclick"),function(v){a._onDblClick(z.getEnclosingWidget(this),
v)}));this.model||this._store2model();this.own(D.after(this.model,"onChange",B.hitch(this,"_onItemChange"),!0),D.after(this.model,"onChildrenChange",B.hitch(this,"_onItemChildrenChange"),!0),D.after(this.model,"onDelete",B.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){B.isString(this.dndController)&&(this.dndController=B.getObject(this.dndController));for(var c={},t=0;t<this.dndParams.length;t++)this[this.dndParams[t]]&&(c[this.dndParams[t]]=this[this.dndParams[t]]);
this.dndController=new this.dndController(this,c)}this._load();this.onLoadDeferred=N(this.pendingCommandsPromise);this.onLoadDeferred.then(B.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;h.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=B.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=B.hitch(this,function(c,t,v){this.getItemChildren(this._v10Compat&&c===this.model.root?null:c,t,v)}));this.model=new aa(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(B.hitch(this,function(a){var c=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(c.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(c.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(c.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
c.labelNode.setAttribute("role","presentation"),c.labelNode.removeAttribute("aria-selected"),c.containerNode.setAttribute("role","tree"),c.containerNode.setAttribute("aria-expanded","true"),c.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(c.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(c):this._itemNodesMap[a]=[c];c._updateLayout();this._expandNode(c).then(B.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),B.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=B.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var c=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(B.hitch(this,function(){var t=
p.map(a,function(C){return!C||B.isString(C)?C:c.model.getIdentity(C)}),v=[];p.forEach(t,function(C){v=v.concat(c._itemNodesMap[C]||[])});this.set("selectedNodes",v)}))},_setPathAttr:function(a){return a.length?N(this.set("paths",[a]).then(function(c){return c[0]})):N(this.set("paths",[]).then(function(c){return c[0]}))},_setPathsAttr:function(a){function c(v,C){var U=v.shift(),K=p.filter(C,function(R){return R.getIdentity()==U})[0];if(K)return v.length?t._expandNode(K).then(function(){return c(v,
K.getChildren())}):K;throw new S.PathError("Could not expand path at "+U);}var t=this;return N(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return g(p.map(a,function(v){v=p.map(v,function(C){return C&&B.isObject(C)?t.model.getIdentity(C):C});if(v.length)return c(v,[t.rootNode]);throw new S.PathError("Empty path");}))}).then(function(v){t.set("selectedNodes",v);return t.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function a(t){return c._expandNode(t).then(function(){var v=p.filter(t.getChildren()||[],function(C){return C.isExpandable});return g(p.map(v,a))})}var c=this;return N(a(this.rootNode))},collapseAll:function(){function a(t){var v=p.filter(t.getChildren()||[],function(C){return C.isExpandable});v=g(p.map(v,a));return!t.isExpanded||t==c.rootNode&&!c.showRoot?v:v.then(function(){return c._collapseNode(t)})}var c=this;return N(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,c){return!a||this.model.mayHaveChildren(a)?c?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,c){(a=this._getNext(c))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,c){if(a=c.getPreviousSibling())for(c=a;c.isExpandable&&c.isExpanded&&
c.hasChildren();)c=c.getChildren(),c=c[c.length-1];else if(a=c.getParent(),this.showRoot||a!==this.rootNode)c=a;c&&c.isTreeNode&&this.focusNode(c)},_onRightArrow:function(a,c){c.isExpandable&&!c.isExpanded?this._expandNode(c):c.hasChildren()&&(c=c.getChildren()[0])&&c.isTreeNode&&this.focusNode(c)},_onLeftArrow:function(a,c){c.isExpandable&&c.isExpanded?this._collapseNode(c):(a=c.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var c=a.getChildren();if(!c.length)break;a=c[c.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var c=a.getNextSibling();if(c)return c;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,c){return l.isDescendant(a,
c.expandoNode)||l.isDescendant(a,c.expandoNodeText)},_onNodePress:function(a,c){this.focusNode(a)},__click:function(a,c,t,v){var C=this.isExpandoNode(c.target,a);a.isExpandable&&(t||C)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:c}),this[v](a.item,a,c),this.focusNode(a));c.stopPropagation();c.preventDefault()},_onClick:function(a,c){this.__click(a,c,this.openOnClick,"onClick")},_onDblClick:function(a,c){this.__click(a,c,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){h.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){h.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var c=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(c);return c}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var c=this.model,t=a.item,v=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new f,c.getChildren(t,function(C){a.unmarkProcessing();a.setChildItems(C).then(function(){a._loadDeferred.resolve(C)})},function(C){console.error(v,": error loading "+a.label+" children: ",
C);a._loadDeferred.reject(C)}));c=a._loadDeferred.then(B.hitch(this,function(){var C=a.expand();this.onOpen(a.item,a);this._state(a,!0);return C}));this._startPaint(c);return c},focusNode:function(a){for(var c=[],t=this.domNode;t&&t.tagName&&"IFRAME"!==t.tagName.toUpperCase();t=t.parentNode)c.push({domNode:t.contentWindow||t,scrollLeft:t.scrollLeft||0,scrollTop:t.scrollTop||0});this.focusChild(a);this.defer(function(){for(var v=0,C=c.length;v<C;v++)c[v].domNode.scrollLeft=c[v].scrollLeft,c[v].domNode.scrollTop=
c[v].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var c=this.model.getIdentity(a);if(c=this._itemNodesMap[c]){var t=this.getLabel(a),v=this.getTooltip(a);p.forEach(c,function(C){C.set({item:a,label:t,tooltip:v});C._updateItemClasses(a)})}},_onItemChildrenChange:function(a,c){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&p.forEach(a,function(t){t.setChildItems(c)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var c=this._itemNodesMap[a];
c&&(p.forEach(c,function(t){this.dndController.removeTreeNode(t);var v=t.getParent();v&&v.removeChild(t);this.lastFocusedChild&&!l.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!l.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();t.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=H(this.cookieName);a&&p.forEach(a.split(","),function(c){this._openedNodes[c]=
!0},this)}},_state:function(a,c){if(!this.persist)return!1;var t=p.map(a.getTreePath(),function(v){return this.model.getIdentity(v)},this).join("/");if(1===arguments.length)return this._openedNodes[t];c?this._openedNodes[t]=!0:delete this._openedNodes[t];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],c;for(c in this._openedNodes)a.push(c);H(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!B.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&r.setMarginBox(this.domNode,a);this._nodePixelIndent=r.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(B.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var c=B.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});k(a,c,c)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new Y(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});e("dojo-bidi")&&S.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});S.PathError=d("TreePathError");S._TreeNode=Y;return S})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(p,D,H,w){return H("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(f){w.mixin(this,f);this.connects=[];f=this.store;if(!f.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");f.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([D.after(f,
"onNew",w.hitch(this,"onNewItem"),!0),D.after(f,"onDelete",w.hitch(this,"onDeleteItem"),!0),D.after(f,"onSet",w.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var f;f=this.connects.pop();)f.remove()},getRoot:function(f,g){this.root?f(this.root):this.store.fetch({query:this.query,onComplete:w.hitch(this,function(l){if(1!=l.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+l.length+" items, but must return exactly one");this.root=l[0];f(this.root)}),onError:g})},mayHaveChildren:function(f){return p.some(this.childrenAttrs,
function(g){return this.store.hasAttribute(f,g)},this)},getChildren:function(f,g,l){var n=this.store;if(n.isItemLoaded(f)){for(var r=[],u=0;u<this.childrenAttrs.length;u++){var d=n.getValues(f,this.childrenAttrs[u]);r=r.concat(d)}var b=0;this.deferItemLoadingUntilExpand||p.forEach(r,function(h){n.isItemLoaded(h)||b++});0==b?g(r):p.forEach(r,function(h,A){n.isItemLoaded(h)||n.loadItem({item:h,onItem:function(B){r[A]=B;0==--b&&g(r)},onError:l})})}else{var e=w.hitch(this,arguments.callee);n.loadItem({item:f,
onItem:function(h){e(h,g,l)},onError:l})}},isItem:function(f){return this.store.isItem(f)},fetchItemByIdentity:function(f){this.store.fetchItemByIdentity(f)},getIdentity:function(f){return this.store.getIdentity(f)},getLabel:function(f){return this.labelAttr?this.store.getValue(f,this.labelAttr):this.store.getLabel(f)},newItem:function(f,g,l){var n={parent:g,attribute:this.childrenAttrs[0]},r;this.newItemIdAttr&&f[this.newItemIdAttr]?this.fetchItemByIdentity({identity:f[this.newItemIdAttr],scope:this,
onItem:function(u){u?this.pasteItem(u,null,g,!0,l):(r=this.store.newItem(f,n))&&void 0!=l&&this.pasteItem(r,g,g,!1,l)}}):(r=this.store.newItem(f,n))&&void 0!=l&&this.pasteItem(r,g,g,!1,l)},pasteItem:function(f,g,l,n,r){var u=this.store,d=this.childrenAttrs[0];g&&p.forEach(this.childrenAttrs,function(e){if(u.containsValue(g,e,f)){if(!n){var h=p.filter(u.getValues(g,e),function(A){return A!=f});u.setValues(g,e,h)}d=e}});if(l)if("number"==typeof r){var b=u.getValues(l,d).slice();b.splice(r,0,f);u.setValues(l,
d,b)}else u.setValues(l,d,u.getValues(l,d).concat(f))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(f,g){g&&this.getChildren(g.item,w.hitch(this,function(l){this.onChildrenChange(g.item,l)}))},onDeleteItem:function(f){this.onDelete(f)},onSetItem:function(f,g){if(-1!=p.indexOf(this.childrenAttrs,g))this.getChildren(f,w.hitch(this,function(l){this.onChildrenChange(f,l)}));else this.onChange(f)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(p,D,H,w,f){return D("dijit.tree.ForestStoreModel",f,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(g){this.root={store:this,root:!0,id:g.rootId,label:g.rootLabel,children:g.rootChildren}},mayHaveChildren:function(g){return g===this.root||this.inherited(arguments)},getChildren:function(g,l,n){g===this.root?this.root.children?l(this.root.children):this.store.fetch({query:this.query,onComplete:w.hitch(this,
function(r){this.root.children=r;l(r)}),onError:n}):this.inherited(arguments)},isItem:function(g){return g===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(g){if(g.identity==this.root.id){var l=g.scope||H.global;g.onItem&&g.onItem.call(l,this.root)}else this.inherited(arguments)},getIdentity:function(g){return g===this.root?this.root.id:this.inherited(arguments)},getLabel:function(g){return g===this.root?this.root.label:this.inherited(arguments)},newItem:function(g,l,n){return l===
this.root?(this.onNewRootItem(g),this.store.newItem(g)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(g,l,n,r,u){if(l===this.root&&!r)this.onLeaveRoot(g);this.inherited(arguments,[g,l===this.root?null:l,n===this.root?null:n,r,u]);if(n===this.root)this.onAddToRoot(g)},onAddToRoot:function(g){console.log(this,": item ",g," added to root")},onLeaveRoot:function(g){console.log(this,": item ",g," removed from root")},_requeryTop:function(){var g=this.root.children||[];this.store.fetch({query:this.query,
onComplete:w.hitch(this,function(l){this.root.children=l;if(g.length!=l.length||p.some(g,function(n,r){return l[r]!=n}))this.onChildrenChange(this.root,l)})})},onNewItem:function(g,l){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(g){-1!=p.indexOf(this.root.children,g)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(g,l,n,r){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(p,D,H,w,f,g,l,n,r,u,d){return D("dijit.tree._dndSelector",d,{constructor:function(){this.selection={};this.anchor=null;this.events.push(n(this.tree.domNode,r.press,w.hitch(this,"onMouseDown")),n(this.tree.domNode,r.release,w.hitch(this,"onMouseUp")),n(this.tree.domNode,r.move,w.hitch(this,"onMouseMove")),n(this.tree.domNode,u.press,w.hitch(this,"onClickPress")),n(this.tree.domNode,u.release,w.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var b=[],e=this.selection,
h;for(h in e)b.push(e[h]);return b},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(b,e){this.setSelection(this.getSelectedTreeNodes().concat([b]));e&&(this.anchor=b);return b},removeTreeNode:function(b){var e=p.filter(this.getSelectedTreeNodes(),function(h){return!g.isDescendant(h.domNode,b.domNode)});this.setSelection(e);return b},isTreeNodeSelected:function(b){return b.id&&!!this.selection[b.id]},
setSelection:function(b){var e=this.getSelectedTreeNodes();p.forEach(this._setDifference(e,b),w.hitch(this,function(h){h.setSelected(!1);this.anchor==h&&delete this.anchor;delete this.selection[h.id]}));p.forEach(this._setDifference(b,e),w.hitch(this,function(h){h.setSelected(!0);this.selection[h.id]=h}));this._updateSelectionProperties()},_setDifference:function(b,e){p.forEach(e,function(h){h.__exclude__=!0});b=p.filter(b,function(h){return!h.__exclude__});p.forEach(e,function(h){delete h.__exclude__});
return b},_updateSelectionProperties:function(){var b=this.getSelectedTreeNodes(),e=[],h=[];p.forEach(b,function(A){var B=A.getTreePath();h.push(A);e.push(B)},this);b=p.map(h,function(A){return A.item});this.tree._set("paths",e);this.tree._set("path",e[0]||[]);this.tree._set("selectedNodes",h);this.tree._set("selectedNode",h[0]||null);this.tree._set("selectedItems",b);this.tree._set("selectedItem",b[0]||null)},onClickPress:function(b){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(b.target,
this.current))){"mousedown"==b.type&&l.isLeft(b)&&b.preventDefault();var e="keydown"==b.type?this.tree.focusedChild:this.current;if(e){var h=f.getCopyKeyState(b),A=e.id;this.singular||b.shiftKey||!this.selection[A]?(this._doDeselect=!1,this.userSelect(e,h,b.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(b){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==b.type?this.tree.focusedChild:this.current,f.getCopyKeyState(b),b.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(b,e){if(b===e)return 0;if("sourceIndex"in document.documentElement)return b.sourceIndex-e.sourceIndex;if("compareDocumentPosition"in document.documentElement)return b.compareDocumentPosition(e)&2?1:-1;if(document.createRange){var h=doc.createRange();h.setStartBefore(b);b=doc.createRange();b.setStartBefore(e);return h.compareBoundaryPoints(h.END_TO_END,b)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(b,e,h){if(this.singular)this.anchor==b&&e?this.selectNone():(this.setSelection([b]),this.anchor=b);else if(h&&this.anchor){e=this._compareNodes(this.anchor.rowNode,b.rowNode);h=this.anchor;0>e?e=h:(e=b,b=h);for(h=[];e!=b;)h.push(e),e=this.tree._getNext(e);h.push(b);this.setSelection(h)}else this.selection[b.id]&&e?this.removeTreeNode(b):e?this.addTreeNode(b,!0):(this.setSelection([b]),this.anchor=b)},getItem:function(b){return{data:this.selection[b],type:["treeNode"]}},forInSelectedItems:function(b,
e){e=e||H.global;for(var h in this.selection)b.call(e,this.getItem(h),h,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(p,D,H,w,f,g){return D("dijit.tree._dndContainer",null,{constructor:function(l,n){this.tree=l;this.node=l.domNode;w.mixin(this,n);this.containerState="";H.add(this.node,"dojoDndContainer");this.events=[f(this.node,g.enter,w.hitch(this,"onOverEvent")),f(this.node,g.leave,
w.hitch(this,"onOutEvent")),p.after(this.tree,"_onNodeMouseEnter",w.hitch(this,"onMouseOver"),!0),p.after(this.tree,"_onNodeMouseLeave",w.hitch(this,"onMouseOut"),!0),f(this.node,"dragstart, selectstart",function(r){r.preventDefault()})]},destroy:function(){for(var l;l=this.events.pop();)l.remove();this.node=this.parent=null},onMouseOver:function(l){this.current=l},onMouseOut:function(){this.current=null},_changeState:function(l,n){var r="dojoDnd"+l;l=l.toLowerCase()+"State";H.replace(this.node,r+
n,r+this[l]);this[l]=n},_addItemClass:function(l,n){H.add(l,"dojoDndItem"+n)},_removeItemClass:function(l,n){H.remove(l,"dojoDndItem"+n)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapLite":function(){define("dojo/on dojo/_base/declare dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/LayerStructure".split(" "),function(p,
D,H,w,f,g,l,n,r){var u=D([n],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"treeSection" class\x3d"tree-section"\x3e\x3cul data-dojo-attach-point\x3d"treeUl" class\x3d"tree-ul tree-root-ul"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e',
map:null,layerStateController:null,layerState:null,customFilter:null,onlySelectLeafLayer:!1,displayLayerTypeIcon:!0,showTables:!0,viewMode:!1,onlyShowWebMapLayers:!1,layerStructure:null,_layerDatas:null,_eventHandles:null,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map-lite");this._layerDatas={};this._eventHandles=[];this.layerStructure=
this.map?r.createInstance(this.map):r.getInstance();this.layerInfosObj=this.layerStructure._layerInfos;this.layerState=this._clearLayerState(this.layerState)||{};this.layerStateController||(this.layerStateController=new u.LayerStateController);var d=this.customFilter?w.hitch(this,this.customFilter):w.hitch(this,this.filter);this.filter=n.andCombineFilters([this.basicFilter,d]);this._createTree()},_createTree:function(){if(this.onlyShowWebMapLayers){var d=this.layerStructure.getWebmapLayerNodes();
var b=this.layerStructure.getWebmapTableNodes()}else d=this.layerStructure.getLayerNodes(),b=this.layerStructure.getTableNodes();0<this._createLayerNodes(d.concat(this.showTables?b:[]),this.treeUl)&&(f.setStyle(this.errorTipSection,"display","none"),this.layerStateController.restoreState(this.layerState,this.layerStructure))},_createLayerNodes:function(d,b){var e=g.map(d,function(A){return this.filter(A._layerInfo)},this),h=0;H(e).then(w.hitch(this,function(A){g.forEach(A,function(B,E){B&&(this._createLayerNode(d[E],
b),h++)},this)}));return h},_createLayerNode:function(d,b){var e=f.create("li",{"class":"tree-node-li",id:"layerchooserlite-tree-node-li-"+d.id},b),h=f.create("div",{"class":"tree-node-div"},e);b=f.create("span",{"class":"tree-node-column-span collapse-span"},h);var A=f.create("span",{"class":"tree-node-column-span check-box-span"},h);A=f.create("div",{"class":"tree-node-column-div check-box-div"},A);var B=f.create("span",{"class":"tree-node-column-span icon-span "+(this.displayLayerTypeIcon?"display":
"")},h);var E=(E=this.layerState[d.id])?E.selected:this.layerStateController.getState(d);E=new l({checked:E},A);var q=f.create("span",{"class":"tree-node-column-span title-span",innerHTML:d.title},h),x=f.create("ul",{"class":"tree-ul tree-subnode-ul",style:"display:none; "},e);e={layerNode:d,layerNodeLi:e,layerNodeDiv:h,collapseSpan:b,iconSpan:B,checkBox:E,subLayerNodeUl:x,hasBeenOpened:!1};this._layerDatas[d.id]=e;d.isLeaf()||(f.addClass(b,"is-leaf"),f.addClass(q,"is-leaf"),d=p(b,"click",w.hitch(this,
this._onCollapse,e)),this._eventHandles.push(d),d=p(q,"click",w.hitch(this,this._onCollapse,e)),this._eventHandles.push(d),this.onlySelectLeafLayer&&(E.setStatus(!1),f.setStyle(A,"display","none")));!0===this.viewMode&&E.setStatus(!1);d=p(E.domNode,"click",w.hitch(this,this._onCheckBoxChange,e));this._eventHandles.push(d);this._setIconImage(e,!1);return e},_setIconImage:function(d,b){if(this.displayLayerTypeIcon){var e=d.layerNode,h=e.getLayerType(),A=e.getLayerObject();H({layerType:h,layerObject:A}).then(w.hitch(this,
function(B){if(B.layerType&&B.layerObject){var E={type:B.layerType,layerInfo:e._layerInfo};B=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");(E=this._getIconInfo(E,b).imageName)&&f.setStyle(d.iconSpan,"background-image","url("+B+"/css/images/"+E+")")}}))}},_getCheckBoxValue:function(d){return d.getStatus()?d.getValue():!1},_clearLayerState:function(d){var b={};d&&this.layerStructure.traversal(w.hitch(this,function(e){d[e.id]&&(b[e.id]={selected:d[e.id].selected})}));return b},
_selectOrDeselectLayer:function(d,b){if(d=this._layerDatas[d])d.checkBox.setValue(b),this._onCheckBoxChange(d)},selectLayer:function(d){this._selectOrDeselectLayer(d,!0)},deselectLayer:function(d){this._selectOrDeselectLayer(d,!1)},getState:function(){var d=w.clone(this.layerState),b;for(b in this._layerDatas)this._layerDatas.hasOwnProperty(b)&&"function"!==typeof this._layerDatas[b]&&(this._getCheckBoxValue(this._layerDatas[b].checkBox)?d[b]={selected:!0}:d[b]={selected:!1});return d},restoreState:function(d){this.layerState=
this._clearLayerState(d);for(var b in this._layerDatas)if(this._layerDatas.hasOwnProperty(b)&&"function"!==typeof this._layerDatas[b]){var e=(d=this._layerDatas[b])&&d.checkBox,h=this.layerState[b];h?e.setValue(h.selected):e.setValue(this.layerStateController.getState(d.layerNode))}this.layerStateController.restoreState(this.layerState,this.layerStructure)},setViewMode:function(d){for(var b in this._layerDatas)if(this._layerDatas.hasOwnProperty(b)&&"function"!==typeof this._layerDatas[b]){var e=this._layerDatas[b];
e=e&&e.checkBox;!0===d?(this.viewMode=!0,e.setStatus(!1)):(this.viewMode=!1,e.setStatus(!0))}},getSelectedLayerNodes:function(){var d=[],b=this.getState(),e;for(e in b)if(b.hasOwnProperty(e)&&"function"!==typeof b[e]&&b[e].selected){var h=this.layerStructure.getNodeById(e);h&&d.push(h)}return d},getLoadedLayerNodes:function(){var d=[],b;for(b in this._layerDatas)if(this._layerDatas.hasOwnProperty(b)&&"function"!==typeof this._layerDatas[b]){var e=this.layerStructure.getNodeById(b);e&&d.push(e)}return d},
getLayerAssociateDomNodesById:function(d){var b=null;(d=this._layerDatas[d])&&(b={collapseIcon:d.collapseSpan,checkBox:d.checkBox.domNode,layerTypeIcon:d.iconSpan});return b},getSelectedItems:function(){var d=[];return d=g.map(this.getSelectedLayerNodes(),function(b){return{name:b.title,url:b.getUrl(),layerInfo:b._layerInfo}},this)},getAllItems:function(){return[]},_clear:function(){this._layerDatas={};g.forEach(this._eventHandles,function(d){d.remove()},this);this._eventHandles=[];f.empty(this.treeUl)},
destroy:function(){this._clear();this.map&&this.layerStructure.destroy();this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)},_onCollapse:function(d){var b="none"===f.getStyle(d.subLayerNodeUl,"display")?!0:!1;b?(f.setStyle(d.subLayerNodeUl,"display","block"),f.addClass(d.collapseSpan,"opened")):(f.setStyle(d.subLayerNodeUl,"display","none"),f.removeClass(d.collapseSpan,"opened"));this._setIconImage(d,b);d.hasBeenOpened||(this._createLayerNodes(d.layerNode.getSubNodes(),
d.subLayerNodeUl),d.hasBeenOpened=!0)},_onCheckBoxChange:function(d,b){this.layerStateController.setState(d.layerNode,this._getCheckBoxValue(d.checkBox));this.emit("selection-change",d.layerNode,this._getCheckBoxValue(d.checkBox));this._onTreeClick(d,b)},_onLayerInfosChanged:function(){this._createTree();this.emit("update")},_onLayerInfosIsShowInMapChanged:function(){this._createTree();this.emit("update")},_onTreeClick:function(d,b){d={name:d.layerNode.title||"",parent:null,layerInfo:d.layerNode._layerInfo,
type:null,layerClass:null,id:null,isLeaf:d.layerNode.isLeaf(),hasChildren:d.layerNode.isLeaf()?!1:!0};this.emit("tree-click",d,null,b)}});u.LayerStateController=D(null,{getState:function(d){return!0},setState:function(d,b){return this},restoreState:function(d,b){return this}});u.LayerVisibilityStateController=D(u.LayerStateController,{getState:function(d){return d.isToggledOn()},setState:function(d,b){d.toggle();return this},restoreState:function(d,b){var e={layerOptions:{}},h;for(h in d)d.hasOwnProperty(h)&&
"function"!==typeof d[h]&&(e.layerOptions[h]={visible:d[h].selected});b.restoreState(e);return this}});u.layerVisibilityStateController=new u.LayerVisibilityStateController;u.LayerLegendStateController=D(u.LayerStateController,{getState:function(d){return d.isShowLegend()}});u.layerLegendStateController=new u.LayerLegendStateController;return u})},"jimu/dijit/ColorPickerButton":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/popup jimu/dijit/ColorSelector".split(" "),
function(p,D,H,w,f,g,l,n,r,u){return p([D,H],{baseClass:"jimu-color-picker-btn",declaredClass:"jimu.dijit.ColorPickerButton",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"color-node" data-dojo-attach-point\x3d"colorNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"seperator"\x3e\x3c/div\x3e\x3cdiv class\x3d"action-node" data-dojo-attach-point\x3d"actionNode"\x3e\x3c/div\x3e\x3c/div\x3e',_isTooltipDialogOpened:!1,color:null,showHex:!0,showHsv:!0,showRgb:!0,ensureMode:!1,postMixInProperties:function(){this.nls=
window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.color?this.color instanceof l||(this.color=new l(this.color)):this.color=new l("#ccc");f.setStyle(this.colorNode,"backgroundColor",this.color.toHex());this.colorNode.title=this.color.toHex();this.showLabel&&this._changeLabel(this.color);this._createTooltipDialog(this.domNode);this._hideTooltipDialog();this.own(g(this.colorNode,"click",w.hitch(this,this._onNodeClick)));this.own(g(this.actionNode,"click",w.hitch(this,this._onNodeClick)));
this.own(g(document.body,"click",w.hitch(this,function(d){this.isPartOfPopup(d.target||d.srcElement)||this._hideTooltipDialog()})))},_onNodeClick:function(d){d.stopPropagation();d.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()},destroy:function(){r.close(this.tooltipDialog);this.picker.destroy();this.tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(d){var b=this.tooltipDialog.domNode;return d===b||f.isDescendant(d,b)},hideTooltipDialog:function(){this._hideTooltipDialog()},
_showTooltipDialog:function(){r.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode});this._isTooltipDialogOpened=!0},_hideTooltipDialog:function(){r.close(this.tooltipDialog);this._isTooltipDialogOpened=!1},_createTooltipDialog:function(){var d=f.create("div");this.tooltipDialog=new n({content:d});f.addClass(this.tooltipDialog.domNode,"jimu-color-picker-dialog");this.picker=new u({showHex:this.showHex,showRgb:this.showRgb,showHsv:this.showHsv,value:this.color.toHex(),onChange:w.hitch(this,
function(e){this.ensureMode||(e=new l(e),this.setColor(e))})});this.picker.placeAt(d);this.picker.startup();if(this.ensureMode){var b=f.create("div",{"class":"jimu-btn jimu-btn-vacation jimu-float-trailing jimu-leading-margin1",title:this.nls.cancel,innerHTML:this.nls.cancel},d);this.own(g(b,"click",w.hitch(this,function(){this._hideTooltipDialog()})));b=f.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.ok,innerHTML:this.nls.ok},d);this.own(g(b,"click",w.hitch(this,
function(){var e=this.picker.get("value");this.setColor(new l(e));this._hideTooltipDialog()})));d=f.create("div",{"class":"jimu-btn jimu-float-trailing jimu-leading-margin1",title:this.nls.apply,innerHTML:this.nls.apply},d);this.own(g(d,"click",w.hitch(this,function(){var e=this.picker.get("value");this.setColor(new l(e))})))}},setColor:function(d){if(d instanceof l){var b=this.color,e="";b&&(e=b.toHex());b=d.toHex();this.color=d;f.setStyle(this.colorNode,"backgroundColor",b);e!==b&&(this.picker.set("value",
b),this.onChange(new l(b)))}},getColor:function(){return this.color},onChange:function(d){}})})},"widgets/Select/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Select/setting/Setting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.chooseSelectingTools}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"drawingToolsContainer" class\x3d"drawing-tools-container jimu-draw-box" data-dojo-attach-event\x3d"onclick:_onDrawingToolsContainerClicked"\x3e\r\n      \x3cdiv class\x3d"draw-item point-icon" title\x3d"${nls.selectByPoint}" data-geotype\x3d"POINT"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item polyline-icon" title\x3d"${nls.selectByLine}" data-geotype\x3d"POLYLINE"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item extent-icon" title\x3d"${nls.selectByRectangle}" data-geotype\x3d"EXTENT"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item circle-icon" title\x3d"${nls.selectByCircle}" data-geotype\x3d"CIRCLE"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item polygon-icon" title\x3d"${nls.selectByPolygon}" data-geotype\x3d"POLYGON"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"draw-item freehand-polygon-icon" title\x3d"${nls.selectByFreehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON"\x3e\r\n        \x3cdiv class\x3d"draw-item-icon"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"config-section inline"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.setSelectionColor}\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"colorPicker" data-dojo-type\x3d"jimu/dijit/ColorPickerButton"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.selectionMode}\x3c/div\x3e\r\n    \x3cdiv class\x3d"option"\x3e\r\n      \x3cinput id\x3d"selectModePartial" name\x3d"selectionMode" data-dojo-type\x3d"dijit/form/RadioButton"\r\n        data-dojo-attach-point\x3d"partialMode"/\x3e\r\n      \x3clabel for\x3d"selectModePartial"\x3e${nls.partiallyWithin}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"option"\x3e\r\n      \x3cinput id\x3d"selectModeWhole" name\x3d"selectionMode" data-dojo-type\x3d"dijit/form/RadioButton"\r\n        data-dojo-attach-point\x3d"whollyMode"/\x3e\r\n      \x3clabel for\x3d"selectModeWhole"\x3e${nls.whollyWithin}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"enableByDefaultCheckBoxDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"exportCheckBoxDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"runtimeLayersCheckBoxDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"config-section"\x3e\r\n    \x3cdiv class\x3d"label"\x3e${nls.layerToSelect}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-chooser" data-dojo-attach-point\x3d"layerChooserDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Select/setting/css/style.css":".jimu-widget-select-setting {margin: 20px 0;}.jimu-widget-select-setting .config-section {width: 100%; margin-bottom: 20px;}.jimu-widget-select-setting .config-section label {color: #353535; font-size: 12px;}.jimu-widget-select-setting .config-section .jimu-color-picker {width: 30px; height: 30px; margin: 0 20px;}.jimu-widget-select-setting .config-section .option {margin: 15px;}.jimu-widget-select-setting .config-section .option input {margin: 0 10px;}.jimu-widget-select-setting .inline \x3e div {display: inline-block; vertical-align: middle;}.jimu-widget-select-setting .label {color: #353535; font-size: 14px;}.jimu-widget-select-setting .drawing-tools-container {margin-top: 5px; overflow: hidden;}.jimu-widget-select-setting .drawing-tools-container .draw-item {float: left; width: 48px; height: 48px; cursor: pointer; background-repeat: no-repeat; background-position: center center; margin-left: 5px; position: relative; border: 1px solid #DBDBDB; border-radius: 1px; color: #666; font-size: 24px; padding: 12px;}.jimu-widget-select-setting .drawing-tools-container .draw-item.point-icon {padding: 12px 17px;}.jimu-rtl .jimu-widget-select-setting .drawing-tools-container .draw-item {float: right; margin-left: 0; margin-right: 5px;}.jimu-widget-select-setting .drawing-tools-container .draw-item:first-child {margin-left: 0 !important; margin-right: 0 !important;}.jimu-widget-select-setting .drawing-tools-container .draw-item .draw-item-icon {position: absolute; left: 2px; top: 2px; width: 16px; height: 16px; display: none; background: url(images/checked.png) center center no-repeat; background-color: #fff;}.jimu-rtl .jimu-widget-select-setting .drawing-tools-container .draw-item .draw-item-icon {left: auto; right: 2px;}.jimu-widget-select-setting .drawing-tools-container .draw-item.selected .draw-item-icon {display: block;}.jimu-widget-select-setting .jimu-basic-layer-chooser-from-map-lite .check-box-div.jimu-state-disabled {display: none;}",
"*now":function(p){p(['dojo/i18n!*preload*widgets/Select/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/on dojo/_base/array dojo/query dojo/_base/html dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapLite jimu/dijit/ColorPickerButton dijit/form/RadioButton".split(" "),function(p,D,H,w,f,g,l,n,r,u,d,b){return p([r,n],{baseClass:"jimu-widget-select-setting",selectionColor:"",selectionMode:"",allowExport:!1,postMixInProperties:function(){this.inherited(arguments);
D.mixin(this.nls,window.jimuNls.featureSetChooser)},postCreate:function(){this.inherited(arguments);this.enableByDefaultCheckBox=new u({label:this.nls.enableByDefault,checked:this.config&&!1!==this.config.enableByDefault,onChange:D.hitch(this,this._onEnableByDefaultChange)},this.enableByDefaultCheckBoxDiv);this.allowExportCheckBox=new u({label:this.nls.allowExport,checked:this.config&&this.config.allowExport,onChange:D.hitch(this,this._onAllowExportChange)},this.exportCheckBoxDiv);this.includeRuntimeLayersCheckBox=
new u({label:this.nls.includeRuntimeLayers,checked:this.config&&!1!==this.config.includeRuntimeLayers,onChange:D.hitch(this,this._onIncludeRuntimeLayersChange)},this.runtimeLayersCheckBoxDiv);this.config&&this._init();this.own(w(this.partialMode,"click",D.hitch(this,this._onSelectPartialMode)));this.own(w(this.whollyMode,"click",D.hitch(this,this._onSelectWhollyMode)));this.own(w(this.colorPicker,"change",D.hitch(this,this._onColorChange)))},_onColorChange:function(e){this.selectionColor=e.toHex()},
_onSelectPartialMode:function(){this.selectionMode="partial"},_onSelectWhollyMode:function(){this.selectionMode="wholly"},_onAllowExportChange:function(e){this.allowExport=e},_onEnableByDefaultChange:function(e){this.enableByDefault=e},_onIncludeRuntimeLayersChange:function(e){this.includeRuntimeLayers=e},_init:function(){(this.selectionColor=this.config.selectionColor)&&this.colorPicker.setColor(new H(this.selectionColor));this.selectionMode=this.config.selectionMode;"partial"===this.config.selectionMode?
(this.partialMode.set("checked",!0),this._onSelectPartialMode()):"wholly"===this.config.selectionMode&&(this.whollyMode.set("checked",!0),this._onSelectWhollyMode());this.enableByDefault=!1!==this.config.enableByDefault;this.enableByDefaultCheckBox.setValue(this.enableByDefault);this.allowExport=this.config.allowExport;this.allowExportCheckBox.setValue(this.allowExport);this.includeRuntimeLayers=!1!==this.config.includeRuntimeLayers;this.includeRuntimeLayersCheckBox.setValue(this.includeRuntimeLayers);
this._selectDrawingTools(this.config.geometryTypes||["EXTENT"]);if(this.layerChooser)this.config.layerState&&this.layerChooser.restoreState(this.config.layerState);else{var e=d.createFeaturelayerFilter(null,!0,!1,!1);this.layerChooser=new b({customFilter:e,onlySelectLeafLayer:!0,onlyShowWebMapLayers:!0,layerState:this.config.layerState});this.layerChooser.placeAt(this.layerChooserDiv);this.layerChooser.startup()}},setConfig:function(e){this.config=e;this._init()},getConfig:function(){return{selectionColor:this.selectionColor,
selectionMode:this.selectionMode,enableByDefault:this.enableByDefault,allowExport:this.allowExport,includeRuntimeLayers:this.includeRuntimeLayers,geometryTypes:this._getSelectedDrawingTools(),layerState:this.layerChooser.getState()}},_onDrawingToolsContainerClicked:function(e){e=e.target||e.srcElement;var h=null;l.hasClass(e,"draw-item")?h=e:l.hasClass(e,"draw-item-icon")&&(h=e.parentNode);h&&(l.toggleClass(h,"selected"),0===g(".selected",this.drawingToolsContainer).length&&l.addClass(h,"selected"))},
_selectDrawingTools:function(e){var h=g(".draw-item",this.drawingToolsContainer);f.forEach(h,D.hitch(this,function(A){var B=A.getAttribute("data-geotype");0<=e.indexOf(B)?l.addClass(A,"selected"):l.removeClass(A,"selected")}))},_getSelectedDrawingTools:function(){var e=[];e=g(".draw-item.selected",this.drawingToolsContainer);return e=f.map(e,D.hitch(this,function(h){return h.getAttribute("data-geotype")}))}})});