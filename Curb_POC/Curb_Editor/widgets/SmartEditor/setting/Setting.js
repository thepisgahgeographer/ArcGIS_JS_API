// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/SmartEditor/setting/EditFields":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-style dojo/dom-construct dojo/on dojo/string dojo/query dojo/text!./EditFields.html ./FieldValidation ./CopyAttributes dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup jimu/dijit/Message esri/lang dijit/registry".split(" "),function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B){return F([G,J,u],{baseClass:"jimu-widget-smartEditor-setting-fields",
templateString:h,_configInfo:null,_fieldValid:null,_fieldValidations:null,_fieldValues:null,_attachmentValidations:null,__layerName:null,_removeFromSmartActionsGroup:[],_removeFromAttributeActionsGroup:[],postCreate:function(){this.inherited(arguments);this._removeFromSmartActionsGroup=[];this._removeFromAttributeActionsGroup=[];this.fieldsPopUp=null;this._initFieldsTable();if(this.honorWebMapSettings)var c=this.editUtils.mergeFieldInfosWithConfiguration(this._configInfo.layerInfo,null);this._setFieldsTable(c||
this._configInfo.fieldInfos);this._fieldValidations=void 0===this._configInfo.fieldValidations?{}:x.clone(this._configInfo.fieldValidations);this._fieldValues=void 0===this._configInfo.fieldValues?{}:x.clone(this._configInfo.fieldValues);this._attachmentValidations=void 0===this._configInfo.attachmentValidations?{}:x.clone(this._configInfo.attachmentValidations);this.own(e(this.attachmentsValidation,"click",x.hitch(this,function(){this._onAttachmentsValidationClicked()})));this._configInfo.layerInfo.layerObject.hasAttachments?
t.set(this.attachmentsValidation,"display","block"):t.set(this.attachmentsValidation,"display","none")},popupEditPage:function(){this.fieldsPopUp=new f({titleLabel:w.substitute({layername:this._layerName},this.nls.fieldsPage.title),width:972,maxHeight:700,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){this._validateTable()?(this.honorWebMapSettings||this._resetFieldInfos(),this._configInfo.fieldValidations=this._fieldValidations,this._configInfo.fieldValues=
this._fieldValues,this._configInfo.attachmentValidations=this._attachmentValidations,this.emit("RemoveFromGroup",{smartActionGroupInfo:this._removeFromSmartActionsGroup,attributeActionGroupInfo:this._removeFromAttributeActionsGroup}),this.fieldsPopUp.close()):g({message:b.substitute(this.nls.fieldsPage.noDisplayFieldWarningMsg,{layerName:this._layerName})})})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){this.fieldsPopUp.close()})}],onClose:x.hitch(this,
function(){})})},_initFieldsTable:function(){this._fieldsTable=new C({fields:[{name:"required",title:"",type:"text","class":"required"},{name:"visible",title:this.nls.fieldsPage.fieldsSettingsTable.display,type:"checkbox","class":"visible",width:"15%"},{name:"isEditable",title:this.nls.fieldsPage.fieldsSettingsTable.edit,type:"checkbox","class":"editable",width:"15%"},{name:"fieldName",title:this.nls.fieldsPage.fieldsSettingsTable.fieldName,type:"text","class":"fieldName",width:"30%"},{name:"label",
title:this.nls.fieldsPage.fieldsSettingsTable.fieldAlias,type:"text",editable:!1,"class":"fieldLabel",width:"30%"},{name:"actions",title:this.nls.fieldsPage.fieldsSettingsTable.actions,type:"actions",actions:["up","down","edit","copy"],"class":"actions",width:"10%"}],selectable:!1,style:{height:"300px",maxHeight:"300px"}});this._fieldsTable.placeAt(this.fieldsTable);this._fieldsTable.startup();d("th.simple-table-field",this._fieldsTable.domNode).forEach(function(c){switch(void 0===c.innerText||""===
c.innerText?"":c.innerText.replace(/(\r\n|\n|\r)/gm,"")){case this.nls.fieldsPage.fieldsSettingsTable.display:c.title=this.nls.fieldsPage.fieldsSettingsTable.displayTip;break;case this.nls.fieldsPage.fieldsSettingsTable.edit:c.title=this.nls.fieldsPage.fieldsSettingsTable.editTip;break;case this.nls.fieldsPage.fieldsSettingsTable.fieldName:c.title=this.nls.fieldsPage.fieldsSettingsTable.fieldNameTip;break;case this.nls.fieldsPage.fieldsSettingsTable.fieldAlias:c.title=this.nls.fieldsPage.fieldsSettingsTable.fieldAliasTip;
break;case this.nls.fieldsPage.fieldsSettingsTable.actions:c.title=this.nls.fieldsPage.fieldsSettingsTable.actionsTip}},this);this.own(e(this._fieldsTable,"actions-edit",x.hitch(this,this._onEditFieldInfoClick)))},_validateTable:function(){if(this.honorWebMapSettings||0===this._configInfo.fieldInfos.length)return!0;var c=this._fieldsTable.getRows();return 0===c.length?!1:K.some(c,function(m){return this._fieldsTable.getRowData(m).visible},this)},_onEditFieldInfoClick:function(c){c=this._fieldsTable.getRowData(c);
var m=w.substitute({fieldname:c.fieldName},this.nls.actionPage.smartActionTitle),A={fields:x.clone(this._configInfo.layerInfo.layerObject.fields)};this._fieldValid=new n({nls:this.nls,_layerDefinition:A,_layerId:this._configInfo.layerInfo.layerObject.id,_url:this._configInfo.layerInfo.layerObject.url,_fieldValidations:this._fieldValidations,_fieldName:c.fieldName,_fieldAlias:c.label,popupTitle:m,_smartActionsTable:this._smartActionsTable});this._fieldValid.removeFromGroup=x.hitch(this,function(D){this._removeFromSmartActionsGroup.push(D)});
this._fieldValid.onGroupEditingStart=x.hitch(this,function(){this.fieldsPopUp&&this.fieldsPopUp.close();this._tab&&this._tab.selectTab(this.nls.layersPage.smartActionsTabTitle)});this._fieldValid.popupActionsPage()},_onCopyAttrButtonClick:function(c){var m=this._fieldsTable.getRowData(c),A={fields:x.clone(this._configInfo.layerInfo.layerObject.fields)};this._copyAttr=new p({nls:this.nls,_layerDefinition:A,_fieldInfos:this._configInfo.fieldInfos,_layerId:this._configInfo.layerInfo.layerObject.id,_url:this._configInfo.layerInfo.layerObject.url,
_fieldName:m.fieldName,_fieldAlias:m.label,_fieldValues:this._fieldValues,_geocoderSettings:this._geocoderSettings,_configuredPresetInfos:this._configuredPresetInfos,layerInfos:this.layerInfos,isRelatedLayer:this.isRelatedLayer,map:this.map,_fieldType:c.fieldType,_attributeActionsTable:this._attributeActionsTable});this.own(e(this._copyAttr,"onGroupEditingStart",x.hitch(this,function(D){this.fieldsPopUp&&this.fieldsPopUp.close();this._tab&&this._tab.selectTab(D)})));this.own(e(this._copyAttr,"removeFromGroup",
x.hitch(this,function(D){this._removeFromAttributeActionsGroup.push(D)})));this._copyAttr.popupActionsPage();this.own(e(this._copyAttr,"SetGeocoder",x.hitch(this,function(){this.emit("SetGeocoder")})))},_onAttachmentsValidationClicked:function(){var c=w.substitute({layername:this._layerName},this.nls.fieldsPage.smartAttachmentPopupTitle),m={fields:x.clone(this._configInfo.layerInfo.layerObject.fields)};this._attachmentFieldValidation=new n({nls:this.nls,_layerDefinition:m,_layerId:this._configInfo.layerInfo.layerObject.id,
_url:this._configInfo.layerInfo.layerObject.url,_fieldValidations:this._attachmentValidations,_fieldName:"Actions",_fieldAlias:"",popupTitle:c});this._attachmentFieldValidation.popupActionsPage()},_setFieldsTable:function(c){var m,A,D;K.forEach(c,function(N){var L=N.visible;"esriFieldTypeGeometry"!==N.type&&"esriFieldTypeOID"!==N.type&&"esriFieldTypeBlob"!==N.type&&"esriFieldTypeGlobalID"!==N.type&&"esriFieldTypeRaster"!==N.type&&"esriFieldTypeXML"!==N.type&&(!1===N.visible&&!0===N.isEditable&&(L=
!0),L={fieldName:N.fieldName,isEditable:N.hasOwnProperty("isEditable")?N.isEditable:N.editable,label:N.label,visible:L},N.hasOwnProperty("nullable")&&!1===N.nullable?L.required="*":L.required="",m=this._fieldsTable.addRow(L).tr,D=d(".jimu-icon-edit",m)[0],D.title=this.nls.fieldsPage.editActionTip,A=m.children[m.children.length-1],m.fieldType=N.type,this._addNewAction(A.children[0],m))},this);setTimeout(x.hitch(this,function(){K.forEach(this._fieldsTable.fields,function(L){"visible"===L.name?L.onChange=
x.hitch(this,this._onDisplayFieldChanged):"isEditable"===L.name&&(L.onChange=x.hitch(this,this._onIsEditableFieldChanged))},this);if(!this.isEditableLayer){var N=d(".editable",this._fieldsTable.domNode);N.forEach(function(L){L=B.getEnclosingWidget(L.childNodes[0]);L.setValue(!1);L.setStatus(!1)})}this.honorWebMapSettings&&(N=d(".editable",this._fieldsTable.domNode),N.forEach(function(L){B.getEnclosingWidget(L.childNodes[0]).setStatus(!1)}),N=d(".visible",this._fieldsTable.domNode),N.forEach(function(L){B.getEnclosingWidget(L.childNodes[0]).setStatus(!1)}))}),
300)},_addNewAction:function(c,m){var A=a.create("div",{"class":"esriCTCopyAction",title:this.nls.fieldsPage.copyActionTip});e(A,"click",x.hitch(this,this._onCopyAttrButtonClick,m));a.place(A,c,"last")},_onDisplayFieldChanged:function(c){var m=this._fieldsTable.getRowData(c);!m.visible&&m.isEditable&&(m.isEditable=!1,this._fieldsTable.editRow(c,m))},_onIsEditableFieldChanged:function(c){var m=this._fieldsTable.getRowData(c);m.isEditable&&!m.visible&&(m.visible=!0,this._fieldsTable.editRow(c,m))},
_resetFieldInfos:function(){var c=[],m=this._fieldsTable.getData();K.forEach(m,x.hitch(this,function(A){var D={isEditable:null===A.isEditable?this.isEditableLayer?!0:!1:A.isEditable,visible:null===A.visible?!0:A.visible};A=this._getFieldInfoByFieldName(this._configInfo.fieldInfos,A.fieldName);x.mixin(A,D);c.push(A)}));this._configInfo.fieldInfos=c},_getFieldInfoByFieldName:function(c,m){var A;K.some(c,function(D){if(D.name===m)return A=D,!0});return A},geocoderConfigured:function(){this._copyAttr.geocoderConfigured()}})})},
"widgets/SmartEditor/setting/FieldValidation":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-construct dojo/query dojo/json dojox/html/entities dojo/text!./FieldValidation.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup ./FilterPage".split(" "),function(F,J,x,K,t,a,e,b,d,h,n,p,u,G){return F([n,h],{baseClass:"jimu-widget-smartEditor-rule-table",templateString:d,_resourceInfo:null,_url:null,_fieldName:null,_fieldValidations:null,
_layerId:null,_fieldsPopUp:null,postCreate:function(){this.inherited(arguments);this._fieldsPopUp=null;this._initActionsTable();this._setActionsTable()},getSettings:function(){return this._fieldValidations},_getConfigActionOrder:function(){var C=[];return void 0!==this._fieldValidations&&null!==this._fieldValidations&&this._fieldValidations.hasOwnProperty(this._fieldName)&&(x.forEach(this._fieldValidations[this._fieldName],function(f){C.push(f.actionName)}),null!==C&&0!==C.length)?C:["Hide","Required",
"Disabled"]},_getConfigAction:function(C){var f=null;void 0!==this._fieldValidations&&null!==this._fieldValidations&&this._fieldValidations.hasOwnProperty(this._fieldName)&&x.some(this._fieldValidations[this._fieldName],function(g){return g.actionName===C?(f=g,!0):!1});return f},_nlsActionToConfig:function(C){switch(C){case this.nls.actionPage.actions.hide:return"Hide";case this.nls.actionPage.actions.disabled:return"Disabled";case this.nls.actionPage.actions.required:return"Required";default:return C}},
popupActionsPage:function(){this._fieldsPopUp&&(this._fieldsPopUp.close(),this._fieldsPopUp=null);this._fieldsPopUp=new u({titleLabel:this.popupTitle,width:920,maxHeight:600,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:J.hitch(this,function(){var C=this._validationTable.getRows();if(void 0===this._fieldValidations||null===this._fieldValidations)this._fieldValidations={};this._fieldValidations[this._fieldName]=[];x.forEach(C,function(f){var g=this._validationTable.getRowData(f);f=
{};f.actionName=this._nlsActionToConfig(g.label);f.submitWhenHidden=g.submitWhenHidden;void 0!==g.expression&&null!==g.expression&&""!==g.expression&&""!==g.filter&&(g=e.parse(b.decode(g.filter)),f.expression=g.expr,f.filter=g);this._fieldValidations[this._fieldName].push(f)},this);this._fieldsPopUp.close()})},{label:this.nls.cancel,classNames:["jimu-btn jimu-btn-vacation"],onClick:J.hitch(this,function(){this._fieldsPopUp.close()})}],onClose:J.hitch(this,function(){})})},_initActionsTable:function(){this._validationTable=
new p({fields:[{name:"label",title:this.nls.actionPage.actionsSettingsTable.rule,type:"text",width:"15%","class":"rule"},{name:"expression",title:this.nls.actionPage.actionsSettingsTable.expression,type:"text",width:"55%","class":"expression"},{name:"groupName",title:this.nls.actionPage.actionsSettingsTable.groupName,type:"text",width:"20%","class":"expression"},{name:"submitWhenHidden",title:"submitWhenHidden",type:"checkbox",hidden:!0},{name:"filter",title:"filter",type:"text",hidden:!0},{name:"actions",
title:this.nls.actionPage.actionsSettingsTable.actions,type:"actions",actions:["up","down","edit"],width:"10%","class":"actions"}],selectable:!1,style:{height:"300px",maxHeight:"300px"}});this._validationTable.onBeforeRowEdit=J.hitch(this,function(C){var f=this._validationTable.getRowData(C);if(f.groupName){var g=t.create("div");t.create("div",{innerHTML:this.nls.actionPage.editOptionsPopup.expression,className:"settingsDesc"},g);t.create("div",{innerHTML:this.nls.actionPage.editOptionsPopup.editGroupHint,
className:"editGroupHint"},g);var w=new u({titleLabel:this.nls.actionPage.editOptionsPopup.popupTitle,width:500,maxHeight:445,autoHeight:!0,content:g,"class":this.baseClass,buttons:[{label:this.nls.actionPage.editOptionsPopup.editGroupButton,onClick:J.hitch(this,function(){this._editGroup(f.groupName);w.close()})},{label:this.nls.actionPage.editOptionsPopup.editIndependentlyButton,onClick:J.hitch(this,function(){this._validationTable._onActionsEdit(C);w.close()})}]})}else this._validationTable._onActionsEdit(C)});
this.own(K(this._validationTable,"row-edit",J.hitch(this,function(C){var f=this._validationTable.getRowData(C);f.groupName&&(f={groupName:f.groupName,layerId:this._layerId,fieldName:this._fieldName,action:this._nlsActionToConfig(f.label)},this.removeFromGroup(f),this._validationTable.editRow(C,{groupName:null}))})));this._validationTable.placeAt(this.validationTable);this._validationTable.startup();a("th.simple-table-field",this._validationTable.domNode).forEach(function(C){switch(void 0===C.innerText||
""===C.innerText?"":C.innerText.replace(/(\r\n|\n|\r)/gm,"")){case this.nls.actionPage.actionsSettingsTable.rule:C.title=this.nls.actionPage.actionsSettingsTable.ruleTip;break;case this.nls.actionPage.actionsSettingsTable.expression:C.title=this.nls.actionPage.actionsSettingsTable.expressionTip;break;case this.nls.actionPage.actionsSettingsTable.actions:C.title=this.nls.actionPage.actionsSettingsTable.actionsTip;break;case this.nls.actionPage.actionsSettingsTable.groupName:C.title=this.nls.actionPage.actionsSettingsTable.groupNameTip}},
this);this.own(K(this._validationTable,"actions-edit",J.hitch(this,this._onEditFieldInfoClick)));this.own(K(this._validationTable,"actions-delete",J.hitch(this,this._onDeleteFieldInfoClick)))},_onDeleteFieldInfoClick:function(C){this._removeFilter(C)},_onEditFieldInfoClick:function(C){this._showFilter(C)},_setActionsTable:function(){var C=this._getConfigActionOrder();x.forEach(C,function(f){var g=this._getConfigAction(f),w=f;switch(f){case "Hide":this.nls.actionPage.hasOwnProperty("actions")&&this.nls.actionPage.actions.hasOwnProperty("hide")&&
(w=this.nls.actionPage.actions.hide);break;case "Required":this.nls.actionPage.hasOwnProperty("actions")&&this.nls.actionPage.actions.hasOwnProperty("required")&&(w=this.nls.actionPage.actions.required);break;case "Disabled":this.nls.actionPage.hasOwnProperty("actions")&&this.nls.actionPage.actions.hasOwnProperty("disabled")&&(w=this.nls.actionPage.actions.disabled);break;default:w=f}f={label:w,expression:null};void 0!==g&&null!==g&&(g.hasOwnProperty("filter")&&void 0!==g.filter&&null!==g.filter&&
(g.filter.smartActionGroupName&&(f.groupName=g.filter.smartActionGroupName),f.filter=e.stringify(g.filter),f.expression=g.filter.expr),g.hasOwnProperty("expression")&&(f.expression=g.expression),g.hasOwnProperty("submitWhenHidden")&&(f.submitWhenHidden=g.submitWhenHidden));this._validationTable.addRow(f)},this)},_removeFilter:function(C){this._validationTable.editRow(C,{expression:"",filter:null,submitWhenHidden:!1})},_showFilter:function(C){this._filterPage&&this._filterPage.destroy();this._filterPage=
new G({nls:this.nls,_resourceInfo:this._resourceInfo,_url:this._url,_layerId:this._layerId,_validationTable:this._validationTable});this._filterPage.popup(C)},_editGroup:function(C){if(this._smartActionsTable){var f=this._smartActionsTable.getRows();x.some(f,function(g){if(this._smartActionsTable.getRowData(g).name===C)return this._fieldsPopUp.close(),this.onGroupEditingStart(),this._smartActionsTable._onActionsEdit(g),!0},this)}},onGroupEditingStart:function(){},removeFromGroup:function(C){}})})},
"widgets/SmartEditor/setting/FilterPage":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/json dojo/text!./FilterPage.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/Filter esri/lang dijit/form/CheckBox dojo/dom-construct".split(" "),function(F,J,x,K,t,a,e,b,d,h,n,p){return F([e,J,a],{baseClass:"jimu-widget-smartEditor-filter-page",templateString:t,_filter:null,_url:null,_layerId:null,_layerDefinition:null,_validationTable:null,postCreate:function(){this.inherited(arguments);
this._init()},_init:function(){this._origNLS=window.jimuNls.filterBuilder.matchMsg;window.jimuNls.filterBuilder.matchMsg=this.nls.filterPage.filterBuilder},destroy:function(){window.jimuNls.filterBuilder.matchMsg=this._origNLS;this._filter&&(this._filter.destroyRecursive(),this._filter=null,delete this._filter);this._submitHidden&&(this._submitHidden.destroyRecursive(),this._submitHidden=null,delete this._submitHidden)},popup:function(u){var G;u&&this._validationTable&&(G=this._validationTable.getRowData(u));
if(G&&G.label===this.nls.actionPage.actions.hide){this.submitWhenHidden.style.display="block";this._submitHidden=new n({id:"submitHidden",checked:void 0===G.submitWhenHidden?!1:G.submitWhenHidden,value:this.nls.filterPage.submitHidden},null);this.submitWhenHidden.appendChild(this._submitHidden.domNode);var C=x.replace("\x3clabel class\x3d'submithide' for\x3d'submitWhenHidden'\x3e{replace}\x3c/label\x3e\x3c/br\x3e\x3c/br\x3e",{replace:this.nls.filterPage.submitHidden});p.place(C,this._submitHidden.domNode,
"after")}else this.submitWhenHidden.style.display="none";this._filter=new d({style:"width:100%;margin-top:22px;",noFilterTip:this.nls.filterPage.noFilterTip});this._filter.placeAt(this.filterControl);var f=new b({titleLabel:h.substitute({action:G?G.label:this._groupName},this.nls.filterPage.title),width:850,height:485,content:this,rowData:G,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var w=this._filter.toJson(),B=!1;this._submitHidden&&this._submitHidden.checked&&(B=this._submitHidden.checked);
w&&w.expr&&("1\x3d1"===w.expr?this._validationTable?this._validationTable.editRow(u,{expression:"",filter:null,submitWhenHidden:B}):(this._filterInfo={expression:"",filter:null,submitWhenHidden:B},this.emit("filterInfo",this._filterInfo)):this._validationTable?this._validationTable.editRow(u,{expression:w.displaySQL,filter:K.stringify(w),submitWhenHidden:B}):(this._filterInfo={expression:w.displaySQL,filter:K.stringify(w),submitWhenHidden:B},this.emit("filterInfo",this._filterInfo)),f.close())})},
{label:this.nls.cancel,classNames:["jimu-btn jimu-btn-vacation"],onClick:function(){f.close()}}]});if(G)var g=G;else this._filterInfo&&(g=this._filterInfo);g&&(void 0===g.filter||null===g.filter||""===g.filter?this._filter.build({url:this._url,partsObj:null,layerDefinition:this._layerDefinition,featureLayerId:this._layerId}):g.filter.parts?this._filter.build({url:this._url,partsObj:g.filter,layerDefinition:this._layerDefinition,featureLayerId:this._layerId}):this._filter.build({url:this._url,partsObj:K.parse(g.filter),
layerDefinition:this._layerDefinition,featureLayerId:this._layerId}))}})})},"widgets/SmartEditor/setting/CopyAttributes":function(){define("dojo/_base/declare dojo/Evented dojo/query dojo/dom-style dijit/registry dojo/_base/lang dojo/_base/array dojo/on dojo/dom-construct dojo/text!./CopyAttributes.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup esri/lang ./Intersection ./Coordinates ./Address".split(" "),function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w){return F([p,
J,n],{baseClass:"jimu-widget-smartEditor-rule-table",templateString:h,_resourceInfo:null,_url:null,_fieldName:null,_fieldValues:null,_configuredFieldValues:null,_layerId:null,_validGeocoderFields:[],_fieldsPopUp:null,_removeGroupInfo:null,_cbxForActionsWithGroupName:[],ValidFieldsForCoordinates:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"],ValidFieldsByType:{esriFieldTypeOID:["esriFieldTypeSmallInteger","esriFieldTypeInteger",
"esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSmallInteger:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeInteger:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSingle:["esriFieldTypeOID","esriFieldTypeSmallInteger",
"esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeGlobalID"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:"esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeGUID esriFieldTypeDate esriFieldTypeOID esriFieldTypeGlobalID".split(" ")},postCreate:function(){this.inherited(arguments);this._fieldsPopUp=null;this._configuredFieldValues=[];this._removeGroupInfo=
null;this._initActionsTable();this._setActionsTable()},getSettings:function(){return this._fieldValues},_getConfigActionOrder:function(){var B=[],c=[];this.isRelatedLayer?c=["Preset"]:(c=["Intersection"],this._validGeocoderFields=this._getValidGeocoderFields(),this._validGeocoderFields.length&&c.push("Address"),-1<this.ValidFieldsForCoordinates.indexOf(this._fieldType)&&c.push("Coordinates"),c.push("Preset"));return void 0!==this._fieldValues&&null!==this._fieldValues&&this._fieldValues.hasOwnProperty(this._fieldName)&&
(e.forEach(this._fieldValues[this._fieldName],function(m){-1<c.indexOf(m.actionName)&&B.push(m.actionName)}),null!==B&&0!==B.length)?B:c},_getValidGeocoderFields:function(){var B=[],c=[];B=this.ValidFieldsByType[this._fieldType];this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")&&(c=e.filter(this._geocoderSettings.fields,function(m){return-1<B.indexOf(m.type)?!0:!1}));return c},_getConfigAction:function(B){var c=null;void 0!==this._fieldValues&&null!==this._fieldValues&&this._fieldValues.hasOwnProperty(this._fieldName)&&
e.some(this._fieldValues[this._fieldName],function(m){return m.actionName===B?(c=m,!0):!1});return c},_nlsActionToConfig:function(B){switch(B){case this.nls.actionPage.copyAction.intersection:return"Intersection";case this.nls.actionPage.copyAction.address:return"Address";case this.nls.actionPage.copyAction.coordinates:return"Coordinates";case this.nls.actionPage.copyAction.preset:return"Preset";default:return B}},popupActionsPage:function(){this._fieldsPopUp&&(this._fieldsPopUp.close(),this._fieldsPopUp=
null);this._fieldsPopUp=new G({titleLabel:C.substitute({fieldname:this._fieldName},this.nls.actionPage.title),width:920,maxHeight:600,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){var B=this._copyAttrTable.getRows();if(void 0===this._fieldValues||null===this._fieldValues)this._fieldValues={};this._fieldValues[this._fieldName]=[];e.forEach(B,function(c){var m=this._copyAttrTable.getRowData(c);c={};c.actionName=this._nlsActionToConfig(m.actionName);this._configuredFieldValues[c.actionName]?
a.mixin(c,this._configuredFieldValues[c.actionName]):a.mixin(c,{enabled:!1});a.mixin(c,{enabled:m.enabled});"Preset"===c.actionName&&this._configuredPresetInfos&&!this._configuredPresetInfos.hasOwnProperty(this._fieldName)&&(this._configuredPresetInfos[this._fieldName]=[""]);!c.enabled&&m.attributeActionGroupName&&(m={groupName:m.attributeActionGroupName,layerId:this._layerId,fieldName:this._fieldName,action:c.actionName},this.removeFromGroup(m),delete c.attributeActionGroupName);this._fieldValues[this._fieldName].push(c)},
this);this._fieldsPopUp.close()})},{label:this.nls.cancel,classNames:["jimu-btn jimu-btn-vacation"],onClick:a.hitch(this,function(){this._fieldsPopUp.close()})}],onClose:a.hitch(this,function(){})})},_initActionsTable:function(){this._copyAttrTable=new u({fields:[{name:"enabled",title:this.nls.actionPage.copyAction.enableText,type:"checkbox",width:"15%"},{name:"actionName",title:this.nls.actionPage.copyAction.actionText,type:"text"},{name:"attributeActionGroupName",title:this.nls.actionPage.actionsSettingsTable.groupName,
type:"text"},{name:"actions",title:this.nls.actionPage.copyAction.criteriaText,type:"actions",actions:["up","down","edit"],"class":"actions"}],selectable:!1,style:{height:"300px",maxHeight:"300px"}});this._copyAttrTable.placeAt(this.copyAttributeTable);this._copyAttrTable.startup();this.own(b(this._copyAttrTable,"actions-edit",a.hitch(this,this._onActionEdit)))},_onActionEdit:function(B){this._removeGroupInfo=null;var c=this._copyAttrTable.getRowData(B);if(c.attributeActionGroupName){var m=d.create("div");
d.create("div",{innerHTML:this.nls.actionPage.editOptionsPopup.editAttributeGroup,className:"settingsDesc"},m);d.create("div",{innerHTML:this.nls.actionPage.editOptionsPopup.editAttributeGroupHint,className:"editGroupHint"},m);var A=new G({titleLabel:this.nls.actionPage.editOptionsPopup.popupTitle,width:500,maxHeight:445,autoHeight:!0,content:m,"class":this.baseClass,buttons:[{label:this.nls.actionPage.editOptionsPopup.editGroupButton,onClick:a.hitch(this,function(){this._editGroup(c);A.close()})},
{label:this.nls.actionPage.editOptionsPopup.editIndependentlyButton,disable:"Preset"===c.actionName?!0:!1,onClick:a.hitch(this,function(){c.attributeActionGroupName&&(this._removeGroupInfo={groupName:c.attributeActionGroupName,layerId:this._layerId,fieldName:this._fieldName,action:this._nlsActionToConfig(c.actionName)});this._onEditFieldInfoClick(B);A.close()})}]})}else this._onEditFieldInfoClick(B)},_onEditFieldInfoClick:function(B){switch(this._copyAttrTable.getRowData(B).actionName){case this.nls.actionPage.copyAction.intersection:this._createIntersectionPanel(B);
break;case this.nls.actionPage.copyAction.address:this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")?this._createAddressPanel(B):this.emit("SetGeocoder");break;case this.nls.actionPage.copyAction.coordinates:this._createCoordinatesPanel(B)}},_removeFromGroup:function(B){this._removeGroupInfo&&(this.removeFromGroup(this._removeGroupInfo),this._copyAttrTable.editRow(B,{attributeActionGroupName:null}))},_createIntersectionPanel:function(B){this._intersectionDijit=f({nls:this.nls,_fieldValues:this._configuredFieldValues,
layerInfos:this.layerInfos,map:this.map,_fieldType:this._fieldType,isGroup:!1,ValidFieldsByType:this.ValidFieldsByType});this.own(b(this._intersectionDijit,"attributeActionUpdated",a.hitch(this,function(){this._removeFromGroup(B)})))},_createCoordinatesPanel:function(B){this._coordinatesDijit=g({nls:this.nls,isGroup:!1,_fieldType:this._fieldType,_fieldValues:this._configuredFieldValues});this.own(b(this._coordinatesDijit,"attributeActionUpdated",a.hitch(this,function(){this._removeFromGroup(B)})))},
_createAddressPanel:function(B){this._addressDijit=w({nls:this.nls,_fieldValues:this._configuredFieldValues,_geocoderSettings:this._geocoderSettings,_validGeocoderFields:this._validGeocoderFields,isGroup:!1});this.own(b(this._addressDijit,"attributeActionUpdated",a.hitch(this,function(){this._removeFromGroup(B)})))},_setActionsTable:function(){var B=this._getConfigActionOrder();this._cbxForActionsWithGroupName=[];e.forEach(B,function(c){var m=this._getConfigAction(c),A=c;switch(c){case "Intersection":this.nls.actionPage.hasOwnProperty("copyAction")&&
this.nls.actionPage.copyAction.hasOwnProperty("intersection")&&(A=this.nls.actionPage.copyAction.intersection);break;case "Address":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("address")&&(A=this.nls.actionPage.copyAction.address);break;case "Coordinates":this.nls.actionPage.hasOwnProperty("copyAction")&&this.nls.actionPage.copyAction.hasOwnProperty("coordinates")&&(A=this.nls.actionPage.copyAction.coordinates);break;case "Preset":this.nls.actionPage.hasOwnProperty("copyAction")&&
this.nls.actionPage.copyAction.hasOwnProperty("preset")&&(A=this.nls.actionPage.copyAction.preset);break;default:A=c}A={actionName:A};void 0!==m&&null!==m?this._configuredFieldValues[c]=m:(this._configuredFieldValues[c]={enabled:!1},"Intersection"===c&&(this._configuredFieldValues[c].fields=[]),"Coordinates"===c&&(this._configuredFieldValues[c].coordinatesSystem="MapSpatialReference",this._configuredFieldValues[c].field="x"));A.enabled=this._configuredFieldValues[c].enabled;this._configuredFieldValues[c].hasOwnProperty("attributeActionGroupName")&&
(A.attributeActionGroupName=this._configuredFieldValues[c].attributeActionGroupName);A.enabled&&"Preset"===c&&!this._configuredFieldValues[c].hasOwnProperty("attributeActionGroupName")&&(A.enabled=!1);m=this._copyAttrTable.addRow(A);A=x(".jimu-checkbox",m.tr)[0];A=t.byNode(A);"Preset"!==c||this._configuredFieldValues[c].hasOwnProperty("attributeActionGroupName")||(A.set("disabled",!0),(m=x(".jimu-icon-edit",m.tr))&&0<m.length&&K.set(m[0],"display","none"));this._configuredFieldValues[c].hasOwnProperty("attributeActionGroupName")&&
(this._cbxForActionsWithGroupName.push(A),this.own(b(A,"change",a.hitch(this,function(){var D=!0;e.some(this._cbxForActionsWithGroupName,function(N){N.getValue()||(D=!1,K.set(this.warningNote,"display","block"))},this);D&&K.set(this.warningNote,"display","none")}))))},this)},geocoderConfigured:function(){this._geocoderSettings&&this._geocoderSettings.hasOwnProperty("url")&&this._createAddressPanel()},_editGroup:function(B){var c=B.attributeActionGroupName;var m=this._nlsActionToConfig(B.actionName);
this._copyAttrTable&&(B=this._attributeActionsTable[m].getRows(),e.some(B,function(A){if(this._attributeActionsTable[m].getRowData(A).name===c)return this._fieldsPopUp.close(),this.onGroupEditingStart(this.nls.layersPage.attributeActionsTabTitle),this._attributeActionsTable[m]._onActionsEdit(A),!0},this))},onGroupEditingStart:function(B){this.emit("onGroupEditingStart",B)},removeFromGroup:function(B){this.emit("removeFromGroup",B)}})})},"widgets/SmartEditor/setting/Intersection":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dijit/form/Select dojo/_base/array dojo/dom-attr dojo/dom-construct dojo/on dojo/query dojo/promise/all dojo/Deferred dojo/text!./Intersection.html dijit/_TemplatedMixin jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Message jimu/dijit/Popup jimu/dijit/CheckBox dijit/popup dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/DropDownButton dojo/dom-class ./layersAndFieldsApplyOn".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R,q){return F([f,J,u],{baseClass:"jimu-widget-smartEditor-setting-intersection",templateString:p,popup:null,totalLayers:[],_layersForApplyOn:[],isGroup:!1,ValidFieldsByType:{esriFieldTypeOID:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSmallInteger:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeInteger:["esriFieldTypeOID",
"esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSingle:["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeGlobalID"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:"esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeGUID esriFieldTypeDate esriFieldTypeOID esriFieldTypeGlobalID".split(" ")},
ValidFieldsByTypeToApplyOn:{esriFieldTypeInteger:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString"]},postCreate:function(){this.inherited(arguments);this.totalLayers=[];this._layersForApplyOn=[];this._createToleranceSettingsDialogContent();this._createDialogContent();this.isDelete||this.showDialog();this._initLayerSelector();this._createLayersAndFields();
this.own(b(this.addLayer,"click",x.hitch(this,function(){if(0<this.totalLayers.length){var k=this._layerTable.addRow({}).tr;this._addLayersDropDown(k);this._addFieldsDropDown(k);this._addToleranceSettings(k)}else new w({message:this.nls.intersectionPage.noLayersMessage})})))},_createDialogContent:function(){this.isEnabled=!1;this._fieldValues&&this._fieldValues.Intersection&&this._fieldValues.Intersection.hasOwnProperty("enabled")&&(this.isEnabled=this._fieldValues.Intersection.enabled);this._initControls();
this._initTable()},_initControls:function(){this.groupNameTextBox=new D({style:{width:"100%"},required:!0,trim:!0},e.create("div",{},this.groupNameTextBoxNode));this.groupNameTextBox.validator=x.hitch(this,function(k){return k?k!==this.prevName&&this.editUtils.isDuplicateGroupName(k,this.existingGroupNames)?(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});
this.name&&this.groupNameTextBox.set("value",this.name);this.dataTypeDropdown=new K({options:this._addDataTypeOptions(),style:{width:"100%"}});this.dataTypeDropdown.placeAt(this.dataTypeDropDownNode);this.dataTypeDropdown.startup();this.own(b(this.dataTypeDropdown,"change",x.hitch(this,function(k){this.isGroup&&(this._fieldType=k,this.totalLayers=[],this._layersForApplyOn=[],k=this._layerTable.getRows(),t.forEach(k,x.hitch(this,function(E){this._layerTable.deleteRow(E)})),this._initLayerSelector(),
this._createLayersAndFields())})));this._fieldType&&this.dataTypeDropdown.set("value",this._fieldType,!1);this.ignoreLayerRanking=new c({label:this.nls.intersectionPage.ignoreLayerRankingCheckboxLabel},e.create("div",{},this.ignoreLayerRankingNode))},_addDataTypeOptions:function(){return[{label:this.nls.dataType.esriFieldTypeString,value:"esriFieldTypeString"},{label:this.nls.dataType.esriFieldTypeInteger,value:"esriFieldTypeInteger"},{label:this.nls.dataType.esriFieldTypeDate,value:"esriFieldTypeDate"},
{label:this.nls.dataType.esriFieldTypeGUID,value:"esriFieldTypeGUID"}]},_initTable:function(){this._layerTable=new g({fields:[{name:"layerName",title:this.nls.intersectionPage.layerText,type:"empty",width:"30%"},{name:"fieldName",title:this.nls.intersectionPage.fieldText,type:"empty",width:"30%"},{name:"toleranceSettings",title:this.nls.intersectionPage.toleranceSettingText,type:"empty",width:"25%"},{name:"actions",title:this.nls.intersectionPage.actionsText,type:"actions",width:"15%",actions:["up",
"down","delete"],"class":"actions"}],selectable:!1});this._layerTable.placeAt(this.layerTableNode);this._layerTable.startup();this.own(b(this._layerTable,"actions-edit",x.hitch(this,this._onEditFieldInfoClick)));this.own(b(this._layerTable,"actions-delete",x.hitch(this,this._onDeleteFieldInfoClick)));this._populateTableData()},_populateTableData:function(){this._fieldValues.Intersection.ignoreLayerRanking&&this.ignoreLayerRanking.setValue(!0);t.forEach(this._fieldValues.Intersection.fields,x.hitch(this,
function(k){if(k.layerId&&this.layerInfos.getLayerInfoById(k.layerId)){var E=this._layerTable.addRow({}).tr;this._addLayersDropDown(E,k);this._addFieldsDropDown(E,k);this._addToleranceSettings(E,k)}}))},_createToleranceSettingsDialogContent:function(){var k=e.create("div",{"class":"esriCTpopupFieldContent"});this._useDefaultToleranceCheckbox=new c({label:this.nls.intersectionPage.useDefaultToleranceText},e.create("div",{"class":"esriCTPopupLabels"},k));e.create("div",{"class":"esriCTPopupLabels esriCTMargin",
innerHTML:this.nls.intersectionPage.toleranceValueText},k);this._toleranceValueTextbox=new N({style:{width:"100%"},constraints:{min:0},required:!0},e.create("div",{"class":"esriCTPopupLabels"},k));e.create("div",{"class":"esriCTPopupLabels esriCTMargin",innerHTML:this.nls.intersectionPage.toleranceUnitText},k);var E=[{label:this.nls.units.miles,value:"miles"},{label:this.nls.units.kilometers,value:"kilometers"},{label:this.nls.units.meters,value:"meters"},{label:this.nls.units.feet,value:"feet"}];
var O=e.create("div",{},k);this._toleranceUnitDropdown=new K({style:{width:"200px"},options:E});this._toleranceUnitDropdown.placeAt(O);this._toleranceUnitDropdown.startup();this.toleranceSettingIconDialog=new A({"class":this.baseClass,content:k});this.own(b(this.toleranceSettingIconDialog,"close",x.hitch(this,function(){var l;var y=this._useDefaultToleranceCheckbox.getValue();var M=this._toleranceValueTextbox.get("value");var S=this._toleranceUnitDropdown.getValue();y?l=this._useDefaultToleranceCheckbox.label:
this._toleranceValueTextbox.isValid()&&(l="px"===S?M+" "+this.nls.intersectionPage.pixelsUnitText:M+" "+this.nls.units[S]);if(y||this._toleranceValueTextbox.isValid())this._toleranceValueTextbox.isValid()?this._selectedRowForToleranceSettings.toleranceSettings.value=M:this._selectedRowForToleranceSettings.toleranceSettings.value=0,this._selectedRowForToleranceSettings.toleranceSettings.unit=S,this._selectedRowForToleranceSettings.toleranceSettings.useDefault=y,a.set(this._selectedRowForToleranceSettings.toleranceTextContainer,
"innerHTML",l),a.set(this._selectedRowForToleranceSettings.toleranceTextContainer,"title",l)})))},_addToleranceSettings:function(k,E){k.toleranceSettings=E&&E.toleranceSettings?E.toleranceSettings:{useDefault:!1,value:0,unit:"meters"};E=k.toleranceSettings.useDefault?this._useDefaultToleranceCheckbox.label:"px"===k.toleranceSettings.unit?k.toleranceSettings.value+" "+this.nls.intersectionPage.pixelsUnitText:k.toleranceSettings.value+" "+this.nls.units[k.toleranceSettings.unit];var O=d(".simple-table-cell",
k)[2];O=e.create("div",{"class":"esriCTToleranceParentDiv"},O);k.toleranceTextContainer=e.create("div",{"class":"esriCTToleranceValueText esriCTEllipsis",innerHTML:E,title:E},O);E=new L({iconClass:"esriCTToleranceSettingsIcon",dropDown:this.toleranceSettingIconDialog,title:this.nls.intersectionPage.toleranceSettingText},e.create("div",{},O));this.own(b(E,"click",x.hitch(this,function(){this._selectedRowForToleranceSettings=k;this._updateUnitsOption();this._toleranceValueTextbox.set("value",k.toleranceSettings.value);
this._useDefaultToleranceCheckbox.setValue(k.toleranceSettings.useDefault);this._toleranceUnitDropdown.set("value",k.toleranceSettings.unit)})))},_updateUnitsOption:function(){var k=!1;"esriGeometryPoint"===this._selectedRowForToleranceSettings.layerSelector.getSelectedItem().layerInfo.layerObject.geometryType?(t.some(this._toleranceUnitDropdown.options,x.hitch(this,function(E){if("px"===E.value)return k=!0})),k||this._toleranceUnitDropdown.addOption({label:this.nls.intersectionPage.pixelsUnitText,
value:"px"})):this._toleranceUnitDropdown.removeOption("px")},_addLayersDropDown:function(k,E){k.layerSelector&&k.layerSelector.destroy();var O=this._createLayerChooserMapArgs();var l=new G(O);l.startup();O=d(".simple-table-cell",k)[0];l=new C({layerChooser:l});l.placeAt(O);l.startup();k.layerSelector=l;l.setSelectedLayer(this.totalLayers[0]);E&&l.setSelectedLayer(this.layerInfos.getLayerInfoById(E.layerId).layerObject);this.own(b(l,"selection-change",x.hitch(this,function(){k.layerFields.set("options",
this._addLayerFieldOptions(k));k.layerFields.set("value",k.layerFields.options[0],!1);var y=d(".esriCTToleranceValueText",k)[0];var M=this.nls.units.meters;k.toleranceSettings={value:0,unit:"meters"};a.set(y,"innerHTML","0 "+M)})))},_createLayerChooserMapArgs:function(){return{multiple:!1,createMapResponse:this.map.webMapResponse,filter:this._createFiltersForLayerSelector()}},_createIntersectionLayerFilter:function(k){return function(E){var O=new n;E.isTable?O.resolve(!1):E.getRootLayerInfo().getLayerObject().then(x.hitch(this,
function(l){var y=[];E.traversal(x.hitch(this,function(M){M.isLeaf()&&M.layerObject&&!M.layerObject.hasOwnProperty("empty")&&y.push(M.getLayerObject())}));h(y).then(x.hitch(this,function(M){M=M.some(x.hitch(this,function(S){if(S&&S.fields)return S.fields.some(function(Q){return-1<k.indexOf(Q.type)});O.resolve(!1)}));O.resolve(M)}))}),x.hitch(this,function(l){console.error(l);O.resolve(!1)}));return O}},_createFiltersForLayerSelector:function(){var k=G.createFeaturelayerFilter(["point","polyline",
"polygon"],!1,!1);var E=G.createImageServiceLayerFilter(!0);k=G.orCombineFilters([k,E]);E=this._createIntersectionLayerFilter(this.ValidFieldsByType[this._fieldType]);return G.andCombineFilters([k,E])},_initLayerSelector:function(){var k=[];var E=this._createLayerChooserMapArgs();this._layerChooserFromMap=new G(E);this._layerChooserFromMap.startup();E=this._layerChooserFromMap.layerInfosObj.getLayerInfoArray();this._getAllFilteredLayers(E,k);return k},_getAllFilteredLayers:function(k,E){t.forEach(k,
x.hitch(this,function(O){if(O.isLeaf()){var l=new n;this._layerChooserFromMap.filter(O).then(x.hitch(this,function(y){y&&(this.totalLayers.push(O),this._isLayerEditable(O)&&this._layersForApplyOn.push(O));l.resolve()}));E.push(l)}else this._getAllFilteredLayers(O.newSubLayers,E)}))},_isLayerEditable:function(k){var E=!1;k&&k.layerObject&&k.layerObject.getEditCapabilities&&(k=k.layerObject.getEditCapabilities(),k.canCreate||k.canUpdate||k.canDelete||k.canUpdateGeometry)&&(E=!0);return E},_addFieldsDropDown:function(k,
E){var O;if(O=d(".simple-table-cell",k)[1])O=e.create("div",{"class":"esriCTDropDownContainer"},O),k.layerFields=new K({options:this._addLayerFieldOptions(k),"class":"esriCTSettingsFieldDropdown"}),k.layerFields.placeAt(O),k.layerFields.startup(),E&&k.layerFields.set("value",E.field,!1)},_addLayerNameOptions:function(){var k=[];var E=this.layerInfos.getLayerInfoArray();t.forEach(E,x.hitch(this,function(O){-1<O.layerObject.capabilities.indexOf("Query")&&k.push({label:O.layerObject.name,value:O.layerObject.id})}));
return k},_addLayerFieldOptions:function(k){var E=[],O=[];if(!k.layerSelector.getSelectedItem())return E;"esriFieldTypeString"===this._fieldType&&E.push({label:this.nls.intersectionPage.useLayerName,value:"esriCTUseLayerName"});O=this.ValidFieldsByType[this._fieldType];k=k.layerSelector.getSelectedItem().layerInfo.layerObject;t.forEach(k.fields,x.hitch(this,function(l){"esriFieldTypeGeometry"!==l.type&&"esriFieldTypeBlob"!==l.type&&"esriFieldTypeRaster"!==l.type&&"esriFieldTypeXML"!==l.type&&-1<O.indexOf(l.type)&&
E.push({label:l.alias||l.name,value:l.name})}));return E},showDialog:function(){var k=600,E=!1;this.isGroup||(R.add(this.groupInfoNode1,"esriCTHidden"),R.add(this.groupInfoNode2,"esriCTHidden"),R.add(this.layerTableNode,"esriCTIntersectionTableMaxHeight"),E=!0,k=400);var O=new B({titleLabel:this.nls.actionPage.copyAction.intersection,width:950,maxHeight:k,autoHeight:E,content:this,"class":this.baseClass,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var l={},y={};l.enabled=this.isEnabled;
l.ignoreLayerRanking=this.ignoreLayerRanking.checked;l.fields=this._getTableData();if(this.isGroup){if(!this.groupNameTextBox.isValid()){this.groupNameTextBox.focus();return}}else delete this._fieldValues.Intersection.attributeActionGroupName;this._fieldValues.Intersection||(this._fieldValues.Intersection={actionName:"Intersection"});x.mixin(this._fieldValues.Intersection,l);this.isGroup?(y.name=this.groupNameTextBox.get("value"),y.dataType=this.dataTypeDropdown.get("value"),y.attributeInfo=l,y.appliedOn=
this._layerAndFieldsApplyOnObj.getCheckedFields(y),this.emit("groupInfoUpdated",y)):this.emit("attributeActionUpdated");O.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){O.close()})}],onClose:x.hitch(this,function(){})});this.isGroup&&this.groupNameTextBox.focus()},_getTableData:function(){var k=[],E;t.forEach(this._layerTable.getRows(),x.hitch(this,function(O){O.layerSelector&&(E={},E.layerId=O.layerSelector.getSelectedItem().layerInfo.id,E.field=
O.layerFields.getValue(),E.toleranceSettings=x.clone(O.toleranceSettings),k.push(E))}));return k},_createLayerFieldsFilter:function(k){var E=[],O={};t.forEach(this._layersForApplyOn,x.hitch(this,function(l){l.isTable||t.forEach(l.layerObject.fields,x.hitch(this,function(y){this.ValidFieldsByTypeToApplyOn[k]&&(E=this.ValidFieldsByTypeToApplyOn[k],-1<E.indexOf(y.type)&&y.editable&&(O[l.id]||(O[l.id]={}),O[l.id][y.name]=y))}))}));return O},_createLayersAndFields:function(){this._layerAndFieldsApplyOnObj=
new q({map:this.map,layerInfos:this.layerInfos,_configInfos:this._configInfos,actionName:"Intersection",nls:this.nls,prevName:this.prevName,existingGroups:this.existingGroups,layerDetails:this._createLayerFieldsFilter(this.dataTypeDropdown.get("value")),appliedOn:this.appliedOn});e.empty(this.tableParentContainer);this._layerAndFieldsApplyOnObj.placeAt(this.tableParentContainer);this._layerAndFieldsApplyOnObj.startup()},deleteGroup:function(){this._layerAndFieldsApplyOnObj.deleteGroup()}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w){var B=x([K,t,a,J],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new w({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=p.hitch(this,this.basicFilter);
this.filter=B.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(c){var m=new b;this.onlyShowVisible?m.resolve(c.isShowInMap()):m.resolve(!0);return m},filter:function(c){c=new b;c.resolve(!0);return c},getSelectedItems:function(){var c=this.tree.getSelectedItems();return G.map(c,p.hitch(this,function(m){return this.getHandledItem(m)}))},getAllItems:function(){var c=this.tree.getAllItems(),m=[];G.forEach(c,
p.hitch(this,function(A){"root"!==A.id&&(A=this.getHandledItem(A),m.push(A))}));return m},getHandledItem:function(c){return{name:c.name,layerInfo:c.layerInfo}},_isLeafItem:function(c){return c.isLeaf},setCreateMapResponse:function(c){this.createMapResponse=c;g.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(p.hitch(this,function(m){this.layerInfosObj=m;this.own(F(this.layerInfosObj,"layerInfosChanged",p.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(F(this.layerInfosObj,"layerInfosIsShowInMapChanged",p.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(c,m){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(c){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(c){this._clear();u.setStyle(this.errorTipSection,"display","block");var m=[];this.onlyShowWebMapLayers?(m=c.getLayerInfoArrayOfWebmap(),
m=m.concat(c.getTableInfoArrayOfWebmap())):(m=c.getLayerInfoArray(),m=m.concat(c.getTableInfoArray()));0!==m.length&&(u.setStyle(this.errorTipSection,"display","none"),G.forEach(m,p.hitch(this,function(A){this._addDirectLayerInfo(A)})))},_addDirectLayerInfo:function(c){c&&c.getLayerObject().then(p.hitch(this,function(){this._addItem("root",c)}),p.hitch(this,function(m){console.error(m)}))},_clear:function(){var c=this._store.query({parent:"root"});G.forEach(c,p.hitch(this,function(m){m&&"root"!==
m.id&&this._store.remove(m.id)}))},_addItem:function(c,m){var A=null,D=m.getLayerType(),N=this.filter(m);n({layerType:D,valid:N}).then(p.hitch(this,function(L){if(L.valid){var R=p.hitch(this,function(O,l){this._id++;A={name:m.title||"",parent:c,layerInfo:m,type:L.layerType,layerClass:m.layerObject.declaredClass,id:this._id.toString(),isLeaf:O,hasChildren:l};this._store.add(A)}),q=m.getSubLayers(),k=0===q.length,E=!0;this.onlyFilterCurrentLayerWhenAddItem?(k&&(E=!1),R(k,E)):k?R(k,!1):(q=G.map(q,p.hitch(this,
function(O){return this.filter(O)})),n(q).then(p.hitch(this,function(O){(O=G.some(O,function(l){return l}))&&R(k,O)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var c=this._getRootItem();c=new e({data:[c],getChildren:function(m){return this.query({parent:m.id})}});this._store=new d(c);c=new h({store:this._store,query:{id:"root"},mayHaveChildren:p.hitch(this,this._mayHaveChildren)});this.tree=new f({multiple:this.multiple,
model:c,showRoot:!1,isLeafItem:p.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:p.hitch(this,function(m,A){"root"!==m.id&&this._onTreeOpen(m,A)}),onClick:p.hitch(this,function(m,A,D){this._onTreeClick(m,A,D);this.emit("tree-click",m,A,D)}),getIconStyle:p.hitch(this,function(m,A){var D=null;if(!m||"root"===m.id)return null;var N={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},L=window.location.protocol+"//"+window.location.host+
require.toUrl("jimu");if(m=this._getIconInfo(m,A).imageName)N.backgroundImage="url("+L+"/css/images/"+m+")",D=N;return D}),getIconClass:p.hitch(this,function(m,A){return this._getIconInfo(m,A).className}),getTooltip:p.hitch(this,function(m){return this.displayTooltipForTreeNode?m.layerInfo.title:""})});u.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(c){return c.hasChildren},_getIconInfo:function(c,m){var A="",D="";"ArcGISDynamicMapServiceLayer"===
c.type||"ArcGISTiledMapServiceLayer"===c.type?m?(A="mapserver_open.png",D="mapservice-layer-icon open"):(A="mapserver_close.png",D="mapservice-layer-icon close"):"GroupLayer"===c.type?m?(A="group_layer2.png",D="group-layer-icon open"):(A="group_layer1.png",D="group-layer-icon close"):"FeatureLayer"===c.type?(c=C.getTypeByGeometryType(c.layerInfo.layerObject.geometryType),"point"===c?(A="point_layer1.png",D="point-layer-icon"):"polyline"===c?(A="line_layer1.png",D="line-layer-icon"):"polygon"===c&&
(A="polygon_layer1.png",D="polygon-layer-icon")):"Table"===c.type?(A="table.png",D="table-icon"):"ArcGISImageServiceLayer"===c.type||"ArcGISImageServiceVectorLayer"===c.type?(A="image_layer.png",D="iamge-layer-icon"):m?(A="mapserver_open.png",D="mapservice-layer-icon open"):(A="mapserver_close.png",D="mapservice-layer-icon close");return{imageName:A,className:D}},_onTreeOpen:function(c,m){if("root"!==c.id){var A=[];m=[];A=c.layerInfo.getSubLayers();c.checked||(this.shelter.show(),m=G.map(A,p.hitch(this,
function(D){return D.getLayerObject()})),n(m).then(p.hitch(this,function(){this.domNode&&(G.forEach(A,p.hitch(this,function(D){this._addItem(c.id,D)})),c.checked=!0,this.shelter.hide())}),p.hitch(this,function(D){console.error(D);this.shelter.hide()})))}},_onTreeClick:function(c,m,A){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});B.createFilterByLayerType=function(c){p.isArrayLike(c)||(c=[]);return function(m){var A=
new b;if(0===c.length)A.resolve(!0);else{var D=[];m.traversal(function(N){D.push(N.getLayerType())});n(D).then(function(N){for(var L=0;L<N.length;L++)for(var R=0;R<c.length;R++)if(N[L]===c[R]){A.resolve(!0);return}A.resolve(!1)},function(N){console.error(N);A.reject(N)})}return A}};B.createFeaturelayerFilter=function(c,m,A,D){var N=["point","polyline","polygon"];c&&0<c.length?(c=G.filter(c,function(L){return 0<=N.indexOf(L)}),0===c.length&&(c=N)):c=N;return function(L){var R=L.getLayerType();L=L.getLayerObject();
return n({layerType:R,layerObject:L}).then(function(q){var k=q.layerType;q=q.layerObject;if("ArcGISDynamicMapServiceLayer"===k||"ArcGISTiledMapServiceLayer"===k||"GroupLayer"===k||"FeatureCollection"===k)return!0;if("FeatureLayer"===k){k=C.getTypeByGeometryType(q.geometryType);k=0<=G.indexOf(c,k);var E=B._shouldPassStatisticsCheck(D,q);return q.url?(q=C.isFeaturelayerUrlSupportQuery(q.url,q.capabilities),k&&q&&E):m&&k}return"Table"===k?(k=C.isFeaturelayerUrlSupportQuery(q.url,q.capabilities),q=B._shouldPassStatisticsCheck(D,
q),A&&k&&q):!1})}};B.createImageServiceLayerFilter=function(c,m){return function(A){var D=A.getLayerType();A=A.getLayerObject();return n({layerType:D,layerObject:A}).then(function(N){var L=N.layerType,R=N.layerObject;return"ArcGISImageServiceLayer"===L||"ArcGISImageServiceVectorLayer"===L?c?C.isImageServiceSupportQuery(N.layerObject.capabilities)?m?B._shouldPassStatisticsCheck(m,R):!0:!1:!0:!1})}};B._shouldPassStatisticsCheck=function(c,m){return c?(c=!1,c=m.advancedQueryCapabilities?!!m.advancedQueryCapabilities.supportsStatistics:
!!m.supportsStatistics):!0};B.createQueryableLayerFilter=function(c){var m=B.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,c);c=B.createImageServiceLayerFilter(!0,c);return B.orCombineFilters([m,c])};B.andCombineFilters=function(c){return B._combineFilters(c,!0)};B.orCombineFilters=function(c){return B._combineFilters(c,!1)};B._combineFilters=function(c,m){return function(A){var D=new b,N=G.map(c,function(L){return L(A)});n(N).then(function(L){var R=!1;R=m?G.every(L,function(q){return q}):
G.some(L,function(q){return q});D.resolve(R)},function(L){console.error(L);D.reject(L)});return D}};return B})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(F,J,x,K,t,a,e){return x("dijit.tree.ObjectStoreModel",e,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(b){t.mixin(this,b);this.childrenCache={}},getRoot:function(b,d){if(this.root)b(this.root);
else{var h=this.store.query(this.query);h.then&&this.own(h);a(h,t.hitch(this,function(n){if(1!=n.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+n.length+" items, but must return exactly one");this.root=n[0];b(this.root);h.observe&&h.observe(t.hitch(this,function(p){this.onChange(p)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(b,d,h){var n=this.store.getIdentity(b);if(this.childrenCache[n])a(this.childrenCache[n],d,h);else{var p=this.childrenCache[n]=
this.store.getChildren(b);p.then&&this.own(p);p.observe&&this.own(p.observe(t.hitch(this,function(u,G,C){this.onChange(u);G!=C&&a(p,t.hitch(this,"onChildrenChange",b))}),!0));a(p,d,h)}},isItem:function(){return!0},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return b[this.labelAttr]},newItem:function(b,d,h,n){return this.store.put(b,{parent:d,before:n})},pasteItem:function(b,d,h,n,p,u){var G=new K;if(d===h&&!n&&!u)return G.resolve(!0),G;d&&!n?this.getChildren(d,t.hitch(this,
function(C){C=[].concat(C);var f=F.indexOf(C,b);C.splice(f,1);this.onChildrenChange(d,C);G.resolve(this.store.put(b,{overwrite:!0,parent:h,oldParent:d,before:u,isCopy:!1}))})):G.resolve(this.store.put(b,{overwrite:!0,parent:h,oldParent:d,before:u,isCopy:!0}));return G},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f){var g=F([C._TreeNode,u],{templateString:K,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=a.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=a.toDom('\x3cinput type\x3d"checkbox" /\x3e');a.addClass(this.checkNode,"jimu-tree-check-node");a.place(this.checkNode,this.contentNode,
"first");this.own(n(this.checkNode,"click",t.hitch(this,this._onClick)));this.own(n(this.rowNode,"keydown",t.hitch(this,function(w,B){B.target=w;B.keyCode!==p.ENTER&&B.keyCode!==p.SPACE||this._onClick(B)},this.checkNode)));this.isLeaf?this.groupId?a.setStyle(this.checkNode,"display","none"):a.setStyle(this.checkNode,"display","inline"):a.setStyle(this.checkNode,"display","none");this.isLeaf?a.addClass(this.domNode,"jimu-tree-leaf-node"):a.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,a.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,a.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(w){(w.target||w.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,w):this.tree._onClick(this,w)},_onChange:function(){this.isLeaf&&setTimeout(t.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return F([C,u],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+f.getRandomString()},postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree");this.own(h.before(this,"onClick",t.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&a.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;a.setAttr(this.domNode,"tabindex",0)},removeItem:function(w){this.model.store.remove(w)},getAllItems:function(){var w=this.getAllTreeNodeWidgets();return e.map(w,t.hitch(this,function(B){var c=B.item;c.selected=B.checkNode.checked;return c}))},getSelectedItems:function(){var w=this.getAllTreeNodeWidgets();w=e.filter(w,t.hitch(this,function(B){return B.checkNode.checked}));return e.map(w,
t.hitch(this,function(B){return B.item}))},getFilteredItems:function(w){var B=this.getAllTreeNodeWidgets();B=e.map(B,t.hitch(this,function(c){var m=c.item;m.selected=c.checkNode.checked;return m}));return e.filter(B,t.hitch(this,function(c){return w(c)}))},getTreeNodeByItemId:function(w){for(var B=this._getAllTreeNodeDoms(),c=0;c<B.length;c++){var m=G.byNode(B[c]);if(m.item.id.toString()===w.toString())return m}return null},selectItem:function(w){(w=this.getTreeNodeByItemId(w))&&w.isLeaf&&this.selectNodeWidget(w)},
unselectItem:function(w){(w=this.getTreeNodeByItemId(w))&&w.isLeaf&&w.unselect()},getAllLeafTreeNodeWidgets:function(){var w=this.getAllTreeNodeWidgets();return e.filter(w,t.hitch(this,function(B){return B.isLeaf}))},getAllTreeNodeWidgets:function(){var w=this._getAllTreeNodeDoms();return e.map(w,t.hitch(this,function(B){return G.byNode(B)}))},isLeafItem:function(w){return w&&w.isLeaf},_getAllTreeNodeDoms:function(){return d(".dijitTreeNode",this.domNode)},_createTreeNode:function(w){w.isLeaf=this.isLeafItem(w.item);
this.multiple||(w.groupId=this.uniqueId);return new g(w)},_onTreeNodeSelect:function(w){this.emit("item-select",{item:w.item,treeNode:w})},_onTreeNodeUnselect:function(w){this.emit("item-unselect",{item:w.item,treeNode:w})},selectNodeWidget:function(w){this.multiple||this.unselectAllLeafNodeWidgets();w.select()},_jimuBeforeClick:function(w,B,c){B.isLeaf&&(a.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?B.toggleSelect():this.selectNodeWidget(B)));return arguments},_onCheckNodeClick:function(w,
B,c){!this.multiple&&B&&this.unselectAllLeafNodeWidgets();b.stop(c);this.focusNode(w);setTimeout(t.hitch(this,function(){B?this.selectNodeWidget(w):w.unselect();this.onClick(w.item,w,c)}),0)},unselectAllLeafNodeWidgets:function(){var w=this.getAllLeafTreeNodeWidgets();e.forEach(w,t.hitch(this,function(B){B.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R,q,k,E,O,l,y,M,S,Q){function V(I){return f.delegate(I.promise||I,{addCallback:function(P){this.then(P)},addErrback:function(P){this.otherwise(P)}})}var W=K("dijit._TreeNode",[L,R,q,k,E],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(I){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=I;this._set("label",I);u("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:l,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(I){var P=Math.max(I,0)*this.tree._nodePixelIndent+"px";h.set(this.domNode,
"backgroundPosition",P+" 0px");h.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",P);F.forEach(this.getChildren(),function(X){X.set("indent",I+1)});this._set("indent",I)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(I){var P=this.tree,X=P.model;P._v10Compat&&I===X.root&&(I=null);this._applyClassAndStyle(I,"icon","Icon");this._applyClassAndStyle(I,"label","Label");this._applyClassAndStyle(I,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(I,P,X){var z="_"+P+"Class";P+="Node";var r=this[z];this[z]=this.tree["get"+X+"Class"](I,this.isExpanded);b.replace(this[P],this[z]||"",r||"");h.set(this[P],this.tree["get"+X+"Style"](I,this.isExpanded)||{})},_updateLayout:function(){var I=this.getParent();I=!I||!I.rowNode||"none"==I.rowNode.style.display;b.toggle(this.domNode,"dijitTreeIsRoot",I);b.toggle(this.domNode,"dijitTreeIsLast",!I&&!this.getNextSibling())},_setExpando:function(I){var P=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];I=I?0:this.isExpandable?this.isExpanded?1:2:3;b.replace(this.expandoNode,P[I],P);this.expandoNodeText.innerHTML=["*","-","+","*"][I]},expand:function(){if(this._expandDeferred)return V(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");b.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var I=p.wipeIn({node:this.containerNode,duration:N.defaultDuration}),P=this._expandDeferred=new t(function(){I.stop()});J.after(I,"onEnd",function(){P.resolve(!0)},!0);I.play();return V(P)},collapse:function(){if(this._collapseDeferred)return V(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");b.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var I=p.wipeOut({node:this.containerNode,duration:N.defaultDuration}),P=this._collapseDeferred=new t(function(){I.stop()});J.after(I,"onEnd",
function(){P.resolve(!0)},!0);I.play();return V(P)},indent:0,setChildItems:function(I){var P=this.tree,X=P.model,z=[],r=P.focusedChild,v=this.getChildren();F.forEach(v,function(H){q.prototype.removeChild.call(this,H)},this);this.defer(function(){F.forEach(v,function(H){if(!H._destroyed&&!H.getParent()){P.dndController.removeTreeNode(H);(function fa(aa){var ca=X.getIdentity(aa.item),ea=P._itemNodesMap[ca];1==ea.length?delete P._itemNodesMap[ca]:(ca=F.indexOf(ea,aa),-1!=ca&&ea.splice(ca,1));F.forEach(aa.getChildren(),
fa)})(H);if(P.persist){var T=F.map(H.getTreePath(),function(aa){return P.model.getIdentity(aa)}).join("/"),U;for(U in P._openedNodes)U.substr(0,T.length)==T&&delete P._openedNodes[U];P._saveExpandedNodes()}P.lastFocusedChild&&!e.isDescendant(P.lastFocusedChild.domNode,P.domNode)&&delete P.lastFocusedChild;r&&!e.isDescendant(r.domNode,P.domNode)&&P.focus();H.destroyRecursive()}})});this.state="Loaded";I&&0<I.length?(this.isExpandable=!0,F.forEach(I,function(H){var T=X.getIdentity(H),U=P._itemNodesMap[T];
if(U)for(var Z=0;Z<U.length;Z++)if(U[Z]&&!U[Z].getParent()){var aa=U[Z];aa.set("indent",this.indent+1);break}aa||(aa=this.tree._createTreeNode({item:H,tree:P,isExpandable:X.mayHaveChildren(H),label:P.getLabel(H),labelType:P.model&&P.model.labelType||"text",tooltip:P.getTooltip(H),ownerDocument:P.ownerDocument,dir:P.dir,lang:P.lang,textDir:P.textDir,indent:this.indent+1}),U?U.push(aa):P._itemNodesMap[T]=[aa]);this.addChild(aa);(this.tree.autoExpand||this.tree._state(aa))&&z.push(P._expandNode(aa))},
this),F.forEach(this.getChildren(),function(H){H._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);I=a(z);this.tree._startPaint(I);return V(I)},getTreePath:function(){for(var I=this,P=[];I&&I!==this.tree.rootNode;)P.unshift(I.item),I=I.getParent();P.unshift(this.tree.rootNode.item);return P},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(I){this.inherited(arguments);var P=this.getChildren();
0==P.length&&(this.isExpandable=!1,this.collapse());F.forEach(P,function(X){X._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(I){this.labelNode.setAttribute("aria-selected",I?"true":"false");b.toggle(this.rowNode,"dijitTreeRowSelected",I)},focus:function(){A.focus(this.focusNode)}});u("dojo-bidi")&&W.extend({_setTextDirAttr:function(I){!I||this.textDir==I&&this._created||(this._set("textDir",I),this.applyTextDir(this.labelNode),F.forEach(this.getChildren(),
function(P){P.set("textDir",I)},this))}});var Y=K("dijit.Tree",[L,O,R,E],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:y,persist:!1,autoExpand:!1,dndController:Q,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,
checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(I,P){w.publish(this.id,f.mixin({tree:this,event:I},P||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new t;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var I=
this;this.own(g(this.containerNode,g.selector(".dijitTreeNode",B.enter),function(z){I._onNodeMouseEnter(D.byNode(this),z)}),g(this.containerNode,g.selector(".dijitTreeNode",B.leave),function(z){I._onNodeMouseLeave(D.byNode(this),z)}),g(this.containerNode,g.selector(".dijitTreeRow",m.press),function(z){I._onNodePress(D.getEnclosingWidget(this),z)}),g(this.containerNode,g.selector(".dijitTreeRow",m),function(z){I._onClick(D.getEnclosingWidget(this),z)}),g(this.containerNode,g.selector(".dijitTreeRow",
"dblclick"),function(z){I._onDblClick(D.getEnclosingWidget(this),z)}));this.model||this._store2model();this.own(J.after(this.model,"onChange",f.hitch(this,"_onItemChange"),!0),J.after(this.model,"onChildrenChange",f.hitch(this,"_onItemChildrenChange"),!0),J.after(this.model,"onDelete",f.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){f.isString(this.dndController)&&(this.dndController=f.getObject(this.dndController));for(var P={},X=0;X<this.dndParams.length;X++)this[this.dndParams[X]]&&
(P[this.dndParams[X]]=this[this.dndParams[X]]);this.dndController=new this.dndController(this,P)}this._load();this.onLoadDeferred=V(this.pendingCommandsPromise);this.onLoadDeferred.then(f.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;G.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var I={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(I.mayHaveChildren=
f.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(I.getChildren=f.hitch(this,function(P,X,z){this.getItemChildren(this._v10Compat&&P===this.model.root?null:P,X,z)}));this.model=new S(I);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(f.hitch(this,function(I){var P=this.rootNode=this.tree._createTreeNode({item:I,tree:this,isExpandable:!0,label:this.label||this.getLabel(I),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?
0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(P.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(P.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(P.containerNode.setAttribute("aria-labelledby",
this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),P.labelNode.setAttribute("role","presentation"),P.labelNode.removeAttribute("aria-selected"),P.containerNode.setAttribute("role","tree"),P.containerNode.setAttribute("aria-expanded","true"),P.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(P.domNode);I=this.model.getIdentity(I);this._itemNodesMap[I]?this._itemNodesMap[I].push(P):this._itemNodesMap[I]=[P];P._updateLayout();
this._expandNode(P).then(f.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),f.hitch(this,function(I){console.error(this,": error loading root: ",I)}))},getNodesByItem:function(I){if(!I)return[];I=f.isString(I)?I:this.model.getIdentity(I);return[].concat(this._itemNodesMap[I])},_setSelectedItemAttr:function(I){this.set("selectedItems",[I])},_setSelectedItemsAttr:function(I){var P=this;return this.pendingCommandsPromise=
this.pendingCommandsPromise.always(f.hitch(this,function(){var X=F.map(I,function(r){return!r||f.isString(r)?r:P.model.getIdentity(r)}),z=[];F.forEach(X,function(r){z=z.concat(P._itemNodesMap[r]||[])});this.set("selectedNodes",z)}))},_setPathAttr:function(I){return I.length?V(this.set("paths",[I]).then(function(P){return P[0]})):V(this.set("paths",[]).then(function(P){return P[0]}))},_setPathsAttr:function(I){function P(z,r){var v=z.shift(),H=F.filter(r,function(T){return T.getIdentity()==v})[0];
if(H)return z.length?X._expandNode(H).then(function(){return P(z,H.getChildren())}):H;throw new Y.PathError("Could not expand path at "+v);}var X=this;return V(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return a(F.map(I,function(z){z=F.map(z,function(r){return r&&f.isObject(r)?X.model.getIdentity(r):r});if(z.length)return P(z,[X.rootNode]);throw new Y.PathError("Empty path");}))}).then(function(z){X.set("selectedNodes",z);return X.paths}))},_setSelectedNodeAttr:function(I){this.set("selectedNodes",
[I])},_setSelectedNodesAttr:function(I){this.dndController.setSelection(I)},expandAll:function(){function I(X){return P._expandNode(X).then(function(){var z=F.filter(X.getChildren()||[],function(r){return r.isExpandable});return a(F.map(z,I))})}var P=this;return V(I(this.rootNode))},collapseAll:function(){function I(X){var z=F.filter(X.getChildren()||[],function(r){return r.isExpandable});z=a(F.map(z,I));return!X.isExpanded||X==P.rootNode&&!P.showRoot?z:z.then(function(){return P._collapseNode(X)})}
var P=this;return V(I(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(I){return this.model.getLabel(I)},getIconClass:function(I,P){return!I||this.model.mayHaveChildren(I)?P?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(I,P){(I=this._getNext(P))&&I.isTreeNode&&this.focusNode(I)},
_onUpArrow:function(I,P){if(I=P.getPreviousSibling())for(P=I;P.isExpandable&&P.isExpanded&&P.hasChildren();)P=P.getChildren(),P=P[P.length-1];else if(I=P.getParent(),this.showRoot||I!==this.rootNode)P=I;P&&P.isTreeNode&&this.focusNode(P)},_onRightArrow:function(I,P){P.isExpandable&&!P.isExpanded?this._expandNode(P):P.hasChildren()&&(P=P.getChildren()[0])&&P.isTreeNode&&this.focusNode(P)},_onLeftArrow:function(I,P){P.isExpandable&&P.isExpanded?this._collapseNode(P):(I=P.getParent())&&I.isTreeNode&&
(this.showRoot||I!==this.rootNode)&&this.focusNode(I)},focusLastChild:function(){var I=this._getLast();I&&I.isTreeNode&&this.focusNode(I)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var I=this.rootNode;I.isExpanded;){var P=I.getChildren();if(!P.length)break;I=P[P.length-1]}return I},_getNext:function(I){if(I.isExpandable&&I.isExpanded&&I.hasChildren())return I.getChildren()[0];for(;I&&I.isTreeNode;){var P=I.getNextSibling();if(P)return P;
I=I.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(I,P){return e.isDescendant(I,P.expandoNode)||e.isDescendant(I,P.expandoNodeText)},_onNodePress:function(I,P){this.focusNode(I)},__click:function(I,P,X,z){var r=this.isExpandoNode(P.target,I);I.isExpandable&&(X||r)?this._onExpandoClick({node:I}):(this._publish("execute",{item:I.item,node:I,evt:P}),this[z](I.item,I,P),this.focusNode(I));P.stopPropagation();P.preventDefault()},_onClick:function(I,P){this.__click(I,P,this.openOnClick,
"onClick")},_onDblClick:function(I,P){this.__click(I,P,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(I){I=I.node;this.focusNode(I);I.isExpanded?this._collapseNode(I):this._expandNode(I)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(I){G.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(I)},_getRootOrFirstNode:function(){G.deprecated(this.declaredClass+
"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(I){I._expandNodeDeferred&&delete I._expandNodeDeferred;if("Loading"!=I.state&&I.isExpanded){var P=I.collapse();this.onClose(I.item,I);this._state(I,!1);this._startPaint(P);return P}},_expandNode:function(I){if(I._expandNodeDeferred)return I._expandNodeDeferred;var P=this.model,X=I.item,z=this;I._loadDeferred||(I.markProcessing(),I._loadDeferred=new t,P.getChildren(X,function(r){I.unmarkProcessing();
I.setChildItems(r).then(function(){I._loadDeferred.resolve(r)})},function(r){console.error(z,": error loading "+I.label+" children: ",r);I._loadDeferred.reject(r)}));P=I._loadDeferred.then(f.hitch(this,function(){var r=I.expand();this.onOpen(I.item,I);this._state(I,!0);return r}));this._startPaint(P);return P},focusNode:function(I){for(var P=[],X=this.domNode;X&&X.tagName&&"IFRAME"!==X.tagName.toUpperCase();X=X.parentNode)P.push({domNode:X.contentWindow||X,scrollLeft:X.scrollLeft||0,scrollTop:X.scrollTop||
0});this.focusChild(I);this.defer(function(){for(var z=0,r=P.length;z<r;z++)P[z].domNode.scrollLeft=P[z].scrollLeft,P[z].domNode.scrollTop=P[z].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(I){var P=this.model.getIdentity(I);if(P=this._itemNodesMap[P]){var X=this.getLabel(I),z=this.getTooltip(I);F.forEach(P,function(r){r.set({item:I,label:X,tooltip:z});r._updateItemClasses(I)})}},_onItemChildrenChange:function(I,P){I=this.model.getIdentity(I);
(I=this._itemNodesMap[I])&&F.forEach(I,function(X){X.setChildItems(P)})},_onItemDelete:function(I){I=this.model.getIdentity(I);var P=this._itemNodesMap[I];P&&(F.forEach(P,function(X){this.dndController.removeTreeNode(X);var z=X.getParent();z&&z.removeChild(X);this.lastFocusedChild&&!e.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!e.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();X.destroyRecursive()},this),delete this._itemNodesMap[I])},
_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var I=x(this.cookieName);I&&F.forEach(I.split(","),function(P){this._openedNodes[P]=!0},this)}},_state:function(I,P){if(!this.persist)return!1;var X=F.map(I.getTreePath(),function(z){return this.model.getIdentity(z)},this).join("/");if(1===arguments.length)return this._openedNodes[X];P?this._openedNodes[X]=!0:delete this._openedNodes[X];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var I=
[],P;for(P in this._openedNodes)I.push(P);x(this.cookieName,I.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!f.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(I){I&&d.setMarginBox(this.domNode,I);this._nodePixelIndent=d.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(f.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(I){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var P=f.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});
c(I,P,P)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(I){return new W(I)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});u("dojo-bidi")&&Y.extend({_setTextDirAttr:function(I){I&&this.textDir!=I&&(this._set("textDir",
I),this.rootNode.set("textDir",I))}});Y.PathError=n("TreePathError");Y._TreeNode=W;return Y})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(F,J,x,K){return x("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(t){K.mixin(this,t);this.connects=[];t=this.store;if(!t.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
t.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([J.after(t,"onNew",K.hitch(this,"onNewItem"),!0),J.after(t,"onDelete",K.hitch(this,"onDeleteItem"),!0),J.after(t,"onSet",K.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var t;t=this.connects.pop();)t.remove()},getRoot:function(t,a){this.root?t(this.root):this.store.fetch({query:this.query,onComplete:K.hitch(this,function(e){if(1!=e.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+e.length+
" items, but must return exactly one");this.root=e[0];t(this.root)}),onError:a})},mayHaveChildren:function(t){return F.some(this.childrenAttrs,function(a){return this.store.hasAttribute(t,a)},this)},getChildren:function(t,a,e){var b=this.store;if(b.isItemLoaded(t)){for(var d=[],h=0;h<this.childrenAttrs.length;h++){var n=b.getValues(t,this.childrenAttrs[h]);d=d.concat(n)}var p=0;this.deferItemLoadingUntilExpand||F.forEach(d,function(G){b.isItemLoaded(G)||p++});0==p?a(d):F.forEach(d,function(G,C){b.isItemLoaded(G)||
b.loadItem({item:G,onItem:function(f){d[C]=f;0==--p&&a(d)},onError:e})})}else{var u=K.hitch(this,arguments.callee);b.loadItem({item:t,onItem:function(G){u(G,a,e)},onError:e})}},isItem:function(t){return this.store.isItem(t)},fetchItemByIdentity:function(t){this.store.fetchItemByIdentity(t)},getIdentity:function(t){return this.store.getIdentity(t)},getLabel:function(t){return this.labelAttr?this.store.getValue(t,this.labelAttr):this.store.getLabel(t)},newItem:function(t,a,e){var b={parent:a,attribute:this.childrenAttrs[0]},
d;this.newItemIdAttr&&t[this.newItemIdAttr]?this.fetchItemByIdentity({identity:t[this.newItemIdAttr],scope:this,onItem:function(h){h?this.pasteItem(h,null,a,!0,e):(d=this.store.newItem(t,b))&&void 0!=e&&this.pasteItem(d,a,a,!1,e)}}):(d=this.store.newItem(t,b))&&void 0!=e&&this.pasteItem(d,a,a,!1,e)},pasteItem:function(t,a,e,b,d){var h=this.store,n=this.childrenAttrs[0];a&&F.forEach(this.childrenAttrs,function(u){if(h.containsValue(a,u,t)){if(!b){var G=F.filter(h.getValues(a,u),function(C){return C!=
t});h.setValues(a,u,G)}n=u}});if(e)if("number"==typeof d){var p=h.getValues(e,n).slice();p.splice(d,0,t);h.setValues(e,n,p)}else h.setValues(e,n,h.getValues(e,n).concat(t))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(t,a){a&&this.getChildren(a.item,K.hitch(this,function(e){this.onChildrenChange(a.item,e)}))},onDeleteItem:function(t){this.onDelete(t)},onSetItem:function(t,a){if(-1!=F.indexOf(this.childrenAttrs,a))this.getChildren(t,K.hitch(this,function(e){this.onChildrenChange(t,
e)}));else this.onChange(t)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(F,J,x,K,t){return J("dijit.tree.ForestStoreModel",t,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(a,e,b){a===
this.root?this.root.children?e(this.root.children):this.store.fetch({query:this.query,onComplete:K.hitch(this,function(d){this.root.children=d;e(d)}),onError:b}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(a){if(a.identity==this.root.id){var e=a.scope||x.global;a.onItem&&a.onItem.call(e,this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===
this.root?this.root.label:this.inherited(arguments)},newItem:function(a,e,b){return e===this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,e,b,d,h){if(e===this.root&&!d)this.onLeaveRoot(a);this.inherited(arguments,[a,e===this.root?null:e,b===this.root?null:b,d,h]);if(b===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){console.log(this,": item ",a," added to root")},onLeaveRoot:function(a){console.log(this,": item ",
a," removed from root")},_requeryTop:function(){var a=this.root.children||[];this.store.fetch({query:this.query,onComplete:K.hitch(this,function(e){this.root.children=e;if(a.length!=e.length||F.some(a,function(b,d){return e[d]!=b}))this.onChildrenChange(this.root,e)})})},onNewItem:function(a,e){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(a){-1!=F.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,e,b,d){this._requeryTop();this.inherited(arguments)}})})},
"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(F,J,x,K,t,a,e,b,d,h,n){return J("dijit.tree._dndSelector",n,{constructor:function(){this.selection={};this.anchor=null;this.events.push(b(this.tree.domNode,d.press,K.hitch(this,"onMouseDown")),b(this.tree.domNode,d.release,K.hitch(this,"onMouseUp")),b(this.tree.domNode,d.move,K.hitch(this,
"onMouseMove")),b(this.tree.domNode,h.press,K.hitch(this,"onClickPress")),b(this.tree.domNode,h.release,K.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var p=[],u=this.selection,G;for(G in u)p.push(u[G]);return p},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(p,u){this.setSelection(this.getSelectedTreeNodes().concat([p]));u&&(this.anchor=p);return p},removeTreeNode:function(p){var u=
F.filter(this.getSelectedTreeNodes(),function(G){return!a.isDescendant(G.domNode,p.domNode)});this.setSelection(u);return p},isTreeNodeSelected:function(p){return p.id&&!!this.selection[p.id]},setSelection:function(p){var u=this.getSelectedTreeNodes();F.forEach(this._setDifference(u,p),K.hitch(this,function(G){G.setSelected(!1);this.anchor==G&&delete this.anchor;delete this.selection[G.id]}));F.forEach(this._setDifference(p,u),K.hitch(this,function(G){G.setSelected(!0);this.selection[G.id]=G}));this._updateSelectionProperties()},
_setDifference:function(p,u){F.forEach(u,function(G){G.__exclude__=!0});p=F.filter(p,function(G){return!G.__exclude__});F.forEach(u,function(G){delete G.__exclude__});return p},_updateSelectionProperties:function(){var p=this.getSelectedTreeNodes(),u=[],G=[];F.forEach(p,function(C){var f=C.getTreePath();G.push(C);u.push(f)},this);p=F.map(G,function(C){return C.item});this.tree._set("paths",u);this.tree._set("path",u[0]||[]);this.tree._set("selectedNodes",G);this.tree._set("selectedNode",G[0]||null);
this.tree._set("selectedItems",p);this.tree._set("selectedItem",p[0]||null)},onClickPress:function(p){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(p.target,this.current))){"mousedown"==p.type&&e.isLeft(p)&&p.preventDefault();var u="keydown"==p.type?this.tree.focusedChild:this.current;if(u){var G=t.getCopyKeyState(p),C=u.id;this.singular||p.shiftKey||!this.selection[C]?(this._doDeselect=!1,this.userSelect(u,G,p.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(p){this._doDeselect&&
(this._doDeselect=!1,this.userSelect("keyup"==p.type?this.tree.focusedChild:this.current,t.getCopyKeyState(p),p.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(p,u){if(p===u)return 0;if("sourceIndex"in document.documentElement)return p.sourceIndex-u.sourceIndex;if("compareDocumentPosition"in document.documentElement)return p.compareDocumentPosition(u)&2?1:-1;if(document.createRange){var G=doc.createRange();G.setStartBefore(p);
p=doc.createRange();p.setStartBefore(u);return G.compareBoundaryPoints(G.END_TO_END,p)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(p,u,G){if(this.singular)this.anchor==p&&u?this.selectNone():(this.setSelection([p]),this.anchor=p);else if(G&&this.anchor){u=this._compareNodes(this.anchor.rowNode,p.rowNode);G=this.anchor;0>u?u=G:(u=p,p=G);for(G=[];u!=p;)G.push(u),u=this.tree._getNext(u);G.push(p);this.setSelection(G)}else this.selection[p.id]&&
u?this.removeTreeNode(p):u?this.addTreeNode(p,!0):(this.setSelection([p]),this.anchor=p)},getItem:function(p){return{data:this.selection[p],type:["treeNode"]}},forInSelectedItems:function(p,u){u=u||x.global;for(var G in this.selection)p.call(u,this.getItem(G),G,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(F,J,x,K,t,a){return J("dijit.tree._dndContainer",null,{constructor:function(e,b){this.tree=
e;this.node=e.domNode;K.mixin(this,b);this.containerState="";x.add(this.node,"dojoDndContainer");this.events=[t(this.node,a.enter,K.hitch(this,"onOverEvent")),t(this.node,a.leave,K.hitch(this,"onOutEvent")),F.after(this.tree,"_onNodeMouseEnter",K.hitch(this,"onMouseOver"),!0),F.after(this.tree,"_onNodeMouseLeave",K.hitch(this,"onMouseOut"),!0),t(this.node,"dragstart, selectstart",function(d){d.preventDefault()})]},destroy:function(){for(var e;e=this.events.pop();)e.remove();this.node=this.parent=
null},onMouseOver:function(e){this.current=e},onMouseOut:function(){this.current=null},_changeState:function(e,b){var d="dojoDnd"+e;e=e.toLowerCase()+"State";x.replace(this.node,d+b,d+this[e]);this[e]=b},_addItemClass:function(e,b){x.add(e,"dojoDndItem"+b)},_removeItemClass:function(e,b){x.remove(e,"dojoDndItem"+b)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p){return F([d,h,a],{templateString:n,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource;this.nls.customSelectLayer=this.label?this.label:this.nls.selectLayer},postCreate:function(){this.inherited(arguments);this.layerInfosObj=
p.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";this.own(K(this.layerChooser,"tree-click",J.hitch(this,this._onTreeClick)));this.own(K(this.layerChooser,"update",J.hitch(this,this._onLayerChooserUpdate)));this.own(K(document.body,"click",J.hitch(this,this._onBodyClicked)));this.own(K(document.body,"keydown",J.hitch(this,function(u){u.keyCode===t.ENTER&&this._onBodyClicked(u)})));
this.own(K(this.layerChooser.domNode,"keydown",J.hitch(this,function(u){u.keyCode===t.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(u){var G=new e;if(u){var C=this.layerInfosObj.getLayerOrTableInfoById(u.id);C?this.layerChooser.filter(C).then(J.hitch(this,function(f){f?(this._onSelectNewItem({layerInfo:C,
name:C.title,url:u.url}),G.resolve(!0)):G.resolve(!1)}),J.hitch(this,function(){G.resolve(!1)})):G.resolve(!1)}else this._onSelectNewItem(null),G.resolve(!0);return G},getSelectedItem:function(){return this._selectedItem},getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(u){u=u.target||u.srcElement;u===this.domNode||x.isDescendant(u,this.domNode)||u===this.layerChooser.domNode||x.isDescendant(u,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(u){u.stopPropagation();
u.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(u){u.keyCode===t.ENTER&&this._onDropDownClick(u)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";b.open({parent:this,popup:this.layerChooser,around:this.domNode});var u=this.layerChooser.domNode.parentNode;u&&(x.addClass(u,"jimu-layer-chooser-from-map-withdropbox-popup"),
this.customClass&&x.addClass(u,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){b.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(u){var G=J.getObject("layerInfo.id",
!1,this._selectedItem)||-1,C=J.getObject("layerInfo.id",!1,u)||-1;G=G!==C;this._selectedItem=u;this.hideLayerChooser();u=J.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=u;x.setAttr(this.layerNameNode,"title",u);u=J.getObject("layerInfo.layerObject",!1,this._selectedItem);G&&this.emit("selection-change",[u])},_onTreeClick:function(){var u=this._getSelectedItems();this._onSelectNewItem(0<u.length?u[0]:null)}})})},"widgets/SmartEditor/setting/layersAndFieldsApplyOn":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on jimu/BaseWidgetSetting dijit/_TemplatedMixin jimu/dijit/CheckBox jimu/utils dojo/dom-attr dojo/dom-class dojo/query dojo/string dojo/dom-style dijit/form/ValidationTextBox dojo/text!./layerAndFieldsApplyOn.html dijit/form/CheckBox dijit/registry".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B){return F([e,J,b],{baseClass:"jimu-widget-smartEditor-setting-layersAndFieldsApplyOn",templateString:g,checkBoxNodes:null,layerCheckBoxNodes:null,showDomainFieldIndicator:!1,searchTextBox:null,defalutFieldInfos:[{actionName:"Intersection",enabled:!1,fields:[]},{actionName:"Address",enabled:!1},{actionName:"Coordinates",enabled:!1,coordinatesSystem:"MapSpatialReference",field:"x"},{actionName:"Preset",enabled:!1}],nlsActionName:{Intersection:"Intersection1",
Address:"Address1",Coordinates:"Coordinates1",Preset:"Preset1"},postCreate:function(){this.inherited(arguments);this.nlsActionName={Intersection:this.nls.actionPage.copyAction.intersection,Address:this.nls.actionPage.copyAction.address,Coordinates:this.nls.actionPage.copyAction.coordinates,Preset:this.nls.actionPage.copyAction.preset};this.layerCheckBoxNodes={};this.checkBoxNodes={};this._prevAppliedOnLayers=[];this.appliedOn&&(this._prevAppliedOnLayers=x.clone(Object.keys(this.appliedOn)));this._addSearchControl();
this._addLayerAndFields(!0)},_addSearchControl:function(){this.searchTextBox=new f({trim:!0,placeHolder:this.nls.actionPage.searchPlaceHolder,intermediateChanges:!0},t.create("div",{},this.searchNode));C.set(this.searchTextBox.domNode,"width","350px");this.own(a(this.searchTextBox,"change",x.hitch(this,this._searchTextUpdated)));var c=t.create("div",{"class":"esriCTExpandAllNode"},this.searchNode),m=t.create("div",{"class":"esriCTExpandAllNode"},this.searchNode);this._expandAllCheckBox=new w({"class":"switch-toggle",
checked:!1},t.create("div",{},c));t.create("label",{innerHTML:this.nls.actionPage.expandAllLabel,"class":"esriCTDojoCheckBoxLabel"},c);this._checkAllFieldsCheckBox=new w({checked:!1},t.create("div",{},m));t.create("label",{innerHTML:this.nls.actionPage.selectAllLabel,"class":"esriCTDojoCheckBoxLabel"},m);this.noFieldsDOM=t.create("div",{innerHTML:this.nls.actionPage.noValidFieldTypeMsg,"class":"esriCTHidden"},this.searchNode);this.own(a(this._expandAllCheckBox,"change",x.hitch(this,function(A){A?
(A=u(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed.esriCTToggleLayerExpanded",this.layerAndFieldsMainDiv))&&0<A.length&&K.forEach(A,function(D){D.click()}):(A=u(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed",this.layerAndFieldsMainDiv))&&0<A.length&&K.forEach(A,function(D){p.contains(D,"esriCTToggleLayerExpanded")||D.click()})})));this.own(a(this._checkAllFieldsCheckBox,"change",x.hitch(this,function(A){var D;var N=""!==this.searchTextBox.get("value")?u("div[searchstring*\x3d'"+this.searchTextBox.get("value").toLowerCase()+
"']",this.layerAndFieldsMainDiv):u(".esriCTFieldsDiv",this.layerAndFieldsMainDiv);K.forEach(N,x.hitch(this,function(L){D=B.byNode(u(".esriCTFieldsCheckBox",L)[0]);A?D.check(!0):D.uncheck(!0)}));this.emit("layerFieldsUpdated",!1)})))},_searchTextUpdated:function(c){var m=c.toLowerCase();if(""!==m){c=u("[searchstring]",this.layerAndFieldsMainDiv);m=u("div[searchstring*\x3d'"+m+"']",this.layerAndFieldsMainDiv);c.style("display","none");c.removeClass("esriCTNotFilteredBySearch");c.addClass("esriCTFilteredBySearch");
m.style("display","");m.replaceClass("esriCTNotFilteredBySearch","esriCTFilteredBySearch");c=this.layerDetails;for(var A in c){var D;if(0<Object.keys(c[A]).length){m=u("[layermaindivid \x3d '"+A+"']",this.layerAndFieldsMainDiv);var N=u("[layerid\x3d'"+A+"']",this.layerAndFieldsMainDiv);var L=!0;for(D=0;D<N.length;D++)if(p.contains(N[D],"esriCTNotFilteredBySearch")){L=!1;break}L?m.style("display","none"):m.style("display","")}}}else u("[layermaindivid]",this.layerAndFieldsMainDiv).style("display",
""),u("[searchstring]",this.layerAndFieldsMainDiv).style("display",""),u("[searchstring]",this.layerAndFieldsMainDiv).removeClass("esriCTFilteredBySearch"),u("[searchstring]",this.layerAndFieldsMainDiv).addClass("esriCTNotFilteredBySearch");this._handleHeaderCheckBoxState()},_addLayerAndFields:function(){var c=[];var m=this.layerDetails;hasFields=!1;for(var A in m)if(0<Object.keys(m[A]).length){hasFields=!0;var D=t.create("div",{"class":"esriCTLayerMainDiv"},this.layerAndFieldsMainDiv);n.set(D,"layermaindivid",
A);this._createLayerName(D,A);D=this._getLayersFieldValues(A);this.appliedOn&&this.appliedOn.hasOwnProperty(A)&&0<this.appliedOn[A].length&&c.push(A);for(var N in m[A])if(m[A][N].editable){var L=!1,R=t.create("div",{"class":"esriCTFieldsDiv  esriCTHidden"},this.layerAndFieldsMainDiv);n.set(R,"layerid",A);if(D&&D.hasOwnProperty(N)){var q;K.some(D[N],function(k){if(k.actionName===this.actionName&&k.enabled&&(!k.hasOwnProperty("attributeActionGroupName")||k.hasOwnProperty("attributeActionGroupName")&&
k.attributeActionGroupName!==this.prevName))return q=k,L=!0},this);"Preset"!==this.actionName||!L||!q||q.hasOwnProperty("attributeActionGroupName")&&""!==q.attributeActionGroupName||(L=!1)}this._createFieldName(m[A][N],A,R,L,q?q.attributeActionGroupName:null)}}0<c.length&&setTimeout(x.hitch(this,function(){this._applyPrevSettings();K.forEach(c,x.hitch(this,function(k){var E=u('[rootnodelayerid\x3d"'+k+'"]');E&&0<E.length&&p.contains(E[0],"esriCTToggleLayerExpanded")&&(u('[rootnodelayerid\x3d"'+k+
'"]').toggleClass("esriCTToggleLayerExpanded"),u('[layerid\x3d"'+k+'"]').toggleClass("esriCTHidden"))}));this.emit("layerFieldsUpdated",!0)}),100);hasFields?p.add(this.noFieldsDOM,"esriCTHidden"):p.remove(this.noFieldsDOM,"esriCTHidden")},_createLayerName:function(c,m){var A;this.layerCheckBoxNodes[m]=[];this.checkBoxNodes[m]=[];if(this.layerInfos.getLayerOrTableInfoById(m)){var D=this.layerInfos.getLayerOrTableInfoById(m).layerObject.name;var N=t.create("div",{"class":"esriCTToggleLayerIcon esriCTToggleLayerCollapsed esriCTToggleLayerExpanded"},
c);n.set(N,"rootnodelayerid",m);this.own(a(N,"click",x.hitch(this,function(L){var R=!0,q=u(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed",this.layerAndFieldsMainDiv);p.toggle(L.currentTarget,"esriCTToggleLayerExpanded");A=n.get(L.currentTarget,"rootnodelayerid");u('[layerid\x3d"'+A+'"]').toggleClass("esriCTHidden");K.some(q,x.hitch(this,function(k){if(p.contains(k,"esriCTToggleLayerExpanded"))return R=!1,!0}));this._expandAllCheckBox.set("checked",R,!1)})));c=t.create("div",{"class":"esriCTLayercheckBox"},
c);t.create("div",{innerHTML:D},c);D=new d({label:D,checked:!1});this.layerCheckBoxNodes[m].push(D);n.set(D.domNode,"LayerCheckBoxId",m);a(D.domNode,"click",x.hitch(this,this._parentNodeStateChanged))}},_getLayersFieldValues:function(c){var m;K.some(this._configInfos,function(A){if(A.featureLayer&&A.featureLayer.id===c)return A.fieldValues?m=A.fieldValues:A.fieldValues={},!0},this);return m},_getAllLayersFieldValues:function(c,m,A){K.forEach(m,function(D){D.featureLayer&&D.featureLayer.id===A&&(D.fieldValues?
c||(c=[]):D.fieldValues={},c.push(D.fieldValues));D.relationshipInfos&&(c=this._getAllLayersFieldValues(c,D.relationshipInfos,A))},this);return c},_createFieldName:function(c,m,A,D,N){var L=h.getDefaultPortalFieldInfo(c);var R=G.substitute(N?this.nls.attributeActionsPage.alreadyAppliedActionMsg:this.nls.attributeActionsPage.alreadyAppliedActionLayerMsg,{action:this.nlsActionName[this.actionName]});N&&(N=G.substitute(this.nls.attributeActionsPage.appliedGroupName,{groupName:N}),R=R+" "+N);R=t.create("div",
{"class":"esriCTExistingExpressionDiv esriCTVisibilityHidden",title:R},A);D&&p.remove(R,"esriCTVisibilityHidden");this.showDomainFieldIndicator&&(D=t.create("div",{"class":"esriCTDomainlistDiv esriCTVisibilityHidden",innerHTML:"*",title:this.nls.actionPage.domainListTitle},A),c.domain&&c.domain.codedValues&&(p.remove(D,"esriCTVisibilityHidden"),p.remove(this.domainFieldHintMsg,"esriCTHidden")));c=t.create("div",{"class":"esriCTFieldsCheckBox"},A);c=new d({label:L.label,value:L.fieldName,checked:!1},
c);this.checkBoxNodes[m].push(c);n.set(A,"searchstring",L.label.toLowerCase());n.set(c.domNode,"fieldsCheckBoxId",m);a(c.domNode,"click",x.hitch(this,this._childNodeStateChanged));a(c,"change",x.hitch(this,function(){this._handleHeaderCheckBoxState()}))},_handleHeaderCheckBoxState:function(){var c=!0;var m=""!==this.searchTextBox.get("value")?u("[searchstring*\x3d'"+this.searchTextBox.get("value").toLowerCase()+"']",this.layerAndFieldsMainDiv):u(".esriCTFieldsDiv",this.layerAndFieldsMainDiv);0<m.length?
K.some(m,x.hitch(this,function(A){A=u(".checkbox",A)[0];if(!p.contains(A,"jimu-icon-checked"))return c=!1,!0})):c=!1;c?this._checkAllFieldsCheckBox.set("checked",!0,!1):this._checkAllFieldsCheckBox.set("checked",!1,!1)},_parentNodeStateChanged:function(c){var m=n.get(c.currentTarget,"LayerCheckBoxId");c=this.layerCheckBoxNodes[m];m=this.checkBoxNodes[m];var A=c[0].getValue();K.forEach(m,x.hitch(this,function(D){A?D.setValue(!0):D.setValue(!1)}))},_childNodeStateChanged:function(c){var m=n.get(c.currentTarget,
"fieldsCheckBoxId");c=this.layerCheckBoxNodes[m];m=this.checkBoxNodes[m];var A=!0;K.some(m,x.hitch(this,function(D){if(!D.getValue())return A=!1,!0}));c[0].setValue(A);this.emit("layerFieldsUpdated",!1)},getOnlyCheckedFields:function(){var c={},m;for(m in this.checkBoxNodes){c[m]=[];for(var A in this.checkBoxNodes[m])this.checkBoxNodes[m][A].checked&&c[m].push(this.checkBoxNodes[m][A].get("value"))}return c},getCheckedFields:function(c){var m={},A;for(A in this.checkBoxNodes){m[A]=[];for(var D in this.checkBoxNodes[A])this.checkBoxNodes[A][D].checked&&
m[A].push(this.checkBoxNodes[A][D].get("value"))}this._applySettingsInLayer(c,m);return m},_removeSettingsFromOtherGroups:function(c,m,A){var D;if(this.existingGroups)for(var N in this.existingGroups)if(N!==c&&N!==this.prevName&&(D=this.existingGroups[N].appliedOn)&&D.hasOwnProperty(m)&&-1<D[m].indexOf(A)){var L=D[m].indexOf(A);D[m].splice(L,1)}},_removePrevSettingsFromLayerFields:function(c){var m=[];if((m=this._getAllLayersFieldValues(m,this._configInfos,c))&&0<m.length)for(var A=0;A<m.length;A++)if(c=
m[A])for(var D in c)for(var N=c[D],L=0;L<N.length;L++)N[L].actionName===this.actionName&&N[L].hasOwnProperty("attributeActionGroupName")&&N[L].attributeActionGroupName===this.prevName&&(N[L].enabled=!1,delete N[L].attributeActionGroupName,"Intersection"===this.actionName?(N[L].fields=[],N[L].ignoreLayerRanking=!1):"Address"===this.actionName?delete N[L].field:"Coordinates"===this.actionName&&(N[L].coordinatesSystem="MapSpatialReference",N[L].field="x"))},_applysettingsToField:function(c,m,A){var D=
[];if((D=this._getAllLayersFieldValues(D,this._configInfos,c))&&0<D.length){for(var N=0;N<D.length;N++){var L=D[N];if(this.appliedOn&&this.appliedOn.hasOwnProperty(c)){var R=this.appliedOn[c];R&&0<R.length&&K.forEach(R,function(q){if(-1===m.indexOf(q)&&L.hasOwnProperty(q)){q=L[q];for(var k=0;k<q.length;k++)q[k].actionName===this.actionName&&(q[k].enabled=!1,delete q[k].attributeActionGroupName,"Intersection"===this.actionName?(q[k].fields=[],q[k].ignoreLayerRanking=!1):"Address"===this.actionName?
delete q[k].field:"Coordinates"===this.actionName&&(q[k].coordinatesSystem="MapSpatialReference",q[k].field="x"))}},this)}}K.forEach(m,function(q){for(var k=0;k<D.length;k++){L=D[k];L.hasOwnProperty(q)||(L[q]=x.clone(this.defalutFieldInfos));var E=L[q];for(var O=0;O<E.length;O++)E[O].actionName===this.actionName&&(A.attributeInfo&&(E[O]=x.mixin(E[O],A.attributeInfo)),E[O].enabled=!0,E[O].attributeActionGroupName=A.name,this._removeSettingsFromOtherGroups(A.name,c,q))}},this)}},_applySettingsInLayer:function(c,
m){for(var A in m){if(this._prevAppliedOnLayers&&-1<this._prevAppliedOnLayers.indexOf(A)){var D=this._prevAppliedOnLayers.indexOf(A);this._prevAppliedOnLayers.splice(D,1)}this._applysettingsToField(A,m[A],c)}this.deleteGroup()},deleteGroup:function(){this._prevAppliedOnLayers&&K.forEach(this._prevAppliedOnLayers,function(c){this._removePrevSettingsFromLayerFields(c)},this)},_applyPrevSettings:function(){if(this.appliedOn)for(var c in this.appliedOn)if(this.appliedOn.hasOwnProperty(c)){var m=this.appliedOn[c];
if(m&&0<m.length){var A=this.layerCheckBoxNodes[c],D=!0;K.forEach(this.checkBoxNodes[c],x.hitch(this,function(L){-1<m.indexOf(L.value)?L.setValue(!0):L.getValue()||(D=!1)}));D&&A&&A[0]&&A[0].setValue(D)}}var N=!0;c=u(".esriCTFieldsDiv",this.layerAndFieldsMainDiv);0<c.length&&K.some(c,x.hitch(this,function(L){L=u(".checkbox",L)[0];if(!p.contains(L,"jimu-icon-checked"))return N=!1,!0}));this._expandAllCheckBox.set("checked",N,!1)}})})},"widgets/SmartEditor/setting/Coordinates":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/text!./Coordinates.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup dijit/form/Select dijit/form/ValidationTextBox ./layersAndFieldsApplyOn dojo/dom-class".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G){return F([d,J,b],{baseClass:"jimu-widget-smartEditor-setting-coordinates",templateString:e,groupNameTextBox:null,postCreate:function(){this.inherited(arguments);this.fieldSelector=this.groupNameTextBox=null;this._initControls();this._createLayersAndFields();this.isDelete||this.showDialog()},_onCoordinateSystemChanged:function(C){this.fieldSelector.set("options",this._getFieldsOptionsObj(C));0<this.fieldSelector.options.length&&this.fieldSelector.set("value",this.fieldSelector.options[0].value)},
showDialog:function(){var C=!1;var f=675;var g=!1;if(this._fieldValues&&this._fieldValues.Coordinates&&this._fieldValues.Coordinates.hasOwnProperty("enabled")){C=this._fieldValues.Coordinates.enabled;var w=this._fieldValues.Coordinates.coordinatesSystem;var B=this._fieldValues.Coordinates.field;var c=this._fieldValues.Coordinates.hasOwnProperty("coordinatesSource")?this._fieldValues.Coordinates.coordinatesSource:"featureLocation"}this.coordinatesSource=new n({options:this._addCoordinatesSourceOpt(),
style:{width:"99%"}},t.create("div",{},this.coordinatesSourceNode));c&&this.coordinatesSource.set("value",c,!1);this.own(a(this.coordinatesSource,"change",x.hitch(this,function(D){m.set("options",this._createCoordinatesOptions(D));0<m.options.length&&(m.set("value",m.options[0].value,!1),this._onCoordinateSystemChanged(m.options[0].value))})));var m=new n({style:{width:"99%"},options:this._createCoordinatesOptions(this.coordinatesSource.value)},t.create("div",{},this.selectCoordinateNode));this.own(a(m,
"change",x.hitch(this,this._onCoordinateSystemChanged)));w&&m.set("value",w,!1);this.fieldSelector=new n({style:{width:"99%"},options:this._getFieldsOptionsObj(m.getValue())},t.create("div",{},this.selectAttributeNode));B&&(this.fieldSelector.set("value",B),"MGRS"===B&&this._createLayersAndFields());this.own(a(this.fieldSelector,"change",x.hitch(this,function(){this._createLayersAndFields()})));this.isGroup||(G.add(this.groupInfoNode1,"esriCTHidden"),G.add(this.groupInfoNode2,"esriCTHidden"),G.remove(this.coordianteDijitMainWrapper,
"esriCTCoordinateWidth"),G.add(this.coordianteDijitMainWrapper,"esriCTFullWidth"),g=!0,f=420);var A=new h({titleLabel:this.nls.coordinatesPage.popupTitle,width:f,maxHeight:500,autoHeight:g,content:this,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var D={},N={};D.enabled=C;D.coordinatesSystem=m.get("value");D.field=this.fieldSelector.get("value");D.coordinatesSource=this.coordinatesSource.get("value");if(this.isGroup){if(!this.groupNameTextBox.isValid()){this.groupNameTextBox.focus();
return}}else delete this._fieldValues.Coordinates.attributeActionGroupName;this._fieldValues.Coordinates||(this._fieldValues.Coordinates={actionName:"Coordinates"});x.mixin(this._fieldValues.Coordinates,D);this.isGroup?(N.name=this.groupNameTextBox.get("value"),N.dataType=this.fieldSelector._getSelectedOptionsAttr().type,N.attributeInfo=D,N.appliedOn=this._layerAndFieldsApplyOnObj.getCheckedFields(N),this.emit("groupInfoUpdated",N)):this.emit("attributeActionUpdated");A.close()})},{label:this.nls.cancel,
classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){A.close()})}],onClose:x.hitch(this,function(){})});this.isGroup&&this.groupNameTextBox.focus()},_initControls:function(){this.groupNameTextBox=new p({style:{width:"99%"},required:!0,trim:!0},t.create("div",{},this.groupNameTextBoxNode));this.groupNameTextBox.validator=x.hitch(this,function(C){return C?C!==this.prevName&&this.editUtils.isDuplicateGroupName(C,this.existingGroupNames)?(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),
!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});this.name&&this.groupNameTextBox.set("value",this.name)},_createCoordinatesOptions:function(C){var f=[];this.isGroup?(0<this.coordinatesSavedDataTypes[C].MapSpatialReference.length&&f.push({label:this.nls.coordinatesPage.mapSpatialReferenceOptionLabel,value:"MapSpatialReference"}),0<this.coordinatesSavedDataTypes[C].LatLong.length&&f.push({label:this.nls.coordinatesPage.latLongOptionLabel,value:"LatLong"}),
0<this.coordinatesSavedDataTypes[C].MGRS.length&&f.push({label:this.nls.coordinatesPage.MGRS,value:"MGRS"})):f.push({label:this.nls.coordinatesPage.mapSpatialReferenceOptionLabel,value:"MapSpatialReference"},{label:this.nls.coordinatesPage.latLongOptionLabel,value:"LatLong"},{label:this.nls.coordinatesPage.MGRS,value:"MGRS"});return f},_getFieldsOptionsObj:function(C){var f=[],g=[];g=this._getCoordinateSystemOptions(C);var w=this.coordinatesSource.get("value");K.forEach(g,x.hitch(this,function(B){var c=
"MGRS"===C?this.nls.coordinatesPage.MGRS:this.nls.coordinatesPage[C][B.name];this.isGroup?(-1!==this.coordinatesSavedDataTypes[w][C].indexOf(B.alias)||-1!==this.coordinatesSavedDataTypes[w].LatLong.indexOf(B.alias))&&f.push({label:c||B.name,value:B.name,type:B.alias}):("xy"!==B.name||"xy"===B.name&&"esriFieldTypeString"===this._fieldType||"yx"!==B.name||"yx"===B.name&&"esriFieldTypeString"===this._fieldType)&&f.push({label:c||B.name,value:B.name,type:B.alias})}));return f},_getCoordinateSystemOptions:function(C){switch(C){case "LatLong":var f=
[{name:"y",alias:"Latitude"},{name:"x",alias:"Longitude"},{name:"xy",alias:"Longitude Latitude"},{name:"yx",alias:"Latitude Longitude"}];break;case "MapSpatialReference":f=[{name:"x",alias:"X"},{name:"y",alias:"Y"},{name:"xy",alias:"X Y"},{name:"yx",alias:"Y X"}];break;case "MGRS":f=[{name:"MGRS",alias:"MGRS"}]}return f},_createLayerFieldsFilter:function(){var C={};!this.fieldSelector||"xy"!==this.fieldSelector.value&&"MGRS"!==this.fieldSelector.value&&"yx"!==this.fieldSelector.value?K.forEach(this._totalLayers,
x.hitch(this,function(f){f.isTable||K.forEach(f.layerObject.fields,x.hitch(this,function(g){if("esriFieldTypeString"===g.type||"esriFieldTypeSmallInteger"===g.type||"esriFieldTypeInteger"===g.type||"esriFieldTypeSingle"===g.type||"esriFieldTypeDouble"===g.type&&g.editable)C[f.id]||(C[f.id]={}),C[f.id][g.name]=g}))})):K.forEach(this._totalLayers,x.hitch(this,function(f){f.isTable||(C[f.id]={},K.forEach(f.layerObject.fields,x.hitch(this,function(g){"esriFieldTypeString"===g.type&&(C[f.id]||(C[f.id]=
{}),C[f.id][g.name]=g)})))}));return C},_createLayersAndFields:function(){this._layerAndFieldsApplyOnObj=new u({map:this.map,layerInfos:this.layerInfos,_configInfos:this._configInfos,actionName:"Coordinates",nls:this.nls,prevName:this.prevName,existingGroups:this.existingGroups,layerDetails:this._createLayerFieldsFilter(),appliedOn:this.appliedOn});t.empty(this.tableParentContainer);this._layerAndFieldsApplyOnObj.placeAt(this.tableParentContainer);this._layerAndFieldsApplyOnObj.startup()},deleteGroup:function(){this._layerAndFieldsApplyOnObj.deleteGroup()},
_addCoordinatesSourceOpt:function(){var C=[];C=[{label:this.nls.coordinatesPage.featureLocation,value:"featureLocation"},{label:this.nls.coordinatesPage.myLocation,value:"myLocation"}];return C=this.removeCoordsSourceOption(C)},removeCoordsSourceOption:function(C){K.forEach(C,x.hitch(this,function(f,g){f&&this.isGroup&&(f=this.coordinatesSavedDataTypes[f.value],0===f.LatLong.length&&0===f.MGRS.length&&0===f.MapSpatialReference.length&&C.splice(g,1))}));return C}})})},"widgets/SmartEditor/setting/Address":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-class dojo/text!./Address.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/Message dijit/form/ValidationTextBox dijit/form/Select ./layersAndFieldsApplyOn dojo/on".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C){return F([d,J,b],{baseClass:"jimu-widget-smartEditor-setting-address",templateString:e,_validGeocoderFields:[],ValidFieldsByTypeToApplyOn:{esriFieldTypeOID:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString"],esriFieldTypeSmallInteger:["esriFieldTypeSmallInteger","esriFieldTypeString","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeInteger:["esriFieldTypeSmallInteger",
"esriFieldTypeString","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeDouble:["esriFieldTypeSmallInteger","esriFieldTypeString","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeSingle:["esriFieldTypeSmallInteger","esriFieldTypeString","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID","esriFieldTypeString"],esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString"]},
postCreate:function(){this.inherited(arguments);this._validGeocoderFields=this._getValidGeocoderFields();this._initControls();this.isDelete||this.showDialog();this._createLayersAndFields();this._geocoderSettings&&this._geocoderSettings.url&&"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"!==this._geocoderSettings.url&&a.add(this.attributeInfoNode,"esriCTHidden")},_initControls:function(){this.groupNameTextBox=new p({style:{width:"99%"},required:!0,trim:!0},t.create("div",{},this.groupNameTextBoxNode));
this.groupNameTextBox.validator=x.hitch(this,function(B){return B?B!==this.prevName&&this.editUtils.isDuplicateGroupName(B,this.existingGroupNames)?(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});this.name&&this.groupNameTextBox.set("value",this.name);var f=this._getFieldsOptionsObj(this._validGeocoderFields);this.fieldSelector=new u({style:{width:"99%"},
options:f},t.create("div",{},this.selectNode));if(this._fieldValues&&this._fieldValues.Address&&this._fieldValues.Address.hasOwnProperty("field"))var g=this._fieldValues.Address.field;if(g){var w=!1;K.some(f,x.hitch(this,function(B){if(B.value===g)return w=!0}));w?this.fieldSelector.set("value",g,!1):new n({message:this.nls.addressPage.prevConfigruedFieldChangedMsg})}this.own(C(this.fieldSelector,"change",x.hitch(this,function(){this._createLayersAndFields()})))},showDialog:function(){var f=!1,g=
!1,w=500,B=675;this.isGroup||(a.add(this.groupInfoNode1,"esriCTHidden"),a.add(this.groupInfoNode2,"esriCTHidden"),a.remove(this.addressDijitMainWrapper,"esriCTAddressWidth"),a.add(this.addressDijitMainWrapper,"esriCTFullWidth"),B=600,w=300,g=!0);f=!1;this._fieldValues&&this._fieldValues.Address&&this._fieldValues.Address.hasOwnProperty("enabled")&&(f=this._fieldValues.Address.enabled);var c=new h({titleLabel:this.nls.addressPage.popupTitle,width:B,maxHeight:w,autoHeight:g,content:this,buttons:[{label:this.nls.ok,
onClick:x.hitch(this,function(){var m={},A={};m.enabled=f;m.field=this.fieldSelector.get("value");if(this.isGroup){if(!this.groupNameTextBox.isValid()){this.groupNameTextBox.focus();return}}else delete this._fieldValues.Address.attributeActionGroupName;this._fieldValues.Address||(this._fieldValues.Address={actionName:"Address"});x.mixin(this._fieldValues.Address,m);this.isGroup?(A.name=this.groupNameTextBox.get("value"),A.dataType=m.field,A.attributeInfo=m,A.appliedOn=this._layerAndFieldsApplyOnObj.getCheckedFields(A),
this.emit("groupInfoUpdated",A)):this.emit("attributeActionUpdated");c.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){c.close()})}],onClose:x.hitch(this,function(){})});this.isGroup&&this.groupNameTextBox.focus()},_getFieldsOptionsObj:function(f){var g=[];K.forEach(f,x.hitch(this,function(w){"esriFieldTypeGeometry"!==w.type&&"esriFieldTypeBlob"!==w.type&&"esriFieldTypeRaster"!==w.type&&"esriFieldTypeXML"!==w.type&&g.push({label:w.alias||w.name,value:w.name,
fieldType:w.type})}));return g},_createLayerFieldsFilter:function(){var f={},g=this.fieldSelector.getOptions(this.fieldSelector.value).fieldType;if(g&&this.ValidFieldsByTypeToApplyOn[g]){var w=this.ValidFieldsByTypeToApplyOn[g];K.forEach(this._totalLayers,x.hitch(this,function(B){B.isTable||K.forEach(B.layerObject.fields,x.hitch(this,function(c){-1<w.indexOf(c.type)&&c.editable&&(f[B.id]||(f[B.id]={}),f[B.id][c.name]=c)}))}))}return f},_createLayersAndFields:function(){this._layerAndFieldsApplyOnObj=
new G({map:this.map,layerInfos:this.layerInfos,_configInfos:this._configInfos,actionName:"Address",nls:this.nls,prevName:this.prevName,existingGroups:this.existingGroups,layerDetails:this._createLayerFieldsFilter(),appliedOn:this.appliedOn});t.empty(this.tableParentContainer);this._layerAndFieldsApplyOnObj.placeAt(this.tableParentContainer);this._layerAndFieldsApplyOnObj.startup()},deleteGroup:function(){this._layerAndFieldsApplyOnObj.deleteGroup()},_getValidGeocoderFields:function(){var f=[];this._geocoderSettings&&
this._geocoderSettings.hasOwnProperty("url")&&K.forEach(this._geocoderSettings.fields,x.hitch(this,function(g){f.push(g)}));return f}})})},"widgets/SmartEditor/setting/EditDescription":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/query dojo/text!./EditDescription.html dijit/_TemplatedMixin jimu/BaseWidgetSetting dijit/Editor jimu/dijit/Popup esri/lang dojo/sniff jimu/utils dojo/_base/html jimu/dijit/EditorXssFilter dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage jimu/dijit/EditorChooseImage jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G){return F([e,a],{baseClass:"jimu-widget-smartEditor-edit-description",templateString:t,_configInfo:null,_fieldValid:null,_fieldValidations:null,__layerName:null,postCreate:function(){this.inherited(arguments);this.editorXssFilter=G.getInstance();this._initEditor();this.resize();setTimeout(J.hitch(this,function(){this.resize()}),200)},popupEditDescription:function(){this._editorObj.focus();this._configInfo.editDescription&&null!==this._configInfo.editDescription&&
this._editorObj.set("value",this.editorXssFilter.sanitize(this._configInfo.editDescription));var C=new d({titleLabel:h.substitute({layername:this._layerName},this.nls.editDescriptionPage.title),width:720,maxHeight:700,autoHeight:!0,content:this,buttons:[{label:this.nls.ok,onClick:J.hitch(this,function(){this._configInfo.editDescription=this.editorXssFilter.sanitize(this._getText());this._editorObj.destroy();C.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:J.hitch(this,
function(){this._editorObj.destroy();C.close()})}],onClose:J.hitch(this,function(){})})},_getText:function(){return this._editorObj.get("value")},_initEditor:function(){if(!this._editorObj){this._initEditorPluginsCSS();this._editorObj=new b({plugins:["bold","italic","underline",p.getEditorTextColor("smartEditor"),p.getEditorBackgroundColor("smartEditor"),"|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent"],extraPlugins:["|",
"createLink","unlink","pastefromword","|","undo","redo","|","viewSource","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editText);this.own(x(this._editorObj,"focus",J.hitch(this,function(){})));this.own(x(this._editorObj,"blur",J.hitch(this,function(){})));this._editorObj.onLoadDeferred.then(J.hitch(this,function(){}));
this._editorObj.startup();if(8!==n("ie"))this._editorObj.resize({w:"100%",h:"100%"});else{var C=u.getMarginBox(this.editText);this._editorObj.resize({w:C.w,h:C.h})}this._editorObj.domNode.style.height="245px"}},_initEditorPluginsCSS:function(){var C=document.getElementsByTagName("head")[0];var f=window.apiUrl+"dojox/editor/plugins/resources/css/TextColor.css";K('link[href\x3d"'+f+'"]',C)[0]||p.loadStyleLink("editor_plugins_resources_TextColor",f);f=window.apiUrl+"dojox/editor/plugins/resources/editorPlugins.css";
K('link[href\x3d"'+f+'"]',C)[0]||p.loadStyleLink("editor_plugins_resources_editorPlugins",f);f=window.apiUrl+"dojox/editor/plugins/resources/css/PasteFromWord.css";K('link[href\x3d"'+f+'"]',C)[0]||p.loadStyleLink("editor_plugins_resources_PasteFromWord",f)}})})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L){function R(k){return new c({command:k.name})}function q(k){return new c({buttonClass:B,command:k.name})}x=x("dijit.Editor",N,{plugins:null,extraPlugins:null,constructor:function(){n.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",m]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(p("ie")||p("trident")||p("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new K;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);n.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=t.getLocalization("dijit._editor",
"commands",this.lang);p("webkit")&&d.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new f({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));J.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);e.add(this.iframe.parentNode,"dijitEditorIFrameContainer");e.add(this.iframe,"dijitEditorIFrame");a.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){J.forEach(this._plugins,function(k){k&&k.destroy&&k.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(k,E){var O=n.isString(k)?{name:k}:n.isFunction(k)?{ctor:k}:k;if(!O.setEditor){var l={args:O,plugin:null,editor:this};O.name&&(c.registry[O.name]?l.plugin=c.registry[O.name](O):G.publish(L._scopeName+".Editor.getPlugin",l));if(!l.plugin)try{var y=
O.ctor||n.getObject(O.name)||F(O.name);y&&(l.plugin=new y(O))}catch(M){throw Error(this.id+": cannot find plugin ["+O.name+"]");}if(!l.plugin)throw Error(this.id+": cannot find plugin ["+O.name+"]");k=l.plugin}1<arguments.length?this._plugins[E]=k:this._plugins.push(k);k.setEditor(this);n.isFunction(k.setToolbar)&&k.setToolbar(this.toolbar)},resize:function(k){k&&w.prototype.resize.apply(this,arguments)},layout:function(){var k=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+b.getPadBorderExtents(this.iframe.parentNode).h+
b.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=k+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(k){var E,O=this.document.body,l=O.clientWidth,y=O.clientHeight,M=O.clientLeft,S=O.offsetWidth,Q=O.offsetHeight,V=O.offsetLeft;/^rtl$/i.test(O.dir||"")?l<S&&k.x>l&&k.x<S&&(E=!0):k.x<M&&k.x>V&&(E=!0);E||y<Q&&k.y>y&&k.y<Q&&(E=!0);E||(delete this._cursorToStart,delete this._savedSelection,"BODY"==k.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(k){this.customUndo&&this.endEditing(!0);"BODY"!=k.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(k){this._inEditing||(this._inEditing=!0,this._beginEditing(k));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(k){if(!this.customUndo||
"undo"!=k&&"redo"!=k){this.customUndo&&(this.endEditing(),this._beginEditing());var E=this.inherited(arguments);this.customUndo&&this._endEditing();return E}return this[k]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(k){try{var E=this.document.execCommand(k,!1,null);if(p("webkit")&&!E)throw{};}catch(O){E=u.substitute,alert(E(this.commands.systemShortcut,
[this.commands[k],E(this.commands[p("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[k]])])),E=!1}return E},queryCommandEnabled:function(k){return!this.customUndo||"undo"!=k&&"redo"!=k?this.inherited(arguments):"undo"==k?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(k){var E=k.mark,O=k.mark;k=k.isCollapsed;var l;if(O)if(9>p("ie")||9===p("ie")&&p("quirks"))if(n.isArray(O))E=[],J.forEach(O,function(S){E.push(D.getNode(S,this.editNode))},this),this.selection.moveToBookmark({mark:E,
isCollapsed:k});else{if(O.startContainer&&O.endContainer&&(l=D.getSelection(this.window))&&l.removeAllRanges){l.removeAllRanges();k=D.create(this.window);var y=D.getNode(O.startContainer,this.editNode);var M=D.getNode(O.endContainer,this.editNode);y&&M&&(k.setStart(y,O.startOffset),k.setEnd(M,O.endOffset),l.addRange(k))}}else(l=D.getSelection(this.window))&&l.removeAllRanges&&(l.removeAllRanges(),k=D.create(this.window),y=D.getNode(O.startContainer,this.editNode),M=D.getNode(O.endContainer,this.editNode),
y&&M&&(k.setStart(y,O.startOffset),k.setEnd(M,O.endOffset),l.addRange(k)))},_changeToStep:function(k,E){this.setValue(E.text);(k=E.bookmark)&&this._moveToBookmark(k)},undo:function(){var k=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var E=this._steps.pop();E&&0<this._steps.length&&(this.focus(),this._changeToStep(E,this._steps[this._steps.length-1]),this._undoedSteps.push(E),this.onDisplayChanged(),delete this._undoRedoActive,k=!0);delete this._undoRedoActive}return k},
redo:function(){var k=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var E=this._undoedSteps.pop();E&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],E),this._steps.push(E),this.onDisplayChanged(),k=!0);delete this._undoRedoActive}return k},endEditing:function(k){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(k),this._inEditing=!1)},_getBookmark:function(){var k=this.selection.getBookmark(),
E=[];if(k&&k.mark){var O=k.mark;if(9>p("ie")||9===p("ie")&&p("quirks")){var l=D.getSelection(this.window);if(n.isArray(O))J.forEach(k.mark,function(M){E.push(D.getIndex(M,this.editNode).o)},this),k.mark=E;else if(l){var y;l.rangeCount&&(y=l.getRangeAt(0));k.mark=y?y.cloneRange():this.selection.getBookmark()}}try{k.mark&&k.mark.startContainer&&(E=D.getIndex(k.mark.startContainer,this.editNode).o,k.mark={startContainer:E,startOffset:k.mark.startOffset,endContainer:k.mark.endContainer===k.mark.startContainer?
E:D.getIndex(k.mark.endContainer,this.editNode).o,endOffset:k.mark.endOffset})}catch(M){k.mark=null}}return k},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:A.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var k=A.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:k,bookmark:this._getBookmark()})},onKeyDown:function(k){p("ie")||this.iframe||k.keyCode!=h.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var E=
k.keyCode;if(k.ctrlKey&&!k.shiftKey&&!k.altKey){if(90==E||122==E){k.stopPropagation();k.preventDefault();this.undo();return}if(89==E||121==E){k.stopPropagation();k.preventDefault();this.redo();return}}this.inherited(arguments);switch(E){case h.ENTER:case h.BACKSPACE:case h.DELETE:this.beginEditing();break;case 88:case 86:if(k.ctrlKey&&!k.altKey&&!k.metaKey){this.endEditing();88==k.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!k.ctrlKey&&!k.altKey&&
!k.metaKey&&(k.keyCode<h.F1||k.keyCode>h.F15)){this.beginEditing();break}case h.ALT:this.endEditing();break;case h.UP_ARROW:case h.DOWN_ARROW:case h.LEFT_ARROW:case h.RIGHT_ARROW:case h.HOME:case h.END:case h.PAGE_UP:case h.PAGE_DOWN:this.endEditing(!0);case h.CTRL:case h.SHIFT:case h.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(k){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(k){this.customUndo?this.isClosed?this.setValue(k):(this.beginEditing(),k||(k="\x26#160;"),this.setValue(k),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(k){this.setValueDeferred.then(n.hitch(this,function(){!this.disabled&&k||!this._buttonEnabledPlugins&&k?
J.forEach(this._plugins,function(E){E.set("disabled",!0)}):this.disabled&&!k&&J.forEach(this._plugins,function(E){E.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(d.set(this.document.body,"color",d.get(this.iframe,"color")),d.set(this.document.body,"background-color",d.get(this.iframe,"background-color")))}catch(k){}}});n.mixin(c.registry,{undo:R,redo:R,cut:R,copy:R,paste:R,insertOrderedList:R,insertUnorderedList:R,
indent:R,outdent:R,justifyCenter:R,justifyFull:R,justifyLeft:R,justifyRight:R,"delete":R,selectAll:R,removeFormat:R,unlink:R,insertHorizontalRule:R,bold:q,italic:q,underline:q,strikethrough:q,subscript:q,superscript:q,"|":function(){return new c({setEditor:function(k){this.editor=k;this.button=new g({ownerDocument:k.ownerDocument})}})}});return x})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(F,J,x,K,t,a,e,b){x("dijit-legacy-requires")&&t(0,function(){F(["dijit/ToolbarSeparator"])});return J("dijit.Toolbar",[a,b,e],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(F,J,x,K){return F("dijit.ToolbarSeparator",[x,K],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);J.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(F,J,x,K,t){J=J("dijit._editor._Plugin",K,{constructor:function(a){this.params=
a||{};x.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:t,disabled:!1,getLabel:function(a){return this.editor.commands[a]},_initButton:function(){if(this.command.length){var a=this.getLabel(this.command),e=this.editor,b=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(a=x.mixin({label:a,ownerDocument:e.ownerDocument,dir:e.dir,
lang:e.lang,showLabel:!1,iconClass:b,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete a.name,this.button=new this.buttonClass(a))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(a,e,b){this.own(F.connect(a,e,this,b))},updateState:function(){var a=this.editor,e=this.command;if(a&&a.isLoaded&&e.length){var b=this.get("disabled");if(this.button)try{var d=
a._implCommand(e);var h=!b&&(this[d]?this[d](e):a.queryCommandEnabled(e));this.enabled!==h&&(this.enabled=h,this.button.set("disabled",!h));if(h&&"boolean"==typeof this.button.checked){var n=a.queryCommandState(e);this.checked!==n&&(this.checked=n,this.button.set("checked",a.queryCommandState(e)))}}catch(p){console.log(p)}}},setEditor:function(a){this.editor=a;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",x.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",x.hitch(this,"updateState")))},setToolbar:function(a){this.button&&a.addChild(this.button)},set:function(a,e){if("object"===typeof a){for(var b in a)this.set(b,a[b]);return this}b=this._getAttrNames(a);if(this[b.s])var d=this[b.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(a,e);return d||this},get:function(a){var e=this._getAttrNames(a);
return this[e.g]?this[e.g]():this[a]},_setDisabledAttr:function(a){this._set("disabled",a);this.updateState()},_getAttrNames:function(a){var e=this._attrPairNames;if(e[a])return e[a];var b=a.charAt(0).toUpperCase()+a.substr(1);return e[a]={s:"_set"+b+"Attr",g:"_get"+b+"Attr"}},_set:function(a,e){this[a]=e}});J.registry={};return J})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n){return F("dijit._editor.plugins.EnterKeyHandling",d,{blockNodeForEnter:"BR",constructor:function(p){p&&("blockNodeForEnter"in p&&(p.blockNodeForEnter=p.blockNodeForEnter.toUpperCase()),K.mixin(this,p))},setEditor:function(p){if(this.editor!==p)if(this.editor=p,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,p.onLoadDeferred.then(K.hitch(this,function(G){this.own(t(p.document,"keydown",K.hitch(this,function(C){if(C.keyCode==x.ENTER){var f=K.mixin({},C);f.shiftKey=
!0;this.handleEnterKey(f)||(C.stopPropagation(),C.preventDefault())}})));9<=a("ie")&&10>=a("ie")&&this.own(t(p.document,"paste",K.hitch(this,function(C){setTimeout(K.hitch(this,function(){var f=this.editor.document.selection.createRange();f.move("character",-1);f.select();f.move("character",1);f.select()}),0)})));return G}));else if(this.blockNodeForEnter){var u=K.hitch(this,"handleEnterKey");p.addKeyHandler(13,0,0,u);p.addKeyHandler(13,0,1,u);this.own(this.editor.on("KeyPressed",K.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var p=this.editor.selection.getAncestorElement("LI");if(p){a("mozilla")&&"LI"==p.parentNode.parentNode.nodeName&&(p=p.parentNode.parentNode);var u=p.firstChild;!u||1!=u.nodeType||"UL"!=u.nodeName&&"OL"!=u.nodeName||(p.insertBefore(u.ownerDocument.createTextNode("\u00a0"),u),u=n.create(this.editor.window),u.setStart(p.firstChild,0),p=n.getSelection(this.editor.window,!0),p.removeAllRanges(),p.addRange(u))}else h.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(p=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(p.innerHTML=this.bogusHtmlContent,9>=a("ie")&&(p=this.editor.document.selection.createRange(),p.move("character",-1),p.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(p){var u,G=this.editor.document,C;if(p.shiftKey){p=this.editor.selection.getParentElement();if(u=n.getAncestor(p,this.blockNodes)){if("LI"==u.tagName)return!0;p=n.getSelection(this.editor.window);var f=p.getRangeAt(0);f.collapsed||(f.deleteContents(),p=n.getSelection(this.editor.window),f=p.getRangeAt(0));if(n.atBeginningOfContainer(u,f.startContainer,f.startOffset)){var g=G.createElement("br");f=n.create(this.editor.window);u.insertBefore(g,
u.firstChild);f.setStartAfter(g);p.removeAllRanges();p.addRange(f)}else if(n.atEndOfContainer(u,f.startContainer,f.startOffset))f=n.create(this.editor.window),g=G.createElement("br"),u.appendChild(g),u.appendChild(G.createTextNode("\u00a0")),f.setStart(u.lastChild,0),p.removeAllRanges(),p.addRange(f);else{if((C=f.startContainer)&&3==C.nodeType){var w=C.nodeValue;var B=G.createTextNode(w.substring(0,f.startOffset));var c=G.createTextNode(w.substring(f.startOffset));u=G.createElement("br");""==c.nodeValue&&
a("webkit")&&(c=G.createTextNode("\u00a0"));J.place(B,C,"after");J.place(u,B,"after");J.place(c,u,"after");J.destroy(C);f=n.create(this.editor.window);f.setStart(c,0);p.removeAllRanges();p.addRange(f);return!1}return!0}}else p=n.getSelection(this.editor.window),p.rangeCount?(f=p.getRangeAt(0))&&f.startContainer&&(f.collapsed||(f.deleteContents(),p=n.getSelection(this.editor.window),f=p.getRangeAt(0)),(C=f.startContainer)&&3==C.nodeType?(u=f.startOffset,C.length<u&&(c=this._adjustNodeAndOffset(C,u),
C=c.node,u=c.offset),w=C.nodeValue,B=G.createTextNode(w.substring(0,u)),c=G.createTextNode(w.substring(u)),u=G.createElement("br"),c.length||(c=G.createTextNode("\u00a0")),B.length?J.place(B,C,"after"):B=C,J.place(u,B,"after"),J.place(c,u,"after"),J.destroy(C)):(0<=f.startOffset&&(g=C.childNodes[f.startOffset]),u=G.createElement("br"),c=G.createTextNode("\u00a0"),g?(J.place(u,g,"before"),J.place(c,u,"after")):(C.appendChild(u),C.appendChild(c))),f=n.create(this.editor.window),f.setStart(c,0),f.setEnd(c,
c.length),p.removeAllRanges(),p.addRange(f),this.editor.selection.collapse(!0)):h.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var m=!0;p=n.getSelection(this.editor.window);f=p.getRangeAt(0);f.collapsed||(f.deleteContents(),p=n.getSelection(this.editor.window),f=p.getRangeAt(0));g=n.getBlockAncestor(f.endContainer,null,this.editor.editNode);var A=g.blockNode;if(this._checkListLater=A&&("LI"==A.nodeName||"LI"==A.parentNode.nodeName))return a("mozilla")&&(this._pressedEnterInBlock=
A),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(A.innerHTML)&&(A.innerHTML="",a("webkit")&&(f=n.create(this.editor.window),f.setStart(A,0),p.removeAllRanges(),p.addRange(f)),this._checkListLater=!1),!0;if(!g.blockNode||g.blockNode===this.editor.editNode){try{h.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(D){}g={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(g.blockNode){if(g.blockNode!=this.editor.editNode&&!(g.blockNode.textContent||g.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(g.blockNode),!1}else g.blockNode=this.editor.editNode;p=n.getSelection(this.editor.window);f=p.getRangeAt(0)}A=G.createElement(this.blockNodeForEnter);A.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(g.blockNode);c=f.endOffset;m=f.endContainer;m.length<c&&(c=this._adjustNodeAndOffset(m,c),m=
c.node,c=c.offset);if(n.atEndOfContainer(g.blockNode,m,c))g.blockNode===g.blockContainer?g.blockNode.appendChild(A):J.place(A,g.blockNode,"after"),m=!1,f=n.create(this.editor.window),f.setStart(A,0),p.removeAllRanges(),p.addRange(f),this.editor.height&&b.scrollIntoView(A);else if(n.atBeginningOfContainer(g.blockNode,f.startContainer,f.startOffset))J.place(A,g.blockNode,g.blockNode===g.blockContainer?"first":"before"),A.nextSibling&&this.editor.height&&(f=n.create(this.editor.window),f.setStart(A.nextSibling,
0),p.removeAllRanges(),p.addRange(f),b.scrollIntoView(A.nextSibling)),m=!1;else{g.blockNode===g.blockContainer?g.blockNode.appendChild(A):J.place(A,g.blockNode,"after");m=!1;g.blockNode.style&&A.style&&g.blockNode.style.cssText&&(A.style.cssText=g.blockNode.style.cssText);if((C=f.startContainer)&&3==C.nodeType){c=f.endOffset;C.length<c&&(c=this._adjustNodeAndOffset(C,c),C=c.node,c=c.offset);w=C.nodeValue;B=G.createTextNode(w.substring(0,c));c=G.createTextNode(w.substring(c,w.length));J.place(B,C,
"before");J.place(c,C,"after");J.destroy(C);for(f=B.parentNode;f!==g.blockNode;){w=G.createElement(f.tagName);f.style&&w.style&&f.style.cssText&&(w.style.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(w.color=f.color),f.face&&(w.face=f.face),f.size&&(w.size=f.size));for(;c;)C=c.nextSibling,w.appendChild(c),c=C;J.place(w,f,"after");B=f;c=w;f=f.parentNode}if(1==c.nodeType||3==c.nodeType&&c.nodeValue)A.innerHTML="";for(B=c;c;)C=c.nextSibling,A.appendChild(c),c=C}f=n.create(this.editor.window);
G=B;if("BR"!==this.blockNodeForEnter){for(;G;)u=G,G=C=G.firstChild;u&&u.parentNode?(A=u.parentNode,f.setStart(A,0),p.removeAllRanges(),p.addRange(f),this.editor.height&&b.scrollIntoView(A),a("mozilla")&&(this._pressedEnterInBlock=g.blockNode)):m=!0}else f.setStart(A,0),p.removeAllRanges(),p.addRange(f),this.editor.height&&b.scrollIntoView(A),a("mozilla")&&(this._pressedEnterInBlock=g.blockNode)}return m},_adjustNodeAndOffset:function(p,u){for(;p.length<u&&p.nextSibling&&3==p.nextSibling.nodeType;)u-=
p.length,p=p.nextSibling;return{node:p,offset:u}},removeTrailingBr:function(p){if(p=/P|DIV|LI/i.test(p.tagName)?p:this.editor.selection.getParentOfType(p,["P","DIV","LI"]))p.lastChild&&(1<p.childNodes.length&&3==p.lastChild.nodeType&&/^[\s\xAD]*$/.test(p.lastChild.nodeValue)||"BR"==p.lastChild.tagName)&&J.destroy(p.lastChild),p.childNodes.length||(p.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R,q,k,E){var O=x("dijit._editor.RichText",[D,N],{constructor:function(l){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};l&&u.isString(l.value)&&(this.value=l.value);this.onLoadDeferred=new K},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[u.trim,u.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);g("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));g("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(g("ie")||g("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[u.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[u.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);B.publish(E._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var l=u.hitch(this,function(S,Q){return function(){return!this.execCommand(S,Q)}}),y={b:l("bold"),i:l("italic"),u:l("underline"),a:l("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:l("formatblock",
"h1"),2:l("formatblock","h2"),3:l("formatblock","h3"),4:l("formatblock","h4"),"\\":l("insertunorderedlist")};g("ie")||(y.Z=l("redo"));for(var M in y)this.addKeyHandler(M,!0,!1,y[M])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(O._editorCommandsLocalized)this._local2NativeFormatNames=O._local2NativeFormatNames,this._native2LocalFormatNames=O._native2LocalFormatNames;else{O._editorCommandsLocalized=!0;O._local2NativeFormatNames={};
O._native2LocalFormatNames={};this._local2NativeFormatNames=O._local2NativeFormatNames;this._native2LocalFormatNames=O._native2LocalFormatNames;for(var l="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),y="",M,S=0;M=l[S++];)y="l"!==M.charAt(1)?y+("\x3c"+M+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+M+"\x3e\x3cbr/\x3e"):y+("\x3c"+M+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+M+"\x3e\x3cbr/\x3e");var Q=b.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:y});this.ownerDocumentBody.appendChild(Q);
l=u.hitch(this,function(){for(var V=Q.firstChild;V;)try{this.selection.selectElement(V.firstChild);var W=V.tagName.toLowerCase();this._local2NativeFormatNames[W]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[W]]=W;V=V.nextSibling.nextSibling}catch(Y){}b.destroy(Q)});this.defer(l)}},open:function(l){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new K;this.isClosed||this.close();B.publish(E._scopeName+"._editor.RichText::open",
this);1===arguments.length&&l.nodeName&&(this.domNode=l);var y=this.domNode;if(u.isString(this.value)){var M=this.value;y.innerHTML=""}else if(y.nodeName&&"textarea"==y.nodeName.toLowerCase()){var S=this.textarea=y;this.name=S.name;M=S.value;y=this.domNode=this.ownerDocument.createElement("div");y.setAttribute("widgetId",this.id);S.removeAttribute("widgetId");y.cssText=S.cssText;y.className+=" "+S.className;b.place(y,S,"before");var Q=u.hitch(this,function(){h.set(S,{display:"block",position:"absolute",
top:"-1000px"});if(g("ie")){var I=S.style;this.__overflow=I.overflow;I.overflow="hidden"}});g("ie")?this.defer(Q,10):Q();if(S.form){var V=S.value;this.reset=function(){this.getValue()!==V&&this.replaceValue(V)};G(S.form,"submit",u.hitch(this,function(){a.set(S,"disabled",this.disabled);S.value=this.getValue()}))}}else M=q.getChildrenHtml(y),y.innerHTML="";this.value=M;y.nodeName&&"LI"===y.nodeName&&(y.innerHTML=" \x3cbr\x3e");this.header=y.ownerDocument.createElement("div");y.appendChild(this.header);
this.editingArea=y.ownerDocument.createElement("div");y.appendChild(this.editingArea);this.footer=y.ownerDocument.createElement("div");y.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!J.useXDomain||J.allowXdRichTextSave)){if((M=t.byId(E._scopeName+"._editor.RichText.value"))&&""!==M.value){Q=M.value.split(this._SEPARATOR);for(var W=0,Y;Y=Q[W++];)if(Y=Y.split(this._NAME_CONTENT_SEP),Y[0]===this.name){this.value=Y[1];Q=Q.splice(W,1);M.value=Q.join(this._SEPARATOR);
break}}O._globalSaveHandler||(O._globalSaveHandler={},c.addOnUnload(function(){for(var I in O._globalSaveHandler){var P=O._globalSaveHandler[I];u.isFunction(P)&&P()}}));O._globalSaveHandler[this.id]=u.hitch(this,"_saveContent")}this.isClosed=!1;M=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");M.id=this.id+"_iframe";M.style.border="none";M.style.width="100%";this._layoutMode?M.style.height="100%":7<=g("ie")?(this.height&&(M.style.height=this.height),this.minHeight&&(M.style.minHeight=
this.minHeight)):M.style.height=this.height?this.height:this.minHeight;M.frameBorder=0;M._loadFunc=u.hitch(this,function(I){this.window=I;this.document=I.document;this.selection=new L.SelectionManager(I);g("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});Q=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");Q=11>g("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+Q+"');document.close()":"javascript: '"+
Q+"'";this.editingArea.appendChild(M);M.src=Q;"LI"===y.nodeName&&(y.lastChild.style.marginTop="-1.2em");e.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var l=h.getComputedStyle(this.domNode);if(this["aria-label"])var y=this["aria-label"];else{var M=C('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||t.byId(this["aria-labelledby"],this.ownerDocument);M&&(y=M.textContent||M.innerHTML||"")}M="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(y?" aria-label\x3d'"+w.escape(y)+"'":"")+"\x3e\x3c/div\x3e";var S=[l.fontWeight,l.fontSize,l.fontFamily].join(" "),Q=l.lineHeight;Q=0<=Q.indexOf("px")?parseFloat(Q)/parseFloat(l.fontSize):0<=Q.indexOf("em")?parseFloat(Q):"normal";var V="",W=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(Y){Y=Y.replace(/^;/ig,"")+";";var I=Y.split(":")[0];if(I){I=u.trim(I);I=I.toLowerCase();var P,X="";for(P=0;P<I.length;P++){var z=I.charAt(P);switch(z){case "-":P++,z=I.charAt(P).toUpperCase();default:X+=
z}}h.set(W.domNode,X,"")}V+=Y+";"});this.iframe.setAttribute("title",y);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||n.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",y?"\x3ctitle\x3e"+w.escape(y)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",S,";\n",this.height||g("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",Q,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",g("ie")||g("trident")||g("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",y?" aria-label\x3d'"+w.escape(y)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+V+"'\x3e",M,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var l=[];this.styleSheets&&(l=this.styleSheets.split(";"),this.styleSheets=
"");l=l.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var y="",M=0,S,Q=A.get(this.ownerDocument);S=l[M++];)S=(new m(Q.location,S)).toString(),this.editingAreaStyleSheets.push(S),y+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+S+'"/\x3e';return y},addStyleSheet:function(l){var y=l.toString(),M=A.get(this.ownerDocument);if("."===y.charAt(0)||"/"!==y.charAt(0)&&!l.host)y=(new m(M.location,y)).toString();-1<F.indexOf(this.editingAreaStyleSheets,y)||(this.editingAreaStyleSheets.push(y),
this.onLoadDeferred.then(u.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(y);else{var S=this.document.getElementsByTagName("head")[0],Q=this.document.createElement("link");Q.rel="stylesheet";Q.type="text/css";Q.href=y;S.appendChild(Q)}})))},removeStyleSheet:function(l){var y=l.toString(),M=A.get(this.ownerDocument);if("."===y.charAt(0)||"/"!==y.charAt(0)&&!l.host)y=(new m(M.location,y)).toString();l=F.indexOf(this.editingAreaStyleSheets,y);-1!==l&&(delete this.editingAreaStyleSheets[l],
C('link[href\x3d"'+y+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(l){l=!!l;this._set("disabled",l);if(this.isLoaded){var y=g("ie")&&(this.isLoaded||!this.focusOnLoad);y&&(this.editNode.unselectable="on");this.editNode.contentEditable=!l;this.editNode.tabIndex=l?"-1":this.tabIndex;y&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(g("mozilla")&&!l&&this._mozSettingProps){l=this._mozSettingProps;for(var M in l)if(l.hasOwnProperty(M))try{this.document.execCommand(M,
!1,l[M])}catch(S){}}this._disabledOK=!0}},onLoad:function(l){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=k.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var y=this;this.beforeIframeNode=b.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=b.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){y.editNode.focus()};this.focusNode=
this.editNode;var M=this.events.concat(this.captureEvents),S=this.iframe?this.document:this.editNode;this.own.apply(this,F.map(M,function(Q){var V=Q.toLowerCase().replace(/^on/,"");return G(S,V,u.hitch(this,Q))},this));this.own(G(S,"mouseup",u.hitch(this,"onClick")));g("ie")&&(this.own(G(this.document,"mousedown",u.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);g("webkit")&&(this._webkitListener=this.own(G(this.document,"mouseup",u.hitch(this,"onDisplayChanged")))[0],this.own(G(this.document,
"mousedown",u.hitch(this,function(Q){Q=Q.target;!Q||Q!==this.document.body&&Q!==this.document||this.defer("placeCursorAtEnd")}))));if(g("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(Q){}this.isLoaded=!0;this.set("disabled",this.disabled);M=u.hitch(this,function(){this.setValue(l);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&f(u.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(M):M()},onKeyDown:function(l){if(l.keyCode===p.SHIFT||l.keyCode===p.ALT||l.keyCode===p.META||l.keyCode===p.CTRL)return!0;l.keyCode===p.TAB&&this.isTabIndent&&(l.stopPropagation(),l.preventDefault(),this.queryCommandEnabled(l.shiftKey?"outdent":"indent")&&this.execCommand(l.shiftKey?"outdent":"indent"));if(l.keyCode==p.TAB&&!this.isTabIndent&&!l.ctrlKey&&!l.altKey)return l.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>g("ie")&&l.keyCode===p.BACKSPACE&&"Control"===this.document.selection.type&&(l.stopPropagation(),l.preventDefault(),this.execCommand("delete"));g("ff")&&(l.keyCode===p.PAGE_UP||l.keyCode===p.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&l.preventDefault();var y=this._keyHandlers[l.keyCode],M=arguments;y&&!l.altKey&&F.some(y,function(S){if(!(S.shift^l.shiftKey||S.ctrl^(l.ctrlKey||l.metaKey)))return S.handler.apply(this,M)||l.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(l){n.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",l)},_setValueAttr:function(l){this.setValue(l)},_setDisableSpellCheckAttr:function(l){this.document?a.set(this.document.body,"spellcheck",!l):this.onLoadDeferred.then(u.hitch(this,function(){a.set(this.document.body,"spellcheck",!l)}));this._set("disableSpellCheck",l)},addKeyHandler:function(l,y,M,S){"string"==
typeof l&&(l=l.toUpperCase().charCodeAt(0));u.isArray(this._keyHandlers[l])||(this._keyHandlers[l]=[]);this._keyHandlers[l].push({shift:M||!1,ctrl:y||!1,handler:S})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(l){this.onDisplayChanged(l)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(l){(g("ie")||g("trident"))&&this.defer(function(){k.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var y=this.getValue(!0);if(y!==this.value)this.onChange(y);
this._set("value",y)},_onFocus:function(l){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!g("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>g("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(l,y){l=l.toLowerCase();"formatblock"===l?g("safari")&&void 0===y&&(l="heading"):"hilitecolor"!==l||g("mozilla")||(l="backcolor");return l},_implCommand:function(l){return"_"+this._normalizeCommand(l)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(l){var y=this._qcaCache[l];return void 0!==y?y:this._qcaCache[l]=this._queryCommandAvailable(l)},_queryCommandAvailable:function(l){switch(l.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return g("ie")||g("trident")||g("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!g("webkit");default:return!1}},execCommand:function(l,y){this.focused&&this.focus();l=this._normalizeCommand(l,y);if(void 0!==y){if("heading"===l)throw Error("unimplemented");"formatblock"===
l&&(g("ie")||g("trident"))&&(y="\x3c"+y+"\x3e")}var M="_"+l+"Impl";if(this[M])var S=this[M](y);else if((y=1<arguments.length?y:null)||"createlink"!==l)S=this.document.execCommand(l,!1,y);this.onDisplayChanged();return S},queryCommandEnabled:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);var y=this._implCommand(l);return this[y]?this[y](l):this._browserQueryCommandEnabled(l)},queryCommandState:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);
try{return this.document.queryCommandState(l)}catch(y){return!1}},queryCommandValue:function(l){if(this.disabled||!this._disabledOK)return!1;l=this._normalizeCommand(l);if(g("ie")&&"formatblock"===l)l=this._native2LocalFormatNames[this.document.queryCommandValue(l)];else if(g("mozilla")&&"hilitecolor"===l){try{var y=this.document.queryCommandValue("styleWithCSS")}catch(M){y=!1}this.document.execCommand("styleWithCSS",!1,!0);l=this.document.queryCommandValue(l);this.document.execCommand("styleWithCSS",
!1,y)}else l=this.document.queryCommandValue(l);return l},_sCall:function(l,y){return this.selection[l].apply(this.selection,y)},placeCursorAtStart:function(){this.focus();var l=!1;if(g("mozilla"))for(var y=this.editNode.firstChild;y;){if(3===y.nodeType){if(0<y.nodeValue.replace(/^\s+|\s+$/g,"").length){l=!0;this.selection.selectElement(y);break}}else if(1===y.nodeType){l=!0;var M=y.tagName?y.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(M)?this.selection.selectElement(y):
this.selection.selectElementChildren(y);break}y=y.nextSibling}else l=!0,this.selection.selectElementChildren(this.editNode);l&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var l=!1;if(g("mozilla"))for(var y=this.editNode.lastChild;y;){if(3===y.nodeType){if(0<y.nodeValue.replace(/^\s+|\s+$/g,"").length){l=!0;this.selection.selectElement(y);break}}else if(1===y.nodeType){l=!0;this.selection.selectElement(y.lastChild||y);break}y=y.previousSibling}else l=!0,this.selection.selectElementChildren(this.editNode);
l&&this.selection.collapse(!1)},getValue:function(l){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,l):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(l){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){l=this._preFilterContent(l);var y=this.isClosed?this.domNode:this.editNode;y.innerHTML=l;this._preDomFilterContent(y)}else this.textarea.value=l;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(u.hitch(this,function(){this.setValue(l)}))},replaceValue:function(l){this.isClosed?this.setValue(l):this.window&&this.window.getSelection&&!g("mozilla")?this.setValue(l):this.window&&this.window.getSelection?(l=this._preFilterContent(l),this.execCommand("selectall"),this.execCommand("inserthtml",l),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(l);this._set("value",this.getValue(!0))},_preFilterContent:function(l){var y=
l;F.forEach(this.contentPreFilters,function(M){M&&(y=M(y))});return y},_preDomFilterContent:function(l){l=l||this.editNode;F.forEach(this.contentDomPreFilters,function(y){y&&u.isFunction(y)&&y(l)},this)},_postFilterContent:function(l,y){if(u.isString(l))var M=l;else l=l||this.editNode,this.contentDomPostFilters.length&&(y&&(l=u.clone(l)),F.forEach(this.contentDomPostFilters,function(S){l=S(l)})),M=q.getChildrenHtml(l);u.trim(M.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(M="");F.forEach(this.contentPostFilters,
function(S){M=S(M)});return M},_saveContent:function(){var l=t.byId(E._scopeName+"._editor.RichText.value");l&&(l.value&&(l.value+=this._SEPARATOR),l.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(l,y){l=l.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");y||(l=l.replace(/'/gm,"\x26#39;"));return l},getNodeHtml:function(l){n.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return q.getNodeHtml(l)},getNodeChildrenHtml:function(l){n.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return q.getChildrenHtml(l)},close:function(l){if(!this.isClosed){arguments.length||(l=!0);l&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);g("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var y=this.textarea.style;y.position="";y.left=y.top="";g("ie")&&(y.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;b.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;e.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);O._globalSaveHandler&&delete O._globalSaveHandler[this.id]},_removeMozBogus:function(l){return l.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(l){l=l.replace(/\sclass="webkit-block-placeholder"/gi,"");l=l.replace(/\sclass="apple-style-span"/gi,
"");return l=l.replace(/<meta charset="utf-8" \/>/gi,"")},_normalizeFontStyle:function(l){return l.replace(/<(\/)?strong([ >])/gi,"\x3c$1b$2").replace(/<(\/)?em([ >])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(l){return l.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(l){if(!l)return!1;
if(g("ie")||g("trident")||g("edge"))return this.focused&&!this.disabled;var y=9>g("ie")?this.document.selection.createRange():this.document;try{return y.queryCommandEnabled(l)}catch(M){return!1}},_createlinkEnabledImpl:function(){var l=!0;return l=g("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var l=!0;return l=g("mozilla")||g("webkit")||g("ie")||g("trident")||g("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var l=!0;return l=g("mozilla")||g("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var l=!0;g("webkit")?((l=this.window.getSelection())&&(l=l.toString()),l=!!l):l=this._browserQueryCommandEnabled("cut");return l},_copyEnabledImpl:function(){var l=!0;g("webkit")?((l=this.window.getSelection())&&(l=l.toString()),l=!!l):l=this._browserQueryCommandEnabled("copy");
return l},_pasteEnabledImpl:function(){var l=!0;return g("webkit")?!0:l=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(l){return g("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,l)},_unlinkImpl:function(l){return this.queryCommandEnabled("unlink")&&(g("mozilla")||g("webkit"))?(l=this.selection.getAncestorElement("a"),this.selection.selectElement(l),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,l)},_hilitecolorImpl:function(l){if(!this._handleTextColorOrProperties("hilitecolor",l))if(g("mozilla")){this.document.execCommand("styleWithCSS",!1,!0);console.log("Executing color command.");var y=this.document.execCommand("hilitecolor",!1,l);this.document.execCommand("styleWithCSS",!1,!1)}else y=this.document.execCommand("hilitecolor",!1,l);return y},_backcolorImpl:function(l){g("ie")&&(l=l?l:null);var y=this._handleTextColorOrProperties("backcolor",l);y||(y=this.document.execCommand("backcolor",
!1,l));return y},_forecolorImpl:function(l){g("ie")&&(l=l?l:null);var y=!1;(y=this._handleTextColorOrProperties("forecolor",l))||(y=this.document.execCommand("forecolor",!1,l));return y},_inserthtmlImpl:function(l){l=this._preFilterContent(l);var y=!0;if(9>g("ie")){var M=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var S=M.item(0);M.length;)M.remove(M.item(0));S.outerHTML=l}else M.pasteHTML(l);M.select()}else if(8>g("trident")){var Q=R.getSelection(this.window);
if(Q&&Q.rangeCount&&Q.getRangeAt){M=Q.getRangeAt(0);M.deleteContents();var V=b.create("div");V.innerHTML=l;for(S=this.document.createDocumentFragment();l=V.firstChild;)var W=S.appendChild(l);M.insertNode(S);W&&(M=M.cloneRange(),M.setStartAfter(W),M.collapse(!1),Q.removeAllRanges(),Q.addRange(M))}}else g("mozilla")&&!l.length?this.selection.remove():y=this.document.execCommand("inserthtml",!1,l);return y},_boldImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),y=this._adaptIEFormatAreaAndExec("bold");
y||(y=this.document.execCommand("bold",!1,l));return y},_italicImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),y=this._adaptIEFormatAreaAndExec("italic");y||(y=this.document.execCommand("italic",!1,l));return y},_underlineImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),y=this._adaptIEFormatAreaAndExec("underline");y||(y=this.document.execCommand("underline",!1,l));return y},_strikethroughImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),
y=this._adaptIEFormatAreaAndExec("strikethrough");y||(y=this.document.execCommand("strikethrough",!1,l));return y},_superscriptImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),y=this._adaptIEFormatAreaAndExec("superscript");y||(y=this.document.execCommand("superscript",!1,l));return y},_subscriptImpl:function(l){var y=!1;if(g("ie")||g("trident"))this._adaptIESelection(),y=this._adaptIEFormatAreaAndExec("subscript");y||(y=this.document.execCommand("subscript",!1,l));return y},
_fontnameImpl:function(l){if(g("ie")||g("trident"))var y=this._handleTextColorOrProperties("fontname",l);y||(y=this.document.execCommand("fontname",!1,l));return y},_fontsizeImpl:function(l){if(g("ie")||g("trident"))var y=this._handleTextColorOrProperties("fontsize",l);y||(y=this.document.execCommand("fontsize",!1,l));return y},_insertorderedlistImpl:function(l){var y=!1;if(g("ie")||g("trident")||g("edge"))y=this._adaptIEList("insertorderedlist",l);y||(y=this.document.execCommand("insertorderedlist",
!1,l));return y},_insertunorderedlistImpl:function(l){var y=!1;if(g("ie")||g("trident")||g("edge"))y=this._adaptIEList("insertunorderedlist",l);y||(y=this.document.execCommand("insertunorderedlist",!1,l));return y},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(l){var y=0;if(l&&l.childNodes){var M;for(M=0;M<l.childNodes.length;M++){var S=d.position(l.childNodes[M]);
y+=S.h}}return y},_isNodeEmpty:function(l,y){return 1===l.nodeType?0<l.childNodes.length?this._isNodeEmpty(l.childNodes[0],y):!0:3===l.nodeType?""===l.nodeValue.substring(y):!1},_removeStartingRangeFromRange:function(l,y){if(l.nextSibling)y.setStart(l.nextSibling,0);else{for(l=l.parentNode;l&&null==l.nextSibling;)l=l.parentNode;l&&y.setStart(l.nextSibling,0)}return y},_adaptIESelection:function(){var l=R.getSelection(this.window);if(l&&l.rangeCount&&!l.isCollapsed){for(var y=l.getRangeAt(0),M=y.startContainer,
S=y.startOffset;3===M.nodeType&&S>=M.length&&M.nextSibling;)S-=M.length,M=M.nextSibling;for(var Q=null;this._isNodeEmpty(M,S)&&M!==Q;)Q=M,y=this._removeStartingRangeFromRange(M,y),M=y.startContainer,S=0;l.removeAllRanges();l.addRange(y)}},_adaptIEFormatAreaAndExec:function(l){var y=R.getSelection(this.window),M=this.document,S;if(l&&y&&y.isCollapsed){if(this.queryCommandValue(l)){l=this._tagNamesForCommand(l);var Q=y.getRangeAt(0);var V=Q.startContainer;if(3===V.nodeType){var W=Q.endOffset;V.length<
W&&(W=this._adjustNodeAndOffset(Y,W),V=W.node,W=W.offset)}for(;V&&V!==this.editNode;){var Y=V.tagName?V.tagName.toLowerCase():"";if(-1<F.indexOf(l,Y)){var I=V;break}V=V.parentNode}if(I&&(Y=Q.startContainer,l=M.createElement(I.tagName),b.place(l,I,"after"),Y&&3===Y.nodeType)){W=Q.endOffset;Y.length<W&&(W=this._adjustNodeAndOffset(Y,W),Y=W.node,W=W.offset);V=Y.nodeValue;Q=M.createTextNode(V.substring(0,W));var P=V.substring(W,V.length);P&&(S=M.createTextNode(P));b.place(Q,Y,"before");if(S){var X=M.createElement("span");
X.className="ieFormatBreakerSpan";b.place(X,Y,"after");b.place(S,X,"after");S=X}b.destroy(Y);W=Q.parentNode;for(Y=[];W!==I;){V=W.tagName;Q={tagName:V};Y.push(Q);V=M.createElement(V);W.style&&V.style&&W.style.cssText&&(V.style.cssText=W.style.cssText,Q.cssText=W.style.cssText);"FONT"===W.tagName&&(W.color&&(V.color=W.color,Q.color=W.color),W.face&&(V.face=W.face,Q.face=W.face),W.size&&(V.size=W.size,Q.size=W.size));W.className&&(V.className=W.className,Q.className=W.className);if(S)for(;S;)Q=S.nextSibling,
V.appendChild(S),S=Q;V.tagName==W.tagName?(X=M.createElement("span"),X.className="ieFormatBreakerSpan",b.place(X,W,"after"),b.place(V,X,"after")):b.place(V,W,"after");Q=W;S=V;W=W.parentNode}if(S){if(1===S.nodeType||3===S.nodeType&&S.nodeValue)l.innerHTML="";for(;S;)Q=S.nextSibling,l.appendChild(S),S=Q}if(Y.length){Q=Y.pop();S=M.createElement(Q.tagName);Q.cssText&&S.style&&(S.style.cssText=Q.cssText);Q.className&&(S.className=Q.className);"FONT"===Q.tagName&&(Q.color&&(S.color=Q.color),Q.face&&(S.face=
Q.face),Q.size&&(S.size=Q.size));for(b.place(S,l,"before");Y.length;)Q=Y.pop(),I=M.createElement(Q.tagName),Q.cssText&&I.style&&(I.style.cssText=Q.cssText),Q.className&&(I.className=Q.className),"FONT"===Q.tagName&&(Q.color&&(I.color=Q.color),Q.face&&(I.face=Q.face),Q.size&&(I.size=Q.size)),S.appendChild(I),S=I;I=M.createTextNode(".");X.appendChild(I);S.appendChild(I)}else X=M.createElement("span"),X.className="ieFormatBreakerSpan",I=M.createTextNode("."),X.appendChild(I),b.place(X,l,"before");S=
R.create(this.window);S.setStart(I,0);S.setEnd(I,I.length);y.removeAllRanges();y.addRange(S);this.selection.collapse(!1);I.parentNode.innerHTML="";l.firstChild||b.destroy(l);return!0}return!1}Q=y.getRangeAt(0);if((Y=Q.startContainer)&&3===Y.nodeType)return W=Q.startOffset,Y.length<W&&(W=this._adjustNodeAndOffset(Y,W),Y=W.node,W=W.offset),V=Y.nodeValue,Q=M.createTextNode(V.substring(0,W)),P=V.substring(W),""!==P&&(S=M.createTextNode(V.substring(W))),X=M.createElement("span"),I=M.createTextNode("."),
X.appendChild(I),Q.length?b.place(Q,Y,"after"):Q=Y,b.place(X,Q,"after"),S&&b.place(S,X,"after"),b.destroy(Y),S=R.create(this.window),S.setStart(I,0),S.setEnd(I,I.length),y.removeAllRanges(),y.addRange(S),M.execCommand(l),b.place(X.firstChild,X,"before"),b.destroy(X),S.setStart(I,0),S.setEnd(I,I.length),y.removeAllRanges(),y.addRange(S),this.selection.collapse(!1),I.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(l){var y=R.getSelection(this.window);if(y.isCollapsed&&y.rangeCount&&
!this.queryCommandValue(l)){var M=y.getRangeAt(0),S=M.startContainer;if(S&&3==S.nodeType&&!M.startOffset)return M="ul","insertorderedlist"===l&&(M="ol"),l=this.document.createElement(M),M=b.create("li",null,l),b.place(l,S,"before"),M.appendChild(S),b.create("br",null,l,"after"),l=R.create(this.window),l.setStart(S,0),l.setEnd(S,S.length),y.removeAllRanges(),y.addRange(l),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(l,y){var M=R.getSelection(this.window),S=this.document,
Q,V;y=y||null;if(l&&M&&M.isCollapsed&&M.rangeCount){var W=M.getRangeAt(0);if((Q=W.startContainer)&&3===Q.nodeType){var Y=W.startOffset;Q.length<Y&&(W=this._adjustNodeAndOffset(Q,Y),Q=W.node,Y=W.offset);var I=Q.nodeValue;W=S.createTextNode(I.substring(0,Y));""!==I.substring(Y)&&(V=S.createTextNode(I.substring(Y)));I=S.createElement("span");Y=S.createTextNode(".");I.appendChild(Y);S=S.createElement("span");I.appendChild(S);W.length?b.place(W,Q,"after"):W=Q;b.place(I,W,"after");V&&b.place(V,I,"after");
b.destroy(Q);Q=R.create(this.window);Q.setStart(Y,0);Q.setEnd(Y,Y.length);M.removeAllRanges();M.addRange(Q);if(g("webkit")){M="color";if("hilitecolor"===l||"backcolor"===l)M="backgroundColor";h.set(I,M,y);this.selection.remove();b.destroy(S);I.innerHTML="\x26#160;";this.selection.selectElement(I);this.focus()}else this.execCommand(l,y),b.place(I.firstChild,I,"before"),b.destroy(I),Q.setStart(Y,0),Q.setEnd(Y,Y.length),M.removeAllRanges(),M.addRange(Q),this.selection.collapse(!1),Y.parentNode.removeChild(Y);
return!0}}return!1},_adjustNodeAndOffset:function(l,y){for(;l.length<y&&l.nextSibling&&3===l.nextSibling.nodeType;)y-=l.length,l=l.nextSibling;return{node:l,offset:y}},_tagNamesForCommand:function(l){return"bold"===l?["b","strong"]:"italic"===l?["i","em"]:"strikethrough"===l?["s","strike"]:"superscript"===l?["sup"]:"subscript"===l?["sub"]:"underline"===l?["u"]:[]},_stripBreakerNodes:function(l){if(this.isLoaded)return C(".ieFormatBreakerSpan",l).forEach(function(y){for(;y.firstChild;)b.place(y.firstChild,
y,"before");b.destroy(y)}),l},_stripTrailingEmptyNodes:function(l){function y(M){return/^(p|div|br)$/i.test(M.nodeName)&&0==M.children.length&&/^[\s\xA0]*$/.test(M.textContent||M.innerText||"")||3===M.nodeType&&/^[\s\xA0]*$/.test(M.nodeValue)}for(;l.lastChild&&y(l.lastChild);)b.destroy(l.lastChild);return l},_setTextDirAttr:function(l){this._set("textDir",l);this.onLoadDeferred.then(u.hitch(this,function(){this.editNode.dir=l}))}});return O})},"dijit/_editor/range":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/lang"],function(F,J,x){var K={getIndex:function(e,b){for(var d=[],h=[],n=e,p,u;e!=b;){var G=0;for(p=e.parentNode;u=p.childNodes[G++];)if(u===e){--G;break}d.unshift(G);h.unshift(G-p.childNodes.length);e=p}if(0<d.length&&3==n.nodeType){for(u=n.previousSibling;u&&3==u.nodeType;)d[d.length-1]--,u=u.previousSibling;for(u=n.nextSibling;u&&3==u.nodeType;)h[h.length-1]++,u=u.nextSibling}return{o:d,r:h}},getNode:function(e,b){if(!x.isArray(e)||0==e.length)return b;var d=b;
F.every(e,function(h){if(0<=h&&h<d.childNodes.length)d=d.childNodes[h];else return d=null,!1;return!0});return d},getCommonAncestor:function(e,b,d){d=d||e.ownerDocument.body;var h=function(u){for(var G=[];u;)if(G.unshift(u),u!==d)u=u.parentNode;else break;return G};e=h(e);b=h(b);h=Math.min(e.length,b.length);for(var n=e[0],p=1;p<h;p++)if(e[p]===b[p])n=e[p];else break;return n},getAncestor:function(e,b,d){for(d=d||e.ownerDocument.body;e&&e!==d;){var h=e.nodeName.toUpperCase();if(b.test(h))return e;
e=e.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(e,b,d){d=d||e.ownerDocument.body;b=b||K.BlockTagNames;for(var h=null,n;e&&e!==d;){var p=e.nodeName.toUpperCase();!h&&b.test(p)&&(h=e);!n&&/^(?:BODY|TD|TH|CAPTION)$/.test(p)&&(n=e);e=e.parentNode}return{blockNode:h,blockContainer:n||e.ownerDocument.body}},atBeginningOfContainer:function(e,b,d){var h=!1,n=0==d;n||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(0,d))&&(n=
!0);if(n)for(h=!0;b&&b!==e;){if(b.previousSibling){h=!1;break}b=b.parentNode}return h},atEndOfContainer:function(e,b,d){var h=!1,n=d==(b.length||b.childNodes.length);n||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(d))&&(n=!0);if(n)for(h=!0;b&&b!==e;){if(b.nextSibling){h=!1;break}b=b.parentNode}return h},adjacentNoneTextNode:function(e,b){var d=e;e=0-e.length||0;for(b=b?"nextSibling":"previousSibling";d&&3==d.nodeType;)e+=d.length,d=d[b];return[d,e]},create:function(e){e=e||window;return e.getSelection?
e.document.createRange():new a},getSelection:function(e,b){if(e.getSelection)return e.getSelection();e=new t.selection(e);b||e._getCurrentSelection();return e}};if(!window.getSelection)var t=K.ie={cachedSelection:{},selection:function(e){this._ranges=[];this.addRange=function(b,d){this._ranges.push(b);d||b._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(b){return this._ranges[b]};this._getCurrentSelection=function(){this.removeAllRanges();
var b=e.document.selection.createRange();b="CONTROL"==e.document.selection.type.toUpperCase()?new a(t.decomposeControlRange(b)):new a(t.decomposeTextRange(b));this.addRange(b,!0),this.isCollapsed=b.collapsed}},decomposeControlRange:function(e){var b=e.item(0),d=e.item(e.length-1);e=b.parentNode;var h=d.parentNode;b=K.getIndex(b,e).o[0];d=K.getIndex(d,h).o[0]+1;return[e,b,h,d]},getEndPoint:function(e,b){var d=e.duplicate();d.collapse(!b);var h="EndTo"+(b?"End":"Start"),n=d.parentElement(),p;if(0<n.childNodes.length)F.every(n.childNodes,
function(C,f){if(3!=C.nodeType)if(d.moveToElementText(C),0<d.compareEndPoints(h,e))if(p&&3==p.nodeType){u=p;var g=!0}else return u=n,G=f,!1;else{if(f==n.childNodes.length-1)return u=n,G=n.childNodes.length,!1}else f==n.childNodes.length-1&&(u=C,g=!0);if(g&&u)return u=(C=K.adjacentNoneTextNode(u)[0])?C.nextSibling:n.firstChild,f=K.adjacentNoneTextNode(u),C=f[0],f=f[1],C?(d.moveToElementText(C),d.collapse(!1)):d.moveToElementText(n),d.setEndPoint(h,e),G=d.text.length-f,!1;p=C;return!0});else{var u=
n;var G=0}b||1!=u.nodeType||G!=u.childNodes.length||(b=u.nextSibling)&&3==b.nodeType&&(u=b,G=0);return[u,G]},setEndPoint:function(e,b,d){e=e.duplicate();var h;if(3!=b.nodeType)if(0<d){if(h=b.childNodes[d-1])if(3==h.nodeType)b=h,d=h.length;else if(h.nextSibling&&3==h.nextSibling.nodeType)b=h.nextSibling,d=0;else{e.moveToElementText(h.nextSibling?h:b);var n=h.parentNode;h=n.insertBefore(h.ownerDocument.createTextNode(" "),h.nextSibling);e.collapse(!1);n.removeChild(h)}}else e.moveToElementText(b),e.collapse(!0);
3==b.nodeType&&(h=K.adjacentNoneTextNode(b),n=h[0],h=h[1],n?(e.moveToElementText(n),e.collapse(!1),"inherit"!=n.contentEditable&&h++):(e.moveToElementText(b.parentNode),e.collapse(!0),e.move("character",1),e.move("character",-1)),d+=h,0<d&&e.move("character",d)!=d&&console.error("Error when moving!"));return e},decomposeTextRange:function(e){var b=t.getEndPoint(e),d=b[0],h=b[1],n=b[0];b=b[1];e.htmlText.length&&(e.htmlText==e.text?b=h+e.text.length:(b=t.getEndPoint(e,!0),n=b[0],b=b[1]));return[d,h,
n,b]},setRange:function(e,b,d,h,n,p){b=t.setEndPoint(e,b,d);e.setEndPoint("StartToStart",b);if(!p)var u=t.setEndPoint(e,h,n);e.setEndPoint("EndToEnd",u||b);return e}},a=K.W3CRange=J(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=
this.startContainer!==this.endContainer?K.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(e,b){b=parseInt(b);if(this.startContainer!==e||this.startOffset!=b)delete this._cachedBookmark,this.startContainer=e,this.startOffset=b,this.endContainer?this._updateInternal():this.setEnd(e,b)},setEnd:function(e,b){b=parseInt(b);if(this.endContainer!==e||this.endOffset!=b)delete this._cachedBookmark,
this.endContainer=e,this.endOffset=b,this.startContainer?this._updateInternal():this.setStart(e,b)},setStartAfter:function(e,b){this._setPoint("setStart",e,b,1)},setStartBefore:function(e,b){this._setPoint("setStart",e,b,0)},setEndAfter:function(e,b){this._setPoint("setEnd",e,b,1)},setEndBefore:function(e,b){this._setPoint("setEnd",e,b,0)},_setPoint:function(e,b,d,h){d=K.getIndex(b,b.parentNode).o;this[e](b.parentNode,d.pop()+h)},_getIERange:function(){var e=(this._body||this.endContainer.ownerDocument.body).createTextRange();
t.setRange(e,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return e},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var e=this.startContainer,b=this._getIERange();3!==e.nodeType||this.startOffset||this.setStartBefore(e);b.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var e=new a([this.startContainer,
this.startOffset,this.endContainer,this.endOffset]);e._body=this._body;return e},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});x.setObject("dijit.range",K);return K})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(F,J,x){var K={};J.setObject("dijit._editor.html",K);var t=K.escapeXml=function(a,e){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,
"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");e||(a=a.replace(/'/gm,"\x26#39;"));return a};K.getNodeHtml=function(a){var e=[];K.getNodeHtmlHelper(a,e);return e.join("")};K.getNodeHtmlHelper=function(a,e){switch(a.nodeType){case 1:var b=a.nodeName.toLowerCase();if(!b||"/"==b.charAt(0))return"";e.push("\x3c",b);var d=[],h={},n;if(x("dom-attributes-explicit")||x("dom-attributes-specified-flag"))for(var p=0;n=a.attributes[p++];){var u=n.name;"_dj"===u.substr(0,3)||x("dom-attributes-specified-flag")&&
!n.specified||u in h||(n=n.value,("src"==u||"href"==u)&&a.getAttribute("_djrealurl")&&(n=a.getAttribute("_djrealurl")),8===x("ie")&&"style"===u&&(n=n.replace("HEIGHT:","height:").replace("WIDTH:","width:")),d.push([u,n]),h[u]=n)}else{var G=(/^input$|^img$/i.test(a.nodeName)?a:a.cloneNode(!1)).outerHTML;h=G.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi);G=G.substr(0,G.indexOf("\x3e"));F.forEach(h,function(C){if(C){var f=C.indexOf("\x3d");if(0<f&&(C=C.substring(0,f),"_dj"!=C.substr(0,3)))if("src"!=C&&"href"!=
C||!a.getAttribute("_djrealurl")){switch(C){case "style":var g=a.style.cssText.toLowerCase();break;case "class":g=a.className;break;case "width":if("img"===b){(f=/width=(\S+)/i.exec(G))&&(g=f[1]);break}case "height":if("img"===b){(f=/height=(\S+)/i.exec(G))&&(g=f[1]);break}default:g=a.getAttribute(C)}null!=g&&d.push([C,g.toString()])}else d.push([C,a.getAttribute("_djrealurl")])}},this)}d.sort(function(C,f){return C[0]<f[0]?-1:C[0]==f[0]?0:1});for(h=0;n=d[h++];)e.push(" ",n[0],'\x3d"',"string"===
typeof n[1]?t(n[1],!0):n[1],'"');switch(b){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":e.push(" /\x3e");break;case "script":e.push("\x3e",a.innerHTML,"\x3c/",b,"\x3e");break;default:e.push("\x3e"),a.hasChildNodes()&&K.getChildrenHtmlHelper(a,e),e.push("\x3c/",b,"\x3e")}break;case 4:case 3:e.push(t(a.nodeValue,!0));break;case 8:e.push("\x3c!--",t(a.nodeValue,!0),"--\x3e");break;default:e.push("\x3c!-- Element not recognized - Type: ",a.nodeType," Name: ",
a.nodeName,"--\x3e")}};K.getChildrenHtml=function(a){var e=[];K.getChildrenHtmlHelper(a,e);return e.join("")};K.getChildrenHtmlHelper=function(a,e){if(a)for(var b=a.childNodes||a,d=!x("ie")||b!==a,h,n=0;h=b[n++];)d&&h.parentNode!=a||K.getNodeHtmlHelper(h,e)};return K})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),function(F,J,x,K,t,a){var e=null,b=F([x,
t],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new a({whiteList:this.whiteList,safeAttrValue:K.hitch(this,function(d,h,n,p){return"style"===h?this.xss.friendlyAttrValue(n).replace(/"/g,"'"):"img"===d&&"src"===h?this.xss.escapeAttrValue(n):this.xss.safeAttrValue(d,h,n,p)}),onTag:K.hitch(this,function(d,h,n){if(n.isWhite&&this._isInWhiteList(d,
this.graphicsWhiteList))return h}),onIgnoreTagAttr:K.hitch(this,function(d,h,n,p){if("data-"===h.substr(0,5))return h+'\x3d"'+this.xss.escapeAttrValue(n)+'"'}),onIgnoreTag:K.hitch(this,function(d,h,n){if("o:"===d.substr(0,2)||"!--[if"===d||"!--[endif]--"===d)return h})},!0);this.xss=this.sanitizer.xss},sanitize:function(d){return this.sanitizer.sanitize(d)},_getWhiteList:function(){var d="title height width class style font-family id align text-align".split(" "),h={div:d,h1:d,h2:d,h3:d,h4:d,h5:d,
h6:d,span:d,p:d,s:d,strong:d,em:d,u:d,ol:d,ul:d,li:d,a:["href","target"].concat(d),img:["src","alt","border"].concat(d),blockquote:d,font:["face","size","color"].concat(d),pre:d,code:d,b:d,i:d,wbr:d,video:"autoplay controls loop muted poster preload".split(" ").concat(d),audio:["autoplay","controls","loop","muted","preload"].concat(d),source:["media","src","type"].concat(d),table:["cellpadding","cellspacing","border"].concat(d),tbody:[].concat(d),tr:["valign"].concat(d),td:["valign","colspan","rowspan",
"nowrap"].concat(d),th:["valign","colspan","rowspan","nowrap"].concat(d),hr:d,html:d,title:d,link:["rel","href"],style:["type"].concat(d),body:d};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],feFuncA:[],feFuncB:[],feFuncG:[],
feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],textPath:[],title:[],tspan:[],
use:[],view:[],object:[],canvas:d};return this._extendObjectOfArrays([h,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size",
"face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],
ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(d){var h={};J.forEach(d,function(n){var p=Object.keys(n);J.forEach(p,function(u){Array.isArray(n[u])&&Array.isArray(h[u])?h[u]=h[u].concat(n[u]):h[u]=n[u]},this)},this);return h},_isInWhiteList:function(d,h){h=Object.keys(h);var n=!1;J.forEach(h,function(p){d===p&&(n=!0)},this);return n}});b.getInstance=function(){null===e&&(e=new b);return e};return b})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u){var G=x("dijit._editor.plugins.LinkDialog",n,{allowUnsafeHtml:!1,linkFilter:[[/</g,"\x26lt;"]],buttonClass:p,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=a.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(f){F("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),a.hitch(this,function(g,w,B){var c=this;this.tag="insertImage"==this.command?"img":"a";g=a.delegate(g.getLocalization("dijit","common",this.lang),g.getLocalization("dijit._editor",
"LinkDialog",this.lang));var m=this.dropDown=this.button.dropDown=new w({title:g[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:a.hitch(this,"setValue"),onOpen:function(){c._onOpenDialog();w.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(a.hitch(c,"_onCloseDialog"),0)}});g.urlRegExp=this.urlRegExp;g.id=B.getUniqueId(this.editor.id);this._uniqueId=g.id;this._setContent(m.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
h.substitute(this.linkDialogTemplate,g));m.startup();this._urlInput=B.byId(this._uniqueId+"_urlInput");this._textInput=B.byId(this._uniqueId+"_textInput");this._setButton=B.byId(this._uniqueId+"_setButton");this.own(B.byId(this._uniqueId+"_cancelButton").on("click",a.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",a.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",a.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=a.hitch(this,function(){var A=this._urlInput.get("value");return this._urlRegExp.test(A)||this._emailRegExp.test(A)});this.own(e(m.domNode,"keydown",a.hitch(this,a.hitch(this,function(A){!A||A.keyCode!=t.ENTER||A.shiftKey||A.metaKey||A.ctrlKey||A.altKey||this._setButton.get("disabled")||(m.onExecute(),m.execute(m.get("value")))}))));f()}))},_checkAndFixInput:function(){var f=this,g=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var w=g,B=!1,c=!1;w&&1<w.length&&(w=a.trim(w),0!==w.indexOf("mailto:")&&(0<w.indexOf("/")?-1===w.indexOf("://")&&"/"!==w.charAt(0)&&w.indexOf("./")&&0!==w.indexOf("../")&&f._hostRxp.test(w)&&(B=!0):f._userAtRxp.test(w)&&(c=!0)));B&&f._urlInput.set("value","http://"+w);c&&f._urlInput.set("value","mailto:"+w);f._setButton.set("disabled",!f._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(a.hitch(this,
function(){this.own(e(this.editor.editNode,"mouseup",a.hitch(this,"_onMouseUp")));this.own(e(this.editor.editNode,"dblclick",a.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(f){this.dropDown.set({parserScope:"dojo",content:f})},_checkValues:function(f){f&&f.urlInput&&(f.urlInput=f.urlInput.replace(/"/g,"\x26quot;"));!this.allowUnsafeHtml&&f&&f.textInput&&("function"===typeof this.linkFilter?f.textInput=this.linkFilter(f.textInput):
J.forEach(this.linkFilter,function(g){f.textInput=f.textInput.replace(g[0],g[1])}));return f},_createlinkEnabledImpl:function(){return!0},setValue:function(f){this._onCloseDialog();if(9>b("ie")){var g=u.getSelection(this.editor.window).getRangeAt(0).endContainer;3===g.nodeType&&(g=g.parentNode);g&&g.nodeName&&g.nodeName.toLowerCase()!==this.tag&&(g=this.editor.selection.getSelectedElement(this.tag));g&&g.nodeName&&g.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(g),
this.editor.execCommand("unlink"))}f=this._checkValues(f);this.editor.execCommand("inserthtml",h.substitute(this.htmlTemplate,f));d("a",this.editor.document).forEach(function(w){w.innerHTML||K.has(w,"name")||w.parentNode.removeChild(w)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(f){if(f&&f.tagName.toLowerCase()===this.tag){var g=f.getAttribute("_djrealurl")||f.getAttribute("href");var w=f.getAttribute("target")||"_self";var B=f.textContent||
f.innerText;this.editor.selection.selectElement(f,!0)}else B=this.editor.selection.getSelectedText();return{urlInput:g||"",textInput:B||"",targetSelect:w||""}},_onOpenDialog:function(){if(b("ie")){var f=u.getSelection(this.editor.window);if(f.rangeCount){var g=f.getRangeAt(0);var w=g.endContainer;3===w.nodeType&&(w=w.parentNode);w&&w.nodeName&&w.nodeName.toLowerCase()!==this.tag&&(w=this.editor.selection.getSelectedElement(this.tag));if(!w||w.nodeName&&w.nodeName.toLowerCase()!==this.tag)(f=this.editor.selection.getAncestorElement(this.tag))&&
f.nodeName&&f.nodeName.toLowerCase()==this.tag?(w=f,this.editor.selection.selectElement(w)):g.startContainer===g.endContainer&&(f=g.startContainer.firstChild)&&f.nodeName&&f.nodeName.toLowerCase()==this.tag&&(w=f,this.editor.selection.selectElement(w))}}else w=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(w))},_onDblClick:function(f){if(f&&f.target&&(f=f.target,(f.tagName?f.tagName.toLowerCase():
"")===this.tag&&K.get(f,"href"))){var g=this.editor;this.editor.selection.selectElement(f);g.onDisplayChanged();g._updateTimer&&(g._updateTimer.remove(),delete g._updateTimer);g.onNormalizedDisplayChanged();var w=this.button;setTimeout(function(){w.set("disabled",!1);w.loadAndOpenDropDown().then(function(){w.dropDown.focus&&w.dropDown.focus()})},10)}},_onMouseUp:function(){if(b("ff")){var f=this.editor.selection.getAncestorElement(this.tag);if(f){var g=u.getSelection(this.editor.window).getRangeAt(0);
if(g.collapsed&&f.childNodes.length){var w=g.cloneRange();w.selectNodeContents(f.childNodes[f.childNodes.length-1]);w.setStart(f.childNodes[0],0);1!==g.compareBoundaryPoints(w.START_TO_START,w)?g.setStartBefore(f):-1!==g.compareBoundaryPoints(w.END_TO_START,w)&&g.setStartAfter(f)}}}}}),C=x("dijit._editor.plugins.ImgLinkDialog",[G],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(f){if(f&&f.tagName.toLowerCase()===this.tag){var g=f.getAttribute("_djrealurl")||f.getAttribute("src");var w=f.getAttribute("alt");this.editor.selection.selectElement(f,!0)}else w=this.editor.selection.getSelectedText();return{urlInput:g||"",textInput:w||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);
this.editor.onLoadDeferred.then(a.hitch(this,function(){this.own(e(this.editor.editNode,"mousedown",a.hitch(this,"_selectTag")))}))},_selectTag:function(f){f&&f.target&&(f=f.target,(f.tagName?f.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(f))},_checkValues:function(f){f&&f.urlInput&&(f.urlInput=f.urlInput.replace(/"/g,"\x26quot;"));f&&f.textInput&&(f.textInput=f.textInput.replace(/"/g,"\x26quot;"));return f},_onDblClick:function(f){if(f&&f.target&&(f=f.target,(f.tagName?
f.tagName.toLowerCase():"")===this.tag&&K.get(f,"src"))){var g=this.editor;this.editor.selection.selectElement(f);g.onDisplayChanged();g._updateTimer&&(g._updateTimer.remove(),delete g._updateTimer);g.onNormalizedDisplayChanged();var w=this.button;setTimeout(function(){w.set("disabled",!1);w.loadAndOpenDropDown().then(function(){w.dropDown.focus&&w.dropDown.focus()})},10)}}});n.registry.createLink=function(f){var g={command:"createLink",allowUnsafeHtml:"allowUnsafeHtml"in f?f.allowUnsafeHtml:!1};
"linkFilter"in f&&(g.linkFilter=f.linkFilter);return new G(g)};n.registry.insertImage=function(){return new C({command:"insertImage"})};G.ImgLinkDialog=C;return G})},"dijit/_editor/plugins/ViewSource":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/dom-attr dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/window ../../focus ../_Plugin ../../form/ToggleButton ../.. ../../registry dojo/i18n!../nls/commands".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w){var B=x("dijit._editor.plugins.ViewSource",C,{stripScripts:!0,stripComments:!0,stripIFrames:!0,stripEventHandlers:!0,readOnly:!1,_fsPlugin:null,toggle:function(){p("webkit")&&(this._vsFocused=!0);this.button.set("checked",!this.button.get("checked"))},_initButton:function(){var c=b.getLocalization("dijit._editor","commands"),m=this.editor;this.button=new f({label:c.viewSource,ownerDocument:m.ownerDocument,dir:m.dir,lang:m.lang,showLabel:!1,iconClass:this.iconClassPrefix+
" "+this.iconClassPrefix+"ViewSource",tabIndex:"-1",onChange:h.hitch(this,"_showSource")});this.button.set("readOnly",!1)},setEditor:function(c){this.editor=c;this._initButton();this.removeValueFilterHandles();this._setValueFilterHandle=J.before(this.editor,"setValue",h.hitch(this,function(m){return[this._filter(m)]}));this._getValueFilterHandle=J.after(this.editor,"getValue",h.hitch(this,function(m){return this._filter(m)}));this.editor.addKeyHandler(d.F12,!0,!0,h.hitch(this,function(m){this.button.focus();
this.toggle();m.stopPropagation();m.preventDefault();setTimeout(h.hitch(this,function(){this.editor.focused&&this.editor.focus()}),100)}))},_showSource:function(c){var m=this.editor,A=m._plugins;this._sourceShown=c;var D=this;try{this.sourceArea||this._createSourceView();if(c)m._sourceQueryCommandEnabled=m.queryCommandEnabled,m.queryCommandEnabled=function(L){return"viewsource"===L.toLowerCase()},this.editor.onDisplayChanged(),F.forEach(A,function(L){!L||L instanceof B||!L.isInstanceOf(C)||L.set("disabled",
!0)}),this._fsPlugin&&(this._fsPlugin._getAltViewNode=function(){return D.sourceArea}),this.sourceArea.value=m.get("value"),this.sourceArea.style.height=m.iframe.style.height,this.sourceArea.style.width=m.iframe.style.width,m.iframe.parentNode.style.position="relative",e.set(m.iframe,{position:"absolute",top:0,visibility:"hidden"}),e.set(this.sourceArea,{display:"block"}),this._resizeHandle=n(window,"resize",h.hitch(this,function(){var L=u.getBox(m.ownerDocument);"_prevW"in this&&"_prevH"in this&&
L.w===this._prevW&&L.h===this._prevH||(this._prevW=L.w,this._prevH=L.h,this._resizer&&(clearTimeout(this._resizer),delete this._resizer),this._resizer=setTimeout(h.hitch(this,function(){delete this._resizer;this._resize()}),10))})),setTimeout(h.hitch(this,this._resize),100),this.editor.onNormalizedDisplayChanged(),this.editor.__oldGetValue=this.editor.getValue,this.editor.getValue=h.hitch(this,function(){var L=this.sourceArea.value;return L=this._filter(L)}),this._setListener=J.after(this.editor,
"setValue",h.hitch(this,function(L){this.sourceArea.value=L||""}),!0);else{if(!m._sourceQueryCommandEnabled)return;this._setListener.remove();delete this._setListener;this._resizeHandle.remove();delete this._resizeHandle;this.editor.__oldGetValue&&(this.editor.getValue=this.editor.__oldGetValue,delete this.editor.__oldGetValue);m.queryCommandEnabled=m._sourceQueryCommandEnabled;if(!this._readOnly){var N=this.sourceArea.value;m.beginEditing();m.set("value",N);m.endEditing()}F.forEach(A,function(L){L&&
L.isInstanceOf(C)&&L.set("disabled",!1)});e.set(this.sourceArea,"display","none");e.set(m.iframe,{position:"relative",visibility:"visible"});delete m._sourceQueryCommandEnabled;this.editor.onDisplayChanged()}setTimeout(h.hitch(this,function(){var L=m.domNode.parentNode;L&&(L=w.getEnclosingWidget(L))&&L.resize&&L.resize();m.resize()}),300)}catch(L){console.log(L)}},updateState:function(){this.button.set("disabled",this.get("disabled"))},_resize:function(){var c=this.editor,m=c.getHeaderHeight(),A=
c.getFooterHeight(),D=a.position(c.domNode),N=a.getPadBorderExtents(c.iframe.parentNode),L=a.getMarginExtents(c.iframe.parentNode),R=a.getPadBorderExtents(c.domNode),q=D.w-R.w;D=D.h-(m+R.h+A);this._fsPlugin&&this._fsPlugin.isFullscreen&&(c=u.getBox(c.ownerDocument),q=c.w-R.w,D=c.h-(m+R.h+A));a.setMarginBox(this.sourceArea,{w:Math.round(q-(N.w+L.w)),h:Math.round(D-(N.h+L.h))})},_createSourceView:function(){var c=this.editor,m=c._plugins;this.sourceArea=t.create("textarea");this.readOnly&&(K.set(this.sourceArea,
"readOnly",!0),this._readOnly=!0);e.set(this.sourceArea,{padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});K.set(this.sourceArea,"aria-label",this.editor.id);t.place(this.sourceArea,c.iframe,"before");p("ie")&&c.iframe.parentNode.lastChild!==c.iframe&&e.set(c.iframe.parentNode.lastChild,{width:"0px",height:"0px",padding:"0px",margin:"0px",borderWidth:"0px",borderStyle:"none"});c._viewsource_oldFocus=c.focus;var A=this;c.focus=function(){if(A._sourceShown)A.setSourceAreaCaret();else try{this._vsFocused?
(delete this._vsFocused,G.focus(c.editNode)):c._viewsource_oldFocus()}catch(L){console.log("ViewSource focus code error: "+L)}};var D,N;for(D=0;D<m.length;D++)if((N=m[D])&&("dijit._editor.plugins.FullScreen"===N.declaredClass||N.declaredClass===g._scopeName+"._editor.plugins.FullScreen")){this._fsPlugin=N;break}this._fsPlugin&&(this._fsPlugin._viewsource_getAltViewNode=this._fsPlugin._getAltViewNode,this._fsPlugin._getAltViewNode=function(){return A._sourceShown?A.sourceArea:this._viewsource_getAltViewNode()});
this.own(n(this.sourceArea,"keydown",h.hitch(this,function(L){this._sourceShown&&L.keyCode==d.F12&&L.ctrlKey&&L.shiftKey&&(this.button.focus(),this.button.set("checked",!1),setTimeout(h.hitch(this,function(){c.focus()}),100),L.stopPropagation(),L.preventDefault())})))},_stripScripts:function(c){c&&(c=c.replace(/<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>/ig,""),c=c.replace(/<\s*script\b([^<>]|\s)*>?/ig,""),c=c.replace(/<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>/ig,""));return c},_stripComments:function(c){c&&
(c=c.replace(/\x3c!--(.|\s){1,}?--\x3e/g,""));return c},_stripIFrames:function(c){c&&(c=c.replace(/<\s*iframe[^>]*>((.|\s)*?)<\\?\/\s*iframe\s*>/ig,""));return c},_stripEventHandlers:function(c){if(c){var m=c.match(/<[a-z]+?\b(.*?on.*?(['"]).*?\2.*?)+>/gim);if(m)for(var A=0,D=m.length;A<D;A++){var N=m[A],L=N.replace(/\s+on[a-z]*\s*=\s*(['"])(.*?)\1/igm,"");c=c.replace(N,L)}}return c},_filter:function(c){c&&(this.stripScripts&&(c=this._stripScripts(c)),this.stripComments&&(c=this._stripComments(c)),
this.stripIFrames&&(c=this._stripIFrames(c)),this.stripEventHandlers&&(c=this._stripEventHandlers(c)));return c},removeValueFilterHandles:function(){this._setValueFilterHandle&&(this._setValueFilterHandle.remove(),delete this._setValueFilterHandle);this._getValueFilterHandle&&(this._getValueFilterHandle.remove(),delete this._getValueFilterHandle)},setSourceAreaCaret:function(){var c=this.sourceArea;G.focus(c);this._sourceShown&&!this.readOnly&&(c.setSelectionRange?c.setSelectionRange(0,0):this.sourceArea.createTextRange&&
(c=c.createTextRange(),c.collapse(!0),c.moveStart("character",-99999),c.moveStart("character",0),c.moveEnd("character",0),c.select()))},destroy:function(){this._resizer&&(clearTimeout(this._resizer),delete this._resizer);this._resizeHandle&&(this._resizeHandle.remove(),delete this._resizeHandle);this._setListener&&(this._setListener.remove(),delete this._setListener);this.removeValueFilterHandles();this.inherited(arguments)}});C.registry.viewSource=C.registry.viewsource=function(c){return new B({readOnly:"readOnly"in
c?c.readOnly:!1,stripComments:"stripComments"in c?c.stripComments:!0,stripScripts:"stripScripts"in c?c.stripScripts:!0,stripIFrames:"stripIFrames"in c?c.stripIFrames:!0,stripEventHandlers:"stripEventHandlers"in c?c.stripEventHandlers:!0})};return B})},"dijit/_editor/plugins/FontChoice":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom-construct dojo/i18n dojo/_base/lang dojo/string dojo/store/Memory ../../registry ../../_Widget ../../_TemplatedMixin ../../_WidgetsInTemplateMixin ../../form/FilteringSelect ../_Plugin ../range dojo/i18n!../nls/FontChoice".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C){F=x("dijit._editor.plugins._FontDropDown",[h,n,p],{label:"",plainText:!1,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${selectId}'\x3e${label}\x3c/label\x3e\x3cinput data-dojo-type\x3d'../../form/FilteringSelect' required\x3d'false' data-dojo-props\x3d'labelType:\"html\", labelAttr:\"label\", searchAttr:\"name\"' class\x3d'${comboClass}' tabIndex\x3d'-1' id\x3d'${selectId}' data-dojo-attach-point\x3d'select' value\x3d''/\x3e\x3c/span\x3e",
contextRequire:F,postMixInProperties:function(){this.inherited(arguments);this.strings=t.getLocalization("dijit._editor","FontChoice");this.label=this.strings[this.command];this.id=d.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.selectId=this.id+"_select";this.inherited(arguments)},postCreate:function(){this.select.set("store",new b({idProperty:"value",data:J.map(this.values,function(c){var m=this.strings[c]||c;return{label:this.getLabel(c,m),name:m,value:c}},this)}));this.select.set("value",
"",!1);this.disabled=this.select.get("disabled")},_setValueAttr:function(c,m){m=!1!==m;this.select.set("value",0>J.indexOf(this.values,c)?"":c,m);m||(this.select._lastValueReported=null)},_getValueAttr:function(){return this.select.get("value")},focus:function(){this.select.focus()},_setDisabledAttr:function(c){this._set("disabled",c);this.select.set("disabled",c)}});var f=x("dijit._editor.plugins._FontNameDropDown",F,{generic:!1,command:"fontName",comboClass:"dijitFontNameCombo",postMixInProperties:function(){this.values||
(this.values=this.generic?["serif","sans-serif","monospace","cursive","fantasy"]:["Arial","Times New Roman","Comic Sans MS","Courier New"]);this.inherited(arguments)},getLabel:function(c,m){return this.plainText?m:"\x3cdiv style\x3d'font-family: "+c+"'\x3e"+m+"\x3c/div\x3e"},_normalizeFontName:function(c){var m=this.values;if(!c||!m)return c;var A=c.split(",");if(1<A.length)for(var D=0,N=A.length;D<N;D++){var L=e.trim(A[D]);if(-1<J.indexOf(m,L))return L}return c},_setValueAttr:function(c,m){m=!1!==
m;c=this._normalizeFontName(c);this.generic&&(c={Arial:"sans-serif",Helvetica:"sans-serif",Myriad:"sans-serif",Times:"serif","Times New Roman":"serif","Comic Sans MS":"cursive","Apple Chancery":"cursive",Courier:"monospace","Courier New":"monospace",Papyrus:"fantasy","Estrangelo Edessa":"cursive",Gabriola:"fantasy"}[c]||c);this.inherited(arguments,[c,m])}}),g=x("dijit._editor.plugins._FontSizeDropDown",F,{command:"fontSize",comboClass:"dijitFontSizeCombo",values:[1,2,3,4,5,6,7],getLabel:function(c,
m){return this.plainText?m:"\x3cfont size\x3d"+c+"'\x3e"+m+"\x3c/font\x3e"},_setValueAttr:function(c,m){m=!1!==m;c.indexOf&&-1!=c.indexOf("px")&&(c={10:1,13:2,16:3,18:4,24:5,32:6,48:7}[parseInt(c,10)]||c);this.inherited(arguments,[c,m])}}),w=x("dijit._editor.plugins._FormatBlockDropDown",F,{command:"formatBlock",comboClass:"dijitFormatBlockCombo",values:"noFormat p h1 h2 h3 pre".split(" "),postCreate:function(){this.inherited(arguments);this.set("value","noFormat",!1)},getLabel:function(c,m){return this.plainText||
"noFormat"==c?m:"\x3c"+c+"\x3e"+m+"\x3c/"+c+"\x3e"},_execCommand:function(c,m,A){if("noFormat"===A){var D;if((m=C.getSelection(c.window))&&0<m.rangeCount&&(A=m.getRangeAt(0),A)){m=A.startContainer;for(D=A.endContainer;m&&m!==c.editNode&&m!==c.document.body&&1!==m.nodeType;)m=m.parentNode;for(;D&&D!==c.editNode&&D!==c.document.body&&1!==D.nodeType;)D=D.parentNode;var N=a.hitch(this,function(k,E){if(k.childNodes&&k.childNodes.length){var O;for(O=0;O<k.childNodes.length;O++){var l=k.childNodes[O];if(1==
l.nodeType&&c.selection.inSelection(l)){var y=l.tagName?l.tagName.toLowerCase():"";-1!==J.indexOf(this.values,y)&&E.push(l);N(l,E)}}}});A=a.hitch(this,function(k){if(k&&k.length){for(c.beginEditing();k.length;)this._removeFormat(c,k.pop());c.endEditing()}});var L=[];if(m==D){for(D=m;D&&D!==c.editNode&&D!==c.document.body;){if(1==D.nodeType){var R=D.tagName?D.tagName.toLowerCase():"";if(-1!==J.indexOf(this.values,R)){var q=D;break}}D=D.parentNode}N(m,L);q&&(L=[q].concat(L))}else for(D=m;c.selection.inSelection(D);)1==
D.nodeType&&(R=D.tagName?D.tagName.toLowerCase():"",-1!==J.indexOf(this.values,R)&&L.push(D),N(D,L)),D=D.nextSibling;A(L);c.onDisplayChanged()}}else c.execCommand(m,A)},_removeFormat:function(c,m){if(c.customUndo){for(;m.firstChild;)K.place(m.firstChild,m,"before");m.parentNode.removeChild(m)}else{c.selection.selectElementChildren(m);var A=c.selection.getSelectedHtml();c.selection.selectElement(m);c.execCommand("inserthtml",A||"")}}}),B=x("dijit._editor.plugins.FontChoice",G,{useDefaultCommand:!1,
_initButton:function(){var c={fontName:f,fontSize:g,formatBlock:w}[this.command],m=this.params;this.params.custom&&(m.values=this.params.custom);var A=this.editor;this.button=new c(a.delegate({dir:A.dir,lang:A.lang},m));this.own(this.button.select.on("change",a.hitch(this,function(D){this.editor.focused&&this.editor.focus();"fontName"==this.command&&-1!=D.indexOf(" ")&&(D="'"+D+"'");this.button._execCommand?this.button._execCommand(this.editor,this.command,D):this.editor.execCommand(this.command,
D)})))},updateState:function(){var c=this.editor,m=this.command;if(c&&c.isLoaded&&m.length&&this.button){var A=this.get("disabled");this.button.set("disabled",A);if(!A){try{var D=c.queryCommandValue(m)||""}catch(L){D=""}(A=a.isString(D)&&(D.match(/'([^']*)'/)||D.match(/"([^"]*)"/)))&&(D=A[1]);"fontSize"!==m||D||(D=3);if("formatBlock"===m)if(D&&"p"!=D)0>J.indexOf(this.button.values,D)&&(D="noFormat");else{D=null;if((m=C.getSelection(this.editor.window))&&0<m.rangeCount&&(m=m.getRangeAt(0)))var N=m.endContainer;
for(;N&&N!==c.editNode&&N!==c.document;){if((m=N.tagName?N.tagName.toLowerCase():"")&&-1<J.indexOf(this.button.values,m)){D=m;break}N=N.parentNode}D||(D="noFormat")}D!==this.button.get("value")&&this.button.set("value",D,!1)}}}});J.forEach(["fontName","fontSize","formatBlock"],function(c){G.registry[c]=function(m){return new B({command:c,plainText:m.plainText})}});B._FontDropDown=F;B._FontNameDropDown=f;B._FontSizeDropDown=g;B._FormatBlockDropDown=w;return B})},"dojox/editor/plugins/Preview":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/Button dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Preview".split(" "),
function(F,J,x,K){var t=F.declare("dojox.editor.plugins.Preview",K,{useDefaultCommand:!1,styles:"",stylesheets:null,iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=F.i18n.getLocalization("dojox.editor.plugins","Preview");this.button=new J.form.Button({label:this._nlsResources.preview,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Preview",tabIndex:"-1",onClick:F.hitch(this,"_preview")})},setEditor:function(a){this.editor=a;this._initButton()},
updateState:function(){this.button.set("disabled",this.get("disabled"))},_preview:function(){try{var a=this.editor.get("value"),e="\t\t\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html; charset\x3dUTF-8'\x3e\n",b;if(this.stylesheets)for(b=0;b<this.stylesheets.length;b++)e+="\t\t\x3clink rel\x3d'stylesheet' type\x3d'text/css' href\x3d'"+this.stylesheets[b]+"'\x3e\n";this.styles&&(e+="\t\t\x3cstyle\x3e"+this.styles+"\x3c/style\x3e\n");a="\x3chtml\x3e\n\t\x3chead\x3e\n"+e+"\t\x3c/head\x3e\n\t\x3cbody\x3e\n"+
a+"\n\t\x3c/body\x3e\n\x3c/html\x3e";var d=window.open("javascript: ''",this._nlsResources.preview,"status\x3d1,menubar\x3d0,location\x3d0,toolbar\x3d0");d.document.open();d.document.write(a);d.document.close()}catch(h){console.warn(h)}}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(a){a.plugin||"preview"!==a.args.name.toLowerCase()||(a.plugin=new t({styles:"styles"in a.args?a.args.styles:"",stylesheets:"stylesheets"in a.args?a.args.stylesheets:null}))});return t})},"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),
function(F,J,x,K,t,a){var e=x("dijit._editor.plugins.TextColor",t,{buttonClass:a,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var b=this;this.button.loadDropDown=function(d){function h(n){b.button.dropDown=new n({dir:b.editor.dir,ownerDocument:b.editor.ownerDocument,value:b.value,onChange:function(p){b.editor.execCommand(b.command,p)},onExecute:function(){b.editor.execCommand(b.command,this.get("value"))}});d()}"string"==
typeof b.colorPicker?F([b.colorPicker],h):h(b.colorPicker)}},updateState:function(){var b=this.editor,d=this.command;if(b&&b.isLoaded&&d.length){if(this.button){var h=this.get("disabled");this.button.set("disabled",h);if(h)return;try{var n=b.queryCommandValue(d)||""}catch(p){n=""}}""==n&&(n="#000000");"transparent"==n&&(n="#ffffff");"string"==typeof n?-1<n.indexOf("rgb")&&(n=J.fromRgb(n).toHex()):(n=((n&255)<<16|n&65280|(n&16711680)>>>16).toString(16),n="#000000".slice(0,7-n.length)+n);this.value=
n;(b=this.button.dropDown)&&b.get&&n!==b.get("value")&&b.set("value",n,!1)}}});t.registry.foreColor=function(b){return new e(b)};t.registry.hiliteColor=function(b){return new e(b)};return e})},"dojox/editor/plugins/ToolbarLineBreak":function(){define("dojo dijit dojox dijit/_Widget dijit/_TemplatedMixin dijit/_editor/_Plugin dojo/_base/declare".split(" "),function(F,J,x,K,t,a,e){var b=e("dojox.editor.plugins.ToolbarLineBreak",[K,t],{templateString:"\x3cspan class\x3d'dijit dijitReset'\x3e\x3cbr\x3e\x3c/span\x3e",
postCreate:function(){F.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin){var h=d.args.name.toLowerCase();if("||"===h||"toolbarlinebreak"===h)d.plugin=new a({button:new b,setEditor:function(n){this.editor=n}})}});return b})},"dojox/editor/plugins/FindReplace":function(){define("dojo dijit dojox dijit/_base/manager dijit/_base/popup dijit/_Widget dijit/_TemplatedMixin dijit/_KeyNavContainer dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/Toolbar dijit/form/CheckBox dijit/form/_TextBoxMixin dijit/form/TextBox dijit/_editor/_Plugin dijit/form/Button dijit/form/DropDownButton dijit/form/ToggleButton ./ToolbarLineBreak dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/FindReplace".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C){F.experimental("dojox.editor.plugins.FindReplace");var f=F.declare("dojox.editor.plugins._FindReplaceCloseBox",[a,e,d],{btnId:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'float: right' class\x3d'dijitInline' tabindex\x3d'-1'\x3e\x3cbutton class\x3d'dijit dijitReset dijitInline' id\x3d'${btnId}' dojoAttachPoint\x3d'button' dojoType\x3d'dijit.form.Button' tabindex\x3d'-1' iconClass\x3d'dijitEditorIconsFindReplaceClose' showLabel\x3d'false'\x3eX\x3c/button\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=J.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.btnId=this.id+"_close";this.inherited(arguments)},startup:function(){this.connect(this.button,"onClick","onClick")},onClick:function(){}}),g=F.declare("dojox.editor.plugins._FindReplaceTextBox",[a,e,d],{textId:"",label:"",toolTip:"",widget:null,widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceTextBox' title\x3d'${tooltip}' tabindex\x3d'-1'\x3e\x3clabel class\x3d'dijitLeft dijitInline' for\x3d'${textId}' tabindex\x3d'-1'\x3e${label}\x3c/label\x3e\x3cinput dojoType\x3d'dijit.form.TextBox' intermediateChanges\x3d'true' class\x3d'focusTextBox' tabIndex\x3d'0' id\x3d'${textId}' dojoAttachPoint\x3d'textBox, focusNode' value\x3d'' dojoAttachEvent\x3d'onKeyPress: _onKeyPress'/\x3e\x3c/span\x3e",
postMixInProperties:function(){this.id=J.getUniqueId(this.declaredClass.replace(/\./g,"_"));this.textId=this.id+"_text";this.inherited(arguments)},postCreate:function(){this.textBox.set("value","");this.disabled=this.textBox.get("disabled");this.connect(this.textBox,"onChange","onChange");F.attr(this.textBox.textbox,"formnovalidate","true")},_setValueAttr:function(m){this.value=m;this.textBox.set("value",m)},focus:function(){this.textBox.focus()},_setDisabledAttr:function(m){this.disabled=m;this.textBox.set("disabled",
m)},onChange:function(m){this.value=m},_onKeyPress:function(m){var A=0,D=0;!m.target||m.ctrlKey||m.altKey||m.shiftKey||(m.keyCode==F.keys.LEFT_ARROW?(A=m.target.selectionStart,D=m.target.selectionEnd,A<D&&(J.selectInputText(m.target,A,A),F.stopEvent(m))):m.keyCode==F.keys.RIGHT_ARROW&&(A=m.target.selectionStart,D=m.target.selectionEnd,A<D&&(J.selectInputText(m.target,D,D),F.stopEvent(m))))}}),w=F.declare("dojox.editor.plugins._FindReplaceCheckBox",[a,e,d],{checkId:"",label:"",tooltip:"",widget:null,
widgetsInTemplate:!0,templateString:"\x3cspan style\x3d'white-space: nowrap' tabindex\x3d'-1' class\x3d'dijit dijitReset dijitInline dijitEditorFindReplaceCheckBox' title\x3d'${tooltip}' \x3e\x3cinput dojoType\x3d'dijit.form.CheckBox' tabIndex\x3d'0' id\x3d'${checkId}' dojoAttachPoint\x3d'checkBox, focusNode' value\x3d''/\x3e\x3clabel tabindex\x3d'-1' class\x3d'dijitLeft dijitInline' for\x3d'${checkId}'\x3e${label}\x3c/label\x3e\x3c/span\x3e",postMixInProperties:function(){this.id=J.getUniqueId(this.declaredClass.replace(/\./g,
"_"));this.checkId=this.id+"_check";this.inherited(arguments)},postCreate:function(){this.checkBox.set("checked",!1);this.disabled=this.checkBox.get("disabled");this.checkBox.isFocusable=function(){return!1}},_setValueAttr:function(m){this.checkBox.set("value",m)},_getValueAttr:function(){return this.checkBox.get("value")},focus:function(){this.checkBox.focus()},_setDisabledAttr:function(m){this.disabled=m;this.checkBox.set("disabled",m)}}),B=F.declare("dojox.editor.plugins._FindReplaceToolbar",n,
{postCreate:function(){this.connectKeyNavHandlers([],[]);this.connect(this.containerNode,"onclick","_onToolbarEvent");this.connect(this.containerNode,"onkeydown","_onToolbarEvent");F.addClass(this.domNode,"dijitToolbar")},addChild:function(m,A){J._KeyNavContainer.superclass.addChild.apply(this,arguments)},_onToolbarEvent:function(m){m.stopPropagation()}}),c=F.declare("dojox.editor.plugins.FindReplace",[C],{buttonClass:J.form.ToggleButton,iconClassPrefix:"dijitEditorIconsFindReplace",editor:null,button:null,
_frToolbar:null,_closeBox:null,_findField:null,_replaceField:null,_findButton:null,_replaceButton:null,_replaceAllButton:null,_caseSensitive:null,_backwards:null,_promDialog:null,_promDialogTimeout:null,_strings:null,_bookmark:null,_initButton:function(){this._strings=F.i18n.getLocalization("dojox.editor.plugins","FindReplace");this.button=new J.form.ToggleButton({label:this._strings.findReplace,showLabel:!1,iconClass:this.iconClassPrefix+" dijitEditorIconFindString",tabIndex:"-1",onChange:F.hitch(this,
"_toggleFindReplace")});F.isOpera&&this.button.set("disabled",!0);this.connect(this.button,"set",F.hitch(this,function(m,A){"disabled"===m&&this._toggleFindReplace(!A&&this._displayed,!0,!0)}))},setEditor:function(m){this.editor=m;this._initButton()},toggle:function(){this.button.set("checked",!this.button.get("checked"))},_toggleFindReplace:function(m,A,D){var N=F.marginBox(this.editor.domNode);m&&!F.isOpera?(F.style(this._frToolbar.domNode,"display","block"),this._populateFindField(),A||(this._displayed=
!0)):(F.style(this._frToolbar.domNode,"display","none"),A||(this._displayed=!1),D||this.editor.focus());this.editor.resize({h:N.h})},_populateFindField:function(){var m=this.editor._sCall("getSelectedText",[null]);this._findField&&this._findField.textBox&&(m&&this._findField.textBox.set("value",m),this._findField.textBox.focus(),J.selectInputText(this._findField.textBox.focusNode))},setToolbar:function(m){this.inherited(arguments);if(!F.isOpera){var A=this._frToolbar=new B;F.style(A.domNode,"display",
"none");F.place(A.domNode,m.domNode,"after");A.startup();this._closeBox=new f;A.addChild(this._closeBox);this._findField=new g({label:this._strings.findLabel,tooltip:this._strings.findTooltip});A.addChild(this._findField);this._replaceField=new g({label:this._strings.replaceLabel,tooltip:this._strings.replaceTooltip});A.addChild(this._replaceField);A.addChild(new x.editor.plugins.ToolbarLineBreak);this._findButton=new J.form.Button({label:this._strings.findButton,showLabel:!0,iconClass:this.iconClassPrefix+
" dijitEditorIconFind"});this._findButton.titleNode.title=this._strings.findButtonTooltip;A.addChild(this._findButton);this._replaceButton=new J.form.Button({label:this._strings.replaceButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplace"});this._replaceButton.titleNode.title=this._strings.replaceButtonTooltip;A.addChild(this._replaceButton);this._replaceAllButton=new J.form.Button({label:this._strings.replaceAllButton,showLabel:!0,iconClass:this.iconClassPrefix+" dijitEditorIconReplaceAll"});
this._replaceAllButton.titleNode.title=this._strings.replaceAllButtonTooltip;A.addChild(this._replaceAllButton);this._caseSensitive=new w({label:this._strings.matchCase,tooltip:this._strings.matchCaseTooltip});A.addChild(this._caseSensitive);this._backwards=new w({label:this._strings.backwards,tooltip:this._strings.backwardsTooltip});A.addChild(this._backwards);this._findButton.set("disabled",!0);this._replaceButton.set("disabled",!0);this._replaceAllButton.set("disabled",!0);this.connect(this._findField,
"onChange","_checkButtons");this.connect(this._findField,"onKeyDown","_onFindKeyDown");this.connect(this._replaceField,"onKeyDown","_onReplaceKeyDown");this.connect(this._findButton,"onClick","_find");this.connect(this._replaceButton,"onClick","_replace");this.connect(this._replaceAllButton,"onClick","_replaceAll");this.connect(this._closeBox,"onClick","toggle");this._promDialog=new J.TooltipDialog;this._promDialog.startup();this._promDialog.set("content","")}},_checkButtons:function(){this._findField.get("value")?
(this._findButton.set("disabled",!1),this._replaceButton.set("disabled",!1),this._replaceAllButton.set("disabled",!1)):(this._findButton.set("disabled",!0),this._replaceButton.set("disabled",!0),this._replaceAllButton.set("disabled",!0))},_onFindKeyDown:function(m){m.keyCode==F.keys.ENTER&&(this._find(),F.stopEvent(m))},_onReplaceKeyDown:function(m){m.keyCode==F.keys.ENTER&&(this._replace()||this._replace(),F.stopEvent(m))},_find:function(m){var A=this._findField.get("value")||"";if(A){var D=this._caseSensitive.get("value"),
N=this._backwards.get("value");A=this._findText(A,D,N);!A&&m&&(this._promDialog.set("content",F.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextFind})),J.popup.open({popup:this._promDialog,around:this._findButton.domNode}),this._promDialogTimeout=setTimeout(F.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;J.popup.close(this._promDialog)}),3E3),setTimeout(F.hitch(this,function(){this.editor.focus()}),0));return A}return!1},_replace:function(m){var A=
!1,D=this.editor;D.focus();var N=this._findField.get("value")||"",L=this._replaceField.get("value")||"";if(N){var R=this._caseSensitive.get("value"),q=this._backwards.get("value"),k=D._sCall("getSelectedText",[null]);F.isMoz&&(N=F.trim(N),k=F.trim(k));N=this._filterRegexp(N,!R);k&&N.test(k)&&(D.execCommand("inserthtml",L),A=!0,q&&(this._findText(L,R,q),D._sCall("collapse",[!0])));!this._find(!1)&&m&&(this._promDialog.set("content",F.string.substitute(this._strings.eofDialogText,{0:this._strings.eofDialogTextReplace})),
J.popup.open({popup:this._promDialog,around:this._replaceButton.domNode}),this._promDialogTimeout=setTimeout(F.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;J.popup.close(this._promDialog)}),3E3),setTimeout(F.hitch(this,function(){this.editor.focus()}),0));return A}return null},_replaceAll:function(m){var A=0;this._backwards.get("value")?this.editor.placeCursorAtEnd():this.editor.placeCursorAtStart();this._replace(!1)&&A++;var D=F.hitch(this,function(){this._replace(!1)?
(A++,setTimeout(D,10)):m&&(this._promDialog.set("content",F.string.substitute(this._strings.replaceDialogText,{0:""+A})),J.popup.open({popup:this._promDialog,around:this._replaceAllButton.domNode}),this._promDialogTimeout=setTimeout(F.hitch(this,function(){clearTimeout(this._promDialogTimeout);this._promDialogTimeout=null;J.popup.close(this._promDialog)}),3E3),setTimeout(F.hitch(this,function(){this._findField.focus();this._findField.textBox.focusNode.select()}),0))});D()},_findText:function(m,A,
D){var N=this.editor,L=N.window,R=!1;if(m)if(L.find)R=L.find(m,A,D,!1,!1,!1,!1);else{var q=N.document;if(q.selection||L.getSelection)if(this.editor.focus(),N=q.body.createTextRange(),R=N.duplicate(),L.getSelection().getRangeAt(0),(q=q.selection?q.selection.createRange():null)?D?N.setEndPoint("EndToStart",q):N.setEndPoint("StartToEnd",q):this._bookmark&&(L=L.getSelection().toString(),N.moveToBookmark(this._bookmark),N.text!=L?(N=R.duplicate(),this._bookmark=null):(D?R.setEndPoint("EndToStart",N):R.setEndPoint("StartToEnd",
N),N=R.duplicate())),A=A?4:0,D&&(A|=1),R=N.findText(m,N.text.length,A))N.select(),this._bookmark=N.getBookmark()}return R},_filterRegexp:function(m,A){for(var D="",N=null,L=0;L<m.length;L++)switch(N=m.charAt(L),N){case "\\":D+=N;L++;D+=m.charAt(L);break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":D+="\\";default:D+=N}D="^"+D+"$";return A?new RegExp(D,"mi"):new RegExp(D,"m")},updateState:function(){this.button.set("disabled",this.get("disabled"))},
destroy:function(){this.inherited(arguments);this._promDialogTimeout&&(clearTimeout(this._promDialogTimeout),this._promDialogTimeout=null,J.popup.close(this._promDialog));this._frToolbar&&(this._frToolbar.destroyRecursive(),this._frToolbar=null);this._promDialog&&(this._promDialog.destroyRecursive(),this._promDialog=null)}});c._FindReplaceCloseBox=f;c._FindReplaceTextBox=g;c._FindReplaceCheckBox=w;c._FindReplaceToolbar=B;F.subscribe(J._scopeName+".Editor.getPlugin",null,function(m){m.plugin||"findreplace"!==
m.args.name.toLowerCase()||(m.plugin=new c({}))});return c})},"dojox/editor/plugins/PasteFromWord":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/RichText dijit/form/Button dijit/Dialog dojox/html/format dojo/_base/connect dojo/_base/declare dojo/i18n dojo/string dojo/i18n!dojox/editor/plugins/nls/PasteFromWord dojo/i18n!dijit/nls/common dojo/i18n!dijit/_editor/nls/commands".split(" "),function(F,J,x,K){var t=F.declare("dojox.editor.plugins.PasteFromWord",
K,{iconClassPrefix:"dijitAdditionalEditorIcon",width:"400px",height:"300px",_template:"\x3cdiv class\x3d'dijitPasteFromWordEmbeddedRTE'\x3e\x3cdiv style\x3d'width: ${width}; padding-top: 5px; padding-bottom: 5px;'\x3e${instructions}\x3c/div\x3e\x3cdiv id\x3d'${uId}_rte' style\x3d'width: ${width}; height: ${height}'\x3e\x3c/div\x3e\x3ctable style\x3d'width: ${width}' tabindex\x3d'-1'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd align\x3d'center'\x3e\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_paste'\x3e${paste}\x3c/button\x3e\x26nbsp;\x3cbutton type\x3d'button' dojoType\x3d'dijit.form.Button' id\x3d'${uId}_cancel'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",
_filters:[{regexp:/(<meta\s*[^>]*\s*>)|(<\s*link\s* href="file:[^>]*\s*>)|(<\/?\s*\w+:[^>]*\s*>)/gi,handler:""},{regexp:/(?:<style([^>]*)>([\s\S]*?)<\/style>|<link\s+(?=[^>]*rel=['"]?stylesheet)([^>]*?href=(['"])([^>]*?)\4[^>\/]*)\/?>)/gi,handler:""},{regexp:/(class="Mso[^"]*")|(\x3c!--(.|\s){1,}?--\x3e)/gi,handler:""},{regexp:/(<p[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/p[^>]*>)|(<p[^>]*>\s*<font[^>]*>\s*(&nbsp;|\u00A0)*\s*<\/\s*font\s*>\s<\/p[^>]*>)/ig,handler:""},{regexp:/(style="[^"]*mso-[^;][^"]*")|(style="margin:\s*[^;"]*;")/gi,
handler:""},{regexp:/(<\s*script[^>]*>((.|\s)*?)<\\?\/\s*script\s*>)|(<\s*script\b([^<>]|\s)*>?)|(<[^>]*=(\s|)*[("|')]javascript:[^$1][(\s|.)]*[$1][^>]*>)/ig,handler:""},{regexp:/<(\/?)o:p[^>]*>/gi,handler:""}],_initButton:function(){this._filters=this._filters.slice(0);var a=F.i18n.getLocalization("dojox.editor.plugins","PasteFromWord");F.mixin(a,F.i18n.getLocalization("dijit","common"));F.mixin(a,F.i18n.getLocalization("dijit._editor","commands"));this.button=new J.form.Button({label:a.pasteFromWord,
showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"PasteFromWord",tabIndex:"-1",onClick:F.hitch(this,"_openDialog")});this._uId=J.getUniqueId(this.editor.id);a.uId=this._uId;a.width=this.width||"400px";a.height=this.height||"300px";this._dialog=(new J.Dialog({title:a.pasteFromWord})).placeAt(F.body());this._dialog.set("content",F.string.substitute(this._template,a));F.style(F.byId(this._uId+"_rte"),"opacity",.001);this.connect(J.byId(this._uId+"_paste"),"onClick","_paste");this.connect(J.byId(this._uId+
"_cancel"),"onClick","_cancel");this.connect(this._dialog,"onHide","_clearDialog")},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(a){this.editor=a;this._initButton()},_openDialog:function(){this._dialog.show();this._rte||setTimeout(F.hitch(this,function(){this._rte=new J._editor.RichText({height:this.height||"300px"},this._uId+"_rte");this._rte.startup();this._rte.onLoadDeferred.addCallback(F.hitch(this,function(){F.animateProperty({node:this._rte.domNode,
properties:{opacity:{start:.001,end:1}}}).play()}))}),100)},_paste:function(){var a=x.html.format.prettyPrint(this._rte.get("value"));this._dialog.hide();var e;for(e=0;e<this._filters.length;e++){var b=this._filters[e];a=a.replace(b.regexp,b.handler)}a=x.html.format.prettyPrint(a);this.editor.focus();this.editor.execCommand("inserthtml",a)},_cancel:function(){this._dialog.hide()},_clearDialog:function(){this._rte.set("value","")},destroy:function(){this._rte&&this._rte.destroy();this._dialog&&this._dialog.destroyRecursive();
delete this._dialog;delete this._rte;this.inherited(arguments)}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(a){a.plugin||"pastefromword"!==a.args.name.toLowerCase()||(a.plugin=new t({width:"width"in a.args?a.args.width:"400px",height:"height"in a.args?a.args.width:"300px"}))});return t})},"dojox/html/format":function(){define(["dojo/_base/kernel","./entities","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(F,J,x,K,t){var a=F.getObject("dojox.html.format",!0);a.prettyPrint=
function(e,b,d,h,n){var p=[],u=0,G=[],C="\t",f="",g=[],w,B=/[=]([^"']+?)(\s|>)/g,c=/style=("[^"]*"|'[^']*'|\S*)/gi,m=/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi;if(b&&0<b&&10>b)for(C="",w=0;w<b;w++)C+=" ";b=K.doc.createElement("div");b.innerHTML=e;var A=J.encode,D=J.decode,N=b.ownerDocument.createElement("div"),L=function(y){y=y.cloneNode(!1);N.appendChild(y);y=N.innerHTML;N.innerHTML="";return y},R=function(){var y;for(y=0;y<u;y++)p.push(C)},q=function(){p.push("\n")},k=function(y){var M;y=y.split("\n");for(M=
0;M<y.length;M++)y[M]=F.trim(y[M]);y=y.join(" ");y=F.trim(y);if(""!==y){var S=[];if(d&&0<d){var Q="";for(M=0;M<u;M++)Q+=C;M=Q.length;Q=d;for(d>M&&(Q-=M);y;)if(y.length>d){for(M=Q;0<M&&" "!==y.charAt(M);M--);if(!M)for(M=Q;M<y.length&&" "!==y.charAt(M);M++);var V=y.substring(0,M);V=F.trim(V);y=F.trim(y.substring(M==y.length?y.length:M+1,y.length));if(V){var W="";for(M=0;M<u;M++)W+=C;V=W+V+"\n"}S.push(V)}else{W="";for(M=0;M<u;M++)W+=C;y=W+y+"\n";S.push(y);y=null}return S.join("")}W="";for(M=0;M<u;M++)W+=
C;return W+y+"\n"}return""},E=function(y){if(y){var M=y;M&&(M=M.replace(/&quot;/gi,'"'),M=M.replace(/&gt;/gi,"\x3e"),M=M.replace(/&lt;/gi,"\x3c"),M=M.replace(/&amp;/gi,"\x26"));var S;y=0;var Q=M.split("\n"),V=[];for(M=0;M<Q.length;M++){var W=Q[M],Y=-1<W.indexOf("\n");if(W=F.trim(W)){Y=y;for(S=0;S<W.length;S++){var I=W.charAt(S);"{"===I?y++:"}"===I&&(y--,Y=y)}I="";for(S=0;S<u+Y;S++)I+=C;V.push(I+W+"\n")}else Y&&0===M&&V.push("\n")}y=V.join("")}return y},O=function(y){var M=y.nodeName.toLowerCase(),
S=F.trim(L(y));y=S.substring(0,S.indexOf("\x3e")+1);y=y.replace(B,'\x3d"$1"$2');y=y.replace(c,function(V){var W=V.substring(0,6);V=V.substring(6,V.length);var Y=V.charAt(0);V=F.trim(V.substring(1,V.length-1));V=V.split(";");var I=[];x.forEach(V,function(X){if(X=F.trim(X))X=X.substring(0,X.indexOf(":")).toLowerCase()+X.substring(X.indexOf(":"),X.length),I.push(X)});I=I.sort();V=I.join("; ");var P=F.trim(V);return P&&";"!==P?W+Y+(V+";")+Y:""});var Q=[];y=y.replace(m,function(V){Q.push(F.trim(V));return""});
Q=Q.sort();y="\x3c"+M;Q.length&&(y+=" "+Q.join(" "));-1!=S.indexOf("\x3c/")?(G.push(M),y+="\x3e"):(y=n?y+" /\x3e":y+"\x3e",G.push(!1));a:switch(M){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "small":M=!0;break a;default:M=!1}g.push(M);f&&!M&&(p.push(k(f)),f="");M?f+=y:(R(),p.push(y),q(),u++)},l=function(y){var M=y.childNodes;if(M){var S;for(S=0;S<M.length;S++){var Q=M[S];if(1===
Q.nodeType){var V=F.trim(Q.tagName.toLowerCase());t("ie")&&Q.parentNode!=y||V&&"/"===V.charAt(0)||(O(Q),"script"===V?p.push(E(Q.innerHTML)):"pre"===V?(Q=Q.innerHTML,t("mozilla")&&(Q=Q.replace("\x3cbr\x3e","\n"),Q=Q.replace("\x3cpre\x3e",""),Q=Q.replace("\x3c/pre\x3e","")),"\n"!==Q.charAt(Q.length-1)&&(Q+="\n"),p.push(Q)):l(Q),Q=g.pop(),f&&!Q&&(p.push(k(f)),f=""),(V=G.pop())?(V="\x3c/"+V+"\x3e",Q?f+=V:(u--,R(),p.push(V),q())):u--)}else 3===Q.nodeType||4===Q.nodeType?f+=A(Q.nodeValue,h):8===Q.nodeType&&
(Q=D(Q.nodeValue,h),R(),p.push("\x3c!--"),q(),u++,p.push(k(Q)),u--,R(),p.push("--\x3e"),q())}}};l(b);f&&(p.push(k(f)),f="");return p.join("")};return a})},"dojox/editor/plugins/InsertAnchor":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/_base/manager dijit/_editor/range dijit/_Templated dijit/TooltipDialog dijit/form/ValidationTextBox dijit/form/Select dijit/form/Button dijit/form/DropDownButton dojo/_base/declare dojo/i18n dojo/string dojo/NodeList-dom dojox/editor/plugins/ToolbarLineBreak dojo/i18n!dojox/editor/plugins/nls/InsertAnchor dojo/i18n!dijit/nls/common".split(" "),
function(F,J,x,K){var t=F.declare("dojox.editor.plugins.InsertAnchor",K,{htmlTemplate:'\x3ca name\x3d"${anchorInput}" class\x3d"dijitEditorPluginInsertAnchorStyle"\x3e${textInput}\x3c/a\x3e',iconClassPrefix:"dijitAdditionalEditorIcon",_template:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_anchorInput'\x3e${anchor}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_anchorInput' name\x3d'anchorInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' intermediateChanges\x3d'true'\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton dojoType\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${cancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){var a=this,e=F.i18n.getLocalization("dojox.editor.plugins","InsertAnchor",this.lang),b=this.dropDown=new J.TooltipDialog({title:e.title,execute:F.hitch(this,"setValue"),onOpen:function(){a._onOpenDialog();J.TooltipDialog.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(F.hitch(a,"_onCloseDialog"),0)}});this.button=new J.form.DropDownButton({label:e.insertAnchor,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"InsertAnchor",tabIndex:"-1",
dropDown:this.dropDown});e.id=J.getUniqueId(this.editor.id);this._uniqueId=e.id;this.dropDown.set("content",b.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+F.string.substitute(this._template,e));b.startup();this._anchorInput=J.byId(this._uniqueId+"_anchorInput");this._textInput=J.byId(this._uniqueId+"_textInput");this._setButton=J.byId(this._uniqueId+"_setButton");this.connect(J.byId(this._uniqueId+"_cancelButton"),"onClick",function(){this.dropDown.onCancel()});
this._anchorInput&&this.connect(this._anchorInput,"onChange","_checkInput");this._textInput&&this.connect(this._anchorInput,"onChange","_checkInput");this.editor.contentDomPreFilters.push(F.hitch(this,this._preDomFilter));this.editor.contentDomPostFilters.push(F.hitch(this,this._postDomFilter));this._setup()},updateState:function(){this.button.set("disabled",this.get("disabled"))},setEditor:function(a){this.editor=a;this._initButton()},_checkInput:function(){var a=!0;this._anchorInput.isValid()&&
(a=!1);this._setButton.set("disabled",a)},_setup:function(){this.editor.onLoadDeferred.addCallback(F.hitch(this,function(){this.connect(this.editor.editNode,"ondblclick",this._onDblClick);setTimeout(F.hitch(this,function(){this._applyStyles()}),100)}))},getAnchorStyle:function(){var a=F.moduleUrl(x._scopeName,"editor/plugins/resources").toString();if(!a.match(/^https?:\/\//i)&&!a.match(/^file:\/\//i)){var e="/"===a.charAt(0)?F.doc.location.protocol+"//"+F.doc.location.host:this._calcBaseUrl(F.global.location.href);
"/"!==e[e.length-1]&&"/"!==a.charAt(0)&&(e+="/");a=e+a}return"@media screen {\n\t.dijitEditorPluginInsertAnchorStyle {\n\t\tbackground-image: url({MODURL}/images/anchor.gif);\n\t\tbackground-repeat: no-repeat;\n\t\tbackground-position: top left;\n\t\tborder-width: 1px;\n\t\tborder-style: dashed;\n\t\tborder-color: #D0D0D0;\n\t\tpadding-left: 20px;\n\t}\n}\n".replace(/\{MODURL\}/gi,a)},_applyStyles:function(){if(!this._styled)try{this._styled=!0;var a=this.editor.document,e=this.getAnchorStyle();if(F.isIE)a.createStyleSheet("").cssText=
e;else{var b=a.createElement("style");b.appendChild(a.createTextNode(e));a.getElementsByTagName("head")[0].appendChild(b)}}catch(d){}},_calcBaseUrl:function(a){var e=null;null!==a&&(e=a.indexOf("?"),-1!=e&&(a=a.substring(0,e)),e=a.lastIndexOf("/"),e=0<e&&e<a.length?a.substring(0,e):a);return e},_checkValues:function(a){a&&(a.anchorInput&&(a.anchorInput=a.anchorInput.replace(/"/g,"\x26quot;")),a.textInput||(a.textInput="\x26nbsp;"));return a},setValue:function(a){this._onCloseDialog();if(!this.editor.window.getSelection){var e=
J.range.getSelection(this.editor.window).getRangeAt(0).endContainer;3===e.nodeType&&(e=e.parentNode);e&&e.nodeName&&"a"!==e.nodeName.toLowerCase()&&(e=this.editor._sCall("getSelectedElement",["a"]));e&&e.nodeName&&"a"===e.nodeName.toLowerCase()&&this.editor.queryCommandEnabled("unlink")&&(this.editor._sCall("selectElementChildren",[e]),this.editor.execCommand("unlink"))}a=this._checkValues(a);this.editor.execCommand("inserthtml",F.string.substitute(this.htmlTemplate,a))},_onCloseDialog:function(){this.editor.focus()},
_getCurrentValues:function(a){if(a&&"a"===a.tagName.toLowerCase()&&F.attr(a,"name")){var e=F.attr(a,"name");var b=a.textContent||a.innerText;this.editor._sCall("selectElement",[a,!0])}else b=this.editor._sCall("getSelectedText");return{anchorInput:e||"",textInput:b||""}},_onOpenDialog:function(){if(this.editor.window.getSelection)var a=this.editor._sCall("getAncestorElement",["a"]);else a=J.range.getSelection(this.editor.window).getRangeAt(0).endContainer,3===a.nodeType&&(a=a.parentNode),a&&a.nodeName&&
"a"!==a.nodeName.toLowerCase()&&(a=this.editor._sCall("getSelectedElement",["a"]));this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(a){a&&a.target&&(a=a.target,"a"===(a.tagName?a.tagName.toLowerCase():"")&&F.attr(a,"name")&&(this.editor.onDisplayChanged(),this.editor._sCall("selectElement",[a]),setTimeout(F.hitch(this,function(){this.button.set("disabled",!1);this.button.openDropDown();this.button.dropDown.focus&&this.button.dropDown.focus()}),
10)))},_preDomFilter:function(a){F.query("a[name]:not([href])",this.editor.editNode).addClass("dijitEditorPluginInsertAnchorStyle")},_postDomFilter:function(a){a&&F.query("a[name]:not([href])",a).removeClass("dijitEditorPluginInsertAnchorStyle");return a}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(a){if(!a.plugin){var e=a.args.name;e&&(e=e.toLowerCase());"insertanchor"===e&&(a.plugin=new t)}});return t})},"dojox/editor/plugins/Blockquote":function(){define("dojo dijit dojox dijit/_editor/_Plugin dijit/form/ToggleButton dojo/_base/connect dojo/_base/declare dojo/i18n dojo/i18n!dojox/editor/plugins/nls/Blockquote".split(" "),
function(F,J,x,K){var t=F.declare("dojox.editor.plugins.Blockquote",K,{iconClassPrefix:"dijitAdditionalEditorIcon",_initButton:function(){this._nlsResources=F.i18n.getLocalization("dojox.editor.plugins","Blockquote");this.button=new J.form.ToggleButton({label:this._nlsResources.blockquote,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"Blockquote",tabIndex:"-1",onClick:F.hitch(this,"_toggleQuote")})},setEditor:function(a){this.editor=a;this._initButton();this.connect(this.editor,
"onNormalizedDisplayChanged","updateState");a.customUndo=!0},_toggleQuote:function(a){try{var e=this.editor;e.focus();var b=this.button.get("checked"),d=J.range.getSelection(e.window),h,n,p,u;d&&0<d.rangeCount&&(h=d.getRangeAt(0));if(h){e.beginEditing();if(b)if(h.startContainer===h.endContainer){if(this._isRootInline(h.startContainer)){for(p=h.startContainer;p&&p.parentNode!==e.editNode;)p=p.parentNode;for(;p&&p.previousSibling&&(this._isTextElement(p)||1===p.nodeType&&this._isInlineFormat(this._getTagName(p)));)p=
p.previousSibling;p&&1===p.nodeType&&!this._isInlineFormat(this._getTagName(p))&&(p=p.nextSibling);if(p){var G=e.document.createElement("blockquote");F.place(G,p,"after");G.appendChild(p);for(u=G.nextSibling;u&&(this._isTextElement(u)||1===u.nodeType&&this._isInlineFormat(this._getTagName(u)));)G.appendChild(u),u=G.nextSibling}}else{for(var C=h.startContainer;(this._isTextElement(C)||this._isInlineFormat(this._getTagName(C))||"li"===this._getTagName(C))&&C!==e.editNode&&C!==e.document.body;)C=C.parentNode;
C!==e.editNode&&C!==C.ownerDocument.documentElement&&(G=e.document.createElement("blockquote"),F.place(G,C,"after"),G.appendChild(C))}G&&(e._sCall("selectElementChildren",[G]),e._sCall("collapse",[!0]))}else{var f;p=h.startContainer;for(u=h.endContainer;p&&this._isTextElement(p)&&p.parentNode!==e.editNode;)p=p.parentNode;for(f=p;f.nextSibling&&e._sCall("inSelection",[f]);)f=f.nextSibling;u=f;if(u===e.editNode||u===e.document.body){G=e.document.createElement("blockquote");F.place(G,p,"after");var g=
this._getTagName(p);if(this._isTextElement(p)||this._isInlineFormat(g))for(e=p;e&&(this._isTextElement(e)||1===e.nodeType&&this._isInlineFormat(this._getTagName(e)));)G.appendChild(e),e=G.nextSibling;else G.appendChild(p);return}u=u.nextSibling;for(f=p;f&&f!==u;){if(1===f.nodeType){if(g=this._getTagName(f),"br"!==g){if(!window.getSelection&&"p"===g&&this._isEmpty(f)){f=f.nextSibling;continue}this._isInlineFormat(g)?G||(G=e.document.createElement("blockquote"),F.place(G,f,"after")):(G&&this._isEmpty(G)&&
G.parentNode.removeChild(G),G=e.document.createElement("blockquote"),F.place(G,f,"after"));G.appendChild(f);f=G}}else this._isTextElement(f)&&(G||(G=e.document.createElement("blockquote"),F.place(G,f,"after")),G.appendChild(f),f=G);f=f.nextSibling}G&&(this._isEmpty(G)?G.parentNode.removeChild(G):(e._sCall("selectElementChildren",[G]),e._sCall("collapse",[!0])),G=null)}else if(G=!1,h.startContainer===h.endContainer){for(n=h.endContainer;n&&n!==e.editNode&&n!==e.document.body;){if("blockquote"===(n.tagName?
n.tagName.toLowerCase():"")){G=!0;break}n=n.parentNode}if(G){for(var w;n.firstChild;)w=n.firstChild,F.place(w,n,"before");n.parentNode.removeChild(n);w&&(e._sCall("selectElementChildren",[w]),e._sCall("collapse",[!0]))}}else{p=h.startContainer;for(u=h.endContainer;p&&this._isTextElement(p)&&p.parentNode!==e.editNode;)p=p.parentNode;for(h=[];p&&p.nextSibling&&e._sCall("inSelection",[p]);)p.parentNode&&"blockquote"===this._getTagName(p.parentNode)&&(p=p.parentNode),h.push(p),p=p.nextSibling;for(var B=
this._findBlockQuotes(h);B.length;){var c=B.pop();if(c.parentNode){for(;c.firstChild;)F.place(c.firstChild,c,"before");c.parentNode.removeChild(c)}}}e.endEditing()}e.onNormalizedDisplayChanged()}catch(m){}},updateState:function(){var a=this.editor,e=this.get("disabled");if(a&&a.isLoaded&&this.button&&(this.button.set("disabled",e),!e)){e=!1;var b=J.range.getSelection(a.window);if(b&&0<b.rangeCount&&(b=b.getRangeAt(0)))var d=b.endContainer;for(;d&&d!==a.editNode&&d!==a.document;){if("blockquote"===
(d.tagName?d.tagName.toLowerCase():"")){e=!0;break}d=d.parentNode}this.button.set("checked",e)}},_findBlockQuotes:function(a){var e=[];if(a){var b;for(b=0;b<a.length;b++){var d=a[b];1===d.nodeType&&("blockquote"===this._getTagName(d)&&e.push(d),d.childNodes&&0<d.childNodes.length&&(e=e.concat(this._findBlockQuotes(d.childNodes))))}}return e},_getTagName:function(a){var e="";a&&1===a.nodeType&&(e=a.tagName?a.tagName.toLowerCase():"");return e},_isRootInline:function(a){var e=this.editor;if(this._isTextElement(a)&&
a.parentNode===e.editNode||1===a.nodeType&&this._isInlineFormat(a)&&a.parentNode===e.editNode)return!0;if(this._isTextElement(a)&&this._isInlineFormat(this._getTagName(a.parentNode))){for(a=a.parentNode;a&&a!==e.editNode&&this._isInlineFormat(this._getTagName(a));)a=a.parentNode;if(a===e.editNode)return!0}return!1},_isTextElement:function(a){return a&&3===a.nodeType||4===a.nodeType?!0:!1},_isEmpty:function(a){if(a.childNodes){var e=!0,b;for(b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(1===
d.nodeType){if("p"!==this._getTagName(d)||F.trim(d.innerHTML)){e=!1;break}}else if(this._isTextElement(d)){if((d=F.trim(d.nodeValue))&&"\x26nbsp;"!==d&&"\u00a0"!==d){e=!1;break}}else{e=!1;break}}return e}return!0},_isInlineFormat:function(a){switch(a){case "a":case "b":case "strong":case "s":case "strike":case "i":case "u":case "em":case "sup":case "sub":case "span":case "font":case "big":case "cite":case "q":case "img":case "small":return!0;default:return!1}}});F.subscribe(J._scopeName+".Editor.getPlugin",
null,function(a){a.plugin||"blockquote"!==a.args.name.toLowerCase()||(a.plugin=new t({}))});return t})},"dojox/editor/plugins/UploadImage":function(){define("dojo dijit dojox dijit/_editor/_Plugin dojo/_base/connect dojo/_base/declare dojox/form/FileUploader dijit/_editor/_Plugin".split(" "),function(F,J,x,K){F.experimental("dojox.editor.plugins.UploadImage");var t=F.declare("dojox.editor.plugins.UploadImage",K,{tempImageUrl:"",iconClassPrefix:"editorIcon",useDefaultCommand:!1,uploadUrl:"",button:null,
label:"Upload",setToolbar:function(a){this.button.destroy();this.createFileInput();a.addChild(this.button)},_initButton:function(){this.command="uploadImage";this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",arguments);delete this.command},updateState:function(){this.button.set("disabled",this.get("disabled"))},createFileInput:function(){var a=F.create("span",{innerHTML:"."},document.body);F.style(a,{width:"40px",height:"20px",paddingLeft:"8px",paddingRight:"8px"});this.button=
new x.form.FileUploader({isDebug:!0,uploadUrl:this.uploadUrl,uploadOnChange:!0,selectMultipleFiles:!1,baseClass:"dojoxEditorUploadNorm",hoverClass:"dojoxEditorUploadHover",activeClass:"dojoxEditorUploadActive",disabledClass:"dojoxEditorUploadDisabled"},a);this.connect(this.button,"onChange","insertTempImage");this.connect(this.button,"onComplete","onComplete")},onComplete:function(a,e,b){a=a[0];e=F.byId(this.currentImageId,this.editor.document);b=this.downloadPath?this.downloadPath+a.name:a.file;
e.src=b;F.attr(e,"_djrealurl",b);a.width&&(e.width=a.width,e.height=a.height)},insertTempImage:function(){this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+this.tempImageUrl+'" width\x3d"32" height\x3d"32"/\x3e')}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(a){if(!a.plugin)switch(a.args.name){case "uploadImage":a.plugin=new t({url:a.args.url})}});return t})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R){F.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return J("dojox.form.FileUploader",[m,A,D],{swfPath:f.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(N.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();if("flash"==this.uploaderType)var q="createFlashUploader";else this.uploaderType="html",q="createHtmlUploader";this[q]();this.fileListId&&this.connect(d.byId(this.fileListId),"click",function(k){k=k.target.parentNode.parentNode.parentNode;k.id&&-1<k.id.indexOf("file_")&&
this.removeFile(k.id.split("file_")[1])});c.addOnUnload(this,this.destroy)},getHiddenNode:function(q){if(!q)return null;var k=null;for(q=q.parentNode;q&&"body"!=q.tagName.toLowerCase();){if("none"==h.get(q,"display")){k=q;break}q=q.parentNode}return k},getButtonStyle:function(){var q=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(q))&&h.set(this._hiddenNode,"display","block");if(!q&&this.button&&this.button.domNode){var k=!0;q=this.button.domNode.className+" dijitButtonNode";var E=this.getText(b(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=q=G.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+q+'"\x3e'+E+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(q=this.button);p.get(q,"class")&&(this.baseClass+=" "+p.get(q,"class"));p.set(q,"class",this.baseClass);this.norm=this.getStyle(q);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(q,this.baseClass+" "+this.hoverClass,k),this.down=this.getTempNodeStyle(q,this.baseClass+" "+this.activeClass,k),this.dsbl=this.getTempNodeStyle(q,this.baseClass+" "+this.disabledClass,k),this.fhtml={cn:this.getText(q),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(q),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){h.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&h.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
h.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),h.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):G.destroy(this.progNode);
h.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});u.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&u.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(k){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);a.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var q=t.connect(this,"onReady",this,function(){t.disconnect(q);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&h.set(this._hiddenNode,"display","none")},onChange:function(q){},onProgress:function(q){},onComplete:function(q){},onCancel:function(){},onError:function(q){},onReady:function(q){},onLoad:function(q){},submit:function(q){q=q?C.toObject(q):null;this.upload(q);return!1},upload:function(q){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var k=g.byId(this.progressWidgetId).domNode;"none"==h.get(k,"display")&&(this.restoreProgDisplay="none",h.set(k,"display","block"));"hidden"==h.get(k,"visibility")&&(this.restoreProgDisplay="hidden",h.set(k,"visibility","visible"))}q&&!q.target&&(this.postData=q);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(q=0;q<this.fileList.length;q++)k=
this.fileList[q],k.bytesLoaded=0,k.bytesTotal=k.size||1E5,k.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(q,k){var E;for(E=0;E<this.fileList.length;E++)if(this.fileList[E].name==q){k||this.fileList.splice(E,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(q):k||(G.destroy(this.fileInputs[E]),this.fileInputs.splice(E,1),this._renumberInputs());this.fileListId&&G.destroy("file_"+q)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(K.forEach(this._subs,t.unsubscribe,dojo),K.forEach(this._cons,t.disconnect,dojo),this.scrollConnect&&t.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(G.destroy(this._fileInput),G.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(t.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(q){!0===q?("flash"==this.uploaderType?h.set(this.insideNode,"top","-2500px"):h.set(this.insideNode,"display",
"none"),h.set(this.progNode,"display","")):!1===q?(h.set(this.insideNode,{display:"",top:"0"}),h.set(this.progNode,"display","none")):h.set(this.progNode,"width",q*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var q=!1,k=t.connect(this,"_complete",function(){t.disconnect(k);q=!0}),E=0,O=setInterval(x.hitch(this,function(){E+=5;E>this.fhtml.nr.w&&(E=0,q=!0);this._displayProgress(E/this.fhtml.nr.w);q&&(clearInterval(O),setTimeout(x.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(q){"string"==typeof q&&(q=Error(q));this.onError(q)},_addToFileList:function(){if(this.fileListId){var q="";K.forEach(this.fileList,function(k){q+='\x3ctable id\x3d"file_'+k.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+k.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(k.size?Math.ceil(.001*k.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);d.byId(this.fileListId).innerHTML=
q}},_change:function(q){e("ie")&&K.forEach(q,function(k){k.name=k.name.split("\\")[k.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(q):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=q);this._addToFileList();this.onChange(q);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(q){q=
x.isArray(q)?q:[q];K.forEach(q,function(k){k.ERROR&&this._error(k.ERROR)},this);K.forEach(this.fileList,function(k){k.bytesLoaded=1;k.bytesTotal=1;k.percent=100;this._progress(k)},this);K.forEach(this.fileList,function(k){this.removeFile(k.name,!0)},this);this.onComplete(q);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(x.hitch(this,function(){h.set(g.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(q){for(var k=0,E=0,O=0;O<this.fileList.length;O++){var l=this.fileList[O];l.name==q.name&&(l.bytesLoaded=q.bytesLoaded,l.bytesTotal=q.bytesTotal,l.percent=Math.ceil(l.bytesLoaded/l.bytesTotal*100),this.log(l.name,"percent:",l.percent));E+=Math.ceil(.001*l.bytesLoaded);k+=Math.ceil(.001*l.bytesTotal)}q=Math.ceil(E/k*100);this.progressWidgetId&&g.byId(this.progressWidgetId).update({progress:q+"%"});this.showProgress&&this._displayProgress(.01*q);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(q){if(this._disabled!=q){if("flash"==this.uploaderType){if(!this.flashReady){var k=t.connect(this,"onLoad",this,function(){t.disconnect(k);this._setDisabledAttr(q)});return}this._disabled=q;this.flashMovie.doDisable(q)}else this._disabled=q,h.set(this._fileInput,"display",this._disabled?"none":"");u.toggle(this.domNode,this.disabledClass,q)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var q=
b("[tabIndex]"),k=0;k<q.length;k++)if(q[k].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=q[k];break}this.nextFocusObject.focus()},_disconnect:function(){K.forEach(this._cons,t.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&G.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();w.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:x.hitch(this,function(q){this._error("HTML Upload Error:"+q.message)}),load:x.hitch(this,
function(q,k,E){this._complete(q)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();h.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(t.connect(this._fileInput,"mouseover",this,function(q){u.add(this.domNode,this.hoverClass);this.onMouseOver(q)}));this._cons.push(t.connect(this._fileInput,"mouseout",this,function(q){setTimeout(x.hitch(this,
function(){u.remove(this.domNode,this.activeClass);u.remove(this.domNode,this.hoverClass);this.onMouseOut(q);this._checkHtmlCancel("off")}),0)}));this._cons.push(t.connect(this._fileInput,"mousedown",this,function(q){u.add(this.domNode,this.activeClass);u.remove(this.domNode,this.hoverClass);this.onMouseDown(q)}));this._cons.push(t.connect(this._fileInput,"mouseup",this,function(q){u.remove(this.domNode,this.activeClass);this.onMouseUp(q);this.onClick(q);this._checkHtmlCancel("up")}));this._cons.push(t.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var q=this._fileInput.value;q?this._change([{name:q,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&p.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(q){"change"==q&&(this.dialogIsOpen=!1);"up"==q&&(this.dialogIsOpen=!0);if("off"==q){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var q=this.fhtml.nr;h.set(this.insideNode,{width:q.w+"px",height:"middle"==q.va?q.h+"px":"auto",
textAlign:q.ta,paddingTop:q.p[0]+"px",paddingRight:q.p[1]+"px",paddingBottom:q.p[2]+"px",paddingLeft:q.p[3]+"px"});try{h.set(this.insideNode,"lineHeight","inherit")}catch(k){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],b("*",this._formNode).forEach(function(q){G.destroy(q)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>e("ie")||e("ie")&&e("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=g.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=G.create("form",{enctype:"multipart/form-data",method:"post",id:g.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,h.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var q=
this.htmlFieldName;this.selectMultipleFiles&&(q+=this.fileCount,this.fileCount++);p.set(this._fileInput,{id:this.id,name:q,type:"file"});u.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);q=n.getMarginBox(this._fileInput);h.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-q.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var q;this.fileCount=0;K.forEach(this.fileInputs,function(k){q=this.htmlFieldName+this.fileCount;this.fileCount++;
p.set(k,"name",q)},this)}},_setFormStyle:function(){R.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");h.set(this.domNode,{overflow:"hidden",position:"relative"});h.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var q in this.postData)G.create("input",{type:"hidden",name:q,value:this.postData[q]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var q=t.connect(this,"_complete",this,function(){t.disconnect(q);this._displayProgress(!1)})}var k={},E;for(E in this.postData)k[E]=this.postData[E];this.flashMovie.doUpload(k)}catch(O){this._error("FileUploader - Sorry, the SWF failed to initialize."+O)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var q=window.location.href.split("/");q.pop();q=q.join("/")+"/";this.uploadUrl=q+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",q," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");q={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:L.serialize("fh",this.fhtml),fileMask:L.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new N(q,this.insideNode);this.flashObject.onError=x.hitch(function(k){this._error("Flash Error: "+k)});this.flashObject.onReady=x.hitch(this,function(){h.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=x.hitch(this,function(k){this.flashMovie=k;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&p.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(q,k){this._subs.push(t.subscribe(this.id+q,this,k))},urlencode:function(q){return q&&"none"!=q?q.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(q){q=q.tagName.toLowerCase();
return"button"==q||"input"==q},getTextStyle:function(q){var k={};k.ff=h.get(q,"fontFamily");if(k.ff){k.ff=k.ff.replace(", ",",");k.ff=k.ff.replace(/"|'/g,"");k.ff="sans-serif"==k.ff?"Arial":k.ff;k.fw=h.get(q,"fontWeight");k.fi=h.get(q,"fontStyle");k.fs=parseInt(h.get(q,"fontSize"),10);if(-1<h.get(q,"fontSize").indexOf("%"))for(var E=q;E.tagName;){if(-1==h.get(E,"fontSize").indexOf("%")){k.fs=parseInt(h.get(E,"fontSize"),10);break}"body"==E.tagName.toLowerCase()&&(k.fs=.16*parseInt(h.get(E,"fontSize"),
10));E=E.parentNode}k.fc=(new B(h.get(q,"color"))).toHex();k.fc=parseInt(k.fc.substring(1,Infinity),16)}k.lh=h.get(q,"lineHeight");k.ta=h.get(q,"textAlign");k.ta="start"!=k.ta&&k.ta?k.ta:"left";k.va=this.isButton(q)?"middle":k.lh==k.h?"middle":h.get(q,"verticalAlign");return k},getText:function(q){q=x.trim(q.innerHTML);-1<q.indexOf("\x3c")&&(q=escape(q));return q},getStyle:function(q){var k={},E=n.getContentBox(q),O=n.getPadExtents(q);k.p=[O.t,O.w-O.l,O.h-O.t,O.l];k.w=E.w+O.w;k.h=E.h+O.h;k.d=h.get(q,
"display");E=new B(h.get(q,"backgroundColor"));k.bc=0==E.a?"#ffffff":E.toHex();k.bc=parseInt(k.bc.substring(1,Infinity),16);if(E=this.urlencode(h.get(q,"backgroundImage")))k.bi={url:E,rp:h.get(q,"backgroundRepeat"),pos:escape(h.get(q,"backgroundPosition"))},k.bi.pos||(E=h.get(q,"backgroundPositionX"),O=h.get(q,"backgroundPositionY"),k.bi.pos=escape(("left"==E?"0%":"right"==E?"100%":E)+" "+("top"==O?"0%":"bottom"==O?"100%":O)));return x.mixin(k,this.getTextStyle(q))},getTempNodeStyle:function(q,k,
E){if(E){E=G.place("\x3c"+q.tagName+"\x3e\x3cspan\x3e"+q.innerHTML+"\x3c/span\x3e\x3c/"+q.tagName+"\x3e",q.parentNode);var O=E.firstChild;u.add(O,q.className);u.add(E,k);q=this.getStyle(O)}else E=G.place("\x3c"+q.tagName+"\x3e"+q.innerHTML+"\x3c/"+q.tagName+"\x3e",q.parentNode),u.add(E,q.className),u.add(E,k),E.id=q.id,q=this.getStyle(E);G.destroy(E);return q}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u){x.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");a=u._iframeName;a=a.substring(0,a.lastIndexOf("_"));var G=K.delegate(u,{create:function(){return G._frame=u.create.apply(u,arguments)},get:null,post:null,send:function(C){var f=t._ioSetArgs(C,function(A){m&&m.cancel()},function(A){var D=null;A=A.ioArgs;try{var N=A.handleAs;"xml"===N||"html"===N?D=m.response.data:(D=m.response.text,"json"===N?D=J.fromJson(D):"javascript"===N&&(D=x.eval(D)))}catch(L){D=
L}return D},function(A,D){D.ioArgs._hasError=!0;return A}),g=f.ioArgs,w="GET",B=b.byId(C.form);C.method&&"POST"===C.method.toUpperCase()&&B&&(w="POST");C={method:w,handleAs:"json"===C.handleAs||"javascript"===C.handleAs?"text":C.handleAs,form:C.form,query:B?null:C.content,data:B?C.content:null,timeout:C.timeout,ioArgs:g};C.method&&(C.method=C.method.toUpperCase());if(F.ioPublish&&x.publish&&!1!==g.args.ioPublish)var c=p.after(u,"_notifyStart",function(A){A.options.ioArgs===g&&(c.remove(),t._ioNotifyStart(f))},
!0);var m=u(g.url,C,!0);g._callNext=m._callNext;m.then(function(){f.resolve(f)}).otherwise(function(A){f.ioArgs.error=A;f.reject(A)});return f},_iframeOnload:e.global[a+"_onload"]});K.setObject("dojo.io.iframe",G);return G})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(F,J,x,K,t,a,e,b,d){function h(f){f=F.delegate(p,f);if(!("path"in f))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in f||(f.id="dojox-embed-flash-"+n++);return f}var n=0,p={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};if(t("ie")){var u=function(f){f=h(f);if(!f)return null;var g,w=f.path;if(f.vars){var B=[];for(g in f.vars)B.push(encodeURIComponent(g)+"\x3d"+encodeURIComponent(f.vars[g]));f.params.FlashVars=B.join("\x26");delete f.vars}w='\x3cobject id\x3d"'+d.escape(String(f.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
d.escape(String(f.width))+'" height\x3d"'+d.escape(String(f.height))+'"'+(f.style?' style\x3d"'+d.escape(String(f.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+d.escape(String(w))+'" /\x3e';if(f.params)for(g in f.params)w+='\x3cparam name\x3d"'+d.escape(g)+'" value\x3d"'+d.escape(String(f.params[g]))+'" /\x3e';return{id:f.id,markup:w+"\x3c/object\x3e"}};var G=function(){for(var f=10,g=null;!g&&7<f;)try{g=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+f--)}catch(w){}return g?(f=g.GetVariable("$version").split(" ")[1].split(","),
{major:null!=f[0]?parseInt(f[0]):0,minor:null!=f[1]?parseInt(f[1]):0,rev:null!=f[2]?parseInt(f[2]):0}):{major:0,minor:0,rev:0}}();J.addOnWindowUnload(function(){console.warn("***************UNLOAD");var f=function(){};K("object").reverse().style("display","none").forEach(function(g){for(var w in g)if("FlashVars"!=w&&"function"==typeof g[w])try{g[w]=f}catch(B){}})})}else u=function(f){f=h(f);if(!f)return null;var g,w=f.path;if(f.vars){var B=[];for(g in f.vars)B.push(encodeURIComponent(g)+"\x3d"+encodeURIComponent(f.vars[g]));
f.params.flashVars=B.join("\x26");delete f.vars}w='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+d.escape(String(w))+'" id\x3d"'+d.escape(String(f.id))+'" width\x3d"'+d.escape(String(f.width))+'" height\x3d"'+d.escape(String(f.height))+'"'+(f.style?' style\x3d"'+d.escape(String(f.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(f.params)for(g in f.params)w+=" "+d.escape(g)+'\x3d"'+d.escape(String(f.params[g]))+'"';return{id:f.id,markup:w+
" /\x3e"}},G=function(){var f=navigator.plugins["Shockwave Flash"];return f&&f.description?(f=f.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=f[0]?parseInt(f[0]):0,minor:null!=f[1]?parseInt(f[1]):0,rev:null!=f[2]?parseInt(f[2]):0}):{major:0,minor:0,rev:0}}();var C=function(f,g){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=G.major;this.minimumVersion=f.minimumVersion||9;this.domNode=this.movie=this.id=null;g&&(g=a.byId(g));setTimeout(F.hitch(this,function(){if(f.expressInstall||this.available&&this.available>=this.minimumVersion)if(f&&g)this.init(f,g);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};F.extend(C,{onReady:function(f){},onLoad:function(f){},onError:function(f){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(f,g){this.destroy();g=a.byId(g||this.domNode);if(!g)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var w=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;C.initialized&&(this.id=C.place(f,g),this.domNode=g,setTimeout(F.hitch(this,
function(){this.movie=this.byId(this.id,f.doc);this.onReady(this.movie);this._poller=setInterval(F.hitch(this,function(){try{w=this.movie.PercentLoaded()}catch(B){console.warn("this.movie.PercentLoaded() failed",B,this.movie)}if(100==w)this._onload();else if(0==w&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(f){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var f=
F.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),g;for(g in this)f[g]||delete this[g];this._poller?e(this,"Load",this,"_destroy"):this._destroy()}},byId:function(f,g){g=g||document;return g.embeds[f]?g.embeds[f]:g[f]?g[f]:window[f]?window[f]:document[f]?document[f]:null}});F.mixin(C,{minSupported:8,available:G.major,supported:G.major>=G.required,minimumRequired:G.required,version:G,initialized:!1,onInitialize:function(){C.initialized=!0},__ie_markup__:function(f){return u(f)},proxy:function(f,
g){x.forEach(g instanceof Array?g:[g],function(w){this[w]=F.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+w+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+x.map(arguments,function(B){return __flash__toXML(B)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},f)}});C.place=function(f,g){f=u(f);g=a.byId(g);g||(g=b.doc.createElement("div"),g.id=f.id+"-container",b.body().appendChild(g));return f?(g.innerHTML=f.markup,
f.id):null};C.onInitialize();F.setObject("dojox.embed.Flash",C);return C})},"dojox/embed/flashVars":function(){define(["dojo"],function(F){F.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var J={serialize:function(x,K){var t=function(d){"string"==typeof d&&(d=d.replace(/;/g,"_sc_"),d=d.replace(/\./g,"_pr_"),d=d.replace(/:/g,"_cl_"));return d},a=dojox.embed.flashVars.serialize,e="";if(F.isArray(K)){for(var b=0;b<K.length;b++)e+=a(x+"."+b,t(K[b]))+";";return e.replace(/;{2,}/g,";")}if(F.isObject(K)){for(b in K)e+=
a(x+"."+b,t(K[b]))+";";return e.replace(/;{2,}/g,";")}return x+":"+K}};F.setObject("dojox.embed.flashVars",J);return J})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(F,J,x,K){var t=F.getObject("dojox.html",!0),a={},e={},b=[];t.insertCssRule=function(d,h,n){n=t.getDynamicStyleSheet(n);var p=d+" {"+h+"}";console.log("insertRule:",p);K("ie")?(n.cssText+=p,console.log("ss.cssText:",n.cssText)):n.sheet?n.sheet.insertRule(p,
n._indicies.length):n.appendChild(x.doc.createTextNode(p));n._indicies.push(d+" "+h);return d};t.removeCssRule=function(d,h,n){var p=-1,u,G;for(u in a)if(!n||n===u){var C=a[u];for(G=0;G<C._indicies.length;G++)if(d+" "+h===C._indicies[G]){p=G;break}if(-1<p)break}if(!C)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===p)return console.warn("The css rule was not found and could not be removed."),!1;C._indicies.splice(p,1);K("ie")?C.removeRule(p):C.sheet&&
C.sheet.deleteRule(p);return!0};t.modifyCssRule=function(d,h,n){};t.getStyleSheet=function(d){if(a[d||"default"])return a[d||"default"];if(!d)return!1;var h=t.getStyleSheets();if(h[d])return t.getStyleSheets()[d];for(var n in h)if(h[n].href&&-1<h[n].href.indexOf(d))return h[n];return!1};t.getDynamicStyleSheet=function(d){d||(d="default");a[d]||(x.doc.createStyleSheet?(a[d]=x.doc.createStyleSheet(),9>K("ie")&&(a[d].title=d)):(a[d]=x.doc.createElement("style"),a[d].setAttribute("type","text/css"),x.doc.getElementsByTagName("head")[0].appendChild(a[d]),
console.log(d," ss created: ",a[d].sheet)),a[d]._indicies=[]);return a[d]};t.enableStyleSheet=function(d){if(d=t.getStyleSheet(d))d.sheet?d.sheet.disabled=!1:d.disabled=!1};t.disableStyleSheet=function(d){if(d=t.getStyleSheet(d))d.sheet?d.sheet.disabled=!0:d.disabled=!0};t.activeStyleSheet=function(d){var h=t.getToggledStyleSheets(),n;if(1===arguments.length)J.forEach(h,function(p){p.disabled=p.title===d?!1:!0});else for(n=0;n<h.length;n++)if(!1===h[n].disabled)return h[n];return!0};t.getPreferredStyleSheet=
function(){};t.getToggledStyleSheets=function(){var d;if(!b.length){var h=t.getStyleSheets();for(d in h)h[d].title&&b.push(h[d])}return b};t.getStyleSheets=function(){if(e.collected)return e;J.forEach(x.doc.styleSheets,function(d){var h=d.sheet?d.sheet:d;d=h.title||h.href;if(K("ie"))-1===h.cssText.indexOf("#default#VML")&&(h.href?e[d]=h:h.imports.length?J.forEach(h.imports,function(n){e[n.title||n.href]=n}):e[d]=h);else{e[d]=h;e[d].id=h.ownerNode.id;d=[];try{d=h[h.cssRules?"cssRules":"rules"]}catch(n){console.warn("Reading css rules from stylesheet "+
h.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",h)}J.forEach(d,function(n){n.href&&(e[n.href]=n.styleSheet,e[n.href].id=h.ownerNode.id)})}});e.collected=!0;return e};return t})},"jimu/dijit/EditorChooseImage":function(){define("dojo dijit dijit/_editor/_Plugin jimu/dijit/ImageChooser dojo/_base/html dojo/_base/lang dojo/i18n dojo/_base/connect dojo/_base/declare".split(" "),function(F,J,x,K,t,a,e){F.experimental("dojox.editor.plugins.ChooseImage");
var b=F.declare("dojox.editor.plugins.ChooseImage",x,{iconClassPrefix:"editorIcon",useDefaultCommand:!1,_initButton:function(){this.createFileInput();this.command="chooseImage";var d=e.getLocalization("dijit._editor","commands");this.button=new J.form.Button({label:d.insertImage,showLabel:!1,iconClass:this.iconClassPrefix+" "+this.iconClassPrefix+"UploadImage",tabIndex:"-1",onClick:a.hitch(this,this._chooseImage)});this.button.set("readOnly",!1);this.editor.commands[this.command]="Upload Image";this.inherited("_initButton",
arguments);delete this.command},updateState:function(){var d=this.get("disabled");this.button.set("disabled",this.get("disabled"));!0===d?(t.addClass(this.button,"dijitButtonDisabled"),this.imageChooser.disableChooseImage()):(t.removeClass(this.button,"dijitButtonDisabled"),this.imageChooser.enableChooseImage())},createFileInput:function(){var d=F.create("span",{innerHTML:"."},document.body);this.imageChooser=new K({showSelfImg:!1,cropImage:!1,format:[K.GIF,K.JPEG,K.PNG]},d);this.connect(this.imageChooser,
"onImageChange","insertTempImage")},_chooseImage:function(){t.setStyle(this.imageChooser.domNode,"display","none");this.imageChooser.triggerImgUpload()},onComplete:function(d){d=d[0];var h=F.byId(this.currentImageId,this.editor.document);var n=this.downloadPath?this.downloadPath+d.name:d.file;h.src=n;F.attr(h,"_djrealurl",n);d.width&&(h.width=d.width,h.height=d.height)},insertTempImage:function(d,h){h=h&&h.fileName?'alt\x3d"'+h.fileName+'"':"";this.currentImageId="img_"+(new Date).getTime();this.editor.execCommand("inserthtml",
'\x3cimg id\x3d"'+this.currentImageId+'" src\x3d"'+d+'" '+h+"/\x3e")},destroy:function(){this.imageChooser&&this.imageChooser.destroy();this.inherited(arguments)}});F.subscribe(J._scopeName+".Editor.getPlugin",null,function(d){if(!d.plugin)switch(d.args.name){case "chooseImage":d.plugin=new b({url:d.args.url})}});x.registry.chooseImage=function(d){return new b(d)};return b})},"jimu/dijit/EditorTextColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),
function(F,J,x,K,t,a){J.experimental("dijit.editor.plugins.EditorTextColor");var e=K("dijit.editor.plugins.EditorTextColor",t,{buttonClass:a,colorPicker:"jimu/dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command="editorTextColor";this.hackCommand="foreColor";this.inherited(arguments);var b="",d=!1;this.params.custom&&(this.params.custom.recordUID&&(b=this.params.custom.recordUID),this.params.custom.forceAttr&&(d=this.params.custom.forceAttr));var h=this;this.button.set("iconClass",
this.iconClassPrefix+" "+this.iconClassPrefix+"ForeColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(n){function p(u){h.button.dropDown=new u({dir:h.editor.dir,ownerDocument:h.editor.ownerDocument,value:h.value,appearance:{showTransparent:!1,showColorPalette:!0,showCoustom:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:b,onChange:function(G){h.editor.execCommand("useCSS",d);h.editor.execCommand("styleWithCSS",!d);h.editor.execCommand(h.hackCommand,
G)},onClose:function(){h.button.closeDropDown()}});n()}"string"===typeof h.colorPicker?F([h.colorPicker],p):p(h.colorPicker)}},updateState:function(){var b=this.editor,d=this.hackCommand;if(b&&b.isLoaded&&d.length){if(this.button){var h=this.get("disabled");this.button.set("disabled",h);if(h)return;try{var n=b.queryCommandValue(d)||""}catch(p){n=""}}""===n?n="#000000":"transparent"===n&&(n="rgba(0, 0, 0, 0)");this.value=n;(b=this.button.dropDown)&&b.getColor&&n!==b.getColor()&&(b.refreshRecords(),
b.setColor(n))}}});J.subscribe(x._scopeName+".Editor.getPlugin",null,function(b){if(!b.plugin)switch(b.args.name){case "editorTextColor":b.plugin=new e}});return e})},"jimu/dijit/EditorBackgroundColor":function(){define("require dojo dijit dojo/_base/declare dijit/_editor/_Plugin dijit/form/DropDownButton".split(" "),function(F,J,x,K,t,a){J.experimental("dijit.editor.plugins.EditorBackgroundColor");var e=K("dijit.editor.plugins.EditorBackgroundColor",t,{buttonClass:a,colorPicker:"jimu/dijit/ColorPalette",
useDefaultCommand:!1,_initButton:function(){this.command="editorBackgroundColor";this.hackCommand="hiliteColor";this.inherited(arguments);var b="";this.params.custom&&this.params.custom.recordUID&&(b=this.params.custom.recordUID);var d=this;this.button.set("iconClass",this.iconClassPrefix+" "+this.iconClassPrefix+"HiliteColor");this.button.set("title",this.getLabel(this.hackCommand));this.button.loadDropDown=function(h){function n(p){d.button.dropDown=new p({dir:d.editor.dir,ownerDocument:d.editor.ownerDocument,
value:d.value,appearance:{showTransparent:!0,showColorPalette:!0,showCoustom:!0,showColorPickerOK:!0,showColorPickerApply:!1,showCoustomRecord:!0},recordUID:b,onChange:function(u){d.editor.execCommand("useCSS",!1);d.editor.execCommand("styleWithCSS",!0);d.editor.execCommand(d.hackCommand,u)},onExecute:function(){d.editor.execCommand(d.hackCommand,this.get("value"))},onClose:function(){d.button.closeDropDown()}});h()}"string"===typeof d.colorPicker?F([d.colorPicker],n):n(d.colorPicker)}},updateState:function(){var b=
this.editor,d=this.hackCommand;if(b&&b.isLoaded&&d.length){if(this.button){var h=this.get("disabled");this.button.set("disabled",h);if(h)return;try{var n=b.queryCommandValue(d)||""}catch(p){n=""}}""===n?n="#000000":"transparent"===n&&(n="rgba(0, 0, 0, 0)");this.value=n;(b=this.button.dropDown)&&b.getColor&&n!==b.getColor()&&(b.refreshRecords(),b.setColor(n))}}});J.subscribe(x._scopeName+".Editor.getPlugin",null,function(b){if(!b.plugin)switch(b.args.name){case "editorBackgroundColor":b.plugin=new e}});
return e})},"widgets/SmartEditor/setting/SmartActionGroup":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-attr dojox/html/entities dojo/on dojo/query dojo/Deferred dojo/text!./SmartActionGroup.html dijit/_TemplatedMixin jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/dijit/Popup dijit/form/ValidationTextBox jimu/dijit/CheckBox dijit/form/CheckBox jimu/dijit/Message ./FilterPage jimu/utils dijit/registry".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R){return F([g,J,G],{baseClass:"jimu-widget-smartEditor-setting-smartActionGroup",templateString:u,_totalLayers:[],_prevAppliedOn:[],filterInfo:{filter:""},searchTextBox:null,postCreate:function(){this.inherited(arguments);this._totalLayers=[];this._prevAppliedOnLayers=[];this.appliedOn&&(this._prevAppliedOnLayers=x.clone(Object.keys(this.appliedOn)));this._initComponents();this._handleParentCheckBoxState()},_initComponents:function(){this.groupNameTextBox=
new c({required:!0,trim:!0,"class":"esriCTGroupNameTextBox"},t.create("div",{},this.groupNameTextBoxNode));this.groupNameTextBox.validator=x.hitch(this,function(q){return q?q!==this.prevName&&this.editUtils.isDuplicateGroupName(q,this.existingGroupNames)?(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});this.name&&this.groupNameTextBox.set("value",this.name);
this._initLayerSelector();this.expressionTextBox=new c({disabled:!0,required:!0,"class":"esriCTTextBoxNode",promptMessage:this.nls.smartActionsPage.invalidExpression},t.create("div",{},this.expressionTextBoxNode));this.filterInfo&&this.filterInfo.expression&&this.expressionTextBox.set("value",this.filterInfo.expression);this.own(h(this.editExpressionIconNode,"click",x.hitch(this,this._showFilter)));this._submitHidden=new m({label:this.nls.smartActionsPage.submitAttributeText},t.create("div",{},this.submitWhenHiddenNode));
this.submitWhenHidden&&this._submitHidden.setValue(this.submitWhenHidden);this._createTable(this.appliedOn)},_addLayersDropDown:function(){var q=this._createLayerChooserMapArgs();q=new C(q);q.startup();q=new f({layerChooser:q});q.placeAt(this.layerSelectorDiv);q.startup();this._layerSelector=q;var k=this._totalLayers[0];this.layerForExpression&&(q=this._jimuLayerInfos.getLayerOrTableInfoById(this.layerForExpression))&&(k=q.layerObject);this._layerSelector.setSelectedLayer(k);this.own(h(this._layerSelector,
"selection-change",x.hitch(this,function(){this.expressionTextBox.get("value")&&(new D({message:this.nls.smartActionsPage.warningMsgOnLayerChange}),this.onFilterInfoChanged({expression:"",filter:null,submitWhenHidden:!1}))})))},_createLayerChooserMapArgs:function(){return{multiple:!1,createMapResponse:this.map.webMapResponse,filter:this._createFiltersForLayerSelector()}},_createFiltersForLayerSelector:function(){return C.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0)},_initLayerSelector:function(){var q=
this._createLayerChooserMapArgs();this._layerChooserFromMap=new C(q);this._layerChooserFromMap.startup();q=this._layerChooserFromMap.layerInfosObj.getLayerInfoArray();var k=this._layerChooserFromMap.layerInfosObj.getTableInfoArray();k&&0<k.length&&(q=q.concat(k));this._getAllFilteredLayers(q,[])},_isLayerEditable:function(q){var k=!1;q&&q.layerObject&&(q=q.layerObject.getEditCapabilities(),q.canCreate||q.canUpdate||q.canDelete||q.canUpdateGeometry)&&(k=!0);return k},_getAllFilteredLayers:function(q,
k){K.forEach(q,x.hitch(this,function(E){if(E.isLeaf()){var O=new p;this._layerChooserFromMap.filter(E).then(x.hitch(this,function(l){l&&this._isLayerEditable(E)&&this._totalLayers.push(E);O.resolve()}));k.push(O)}else this._getAllFilteredLayers(E.newSubLayers,k)}))},_validateGroup:function(){if(!this.groupNameTextBox.isValid())return this.groupNameTextBox.focus(),!1;if(this._layerSelector){var q=this._layerSelector.getSelectedItem();if(!q||!q.layerInfo||!q.layerInfo.layerObject)return!1}else return!1;
return this.expressionTextBox.isValid()?!0:(this.expressionTextBox.set("disabled",!1),this.expressionTextBox.focus(),this.expressionTextBox.set("disabled",!0),!1)},showDialog:function(){this._addLayersDropDown();var q=new B({titleLabel:this.nls.smartActionsPage.smartActionLabel,width:900,maxHeight:550,autoHeight:!1,content:this,"class":this.baseClass,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var k={},E=this._layerSelector.getSelectedItem().layerInfo.layerObject;if(this._validateGroup()){k.name=
this.groupNameTextBox.get("value");k.submitWhenHidden=this._submitHidden.checked;k.layerForExpression=E.id;k.filterInfo=this.filterInfo;k.appliedOn=this.appliedOn;this._applySettingsInLayer(k);for(var O in k.appliedOn){E=k.appliedOn[O];for(var l in E)E[l].hasOwnProperty("Priority")&&delete E[l].Priority,E[l].hasOwnProperty("ExistingExpressions")&&delete E[l].ExistingExpressions}this.emit("groupInfoUpdated",k);q.close()}})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,
function(){q.close()})}],onClose:x.hitch(this,function(){})});this.groupNameTextBox.focus();this._setMaxWidth()},_getTableData:function(){var q=[],k;K.forEach(this._layerTable.getRows(),x.hitch(this,function(E){E.layerSelector&&(k={},k.layerId=E.layerSelector.getSelectedItem().layerInfo.id,k.field=E.layerFields.getValue(),q.push(k))}));return q},_showFilter:function(q){if(!this.groupNameTextBox.isValid())return this.groupNameTextBox.focus(),!1;this._filterPage&&this._filterPage.destroy();var k=this._layerSelector.getSelectedItem().layerInfo.layerObject;
this._filterPage=new N({nls:this.nls,_resourceInfo:this._resourceInfo,_url:k.url,_layerId:k.id,_filterInfo:this.filterInfo,_groupName:this.groupNameTextBox.get("value")});this.own(h(this._filterPage,"filterInfo",x.hitch(this,function(E){this.onFilterInfoChanged(E)})));this._filterPage.popup(q)},onFilterInfoChanged:function(q){this.filterInfo=x.clone(q);this.filterInfo.filter=JSON.parse(d.decode(this.filterInfo.filter));this.expressionTextBox.set("value",q.expression);this._destroyTable();this._createTable(this.appliedOn);
this._handleParentCheckBoxState()},_destroyTable:function(){t.empty(this.tableParentContainer)},_createHeaderObj:function(q,k,E){var O,l=["","Hide","Required","Disabled"],y=t.create("th"),M=t.create("div",{innerHTML:q.title,title:q.title});q.hasOwnProperty("headerIcon")&&(O=t.create("div",{title:q.title}));0<E&&(a.add(y,"esriCTTableTH"),a.add(M,"esriCTTableHeaderTitle "),q.hasOwnProperty("headerIcon")&&a.add(O,"esriCTTableHeaderIcon "+q.headerIcon));var S=t.create("div",{"class":"esriCTPriorityColumnParentContainer"}),
Q=t.create("div",{"class":"esriCTPriorityColumnParentDiv"});Q.appendChild(M);q.hasOwnProperty("headerIcon")&&Q.appendChild(O);O=t.create("div",{"class":"esriCTPriorityNumberDiv"});if(3>=E){a.add(O,"esriCTSAHeaderCheckbox");var V,W;var Y=new m({label:""},t.create("div",{},O));b.set(Y.domNode,"action",l[E]);h(Y,"change",x.hitch(this,function(I){var P=b.get(Y.domNode,"action");V=""!==this.searchTextBox.get("value")?n("tr[searchstring^\x3d'"+this.searchTextBox.get("value").toLowerCase()+"']",this.tableParentContainer):
n("tr.esriCTSmartActionGroupRow",this.tableParentContainer);K.forEach(V,x.hitch(this,function(X){var z=b.get(X,"layerid");var r=b.get(X,"field");z&&r&&(this.appliedOn[z][r][P]=I);(W=n("[action\x3d"+P+"]",X))&&W[0]&&(W=R.byNode(W[0]),I?W.check(!0):W.uncheck(!0))}))}))}4===E&&(t.create("div",{"class":"esriCTPriorityOneDiv",innerHTML:this.nls.smartActionsPage.priorityOneText},O),t.create("div",{"class":"esriCTPriorityTwoDiv",innerHTML:this.nls.smartActionsPage.priorityTwoText},O),t.create("div",{"class":"esriCTPriorityThreeDiv",
innerHTML:this.nls.smartActionsPage.priorityThreeText},O));0===E?this._addSearchControl(S):(S.appendChild(Q),S.appendChild(O));y.appendChild(S);e.set(y,"width",q.width);k.appendChild(y)},_addSearchControl:function(q){this.searchTextBox=new c({trim:!0,placeHolder:this.nls.actionPage.searchPlaceHolder,intermediateChanges:!0},t.create("div",{},q));e.set(this.searchTextBox.domNode,"width","350px");this.own(h(this.searchTextBox,"change",x.hitch(this,this._searchTextUpdated)));q=t.create("div",{"class":"esriCTExpandAllNode"},
q);this._expandAllCheckBox=new A({"class":"switch-toggle",checked:!1},t.create("div",{},q));t.create("label",{innerHTML:this.nls.actionPage.expandAllLabel},q);this.own(h(this._expandAllCheckBox,"change",x.hitch(this,function(k){k?(k=n(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed.esriCTToggleLayerExpanded",this.layerAndFieldsMainDiv))&&0<k.length&&K.forEach(k,function(E){E.click()}):(k=n(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed",this.layerAndFieldsMainDiv))&&0<k.length&&K.forEach(k,
function(E){a.contains(E,"esriCTToggleLayerExpanded")||E.click()})})))},_searchTextUpdated:function(q){q=q.toLowerCase();if(""!==q){var k=n("[searchstring]",this.tableParentContainer);var E=n("tr[searchstring^\x3d'"+q+"']",this.tableParentContainer);k.style("display","none");k.removeClass("esriCTNotFilteredBySearch");k.addClass("esriCTFilteredBySearch");E.style("display","");E.replaceClass("esriCTNotFilteredBySearch","esriCTFilteredBySearch");q=this.appliedOn;this._handleParentCheckBoxState(E);for(var O in q){var l;
if(0<Object.keys(q[O]).length){E=n("[layermaindivid \x3d '"+O+"']",this.tableParentContainer);k=n("[layerid\x3d'"+O+"']",this.tableParentContainer);var y=!0;for(l=0;l<k.length;l++)if(a.contains(k[l],"esriCTNotFilteredBySearch")){y=!1;break}y?E.style("display","none"):E.style("display","")}}}else n("[layermaindivid]",this.tableParentContainer).style("display",""),n("[searchstring]",this.tableParentContainer).style("display",""),n("[searchstring]",this.tableParentContainer).removeClass("esriCTFilteredBySearch"),
n("[searchstring]",this.tableParentContainer).addClass("esriCTNotFilteredBySearch"),this._handleParentCheckBoxState(E)},_handleParentCheckBoxState:function(q){var k=!0,E=!0,O=!0,l,y,M;q||(q=n("tr.esriCTSmartActionGroupRow",this.tableParentContainer));K.forEach(q,x.hitch(this,function(V){l=n("[action\x3d'Hide']",V);y=n("[action\x3d'Required']",V);M=n("[action\x3d'Disabled']",V);0<l.length&&0<y.length&&0<M.length&&(l=R.byNode(l[0]),y=R.byNode(y[0]),M=R.byNode(M[0]),l.getValue()||(k=!1),y.getValue()||
(E=!1),M.getValue()||(O=!1))}));q=R.byNode(n(".esriCTTableTH [action\x3d'Hide']",this.tableParentContainer)[0]);var S=R.byNode(n(".esriCTTableTH [action\x3d'Required']",this.tableParentContainer)[0]);var Q=R.byNode(n(".esriCTTableTH [action\x3d'Disabled']",this.tableParentContainer)[0]);k?q.check(!0):q.uncheck(!0);E?S.check(!0):S.uncheck(!0);O?Q.check(!0):Q.uncheck(!0)},_createHeaders:function(q){var k=[{title:"",icon:"",width:"41%"},{title:this.nls.actionPage.actions.hide,width:"13%",headerIcon:"esriCTHide"},
{title:this.nls.actionPage.actions.required,width:"13%",headerIcon:"esriCTRequired"},{title:this.nls.actionPage.actions.disabled,width:"13%",headerIcon:"esriCTDisabled"},{title:this.nls.smartActionsPage.priorityColumnText,icon:"",width:"20%"}];var E=t.create("thead",{});var O=E.insertRow(0);a.add(O,"esriCTTableRow");K.forEach(k,x.hitch(this,function(l,y){this._createHeaderObj(l,O,y)}));q.appendChild(E)},_setMaxWidth:function(){var q=n(".esriCTTableHeaderTitle");K.forEach(q,x.hitch(this,function(k){var E=
e.getComputedStyle(k).width;e.set(k,"max-width",E)}))},_createPriorityIcons:function(q,k){var E=k.Priority;q=t.create("td",{style:{width:"20%"}},q);var O=t.create("div",{"class":"esriCTPriorityIconMainDiv"},q);K.forEach(E,x.hitch(this,function(l){t.create("div",{"class":"esriCTPriorityIcons esriCT"+l,title:this.nls.actionPage.actions[l.toLowerCase()]},O)}));E=t.create("div",{"class":"jimu-icon jimu-icon-edit esriCTPriorityEditIcon",title:this.nls.smartActionsPage.priorityPopupTitle},O);this.own(h(E,
"click",x.hitch(this,function(l){this._createPriorityTable(l.currentTarget.parentNode);this._createPriorityPopup(l.currentTarget.parentNode,k)})))},_createPriorityTable:function(q){this._priorityTable=new w({fields:[{name:"priorityName",title:this.nls.smartActionsPage.priorityPopupColumnTitle,type:"empty",width:"80%"},{name:"actions",title:this.nls.intersectionPage.actionsText,type:"actions",width:"20%",actions:["up","down"],"class":"actions"}],selectable:!1});this._priorityTable.startup();this._populatePriorityTable(q)},
_getExistingPriority:function(q){var k={esriCTHide:"Hide",esriCTRequired:"Required",esriCTDisabled:"Disabled"},E=[];K.forEach(q.childNodes,x.hitch(this,function(O,l){if(3>l)for(var y in k)a.contains(O,y)&&E.push(k[y])}));return E},_populatePriorityTable:function(q){q=this._getExistingPriority(q);K.forEach(q,x.hitch(this,function(k){var E=t.create("div",{innerHTML:this.nls.actionPage.actions[k.toLowerCase()],title:this.nls.actionPage.actions[k.toLowerCase()]});a.add(E,"esriCTTablePriorityTitle");b.set(E,
"priority",k);var O=t.create("div",{title:this.nls.actionPage.actions[k.toLowerCase()]});a.add(O,"esriCTPriorityPopupIcon esriCT"+k);k=this._priorityTable.addRow({}).tr;k=n(".simple-table-cell",k)[0];k.appendChild(O);k.appendChild(E)}))},_fetchPriority:function(){var q=this._priorityTable.getRows(),k=[];K.forEach(q,x.hitch(this,function(E){k.push(b.get(E.childNodes[0].childNodes[1],"priority"))}));return k},_changePriority:function(q,k){K.forEach(q,x.hitch(this,function(E,O){K.forEach(k.childNodes,
x.hitch(this,function(l,y){O===y&&(K.forEach(["Hide","Required","Disabled"],x.hitch(this,function(M){a.remove(l,"esriCT"+M)})),a.add(l,"esriCT"+E),b.set(l,"title",this.nls.actionPage.actions[E.toLowerCase()]))}))}))},_createPriorityPopup:function(q,k){var E=new B({titleLabel:this.nls.smartActionsPage.priorityPopupTitle,width:450,maxHeight:445,autoHeight:!0,content:this._priorityTable,"class":this.baseClass,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var O=this._fetchPriority();this._changePriority(O,
q);k.Priority=O;E.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){E.close()})}],onClose:x.hitch(this,function(){})})},_createLayerName:function(q,k){var E=k,O=t.create("td"),l=t.create("div",{"class":"esriCTLayerNameRowParent"},O);this._jimuLayerInfos.getLayerInfoById(k)?E=this._jimuLayerInfos.getLayerInfoById(k).layerObject.name:this._jimuLayerInfos.getTableInfoById(k)&&(E=this._jimuLayerInfos.getTableInfoById(k).layerObject.name);var y=t.create("div",
{"class":"esriCTToggleLayerIcon esriCTToggleLayerCollapsed esriCTToggleLayerExpanded",style:{"margin-top":"5px"}},l);t.create("div",{"class":"esriCTLayerTitle",innerHTML:E,title:E},l);b.set(y,"rootnodelayerid",k);this.own(h(y,"click",x.hitch(this,function(M){var S=!0,Q=n(".esriCTToggleLayerIcon.esriCTToggleLayerCollapsed",this.layerAndFieldsMainDiv);a.toggle(M.currentTarget,"esriCTToggleLayerExpanded");M=b.get(M.currentTarget,"rootnodelayerid");n('tr[layerid\x3d"'+M+'"]').toggleClass("esriCTHidden");
K.some(Q,x.hitch(this,function(V){if(a.contains(V,"esriCTToggleLayerExpanded"))return S=!1,!0}));this._expandAllCheckBox.set("checked",S,!1)})));q.appendChild(O)},_createFieldNameTd:function(q,k){var E=t.create("td",{innerHTML:k,"class":"esriCTLayerFields"});q.appendChild(E);b.set(q,"searchstring",k.toLowerCase())},_addRows:function(q,k){var E=k.layerDetails;k=k.fieldLabels;var O=[],l;for(l in E){var y=E[l],M=t.create("tr",{"class":"esriCTSmartActionGroupRow esriCTLayerNameRow"});this._createLayerName(M,
l);b.set(M,"layermaindivid",l);q.appendChild(M);for(var S in y){M=t.create("tr",{"class":"esriCTSmartActionGroupRow esriCTLayerFieldRow esriCTHidden"});b.set(M,"layerid",l);b.set(M,"field",S);this._createFieldNameTd(M,k[l][S]);var Q={layerid:l,field:S,action:"Hide"},V="";y[S].ExistingExpressions.hasOwnProperty("Hide")&&(V=y[S].ExistingExpressions.Hide);this._createCheckBox(M,Q,y[S].Hide,V);Q.action="Required";V="";y[S].ExistingExpressions.hasOwnProperty("Required")&&(V=y[S].ExistingExpressions.Required);
this._createCheckBox(M,Q,y[S].Required,V);Q.action="Disabled";V="";y[S].ExistingExpressions.hasOwnProperty("Disabled")&&(V=y[S].ExistingExpressions.Disabled);this._createCheckBox(M,Q,y[S].Disabled,V);-1===O.indexOf(l)&&(y[S].Hide||y[S].Required||y[S].Disabled)&&O.push(l);this._createPriorityIcons(M,y[S]);q.appendChild(M)}}0<O.length&&setTimeout(x.hitch(this,function(){K.forEach(O,function(W){n('div[rootnodelayerid\x3d"'+W+'"]').toggleClass("esriCTToggleLayerExpanded");n('tr[layerid\x3d"'+W+'"]').toggleClass("esriCTHidden")})}),
100)},_createCheckBox:function(q,k,E,O){var l=t.create("td",{style:{width:"13%"}}),y=!0,M,S;a.add(l,"esriCTCheckBoxTD");var Q=t.create("div");E&&O&&(E=!1);var V=t.create("div");a.add(V,"esriCTCheckBoxMainDiv");var W=t.create("div");E=new m({checked:E},W);b.set(W,"action",k.action);b.set(W,"field",k.field);b.set(W,"layerid",k.layerid);var Y=this.appliedOn[k.layerid][k.field];this.own(h(E,"change",x.hitch(this,function(I){var P=b.get(W,"action");y=!0;Y[P]=I;fieldsMatchingNodes=""!==this.searchTextBox.get("value")?
n("tr[searchstring^\x3d'"+this.searchTextBox.get("value").toLowerCase()+"']",this.tableParentContainer):n("tr.esriCTSmartActionGroupRow",this.tableParentContainer);0<fieldsMatchingNodes.length?K.some(fieldsMatchingNodes,x.hitch(this,function(X){if((X=n("[action\x3d"+P+"]",X))&&X[0]&&(M=R.byNode(X[0]))&&!M.getValue())return y=!1,!0})):y=!1;S=R.byNode(n(".esriCTTableTH [action\x3d"+P+"]",this.tableParentContainer)[0]);y&&!S.getValue()?S.check(!0):S.uncheck(!0)})));V.appendChild(W);Q.appendChild(V);
O&&(k=t.create("div",{title:O}),a.add(k,"esriCTExistingExpressionDiv"),Q.appendChild(k));l.appendChild(Q);q.appendChild(l)},_createTable:function(q){var k=t.create("table");a.add(k,"esriCTTableMainNode tableBodyScroll");this._createHeaders(k);this.tableParentContainer.appendChild(k);var E=t.create("tbody",{style:"width: 808px"});(q=this._createLayerDetails(x.clone(q)))&&q.layerDetails&&q.fieldLabels&&(this.appliedOn=q.layerDetails,this._addRows(E,q));k.appendChild(E)},_validateIfLayerHaveUsedFields:function(q,
k){if(k){var E=k.length;K.forEach(q,function(O){K.forEach(k,function(l){O.name===l.fieldObj.name&&O.type===l.fieldObj.type&&E--})},this)}return 0===E?!0:!1},_mergeActions:function(q,k){for(var E=0;E<q.length;E++)for(var O=0;O<k.length;O++)if(k[O].filter&&k[O].actionName===q[E].actionName){q[E]=x.clone(k[O]);break}return q},_mergeFieldValidations:function(q){var k={};K.forEach(q,function(E){for(var O in E)k.hasOwnProperty(O)?k[O]=this._mergeActions(k[O],E[O]):k[O]=x.clone(E[O])},this);return k},_getLayersFieldValidations:function(q,
k,E){K.forEach(k,function(O){O.featureLayer&&O.featureLayer.id===E&&O.fieldValidations&&(q||(q=[]),q.push(O.fieldValidations));O.relationshipInfos&&(q=this._getLayersFieldValidations(q,O.relationshipInfos,E))},this);return q},_getPartsInExpression:function(q,k){k&&K.forEach(k,x.hitch(this,function(E){E.parts?this._getPartsInExpression(q,E.parts):q.push(E)}));return q},_createLayerDetails:function(q){var k;var E=null;this.filterInfo&&this.filterInfo.filter&&(k=this._getPartsInExpression([],this.filterInfo.filter.parts));
E={};var O={};K.forEach(this._totalLayers,function(l){if(!l.isTable||l.isTable&&0<l.layerObject.relationships.length){var y=[];var M=!1;var S={};M=this._jimuLayerInfos.getLayerOrTableInfoById(l.id);S.allFields=M.layerObject.fields;M&&(M=this.editUtils.getConfigInfo(M,{}),S.fieldInfos=M.fieldInfos);M=this._validateIfLayerHaveUsedFields(S.allFields,k);S&&S.fieldInfos&&(M||!k)&&(y=this._getLayersFieldValidations(y,this._configInfos,l.id),S.fieldValidations=this._mergeFieldValidations(y),E[l.id]={},O[l.id]=
{},K.forEach(S.fieldInfos,function(Q){var V=L.getDefaultPortalFieldInfo(Q);"esriFieldTypeGeometry"!==Q.type&&"esriFieldTypeOID"!==Q.type&&"esriFieldTypeBlob"!==Q.type&&"esriFieldTypeGlobalID"!==Q.type&&"esriFieldTypeRaster"!==Q.type&&"esriFieldTypeXML"!==Q.type&&(O[l.id][Q.name]=V.label,E[l.id][Q.name]=q&&q[l.id]&&q[l.id][Q.name]?q[l.id][Q.name]:{Hide:!1,Required:!1,Disabled:!1},S.fieldValidations&&S.fieldValidations[Q.name]?(V=this._getPriorites(S.fieldValidations[Q.name]),E[l.id][Q.name].Priority=
V.Priority,E[l.id][Q.name].ExistingExpressions=V.ExistingExpressions):(E[l.id][Q.name].Priority=["Hide","Required","Disabled"],E[l.id][Q.name].ExistingExpressions=[]))},this))}},this);return{layerDetails:E,fieldLabels:O}},_getPriorites:function(q){var k=[],E={};K.forEach(q,function(O){k.push(O.actionName);O.filter&&O.filter.displaySQL&&(!O.filter.hasOwnProperty("smartActionGroupName")||!this.prevName||O.filter.hasOwnProperty("smartActionGroupName")&&this.prevName&&this.prevName!==O.filter.smartActionGroupName)&&
(E[O.actionName]=O.filter.displaySQL)},this);return{Priority:k,ExistingExpressions:E}},_getVaidationForAction:function(q,k){var E=null;K.some(q,function(O){if(O.actionName===k&&O.filter&&O.filter.displaySQL)return E=O,!0});return E},_applysettingsToField:function(q,k){var E=[];E=this._getLayersFieldValidations(E,this._configInfos,q);var O=k.appliedOn[q];for(var l=0;l<E.length;l++){var y=E[l];if(y)for(var M in O){for(var S=O[M],Q=[],V=!1,W=0;W<S.Priority.length;W++){var Y=S.Priority[W],I={};I.actionName=
Y;I.submitWhenHidden=!1;if(S[Y])V=!0,"Hide"===Y&&(I.submitWhenHidden=k.submitWhenHidden),I.expression=k.filterInfo.expression,I.filter=x.clone(k.filterInfo).filter,I.filter.smartActionGroupName=k.name,this._removeSettingsFromOtherGroups(k.name,q,M,Y);else if(y&&y[M]){var P=this._getVaidationForAction(y[M],Y);P&&P.filter&&!S[Y]&&P.filter.hasOwnProperty("smartActionGroupName")&&P.filter.smartActionGroupName===this.prevName?V=!0:P&&(I.expression=P.filter.expr,I.filter=P.filter)}Q.push(I)}V&&(y||(y={}),
y[M]=Q)}}},_removePrevSettingsFromLayerFields:function(q){var k=[];if(k=this._getLayersFieldValidations(k,this._configInfos,q))for(var E=0;E<k.length;E++)if(q=k[E])for(var O in q)q&&q[O]&&K.forEach(q[O],function(l){l&&l.filter&&l.filter.hasOwnProperty("smartActionGroupName")&&l.filter.smartActionGroupName===this.prevName&&(l.submitWhenHidden=!1,l.hasOwnProperty("expression")&&delete l.expression,delete l.filter)},this)},_removeSettingsFromOtherGroups:function(q,k,E,O){var l;if(this.existingGroups)for(var y in this.existingGroups)y!==
q&&y!==this.prevName&&(l=this.existingGroups[y].appliedOn)&&l.hasOwnProperty(k)&&l[k].hasOwnProperty(E)&&l[k][E].hasOwnProperty(O)&&(l[k][E][O]=!1)},_applySettingsInLayer:function(q){for(var k in q.appliedOn){if(this._prevAppliedOnLayers&&-1<this._prevAppliedOnLayers.indexOf(k)){var E=this._prevAppliedOnLayers.indexOf(k);this._prevAppliedOnLayers.splice(E,1)}this._applysettingsToField(k,q)}this.deleteGroup()},deleteGroup:function(){this._prevAppliedOnLayers&&K.forEach(this._prevAppliedOnLayers,function(q){this._removePrevSettingsFromLayerFields(q)},
this)}})})},"widgets/SmartEditor/utils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array esri/geometry/Extent jimu/utils esri/dijit/AttributeInspector".split(" "),function(F,J,x,K,t,a){var e={};e.ATI=F([a],{constructor:function(){this._aiConnects=[];this._selection=[];this._toolTips=[]}});e.checkIfFieldAliasAlreadyExists=function(b,d){return 0<=b.split(",").indexOf(d)};e.pointToExtent=function(b,d,h){var n=b.extent.getWidth()/b.width;h*=n;return new K(d.x-h,d.y-h,d.x+h,d.y+h,
b.spatialReference)};e.filterOnlyUpdatedAttributes=function(b,d,h){if(null===d||void 0===d)return b;var n={},p;for(p in b)b.hasOwnProperty(p)&&(p===h.objectIdField||p===h.globalIdField?n[p]=b[p]:(null!==b[p]||""!==d[p])&&b[p]!==d[p]&&(n[p]=b[p]));return n};e.mergeFieldInfosWithConfiguration=function(b,d){var h=[],n=this.getDefaultEditableFieldInfos(b,!1);d&&d.fieldInfos?(x.forEach(d.fieldInfos,function(G){x.some(n,function(C){if(G.fieldName===C.fieldName)return h.push(this.mergeLastToFirst(C,G)),
!0},this)},this),x.forEach(n,function(G){0===x.filter(h,function(C){return C.fieldName===G.fieldName},this).length&&h.push(G)},this)):h=n;var p=[];b.layerObject.hasOwnProperty("globalIdField")&&void 0!==b.layerObject.globalIdField&&null!==b.layerObject.globalIdField&&p.push(b.layerObject.globalIdField);b.layerObject.hasOwnProperty("objectIdField")&&void 0!==b.layerObject.objectIdField&&null!==b.layerObject.objectIdField&&p.push(b.layerObject.objectIdField);if(b.layerObject.hasOwnProperty("editFieldsInfo")&&
void 0!==b.layerObject.editFieldsInfo&&null!==b.layerObject.editFieldsInfo)for(var u in b.layerObject.editFieldsInfo)b.layerObject.editFieldsInfo.hasOwnProperty(u)&&p.push(b.layerObject.editFieldsInfo[u]);return h=h.filter(function(G){return-1!==x.indexOf(p,G.fieldName)?!1:G.isEditableOnLayer})};e.getDefaultEditableFieldInfos=function(b,d){var h=[],n=this.getFieldInfosFromWebmap(b);b=this.getFieldInfosLayer(b);if(void 0===n||null===n)n=b;else{var p=[];x.forEach(b,function(u){0===x.filter(n,function(G){return G.name===
u.fieldName}).length&&(u.isEditableOnLayer=u.editable,p.push(u))});0<p.length&&(n=n.concat(p))}x.forEach(n,function(u){!1===u.hasOwnProperty("isEditableOnLayer")&&(u.isEditableOnLayer=u.editable);!1===u.editable&&(u.isEditable=u.editable);!1===u.isEditable&&(u.editable=u.isEditable);!0===u.editable&&(u.visible=!0);u.fieldName=u.name;!0===u.editable&&!0===d?h.push(J.clone(u)):!1===d&&h.push(J.clone(u))});return h};e.updatePopupDateFormat=function(b){var d={shortDate:{datePattern:"M/d/y"},shortDateLE:{datePattern:"d/M/y"},
longMonthDayYear:{datePattern:"MMMM d, y"},dayShortMonthYear:{datePattern:"d MMM y"},longDate:{datePattern:"EEEE, MMMM d, y",selector:"date"},shortDateShortTime:{datePattern:"M/d/y",timePattern:"h:mm a",timeEnabled:!0},shortDateLEShortTime:{datePattern:"d/M/y",timePattern:"h:mm a",timeEnabled:!0},shortDateShortTime24:{datePattern:"M/d/y",timePattern:"H:mm",timeEnabled:!0},shortDateLEShortTime24:{datePattern:"d/M/y",timePattern:"H:mm",timeEnabled:!0},shortDateLongTime:{datePattern:"M/d/y",timePattern:"h:mm:ss a",
timeEnabled:!0},shortDateLELongTime:{datePattern:"d/M/y",timePattern:"h:mm:ss a",timeEnabled:!0},shortDateLongTime24:{datePattern:"M/d/y",timePattern:"H:mm:ss",timeEnabled:!0},shortDateLELongTime24:{datePattern:"d/M/y",timePattern:"H:mm:ss",timeEnabled:!0},longMonthYear:{datePattern:"MMMM y"},shortMonthYear:{datePattern:"MMM y"},year:{datePattern:"y"}},h="",n;for(n in d)if(t.isEqual(b,d[n])){h=n;break}return h};e.getFieldInfosFromWebmap=function(b){var d=null,h=b.getPopupInfo();h&&h.fieldInfos&&(d=
[],x.forEach(h.fieldInfos,function(n){x.some(b.layerObject.fields,function(p){if(p.name===n.fieldName)return p=this.mergeFirstToLast(n,p),p.format&&p.format.dateFormat&&(p.format.dateFormat.hasOwnProperty("datePattern")||p.format.dateFormat.hasOwnProperty("timePattern"))&&(p.format.dateFormat=this.updatePopupDateFormat(p.format.dateFormat)),p.format&&p.format.dateFormat&&p.format.dateFormat.toLowerCase()&&0<=p.format.dateFormat.toLowerCase().indexOf("time")&&(p.format.time=!0),d.push(p),!0},this)},
this));return d};e.getFieldInfosLayer=function(b){var d=[];b&&b.layerObject&&x.forEach(b.layerObject.fields,function(h){var n=t.getDefaultPortalFieldInfo(h);n=this.mergeFirstToLast(n,h);n.format&&n.format.dateFormat&&(n.format.dateFormat.hasOwnProperty("datePattern")||n.format.dateFormat.hasOwnProperty("timePattern"))&&(n.format.dateFormat=this.updatePopupDateFormat(n.format.dateFormat));n.format&&n.format.dateFormat&&n.format.dateFormat.toLowerCase()&&0<=n.format.dateFormat.toLowerCase().indexOf("time")&&
(n.format.time=!0);n.visible=!0;d.push(n)},this);return d};e.getConfigInfos=function(b,d,h,n,p){var u=[],G=b.getLayerInfoArrayOfWebmap(),C=[];p&&(C=b.getTableInfoArrayOfWebmap(),G=G.concat(C));x.forEach(G,function(f){var g=!1;"Table"!==f.layerObject.type&&"Feature Layer"!==f.layerObject.type||!f.layerObject.url||(f.layerObject.isEditable&&f.layerObject.isEditable()&&h?g=!0:void 0!==h&&!1===h&&(g=!0));if(!0===g){var w=this.getConfigInfo(f,d);w.layerInfo=f;!0===w.featureLayer.layerAllowsDelete&&!1===
w.featureLayer.layerAllowsCreate&&!1===w.featureLayer.layerAllowsUpdate?console.warn(w.layerInfo.title+" delete only not supported"):n&&!0===n?!0===x.some(d,function(B){return B.featureLayer.id===w.featureLayer.id})&&u.push(w):u.push(w)}},this);return u};e.getConfigInfo=function(b,d){var h=null,n=this.createDefaultConfigInfo(b);!1===x.some(d,function(p){return p.featureLayer&&p.featureLayer.id===b.layerObject.id?(h=J.clone(p),h.fieldInfos=this.mergeFieldInfosWithConfiguration(b,h),h=this.mergeDefaultWithConfig(h,
n),!0):!1},this)&&(h=n);return h};e.mergeDefaultWithConfig=function(b,d){b.featureLayer=d.featureLayer;!0===b.allowDelete&&!1===b.featureLayer.layerAllowsDelete&&(b.allowDelete=!1);!1===b.disableGeometryUpdate&&!1===b.featureLayer.layerAllowGeometryUpdates&&(b.disableGeometryUpdate=!0);!1===b.featureLayer.layerAllowsCreate&&!0===b.featureLayer.layerAllowsUpdate&&(b.allowUpdateOnly=!0);return b};e.createDefaultConfigInfo=function(b){var d=!1,h=!1,n=!1,p=!1;try{var u=b.layerObject.getEditCapabilities();
u.canCreate&&(d=!0);u.canUpdate&&(p=h=!0);u.canDelete&&(n=!0)}catch(G){b.layerObject.hasOwnProperty("capabilities")&&(-1===String(b.layerObject.capabilities).indexOf("Update")&&-1===String(b.layerObject.capabilities).indexOf("Delete")&&-1===String(b.layerObject.capabilities).indexOf("Create")&&-1!==String(b.layerObject.capabilities).indexOf("Editing")?d=n=h=!0:(-1!==String(b.layerObject.capabilities).indexOf("Update")&&(p=h=!0),-1!==String(b.layerObject.capabilities).indexOf("Delete")&&(n=!0),-1!==
String(b.layerObject.capabilities).indexOf("Create")&&(d=!0)))}b.layerObject.hasOwnProperty("allowGeometryUpdates")&&(p=b.layerObject.allowGeometryUpdates);"Table"===b.layerObject.type&&b.layerObject.url&&b.getCapabilitiesOfWebMap()&&(h=b.getCapabilitiesOfWebMap(),b.layerObject.isEditable&&b.layerObject.isEditable()&&h&&-1<h.toLowerCase().indexOf("editing")?h=!0:n=h=d=!1,p=!1);p=p&&h;return{featureLayer:{id:b.layerObject.id,layerAllowsCreate:d,layerAllowsUpdate:h,layerAllowsDelete:n,layerAllowGeometryUpdates:p},
disableGeometryUpdate:!p,allowUpdateOnly:!d,allowDelete:!1,fieldInfos:this.mergeFieldInfosWithConfiguration(b,null),_editFlag:d||h?!0:!1}};e.mergeLastToFirst=function(){for(var b={},d=0,h=arguments.length,n;d<h;d++)for(n in arguments[d])arguments[d].hasOwnProperty(n)&&(b[n]=arguments[d][n]);return b};e.mergeFirstToLast=function(){for(var b={},d=arguments.length-1,h;0<=d;d--)for(h in arguments[d])arguments[d].hasOwnProperty(h)&&(b[h]=arguments[d][h]);return b};e.isObjectEmpty=function(b){if(b)for(var d in b)if(b.hasOwnProperty(d))return!1;
return!0};e.addDateTimeFormat=function(b){b&&b.format&&null!==b.format&&b.format.dateFormat&&null!==b.format.dateFormat&&0<=b.format.dateFormat.toString().toUpperCase().indexOf("TIME")&&(b.format.time=!0)};e.isDuplicateGroupName=function(b,d){var h=!1;x.some(d,J.hitch(this,function(n){if(b.toLowerCase()===n.toLowerCase())return h=!0}));return h};return e})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R,q,k,E,O,l,y,M,S,Q,V,W,Y,I,P,X){var z=F([D,w,B],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:X,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},_defaultRichTextPlugins:"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),css:{label:"atiLabel",field:"atiField",textArea:"atiTextAreaField",richText:"atiRichTextField",attachmentEditor:"atiAttachmentEditor",red:"atiRequiredField"},
constructor:function(r,v){J.mixin(this,C.widgets.attributeInspector);r=r||{};r.featureLayer||r.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(r);this._layerInfos=r.layerInfos||[{featureLayer:r.featureLayer,options:r.options||[]}];this._layerInfos=x.filter(this._layerInfos,function(H){return!H.disableAttributeUpdate});this._hideNavButtons=r.hideNavButtons||!1},postCreate:function(){if(x.every(this._layerInfos,
function(v){return v.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var r=this._layerInfos.length;x.forEach(this._layerInfos,function(v){v=v.featureLayer;if(v.loaded)r--;else var H=K.connect(v,"onLoad",this,function(T){K.disconnect(H);H=null;r--;r||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();x.forEach(this._aiConnects,K.disconnect);delete this._aiConnects;
this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(r,v){v&&(this._createOnlyFirstTime=!0);
this._updateSelection([r],v);this._updateUI()},onLayerSelectionChange:function(r,v,H){this._createOnlyFirstTime=!1;this._featureIdx=H===G.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(r,v,H,T){},onLayerError:function(r,v,H,T){},onLayerEditsError:function(r,
v,H,T){},onLayerEditsComplete:function(r,v,H,T){T=T||[];if(T.length){var U=this._selection,Z=r.featureLayer.objectIdField;x.forEach(T,J.hitch(this,function(fa){x.some(U,J.hitch(this,function(ca,ea){if(ca.attributes[Z]!==fa.objectId)return!1;this._selection.splice(ea,1);return!0}))}))}v=v||[];v.length&&(this._selection=L.findFeatures(v,r.featureLayer),this._featureIdx=0);T=this._numFeatures=(this._selection=L.sortFeaturesById(this._layerInfos,this._selection))?this._selection.length:0;if(v.length){if(v=
T?this._selection[this._featureIdx]:null)T=v.getLayer().getEditCapabilities(),T.canCreate&&!T.canUpdate||this._showFeature(v);this._updateUI()}H=H||[];if(H.length){var aa=this._rollbackInfo;x.forEach(H,function(fa){var ca=L.findFeatures(H,r.featureLayer)[0];if(!fa.success&&ca.attributes[r.featureLayer.objectIdField]===fa.objectId&&aa){var ea=aa.field;fa=aa.graphic.attributes[ea.name];var ba=x.filter(this._currentLInfo.fieldInfos,function(ja){return ja.fieldName===ea.name},this)[0].dijit;ca.attributes[ea.name]=
fa;"esriFieldTypeDate"===ea.type&&(fa=new Date(fa));this._setValue(ba,fa)}},this)}this._rollbackInfo=null},onFieldValueChange:function(r,v){var H=r.field,T=r.dijit,U=this._currentFeature,Z=this._currentLInfo,aa=H.name;r=this._isFieldRequired(H,r);if(""===T.displayedValue||"dijit.form.ValidationTextBox"!==T.declaredClass||T.isValid())if(""!==T.displayedValue&&T.displayedValue!==v&&T.isValid&&!T.isValid())this._setValue(T,U.attributes[H.name]);else{var fa=!("esriFieldTypeInteger"!==H.type&&"esriFieldTypeSmallInteger"!==
H.type&&"esriFieldTypeSingle"!==H.type&&"esriFieldTypeDouble"!==H.type);if(r&&(null===v||""===v||"undefined"===typeof v||fa&&isNaN(v))){aa=U.attributes[H.name];if("esriFieldTypeDate"===H.type&&(aa=new Date(aa),T instanceof Array)){this._setValue(T[0],aa);this._setValue(T[1],aa);return}this._setValue(T,aa)}else{if(fa){if(isNaN(v)||""===v)v=null;fa&&null!==v&&(v=Number(v))}"esriFieldTypeDate"===H.type&&(T instanceof Array?(v=T[0].getValue(),T=T[1].getValue(),v=v&&T?new Date(v.getFullYear(),v.getMonth(),
v.getDate(),T.getHours(),T.getMinutes(),T.getSeconds(),T.getMilliseconds()):v||T||null):(v=T.getValue(),H.domain&&(v=Number(v))),v=v&&v.getTime?v.getTime():v&&v.toGregorian?v.toGregorian().getTime():v);if(this._currentFeature.attributes[H.name]!==v){if(aa===Z.typeIdField){var ca=this._findFirst(Z.types,"id",v);x.forEach(Z.fieldInfos,function(ea){(H=ea.field)&&H.name!==Z.typeIdField&&(ea=ea.dijit,this._setFieldDomain(ea,ca,H)&&ea&&(this._setValue(ea,U.attributes[H.name]+""),!1===ea.isValid()&&this._setValue(ea,
null)))},this)}this.onAttributeChange(U,aa,v)}}}else this._setValue(T,U.attributes[H.name])},onDeleteBtn:function(r){this._deleteFeature()},onNextFeature:function(r){this._onNextFeature(1)},onPreviousFeature:function(r){this._onNextFeature(-1)},onFirstFeature:function(r){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(r){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var r=this._layerInfos;this._editorTrackingInfos={};x.forEach(r,this._initLayerInfo,
this)},_initLayerInfo:function(r){var v=r.featureLayer,H;this._userIds={};var T=v.id;v.credential&&(this._userIds[T]=v.credential.userId);r.userId&&(this._userIds[T]=r.userId);this._connect(v,"onSelectionComplete",J.hitch(this,"onLayerSelectionChange",r));this._connect(v,"onSelectionClear",J.hitch(this,"onLayerSelectionClear",r));this._connect(v,"onEditsComplete",J.hitch(this,"onLayerEditsComplete",r));this._connect(v,"error",J.hitch(this,"onLayerError",r));this._connect(v,"onUpdateEnd",J.hitch(this,
"onLayerUpdateEnd",r));r.showAttachments=v.hasAttachments?n.isDefined(r.showAttachments)?r.showAttachments:!0:!1;r.hideFields=r.hideFields||[];r.htmlFields=r.htmlFields||[];r.isEditable=v.isEditable()?n.isDefined(r.isEditable)?r.isEditable:!0:!1;r.typeIdField=v.typeIdField;r.layerId=v.id;r.types=v.types;v.globalIdField&&((H=this._findFirst(r.fieldInfos,"fieldName",v.globalIdField))||r.showGlobalID||r.hideFields.push(v.globalIdField));(T=this._findFirst(r.fieldInfos,"fieldName",v.objectIdField))||
r.showObjectID||r.hideFields.push(v.objectIdField);var U=this._getFields(r.featureLayer);if(U){var Z=r.fieldInfos||[];Z=x.map(Z,function(aa){return J.mixin({},aa)});Z.length?r.fieldInfos=x.filter(x.map(Z,J.hitch(this,function(aa){var fa=aa.stringFieldOption||(this._isInFields(aa.fieldName,r.htmlFields)?z.STRING_FIELD_OPTION_RICHTEXT:z.STRING_FIELD_OPTION_TEXTBOX);return J.mixin(aa,{field:this._findFirst(U,"name",aa.fieldName),stringFieldOption:fa})})),"return item.field;"):(U=x.filter(U,J.hitch(this,
function(aa){return!this._isInFields(aa.name,r.hideFields)})),r.fieldInfos=x.map(U,J.hitch(this,function(aa){var fa=this._isInFields(aa.name,r.htmlFields)?z.STRING_FIELD_OPTION_RICHTEXT:z.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:aa.name,field:aa,stringFieldOption:fa}})));r.showGlobalID&&!H&&Z.push(this._findFirst(U,"name",v.globalIdField));r.showObjectID&&!T&&Z.push(this._findFirst(U,"name",v.objectIdField));H=[];v.editFieldsInfo&&(v.editFieldsInfo.creatorField&&H.push(v.editFieldsInfo.creatorField),
v.editFieldsInfo.creationDateField&&H.push(v.editFieldsInfo.creationDateField),v.editFieldsInfo.editorField&&H.push(v.editFieldsInfo.editorField),v.editFieldsInfo.editDateField&&H.push(v.editFieldsInfo.editDateField));this._editorTrackingInfos[v.id]=H}},_createAttachmentEditor:function(){this._attachmentEditor=null;var r=x.filter(this._layerInfos,function(v){return v.showAttachments});r&&r.length&&(this._attachmentEditor=new N({"class":this.css.attachmentEditor},this.attachmentEditor),this._attachmentEditor.startup())},
_setCurrentLInfo:function(r){var v=this._currentLInfo?this._currentLInfo.featureLayer:null,H=r.featureLayer;if(v&&v.id===H.id&&!v.ownershipBasedAccessControlForFeatures&&(v=H.getEditCapabilities(),!v.canCreate||v.canUpdate))return;this._currentLInfo=r;this._createTable()},_updateSelection:function(r,v){this._selection=r||[];x.forEach(this._layerInfos,this._getSelection,this);this._selection=L.sortFeaturesById(this._layerInfos,this._selection);this._numFeatures=this._selection.length;this._showFeature(this._numFeatures?
this._selection[this._featureIdx]:null,v)},_getSelection:function(r){r=r.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(r)},_updateUI:function(){var r=this._numFeatures,v=this._currentLInfo;this.layerName.innerHTML=v&&0!==r?v.featureLayer?v.featureLayer.name:"":this.NLS_noFeaturesSelected;b.set(this.attributeTable,"display",r?"":"none");b.set(this.editButtons,"display",r?"":"none");b.set(this.navButtons,"display",!this._hideNavButtons&&1<r?"":"none");this.navMessage.innerHTML=
n.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&b.set(this._attachmentEditor.domNode,"display",v&&v.showAttachments&&r?"":"none");b.set(this.deleteBtn.domNode,"display",v&&!1===v.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(r){this._featureIdx+=r;0>this._featureIdx?this._featureIdx=this._numFeatures-
1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);r=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(r);this._updateUI();this.onNext(r)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(r,v){if(r){this._currentFeature=r;v=v?v:r.getLayer();var H=v.getEditCapabilities({feature:r,userId:this._userIds[v.id]});this._canUpdate=H.canUpdate;this._canDelete=H.canDelete;if(H=this._getLInfoFromFeatureLayer(v)){this._setCurrentLInfo(H);
var T=r.attributes,U=this._findFirst(H.types,"id",T[H.typeIdField]),Z=null;x.forEach(H.fieldInfos,function(aa){Z=aa.field;var fa=[];aa.dijit&&1<aa.dijit.length?x.forEach(aa.dijit,function(ca){fa.push(ca)}):fa.push(aa.dijit);x.forEach(fa,J.hitch(this,function(ca){if(ca){var ea=this._setFieldDomain(ca,U,Z),ba=T[Z.name];ba=ba&&ea&&ea.codedValues&&ea.codedValues.length?ea.codedValues[ba]?ea.codedValues[ba].name:ba:ba;n.isDefined(ba)||(ba="");"dijit.form.DateTextBox"===ca.declaredClass||"dijit.form.TimeTextBox"===
ca.declaredClass?ba=""===ba?null:new Date(ba):"dijit.form.FilteringSelect"===ca.declaredClass&&(ca._lastValueReported=null,ba=T[Z.name]+"");try{this._setValue(ca,ba),"dijit.form.FilteringSelect"===ca.declaredClass&&!1===ca.isValid()&&this._setValue(ca,null)}catch(ja){ca.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&H.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,v);(r=v.getEditSummary(r))?(this.editorTrackingInfoDiv.innerHTML=r,p.show(this.editorTrackingInfoDiv)):
p.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(r,v,H){if(!r)return null;var T=H.domain;v&&v.domains&&v.domains[H.name]&&!1===v.domains[H.name]instanceof u&&(T=v.domains[H.name]);if(!T)return null;T.codedValues&&0<T.codedValues.length?(r.set("store",this._toStore(x.map(T.codedValues,function(U){return{id:U.code+"",name:U.name}}))),this._setValue(r,T.codedValues[0].code+"")):(r.constraints={min:n.isDefined(T.minValue)?T.minValue:Number.MIN_VALUE,max:n.isDefined(T.maxValue)?T.maxValue:
Number.MAX_VALUE},this._setValue(r,r.constraints.min));return T},_setValue:function(r,v){r.set&&(r._onChangeActive=!1,r.set("value",v,!0),r._onChangeActive=!0)},_getFields:function(r){var v=r._getOutFields();if(!v)return null;r=r.fields;return"*"==v?r:x.filter(x.map(v,J.hitch(this,"_findFirst",r,"name")),n.isDefined)},_isInFields:function(r,v){return r&&(v||v.length)?x.some(v,function(H){return H.toLowerCase()===r.toLowerCase()}):!1},_isFieldNullable:function(r,v){return!(!1===r.nullable||v.field&&
!1===v.field.nullable)},_isFieldRequired:function(r,v){return!1!==r.editable&&!1!==v.isEditable&&!this._isFieldNullable(r,v)},_findFirst:function(r,v,H){return(r=x.filter(r,function(T){return T.hasOwnProperty(v)&&T[v]===H}))&&r.length?r[0]:null},_getLInfoFromFeatureLayer:function(r){return this._findFirst(this._layerInfos,"layerId",r?r.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=d.create("table",{cellspacing:"0",cellpadding:"0"},
this.attributeTable);var r=d.create("tbody",null,this._attributes),v=this._currentLInfo,H=this._findFirst(v.types,"id",this._currentFeature.attributes[v.typeIdField]);x.forEach(v.fieldInfos,J.hitch(this,"_createField",H,r),this);this._createOnlyFirstTime=!1},_createField:function(r,v,H){var T=this._currentLInfo,U=H.field;if(!this._isInFields(U.name,T.hideFields)&&!this._isInFields(U.name,this._editorTrackingInfos[T.featureLayer.id])){var Z=!1,aa;v=d.create("tr",null,v);var fa=d.create("td",{innerHTML:H.label||
U.alias||U.name,"class":this.css.label,"data-fieldname":U.name},v);this._isFieldRequired(U,H)&&d.create("span",{"class":this.css.red,innerHTML:" *"},fa);v=d.create("td",null,v);if(H.customField){d.place(H.customField.domNode||H.customField,d.create("div",null,v),"first");var ca=H.customField}else if(!1===T.isEditable||!1===U.editable||!1===H.isEditable||"esriFieldTypeOID"===U.type||"esriFieldTypeGlobalID"===U.type||!this._canUpdate&&!this._createOnlyFirstTime)Z=!0;T=T.typeIdField&&U.name.toLowerCase()==
T.typeIdField.toLowerCase();fa=!!this._getDomainForField(U,r);!ca&&T?ca=this._createTypeField(U,H,v):!ca&&fa&&(ca=this._createDomainField(U,H,r,v));if(!ca)switch(U.type){case "esriFieldTypeString":ca=this._createStringField(U,H,v);break;case "esriFieldTypeDate":ca=this._createDateField(U,H,v);H.format&&H.format.time&&(aa=this._createTimeField(U,H,v));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":ca=this._createIntField(U,H,v);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":ca=
this._createFltField(U,H,v);break;default:ca=this._createStringField(U,H,v)}H.tooltip&&H.tooltip.length&&this._toolTips.push(new V({connectId:[ca.id],label:H.tooltip}));ca.onChange=J.hitch(this,"onFieldValueChange",H);ca.set("disabled",Z);aa?(H.dijit=[ca,aa],aa.onChange=J.hitch(this,"onFieldValueChange",H),aa.set("disabled",Z)):H.dijit=ca}},_createTypeField:function(r,v,H){H=d.create("div",null,H);var T=r.domain;return T&&"range"===T.type&&T.minValue===T.maxValue?new S({"class":this.css.field,trim:!0,
maxLength:r.length,name:r.alias||r.name,required:this._isFieldRequired(r,v)},H):new O({"class":this.css.field,name:r.alias||r.name,required:this._isFieldRequired(r,v),store:this._toStore(x.map(this._currentLInfo.types,function(U){return{id:U.id,name:U.name}})),searchAttr:"name"},H)},_getDomainForField:function(r,v){var H=r.domain;(r=r.name)&&v&&v.domains&&v.domains[r]&&!1===v.domains[r]instanceof u&&(H=v.domains[r]);return H||null},_createDomainField:function(r,v,H,T){H=this._getDomainForField(r,
H);T=d.create("div",null,T);return H.codedValues?new O({"class":this.css.field,name:r.alias||r.name,searchAttr:"name",required:this._isFieldRequired(r,v)},T):new l({"class":this.css.field},T)},_createStringField:function(r,v,H){H=d.create("div",null,H);var T={trim:!0,maxLength:r.length,required:this._isFieldRequired(r,v)};if(v.stringFieldOption===z.STRING_FIELD_OPTION_TEXTAREA)return T["class"]=this.css.field+" "+this.css.textArea,new M(T,H);if(v.stringFieldOption===z.STRING_FIELD_OPTION_RICHTEXT)return T["class"]=
this.css.field+" "+this.css.richText,T.height="100%",T.width="100%",T.plugins=v.richTextPlugins||this._defaultRichTextPlugins,H=new c(T,H),H.startup(),H;var U=this;T.validator=function(Z,aa){this._maskValidSubsetError=!1;this._hasBeenBlurred=!0;return U._isFieldNullable(r,v)||!(""===Z||null===Z)};return new S(T,H)},_createTimeField:function(r,v,H){H=d.create("div",null,H);r={"class":this.css.field,trim:!0,required:this._isFieldRequired(r,v),constraints:{formatLength:"medium"}};this._datePackage&&
(r.datePackage=this._datePackage);return new Q(r,H)},_createDateField:function(r,v,H){H=d.create("div",null,H);r={"class":this.css.field,trim:!0,required:this._isFieldRequired(r,v)};this._datePackage&&(r.datePackage=this._datePackage);return new q(r,H)},_createIntField:function(r,v,H){H=d.create("div",null,H);return new E({"class":this.css.field,constraints:"esriFieldTypeSmallInteger"===r.type?{min:-32768,max:32767,places:0}:{places:0},trim:!0,invalidMessage:this.NLS_validationInt,required:this._isFieldRequired(r,
v)},H)},_createFltField:function(r,v,H){H=d.create("div",null,H);return new E({"class":this.css.field,constraints:{max:Infinity,min:-Infinity,places:"0,20"},trim:!0,invalidMessage:this.NLS_validationFlt,required:this._isFieldRequired(r,v)},H)},_toStore:function(r){return new W({data:{identifier:"id",label:"name",items:r}})},_connect:function(r,v,H){this._aiConnects.push(K.connect(r,v,H))},_getDatePackage:function(r){return null===r.datePackage?null:r.datePackage?r.datePackage:"ar"===a.locale?"dojox.date.islamic":
null},_destroyAttributeTable:function(){x.forEach(this._layerInfos,function(r){x.forEach(r.fieldInfos,function(v){var H=v.dijit;if(H){H._onChangeHandle=null;if(v.customField)return;H instanceof Array?x.forEach(H,J.hitch(this,function(T){T.destroyRecursive?T.destroyRecursive():T.destroy&&T.destroy();T._onChangeHandle=null})):H.destroyRecursive?H.destroyRecursive():H.destroy&&H.destroy()}v.dijit=null},this)},this);x.forEach(this._toolTips,function(r){r.destroy()});this._toolTips=[];this._attributes&&
d.destroy(this._attributes)}});J.mixin(z,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});e("extend-esri")&&J.setObject("dijit.AttributeInspector",z,h);return z})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g){F=F([h,n],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:f,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}' style\x3d'display: flex;'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;padding:0 2px;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},
_layerEditingCap:{},constructor:function(w,B){J.mixin(this,g.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=x.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=x.connect(this._uploadField,"onfocus",J.hitch(this,function(w){C.hide(this._attachmentError)}))},destroy:function(){K.forEach(this._aeConnects,x.disconnect);x.disconnect(this._uploadField_connect);x.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(w,B){this._attachmentList.innerHTML=this.NLS_none;this._uploadField.value="";K.forEach(this.domNode.children,function(c,m){C.show(c)});C.hide(this._attachmentError);w&&(this._featureLayer=w.getLayer()||B)&&("esri.layers.FeatureLayer"===this._featureLayer.declaredClass&&this._featureLayer.getEditCapabilities?(this._currentLayerId=this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=
this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:w}).canUpdate,this._oid=w.attributes[this._featureLayer.objectIdField],this._getAttachments(w)):B&&B.getEditCapabilities()||(C.hide(this._uploadForm),K.forEach(this.domNode.children,function(c,m){C.hide(c)})))},_getAttachments:function(w){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,
J.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){C.hide(this._attachmentError);this._featureLayer&&this._featureLayer.addAttachment?(C.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,J.hitch(this,"_onAddAttachmentComplete"),J.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(w,B){this._tempUpload&&(C.show(this._attachmentProgress),B.addAttachment(w,this._tempUpload,J.hitch(this,"_onAddAttachmentComplete"),
J.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(w,B){C.show(this._attachmentProgress);this._featureLayer.deleteAttachments(w,[B],J.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(w){var B=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?
(B=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(B=this._listHtml+this._endHtml);var c=this._attachmentList;w=K.map(w,J.hitch(this,function(m){return G.substitute({href:m.url,name:m.name,oid:m.objectId,attid:m.id},B)}));c.innerHTML=w.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(w){C.hide(this._attachmentProgress.domNode);var B=this._attachmentList,
c=this._uploadField,m=c.value,A=m.lastIndexOf("\\");-1<A&&(m=m.substring(A+1,m.length));m=m.replace(/ /g,"_");A=b.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()});var D=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(D=this._listHtml+this._endHtml);w=G.substitute({href:this._featureLayer._url.path+"/"+w.objectId+"/attachments/"+w.attachmentId+
(A?"?"+A:""),name:m,oid:w.objectId,attid:w.attachmentId},D);B.innerHTML=B.innerHTML==this.NLS_none?w:B.innerHTML+w;this._updateConnects();c.value=""},_onAddAttachmentError:function(w){C.hide(this._attachmentProgress.domNode);if(w){var B=this.NLS_error,c=this._attachmentError;G.isDefined(w.code)&&400===w.code&&(B=this.NLS_fileNotSupported);d.set(c,"innerHTML",B);C.show(c)}},_onDeleteAttachmentComplete:function(w){C.hide(this._attachmentProgress.domNode);var B=this._attachmentList;K.every(w,function(c){return c.success})&&
(t.query("#node_"+w[0].objectId+"_"+w[0].attachmentId).orphan(),B.children&&B.children.length||(B.innerHTML=this.NLS_none))},_updateConnects:function(){K.forEach(this._aeConnects,x.disconnect);t.query(".deleteAttachment").forEach(function(w){this._aeConnects.push(x.connect(w,"onclick",J.hitch(this,"_deleteAttachment",this._oid,w.id)))},this)}});a("extend-esri")&&J.setObject("dijit.editing.AttachmentEditor",F,u);return F})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(F,J,x,K,t,a,e,b){return J("dijit.ProgressBar",[a,e],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:b,_indeterminateHighContrastImagePath:F.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(d){var h="rtl"==d.toLowerCase();x.toggle(this.domNode,"dijitProgressBarRtl",h);x.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&h);this.inherited(arguments)},update:function(d){K.mixin(this,d||{});d=this.internalProgress;var h=this.domNode,n=1;this.indeterminate?h.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(n=Math.min(parseFloat(this.progress)/100,1),this.progress=n*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),n=this.maximum?this.progress/this.maximum:0),h.setAttribute("aria-valuenow",this.progress));h.setAttribute("aria-labelledby",this.labelNode.id);h.setAttribute("aria-valuemin",0);h.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(n);x.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);x.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());d.style.width=100*n+"%";this.onChange()},_setValueAttr:function(d){this._set("value",
d);Infinity==d?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:d})},_setLabelAttr:function(d){this._set("label",d);this.update()},_setIndeterminateAttr:function(d){this._set("indeterminate",d);this.update()},report:function(d){return this.label?this.label:this.indeterminate?"\x26#160;":t.format(d,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(F,J,x,K){var t={};t={findFeatures:function(a,e,b){var d=e.objectIdField;e=J.filter(e.graphics,function(h){return J.some(a,function(n){return h.attributes[d]===n.objectId})});if(b)b(e);else return e},getSelection:function(a){var e=[];J.forEach(a,function(b){b=b.getSelectedFeatures();J.forEach(b,function(d){e.push(d)})});return e},sortFeaturesById:function(a,e){var b=J.map(a,function(d){return d.featureLayer});e.sort(function(d,h){var n=d.getLayer(),p=h.getLayer();if(!n)return-1;if(!p)return 1;
var u=J.indexOf(b,n);p=J.indexOf(b,p);u-=p;u||(n=n.objectIdField,u=d.attributes[n]-h.attributes[n]);return u});return e}};x("extend-esri")&&F.setObject("dijit.editing.Util.LayerHelper",t,K);return t})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(F,J,x,K){var t=J.getObject("date.islamic",!0,F);t.getDaysInMonth=function(a){return a.getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};t.compare=function(a,e,b){a instanceof K&&(a=a.toGregorian());
e instanceof K&&(e=e.toGregorian());return x.compare.apply(null,arguments)};t.add=function(a,e,b){var d=new K(a);switch(e){case "day":d.setDate(a.getDate()+b);break;case "weekday":var h=a.getDay();if(5>h+b&&0<h+b)d.setDate(a.getDate()+b);else{var n=e=0;5==h?(h=4,n=0<b?-1:1):6==h&&(h=4,n=0<b?-2:2);h=0<b?5-h-1:-h;var p=b-h,u=parseInt(p/5);0!=p%5&&(e=0<b?2:-2);e=e+7*u+p%5+h;d.setDate(a.getDate()+e+n)}break;case "year":d.setFullYear(a.getFullYear()+b);break;case "week":b*=7;d.setDate(a.getDate()+b);break;
case "month":a=a.getMonth();d.setMonth(a+b);break;case "hour":d.setHours(a.getHours()+b);break;case "minute":d._addMinutes(b);break;case "second":d._addSeconds(b);break;case "millisecond":d._addMilliseconds(b)}return d};t.difference=function(a,e,b){e=e||new K;b=b||"day";var d=e.getFullYear()-a.getFullYear(),h=1;switch(b){case "weekday":d=Math.round(t.difference(a,e,"day"));h=parseInt(t.difference(a,e,"week"));if(0==d%7)d=5*h;else{b=0;var n=a.getDay(),p=e.getDay();h=parseInt(d/7);e=d%7;a=new K(a);
a.setDate(a.getDate()+7*h);a=a.getDay();if(0<d)switch(!0){case 5==n:b=-1;break;case 6==n:b=0;break;case 5==p:b=-1;break;case 6==p:b=-2;break;case 5<a+e:b=-2}else if(0>d)switch(!0){case 5==n:b=0;break;case 6==n:b=1;break;case 5==p:b=2;break;case 6==p:b=1;break;case 0>a+e:b=2}d=d+b-2*h}h=d;break;case "year":h=d;break;case "month":b=e.toGregorian()>a.toGregorian()?e:a;n=e.toGregorian()>a.toGregorian()?a:e;h=b.getMonth();p=n.getMonth();if(0==d)h=b.getMonth()-n.getMonth();else for(h=12-p+h,d=n.getFullYear()+
1,b=b.getFullYear(),d;d<b;d++)h+=12;e.toGregorian()<a.toGregorian()&&(h=-h);break;case "week":h=parseInt(t.difference(a,e,"day")/7);break;case "day":h/=24;case "hour":h/=60;case "minute":h/=60;case "second":h/=1E3;case "millisecond":h*=e.toGregorian().getTime()-a.toGregorian().getTime()}return Math.round(h)};return t})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(F,J,x){var K=J("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,
_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var t=arguments.length;t?1==t?(t=arguments[0],"number"==typeof t&&(t=new Date(t)),t instanceof Date?this.fromGregorian(t):""==t?this._date=new Date(""):(this._year=t._year,this._month=t._month,this._date=t._date,this._hours=t._hours,this._minutes=t._minutes,this._seconds=t._seconds,this._milliseconds=t._milliseconds)):3<=t&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=
arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(t){t=parseInt(t);if(!(0<t&&t<=this.getDaysInIslamicMonth(this._month,this._year))){var a;if(0<t)for(a=this.getDaysInIslamicMonth(this._month,this._year);t>a;t-=a,a=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(a=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=t;a=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),t+=a}this._date=t;return this},setFullYear:function(t){this._year=+t},setMonth:function(t){this._year+=Math.floor(t/12);this._month=0<t?Math.floor(t%12):Math.floor((t%12+12)%12)},setHours:function(){var t=arguments.length,a=0;1<=t&&(a=parseInt(arguments[0]));2<=t&&(this._minutes=parseInt(arguments[1]));3<=t&&(this._seconds=parseInt(arguments[2]));4==t&&(this._milliseconds=parseInt(arguments[3]));for(;24<=a;)this._date++,t=this.getDaysInIslamicMonth(this._month,
this._year),this._date>t&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=t),a-=24;this._hours=a},_addMinutes:function(t){t+=this._minutes;this.setMinutes(t);this.setHours(this._hours+parseInt(t/60));return this},_addSeconds:function(t){t+=this._seconds;this.setSeconds(t);this._addMinutes(parseInt(t/60));return this},_addMilliseconds:function(t){t+=this._milliseconds;this.setMilliseconds(t);this._addSeconds(parseInt(t/1E3));return this},setMinutes:function(t){this._minutes=
t%60;return this},setSeconds:function(t){this._seconds=t%60;return this},setMilliseconds:function(t){this._milliseconds=t%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var t=new Date;t.setHours(this._hours);t.setMinutes(this._minutes);t.setSeconds(this._seconds);t.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+t.toTimeString()},toGregorian:function(){var t=this._year;t=Math.floor(this._date+Math.ceil(29.5*this._month)+354*
(t-1)+Math.floor((3+11*t)/30)+this._ISLAMIC_EPOCH-1-.5)+.5;var a=t-this._GREGORIAN_EPOCH,e=Math.floor(a/146097),b=this._mod(a,146097);a=Math.floor(b/36524);var d=this._mod(b,36524);b=Math.floor(d/1461);d=this._mod(d,1461);d=Math.floor(d/365);e=400*e+100*a+4*b+d;4!=a&&4!=d&&e++;a=t-(this._GREGORIAN_EPOCH+365*(e-1)+Math.floor((e-1)/4)-Math.floor((e-1)/100)+Math.floor((e-1)/400));b=this._GREGORIAN_EPOCH-1+365*(e-1)+Math.floor((e-1)/4)-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor(739/12+(x.isLeapYear(new Date(e,
3,1))?-1:-2)+1);b=t<b?0:x.isLeapYear(new Date(e,3,1))?1:2;a=Math.floor((12*(a+b)+373)/367);b=this._GREGORIAN_EPOCH-1+365*(e-1)+Math.floor((e-1)/4)-Math.floor((e-1)/100)+Math.floor((e-1)/400)+Math.floor((367*a-362)/12+(2>=a?0:x.isLeapYear(new Date(e,a-1,1))?-1:-2)+1);return new Date(e,a-1,t-b+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(t){t=new Date(t);var a=t.getFullYear(),e=t.getMonth(),b=t.getDate();a=this._GREGORIAN_EPOCH-1+365*(a-1)+Math.floor((a-1)/4)+
-Math.floor((a-1)/100)+Math.floor((a-1)/400)+Math.floor((367*(e+1)-362)/12+(2>=e+1?0:x.isLeapYear(t)?-1:-2)+b);a=Math.floor(a)+.5;a-=this._ISLAMIC_EPOCH;e=Math.floor((30*a+10646)/10631);b=Math.ceil((a-29-this._yearStart(e))/29.5);b=Math.min(b,11);this._date=Math.ceil(a-this._monthStart(e,b))+1;this._month=b;this._year=e;this._hours=t.getHours();this._minutes=t.getMinutes();this._seconds=t.getSeconds();this._milliseconds=t.getMilliseconds();this._day=t.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(t){return 354*(t-1)+Math.floor((3+11*t)/30)},_monthStart:function(t,a){return Math.ceil(29.5*a)+354*(t-1)+Math.floor((3+11*t)/30)},_civilLeapYear:function(t){return 11>(14+11*t)%30},getDaysInIslamicMonth:function(t,a){var e=0;e=29+(t+1)%2;11==t&&this._civilLeapYear(a)&&e++;return e},_mod:function(t,a){return t-a*Math.floor(t/a)}});K.getDaysInIslamicMonth=function(t){return(new K).getDaysInIslamicMonth(t.getMonth(),t.getFullYear())};return K})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(F,J,x,K,t,a,e,b,d){function h(C,f,g,w,B){return B.replace(/([a-z])\1*/ig,function(c){var m=c.charAt(0);c=c.length;var A=["abbr","wide","narrow"];switch(m){case "G":var D=f.eraAbbr[0];break;case "y":D=String(C.getFullYear());break;case "M":D=C.getMonth();if(3>c){D+=1;var N=!0}else m=["months-format",A[c-3]].join("-"),D=f[m][D];break;case "d":D=C.getDate(!0);N=!0;break;case "E":D=C.getDay();3>c?(D+=1,N=!0):(m=["days-format",A[c-3]].join("-"),D=f[m][D]);break;case "a":D=12>C.getHours()?"am":
"pm";D=f["dayPeriods-format-wide-"+D];break;case "h":case "H":case "K":case "k":N=C.getHours();switch(m){case "h":D=N%12||12;break;case "H":D=N;break;case "K":D=N%12;break;case "k":D=N||24}N=!0;break;case "m":D=C.getMinutes();N=!0;break;case "s":D=C.getSeconds();N=!0;break;case "S":D=Math.round(C.getMilliseconds()*Math.pow(10,c-3));N=!0;break;case "z":if(D=K.getTimezoneName(C.toGregorian()))break;c=4;case "Z":D=C.toGregorian().getTimezoneOffset();D=[0>=D?"+":"-",e.pad(Math.floor(Math.abs(D)/60),2),
e.pad(Math.abs(D)%60,2)];4==c&&(D.splice(0,0,"GMT"),D.splice(3,0,":"));D=D.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+B);}N&&(D=e.pad(D,c));return D})}function n(C,f,g,w){var B=function(A){return A};f=f||B;g=g||B;w=w||B;var c=C.match(/(''|[^'])+/g),m="'"==C.charAt(0);x.forEach(c,function(A,D){A?(c[D]=(m?g:f)(A),m=!m):c[D]=""});return w(c.join(""))}function p(C,f,g,w){w=a.escapeString(w);t.normalizeLocale(g.locale);return w.replace(/([a-z])\1*/ig,
function(B){var c=B.charAt(0);var m=B.length,A="";g.strict?1<m&&(A="0{"+(m-1)+"}"):A="0?";switch(c){case "y":c="\\d+";break;case "M":c=2<m?"\\S+ ?\\S+":A+"[1-9]|1[0-2]";break;case "d":c="[12]\\d|"+A+"[1-9]|3[01]";break;case "E":c="\\S+";break;case "h":c=A+"[1-9]|1[0-2]";break;case "k":c=A+"\\d|1[01]";break;case "H":c=A+"\\d|1\\d|2[0-3]";break;case "K":c=A+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":c=A+"\\d|[0-5]\\d";break;case "S":c="\\d{"+m+"}";break;case "a":m=g.am||f["dayPeriods-format-wide-am"];
A=g.pm||f["dayPeriods-format-wide-pm"];g.strict?c=m+"|"+A:(c=m+"|"+A,m!=m.toLowerCase()&&(c+="|"+m.toLowerCase()),A!=A.toLowerCase()&&(c+="|"+A.toLowerCase()));break;default:c=".*"}C&&C.push(B);return"("+c+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var u=J.getObject("date.islamic.locale",!0,F);u.format=function(C,f){f=f||{};var g=t.normalizeLocale(f.locale),w=f.formatLength||"short",B=u._getIslamicBundle(g),c=[];g=J.hitch(this,h,C,B,g,f.fullYear);if("year"==f.selector)return C.getFullYear();"time"!=f.selector&&
(C=f.datePattern||B["dateFormat-"+w])&&c.push(n(C,g));"date"!=f.selector&&(f=f.timePattern||B["timeFormat-"+w])&&c.push(n(f,g));return c.join(" ")};u.regexp=function(C){return u._parseInfo(C).regexp};u._parseInfo=function(C){C=C||{};var f=t.normalizeLocale(C.locale);f=u._getIslamicBundle(f);var g=C.formatLength||"short",w=C.datePattern||f["dateFormat-"+g];g=C.timePattern||f["timeFormat-"+g];var B=[];return{regexp:n("date"==C.selector?w:"time"==C.selector?g:"undefined"==typeof g?w:w+" "+g,J.hitch(this,
p,B,f,C)),tokens:B,bundle:f}};u.parse=function(C,f){C=C.replace(/[\u200E\u200F\u202A\u202E]/g,"");f||(f={});var g=u._parseInfo(f),w=g.tokens,B=g.bundle;g=g.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");C=(new RegExp("^"+g+"$")).exec(C);t.normalizeLocale(f.locale);if(!C)return null;var c=[1389,0,1,0,0,0,0],m="",A=["abbr","wide","narrow"];x.every(C,function(D,N){if(!N)return!0;N=w[N-1];var L=N.length;switch(N.charAt(0)){case "y":c[0]=Number(D);break;case "M":if(2<L){if(N=B["months-format-"+A[L-3]].concat(),
f.strict||(D=D.replace(".","").toLowerCase(),N=x.map(N,function(q){return q?q.replace(".","").toLowerCase():q})),D=x.indexOf(N,D),-1==D)return!1}else D--;c[1]=Number(D);break;case "D":c[1]=0;case "d":c[2]=Number(D);break;case "a":N=f.am||B["dayPeriods-format-wide-am"];L=f.pm||B["dayPeriods-format-wide-pm"];if(!f.strict){var R=/\./g;D=D.replace(R,"").toLowerCase();N=N.replace(R,"").toLowerCase();L=L.replace(R,"").toLowerCase()}if(f.strict&&D!=N&&D!=L)return!1;m=D==L?"p":D==N?"a":"";break;case "K":24==
D&&(D=0);case "h":case "H":case "k":c[3]=Number(D);break;case "m":c[4]=Number(D);break;case "s":c[5]=Number(D);break;case "S":c[6]=Number(D)}return!0});C=+c[3];"p"===m&&12>C?c[3]=C+12:"a"===m&&12==C&&(c[3]=0);return new b(c[0],c[1],c[2],c[3],c[4],c[5],c[6])};var G=[];u.addCustomFormats=function(C,f){G.push({pkg:C,name:f})};u._getIslamicBundle=function(C){var f={};x.forEach(G,function(g){g=t.getLocalization(g.pkg,g.name,C);f=J.mixin(f,g)},this);return f};u.addCustomFormats("dojo.cldr","islamic");u.getNames=
function(C,f,g,w,B){w=u._getIslamicBundle(w);C=[C,g,f];if("standAlone"==g){g=C.join("-");var c=w[g];1==c[0]&&(c=void 0)}C[1]="format";return(c||w[C.join("-")]).concat()};u.weekDays=u.getNames("days","wide","format");u.months=u.getNames("months","wide","format");return u})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(F,J,x){return F([J],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services",
"http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],_createServiceBrowser:function(K){return new x(K)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C){return F([J,x,K,a],{templateString:t,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=h.mixin({},window.jimuNls.common);this.nls=h.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
b.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(f){var g=new e;(this.url=f)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),g=this._onBtnValidateClick()):g.reject();return g},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?d.forEach(this._examples,h.hitch(this,function(g){b.create("div",{innerHTML:g,
"class":"example-url"},this.exampleTd)})):b.setStyle(this.exampleTr,"display","none");var f={multiple:this.multiple,_onTreeClick:h.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(f);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(p.after(this.urlInput,"validator",h.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(n(this.serviceBrowser,"error",h.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(f){},_validateUrl:function(f){f=f.replace(/\/*$/g,"");if((f=f.match(/\/rest\/services\/*(.*)/gi))&&0<f.length)if(f=f[0].replace(/\/rest\/services\/*/,"")){var g=f.split("/");if(1===g.length)return!0;if(2===g.length)return this.serviceBrowser.isServiceTypeSupported(g[1]);if(3<=g.length)return f=this.serviceBrowser.isServiceTypeSupported(g[1]),g=this.serviceBrowser.isServiceTypeSupported(g[2]),f||g}else return!0;else return!1},_afterUrlValidate:function(f){f&&
(f=this.urlInput.get("value"),f=this._validateUrl(f));f?b.removeClass(this.btnValidate,"jimu-state-disabled"):b.addClass(this.btnValidate,"jimu-state-disabled");return f},_onServiceBrowserError:function(f){this._showErrorMessage(f)},_showErrorMessage:function(f){f&&"string"===typeof f?(this.errorNode.innerHTML=f,b.addClass(this.errorSection,"visible")):b.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";b.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var f=new e;if(this.urlInput.validate()){var g=this.urlInput.get("value");this.serviceBrowser.setUrl(g).then(h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();f.resolve()}),h.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();f.reject()}));this.emit("validate-click")}else f.reject();return f},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?b.removeClass(this.btnOk,"jimu-state-disabled"):
b.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var f=this.getSelectedItems();0<f.length&&this.emit("ok",f)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(F,J,x,K,t){return F([J],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",
url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=t.getGeocodeServiceBrowserRule()},getSelectedItems:function(){var a=this.inherited(arguments);return a=K.map(a,x.hitch(this,function(e){return{name:e.name,url:e.url}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C){return F([J,x,K,t],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(f){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new d;f&&"string"===typeof f&&f.replace(/\/*$/g,"")||this._def.reject();f=f.replace(/\/*$/g,"");f=a.trim(f);var g=f.match(/^http(s?):\/\//gi);g&&0<g.length||
(f="http://"+f);if(!(0>=f.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=f))return f=this._getRootItem(),f=G.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,f):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,f):this._searchFolderServiceUrl(this._currentUrl,f),this.shelter.show(),f.then(a.hitch(this,function(w){this.domNode&&this.shelter.hide();var B=this.tree.getAllLeafTreeNodeWidgets();1===B.length&&
B[0].select();this._def.resolve(w)}),a.hitch(this,function(w){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(w)})),this._def;this._def.reject()},_getItem:function(f){return this.rule.getItem(f)},_getSubItemUrls:function(f){return this.rule.getSubItemUrls(f)},_getSubItems:function(f){var g=new d;this._getSubItemUrls(f).then(a.hitch(this,function(w){w=b.map(w,a.hitch(this,function(B){return this._getItem(B)}));h(w).then(a.hitch(this,function(B){B=b.filter(B,a.hitch(this,
function(c){return c&&"object"===typeof c}));g.resolve(B)}),a.hitch(this,function(B){g.reject(B)}))}),a.hitch(this,function(w){g.reject(w)}));return g},_selectFirstLeafTreeNodeWidget:function(){var f=this.tree.getAllLeafTreeNodeWidgets();1===f.length&&f[0].select()},isLeafItem:function(f){return 0<=this.rule.leafTypes.indexOf(f.type)},isServiceTypeSupported:function(f){return this.rule.isServiceTypeSupported(f)},_getStringEndWith:function(f,g){var w="",B=f.indexOf(g);0<=B&&(w=f.slice(0,B+g.length));
return w},_isUrlContainsServiceType:function(f){return this.rule.isUrlContainsServiceType(f)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(f){var g="";f=f.split("/");return g=f[f.length-1]},_searchBaseServiceUrl:function(f,g){var w=new d;this._getRestInfo(f).then(a.hitch(this,function(B){if(this.domNode){var c=[];b.map(B.folders,a.hitch(this,function(m){var A={name:m,type:"folder",url:f+"/"+m,parent:g.id};this._addItem(A);
var D=new d;this._doSearchFolderServiceUrl(A.url,A.id).then(a.hitch(this,function(N){0<N.length?b.forEach(N,a.hitch(this,function(L){L.parent=A.id;this._addItem(L)})):this._removeItem(A.id);D.resolve()}),a.hitch(this,function(N){D.reject(N)}));c.push(D);return D}));b.forEach(B.services,a.hitch(this,function(m){if(this.isServiceTypeSupported(m.type)){m=f+"/"+m.name+"/"+m.type;var A=new d;this.rule.getItem(m).then(a.hitch(this,function(D){D&&(D.parent=g.id,this._addItem(D));A.resolve()}),a.hitch(this,
function(D){console.error(D);A.reject(D)}));c.push(A)}}));h(c).then(a.hitch(this,function(){this.domNode&&w.resolve()}),a.hitch(this,function(m){console.error(m);this.domNode&&w.reject(m)}))}}),a.hitch(this,function(B){console.error(B);this.domNode&&w.reject({errorCode:"NETWORK_ERROR",error:B})}));return w},_searchFolderServiceUrl:function(f,g){var w=new d;this._doSearchFolderServiceUrl(f,g).then(a.hitch(this,function(B){this.domNode&&(b.forEach(B,a.hitch(this,function(c){c.parent=g.id;this._addItem(c)})),
w.resolve())}),a.hitch(this,function(B){console.error(B);this.domNode&&w.reject({errorCode:"NETWORK_ERROR",error:B})}));return w},_doSearchFolderServiceUrl:function(f){var g=new d,w=this._getBaseServiceUrl();this._getRestInfo(f).then(a.hitch(this,function(B){B=B.services;var c=[];B&&0<B.length&&b.forEach(B,a.hitch(this,function(m){this.isServiceTypeSupported(m.type)&&(m=this.rule.getItem(w+"/"+m.name+"/"+m.type),c.push(m))}));h(c).then(a.hitch(this,function(m){m=b.filter(m,a.hitch(this,function(A){return A}));
g.resolve(m)}),a.hitch(this,function(m){console.error(m);g.reject(m)}))}),a.hitch(this,function(B){console.error(B);g.reject(B)}));return g},_searchServiceUrl:function(f,g){var w=new d;this._getSubItems(f).then(a.hitch(this,function(B){B&&0<B.length?(b.forEach(B,a.hitch(this,function(c){c.parent=g.id;this._addItem(c)})),w.resolve()):this._getItem(f).then(a.hitch(this,function(c){c&&(c.parent=g.id,this._addItem(c));w.resolve()}),a.hitch(this,function(c){w.reject(c)}))}),a.hitch(this,function(B){w.reject(B)}));
return w},_getRestInfo:function(f){var g=new d;this.rule.getRestInfo(f).then(a.hitch(this,function(w){this.domNode&&g.resolve(w)}),a.hitch(this,function(w){this.domNode&&g.reject(w)}));return g},_clear:function(){var f=this._store.query({parent:"root"});b.forEach(f,a.hitch(this,function(g){g&&"root"!==g.id&&this._store.remove(g.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(f){this._id++;f.id=this._id.toString();this._store.add(f);return f},_removeItem:function(f){this._store.remove(f)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var f=this._getRootItem();f=new n({data:[f],getChildren:function(g){return this.query({parent:g.id})}});this._store=new p(f);f=new u({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new C({multiple:this.multiple,model:f,showRoot:!1,style:{width:"100%"},isLeafItem:a.hitch(this,this.isLeafItem),onOpen:a.hitch(this,function(g,w){this._onTreeOpen(g,w);
this.emit("tree-open",g,w)}),onClick:a.hitch(this,function(g,w,B){this._onTreeClick(g,w,B);this.emit("tree-click",g,w,B)}),getIconStyle:a.hitch(this,function(g,w){var B=null;if(!g)return null;var c={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},m=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),A=this._getIconImageName(g,w);A||("folder"===g.type?A=w?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(g.type)&&
(A=w?"folder_open_default.png":"folder_close_default.png"));A&&(c.backgroundImage="url("+m+"/css/images/"+A+")",B=c);return B})});e.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(f,g){var w="";"function"===typeof this.rule.getIconImageName&&(w=this.rule.getIconImageName(f,g));return w},_mayHaveChildren:function(f){return"root"===f.type?!0:!this.isLeafItem(f)},_onTreeOpen:function(f,g){"root"===f.id||0<this._store.query({parent:f.id}).length||
f.checking||f.checked||(f.checking=!0,this._getSubItems(f.url).then(a.hitch(this,function(w){b.forEach(w,a.hitch(this,function(B){B.parent=f.id;this._addItem(B)}));f.checking=!1;f.checked=!0}),a.hitch(this,function(w){console.error(w);f.checking=!1;f.checked=!0})))},_onTreeClick:function(f,g,w){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(F,J,x,K,t){var a={combineRules:function(e){var b=new t;J.forEach(e,function(d){J.forEach(d.leafTypes,function(h){0>b.leafTypes.indexOf(h)&&b.leafTypes.push(h)});J.forEach(d.serviceTypes,function(h){0>b.serviceTypes.indexOf(h)&&b.serviceTypes.push(h)})});b.getMatchedRule=function(d){var h=null;J.some(e,function(n){return n.isUrlContainsServiceType(d)?(h=n,!0):!1});return h};b.getItem=function(d){var h=null;return h=(h=b.getMatchedRule(d))?h.getItem(d):
b.defaultGetItem(d)};b.getSubItemUrls=function(d){var h=null;return h=(h=b.getMatchedRule(d))?h.getSubItemUrls(d):b.defaultGetSubItemUrls(d)};b.getIconImageName=function(d,h){var n="";if(d.url){var p=b.getMatchedRule(d.url);p&&"function"===typeof p.getIconImageName&&(n=p.getIconImageName(d,h))}return n};return b},getFeaturelayerServiceBrowserRule:function(e,b,d){e=F.clone(e);var h=["point","polyline","polygon"];F.isArrayLike(e)&&0<e.length?(e=J.filter(e,function(n){return 0<=h.indexOf(n)}),0===e.length&&
(e=h)):e=h;return a._getFeaturelayerServiceBrowserRule(e,b,d)},_getFeaturelayerServiceBrowserRule:function(e,b,d){return new t({types:e,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(h){var n=new x;this.isUrlEndWithServiceType(h,this.serviceTypes)?n=this.defaultGetItem(h):this.getRestInfo(h).then(F.hitch(this,function(p){p=this._getItemByLayerDefinition(h,p);n.resolve(p)}),
F.hitch(this,function(p){n.reject(p)}));return n},getSubItemUrls:function(h){var n=new x;return n=this.isUrlEndWithServiceType(h)?this._getSubUrlsByServiceUrl(h):this._getSubUrlsByGroupUrl(h)},getIconImageName:function(h,n){var p="";"MapServer"===h.type||"FeatureServer"===h.type?p=n?"mapserver_open.png":"mapserver_close.png":h.type===this._groupLayerType?p=n?"group_layer2.png":"group_layer1.png":h.type===this._featureLayerType?(h=K.getTypeByGeometryType(h.definition&&h.definition.geometryType),"point"===
h?p="point_layer1.png":"polyline"===h?p="line_layer1.png":"polygon"===h&&(p="polygon_layer1.png")):h.type===this._tableType?p="table.png":"root"===h.type&&this._currentUrl&&J.some(this.serviceTypes,F.hitch(this,function(u){return K.isStringEndWith(this._currentUrl,"/"+u)}))&&(p=n?"mapserver_open.png":"mapserver_close.png");return p},_getSubUrlsByServiceUrl:function(h){var n=new x;this.getRestInfo(h).then(F.hitch(this,function(p){var u=[];J.forEach(p.layers,F.hitch(this,function(G){0<=G.parentLayerId||
u.push(h+"/"+G.id)}));d&&J.forEach(p.tables,F.hitch(this,function(G){0<=G.parentLayerId||u.push(h+"/"+G.id)}));n.resolve(u)}),F.hitch(this,function(p){n.reject(p)}));return n},_getSubUrlsByGroupUrl:function(h){var n=new x;this.getRestInfo(h).then(F.hitch(this,function(p){var u=[];if(p.type===this._groupLayerType){var G=this._getServiceUrlByLayerUrl(h);u=J.map(p.subLayers||[],F.hitch(this,function(C){return G+"/"+C.id}))}n.resolve(u)}),F.hitch(this,function(p){n.reject(p)}));return n},_getItemByLayerDefinition:function(h,
n){var p=null,u=n.type;if(u===this._groupLayerType)p={name:n.name,type:u,url:h,definition:n};else if(u===this._featureLayerType||u===this._tableType){var G=!1;u===this._featureLayerType?G=this._validateEsriGeometryType(n.geometryType):u===this._tableType&&(G=!0);G&&(G=!1,(G=b?K.isFeaturelayerUrlSupportQuery(h,n.capabilities):!0)&&(p={name:n.name,type:u,url:h,definition:n}))}return p},_validateEsriGeometryType:function(h){h=K.getTypeByGeometryType(h);return 0<=this.types.indexOf(h)},_getServiceUrlByLayerUrl:function(h){for(var n=
"",p=0;p<this.serviceTypes.length;p++){var u=this.serviceTypes[p].toLowerCase(),G=h.toLowerCase().lastIndexOf("/"+u+"/");if(0<=G){n=h.slice(0,G+u.length+1);break}}return n}})},getGeocodeServiceBrowserRule:function(){return new t({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new t({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(e){var b=new x;this.isUrlEndWithServiceType(e)?b=this.defaultGetItem(e):this.getRestInfo(e).then(F.hitch(this,
function(d){b.resolve({name:d.displayName||d.name,type:"GPTask",url:e,definition:d})}),F.hitch(this,function(d){b.reject(d)}));return b},getSubItemUrls:function(e){var b=new x;this.isUrlEndWithServiceType(e)?this.getRestInfo(e).then(F.hitch(this,function(d){d=J.map(d.tasks||[],F.hitch(this,function(h){return e+"/"+h}));b.resolve(d)}),F.hitch(this,function(d){b.reject(d)})):b.resolve([]);return b},getIconImageName:function(e,b){b="";"GPServer"===e.type?b="toolbox.png":"GPTask"===e.type&&(b="tool.png");
return b}})},getImageServiceBrowserRule:function(e){return new t({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(b){var d=new x;this.isUrlEndWithServiceType(b)?this.defaultGetItem(b).then(F.hitch(this,function(h){e?K.isImageServiceSupportQuery(h.definition.capabilities)?d.resolve(h):d.resolve(null):d.resolve(h)}),F.hitch(this,function(h){d.reject(h)})):d.resolve(null);return d},getIconImageName:function(b,d){d="";"ImageServer"===b.type&&(d="image_layer.png");return d}})},
getQueryableServiceBrowserRule:function(){var e=a.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),b=a.getImageServiceBrowserRule(!0);return a.combineRules([e,b])}};return a})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(F,J,x,K,t,a,e){return F([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(b){J.mixin(this,b);J.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);J.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(b){return this.defaultGetItem(b)},getSubItemUrls:function(b){return this.defaultGetSubItemUrls(b)},getIconImageName:function(b,d){return""},defaultGetItem:function(b){var d=new K;b=b.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(b)){var h=b.split("/"),n=h[h.length-1],p=h[h.length-2];this.getRestInfo(b).then(J.hitch(this,function(u){d.resolve({name:p,type:n,url:b,definition:u})}),J.hitch(this,function(u){console.error(u);
d.reject({errorCode:"NETWORK_ERROR",error:u})}))}else d.resolve(null);return d},defaultGetSubItemUrls:function(b){b=new K;b.resolve([]);return b},getRestInfo:function(b){var d=new K;b=b.replace(/\/*$/g,"");var h=this._restInfoCache[b];if(h)d.resolve(h);else{h={url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4};var n=e.findCredential(b);n&&n.token&&(h.content.token=n.token);a(h).then(J.hitch(this,function(p){this._restInfoCache[b]=p;d.resolve(p)}),function(p){d.reject(p)})}return d},
isServiceTypeSupported:function(b){b=b.toLowerCase();return x.some(this.serviceTypes,J.hitch(this,function(d){return d.toLowerCase()===b}))},isUrlEndWithServiceType:function(b){return x.some(this.serviceTypes,J.hitch(this,function(d){return t.isStringEndWith(b,"/"+d)}))},isUrlContainsServiceType:function(b){b=b.toLowerCase();return x.some(this.serviceTypes,J.hitch(this,function(d){d=d.toLowerCase();return 0<=b.indexOf("/"+d)}))}})})},"widgets/SmartEditor/setting/Preset":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/on dojo/string dojo/mouse dojo/text!./Preset.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/CheckBox jimu/dijit/Message dijit/form/Select dijit/form/ValidationTextBox ./ChooseFromLayer ./RelativeDates ./RelativeDomains dojo/dom-class dijit/form/NumberTextBox ./layersAndFieldsApplyOn ../presetUtils jimu/utils".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N){return F([n,J,h],{baseClass:"jimu-widget-smartEditor-setting-presetPopup",templateString:d,groupNameTextBox:null,dataTypeDropdown:null,hasDomainField:null,presetValueDijitNode:null,presetValueTimeNode:null,_selectedRelativeDate:null,_selectedRelativeDomains:null,_selectedDomainFields:[],ValidFieldsByTypeToApplyOn:{esriFieldTypeInteger:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],esriFieldTypeGUID:["esriFieldTypeGUID"],
esriFieldTypeDate:["esriFieldTypeDate"],esriFieldTypeString:["esriFieldTypeString"]},postCreate:function(){this.inherited(arguments);this._isDomainField();this._initControls();this.isDelete||this.showDialog()},_initControls:function(){this.groupNameTextBox=new f({required:!0,trim:!0,style:{width:"100%"}});this.groupNameTextBox.placeAt(this.groupNameDiv);this.groupNameTextBox.validator=x.hitch(this,function(L){return L?L!==this.prevName&&this.editUtils.isDuplicateGroupName(L,this.existingGroupNames)?
(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.uniqueGroupNameMsg),!1):!0:(this.groupNameTextBox.set("invalidMessage",this.nls.smartActionsPage.requiredGroupNameMsg),!1)});this.groupNameTextBox.startup();this.name&&this.groupNameTextBox.set("value",this.name);this.dataTypeDropdown=new C({options:this._addDataTypeOptions(),style:{width:"100%"}});this.own(a(this.dataTypeDropdown,"change",x.hitch(this,function(L){var R;this.chooseFromLayerInfo&&(this.chooseFromLayerInfo=null);
this.showOnlyDomainFieldsCB.getValue()||"esriFieldTypeDate"!==L||(this._selectedRelativeDate=R={dateType:"fixed"});this._createValueDijit(L,R,!0);this._domainTableData=[];this._enableDisablePresetValueDijit()})));this.dataTypeDropdown.placeAt(this.dataTypeDropdownDiv);this.dataTypeDropdown.startup();this.showOnlyDomainFieldsCB=new u({label:this.nls.presetPage.showOnlyDomainFields},t.create("div",{},this.showOnlyDomainFieldsNode));this.showOnlyDomainFields&&this.showOnlyDomainFieldsCB.setValue(!0);
this.own(a(this.showOnlyDomainFieldsCB,"change",x.hitch(this,function(L){var R,q=this.dataTypeDropdown.get("value");L||"esriFieldTypeDate"!==q||(this._selectedRelativeDate=R={dateType:"fixed"});this._createValueDijit(q,R,!0);this._createLayersAndFields(q,L)})));this.dataType&&(this.dataTypeDropdown.set("value",this.dataType,!1),this.showOnlyDomainFields?this._selectedRelativeDomains=this._domainTableData=this.presetValue:"esriFieldTypeDate"===this.dataType&&(this._selectedRelativeDate=this.presetValue),
this._createValueDijit(this.dataType,this.presetValue,!0));this.hideInPresetDisplayCB=new u({label:this.nls.presetPage.hideInPresetDisplay},t.create("div",{},this.hideInPresetDisplayNode));this.hideInPresetDisplay&&this.hideInPresetDisplayCB.setValue(!0)},_createValueDijit:function(L,R,q){var k;if(k=this.createDijitOnDataTypeChange(L))this.presetValueDijitNode=k,this.own(a(this.presetValueDijitNode.domNode,b.enter,x.hitch(this,function(){if(this._selectedRelativeDate&&"esriFieldTypeDate"===this.dataTypeDropdown.get("value")&&
!this._checkIfDomainFieldSelected()){var E=D.getDateFromRelativeInfo(this._selectedRelativeDate,!0);""===E&&(E=this.nls.relativeDates.noDateDefinedTooltip);this.presetValueDijitNode.set("title",E)}else""!==this.presetValueDijitNode.get("value")?this.presetValueDijitNode.set("title",this.presetValueDijitNode.get("value")):this.presetValueDijitNode.set("title",this.nls.relativeDates.noDateDefinedTooltip)}))),this.presetValueDijitNode.placeAt(this.presetValueDiv),this.presetValueDijitNode.startup(),
R&&(this.showOnlyDomainFields?this.presetValueDijitNode.set("value",this._getDefaultDomain(R)):"esriFieldTypeDate"===L&&R.dateType?"fixed"===R.dateType?R.dateTime?this.presetValueDijitNode.set("value",D.getDateFromRelativeInfo(R,!0)):this.presetValueDijitNode.set("value",""):this.presetValueDijitNode.set("value",this.nls.relativeDates[R.dateType]):this.presetValueDijitNode.set("value",R)),q&&this._createLayersAndFields(L,!1)},_addDataTypeOptions:function(){return[{label:this.nls.dataType.esriFieldTypeString,
value:"esriFieldTypeString"},{label:this.nls.dataType.esriFieldTypeInteger,value:"esriFieldTypeInteger"},{label:this.nls.dataType.esriFieldTypeDate,value:"esriFieldTypeDate"},{label:this.nls.dataType.esriFieldTypeGUID,value:"esriFieldTypeGUID"}]},_isDomainField:function(){K.forEach(this._totalLayers,x.hitch(this,function(L){K.some(L.layerObject.fields,x.hitch(this,function(R){if(R.domain&&"codedValue"===R.domain.type)return this.hasDomainField=!0}))}))},_createLayerFieldsFilter:function(L,R){var q=
[],k={};K.forEach(this._totalLayers,x.hitch(this,function(E){(!E.isTable||E.isTable&&0<E.layerObject.relationships.length)&&K.forEach(E.layerObject.fields,x.hitch(this,function(O){this.ValidFieldsByTypeToApplyOn[L]&&(q=this.ValidFieldsByTypeToApplyOn[L],-1<q.indexOf(O.type)&&O.editable&&(!R||O.domain&&(!O.domain||"range"!==O.domain.type))&&(k[E.id]||(k[E.id]={}),k[E.id][O.name]=O))}))}));return k},_createLayersAndFields:function(L,R){this._layerAndFieldsApplyOnObj=new A({map:this.map,showDomainFieldIndicator:!0,
layerInfos:this.layerInfos,_configInfos:this._configInfos,actionName:"Preset",nls:this.nls,prevName:this.prevName,existingGroups:this.existingGroups,_configuredPresetInfos:this._configuredPresetInfos,layerDetails:this._createLayerFieldsFilter(L,R),appliedOn:this.appliedOn});t.empty(this.tableParentContainer);this._layerAndFieldsApplyOnObj.placeAt(this.tableParentContainer);this._layerAndFieldsApplyOnObj.startup();c.add(this._layerAndFieldsApplyOnObj.layerAndFieldsMainDiv,"esriCTOverrideForPreset");
a(this._layerAndFieldsApplyOnObj,"layerFieldsUpdated",x.hitch(this,function(q){this._fieldsToAppliedUpdated=!0;this.tableDomains=this._consolidateLayerDomains();this._domainTableData=this._createDomainData();this._checkIfDomainFieldSelected()||q||this._createValueDijit(this.dataTypeDropdown.get("value"),this.presetValueDijitNode.get("value"),!1);this._enableDisablePresetValueDijit(q)}))},_enableDisablePresetValueDijit:function(L){var R=this._checkIfDomainFieldSelected();this.presetValueDijitNode&&
(R||"esriFieldTypeDate"===this.dataTypeDropdown.get("value")?(this.presetValueDijitNode.set("disabled",!0),L=L?this.presetValue:this._domainTableData,L=this._getDefaultDomain(L),R&&this.presetValueDijitNode.set("value",L)):(this.presetValueDijitNode.set("disabled",!1),this.presetValueDijitNode.isValid()||this.presetValueDijitNode.set("value","")))},_isDomainValueSelected:function(){var L=!1,R;K.some(this._domainTableData,x.hitch(this,function(q){if(q.isDefault)return L=!0,R=q,!0}));return{isDomainSelected:L,
selectedDomain:R}},deleteGroup:function(){this._layerAndFieldsApplyOnObj.deleteGroup()},showDialog:function(){this.presetPopup=new p({titleLabel:this.nls.fieldsPage.fieldsSettingsTable.canPresetValue,width:950,maxHeight:600,autoHeight:!1,"class":this.baseClass,content:this,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var L=!0;var R={};if(this.groupNameTextBox.isValid()){R.name=N.stripHTML(this.groupNameTextBox.get("value"));R.dataType=this.dataTypeDropdown.get("value");"esriFieldTypeGUID"===
R.dataType&&""===this.presetValueDijitNode.get("value")&&(L=!1);var q=this._checkIfDomainFieldSelected();!L||this.presetValueDijitNode.isValid()||q?(R.showOnlyDomainFields=q,R.hideInPresetDisplay=this.hideInPresetDisplayCB.getValue(),q&&this._domainTableData?R.presetValue=x.clone(this._domainTableData):"esriFieldTypeDate"===R.dataType?R.presetValue=x.clone(this._selectedRelativeDate):this.presetValueDijitNode&&(R.presetValue=this.presetValueDijitNode.get("value")),this.chooseFromLayerInfo&&(R.chooseFromLayerInfo=
this.chooseFromLayerInfo),R.appliedOn=this._layerAndFieldsApplyOnObj.getCheckedFields(R),this._hasFieldsInPresetGroup(R)?(this.emit("groupInfoUpdated",R),this.presetPopup.close()):G({message:e.substitute(this.nls.attributeActionsPage.presetNoFieldWarningMsg,{groupName:R.name})})):this.presetValueDijitNode.focus()}else this.groupNameTextBox.focus()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){this.presetPopup.close()})}]});this.groupNameTextBox.focus()},
_hasFieldsInPresetGroup:function(L){var R=!1,q;for(q in L.appliedOn)if(0<L.appliedOn[q].length){R=!0;break}return R},createDijitOnDataTypeChange:function(L){t.empty(this.presetValueDiv);this.presetValueDijitNode=this.presetValueTimeNode=null;if(this._checkIfDomainFieldSelected()||"esriFieldTypeDate"===L)L=new f({required:!1,disabled:!0,trim:!0,style:{width:"100%"}});else switch(L){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":case "esriFieldTypeSingle":case "esriFieldTypeDouble":L=
new m({style:"width:100%"});break;case "esriFieldTypeGUID":L=new f({style:"width:100%"});L.validator=x.hitch(this,function(R){return""===R?!0:D.isGuid(R)});break;default:L=new f({required:!1,trim:!0,style:{width:"100%"}})}return L},_onSelectPresetValueButtonClick:function(){var L=this.dataTypeDropdown.get("value");this._checkIfDomainFieldSelected()?(this._relativeDomainsObj=new B({nls:this.nls,layerInfos:this.layerInfos,domainTableData:this._domainTableData,dataType:this.dataTypeDropdown.get("value"),
_selectedRelativeDomains:this._selectedRelativeDomains,selectedDomainFields:this._selectedDomainFields}),this.own(a(this._relativeDomainsObj,"updatePresetValue",x.hitch(this,function(R){this._selectedRelativeDomains=this._domainTableData=R.domainData;this.presetValueDijitNode.set("value",R.defaultValue)})))):"esriFieldTypeDate"===L?(this._relativeDatesObj=new w({nls:this.nls,relativeDates:this._selectedRelativeDate,map:this.map,layerInfos:this.layerInfos,selectedPresetValue:this._selectedRelativeDate&&
this._selectedRelativeDate.chooseFromLayerInfo?this._selectedRelativeDate.chooseFromLayerInfo.selectedValue:""}),this.own(a(this._relativeDatesObj,"updatePresetValue",x.hitch(this,function(R){this._selectedRelativeDate=R;"fixed"===this._selectedRelativeDate.dateType?this._selectedRelativeDate.dateTime?this.presetValueDijitNode.set("value",D.getDateFromRelativeInfo(this._selectedRelativeDate,!0)):this.presetValueDijitNode.set("value",""):this.presetValueDijitNode.set("value",this.nls.relativeDates[R.dateType])})))):
(this.ChooseFromLayerObj=new g({map:this.map,nls:this.nls,allLayers:this._totalLayers,dataType:this.dataTypeDropdown.get("value"),layerInfos:this.layerInfos,chooseFromLayerInfo:this.chooseFromLayerInfo?this.chooseFromLayerInfo:null,selectedPresetValue:this.chooseFromLayerInfo?this.chooseFromLayerInfo.selectedValue:""}),a(this.ChooseFromLayerObj,"updatePresetValue",x.hitch(this,function(R){var q=R.selectedValue,k=this.layerInfos.getLayerOrTableInfoById(R.layerId).layerObject.getField(R.field);k.domain&&
"esriFieldTypeString"===this.dataTypeDropdown.get("value")&&K.some(k.domain.codedValues,x.hitch(this,function(E){E.code.toString()===R.selectedValue.toString()&&(q=E.name)}));this.chooseFromLayerInfo=R;this.presetValueDijitNode.set("value",q)})),a(this.ChooseFromLayerObj,"cancelButtonClicked",x.hitch(this,function(){})))},_getDefaultDomain:function(L){var R="";K.some(L,x.hitch(this,function(q){if(q.isDefault)return R=q.label,!0}));return R},_consolidateLayerDomains:function(){var L=[],R,q={};var k=
this._layerAndFieldsApplyOnObj.getOnlyCheckedFields();this._selectedDomainFields=[];for(var E in k){var O=this.layerInfos.getLayerOrTableInfoById(E);K.forEach(k[E],x.hitch(this,function(y){(R=O.layerObject.getField(y))&&R.domain&&R.domain.codedValues&&(y=N.getDefaultPortalFieldInfo(R),this._selectedDomainFields.push(y.label),K.forEach(R.domain.codedValues,x.hitch(this,function(M){q.hasOwnProperty(M.code)?0>q[M.code].indexOf(M.name)&&q[M.code].push(M.name):(q[M.code]=[],q[M.code].push(M.name))})))}))}for(var l in q)L.push({value:l,
displayedLabel:q[l].join(" | ")});return L},_createDomainData:function(){var L=[];K.forEach(this._selectedRelativeDomains,x.hitch(this,function(R){for(var q,k=this.tableDomains.length-1;0<=k;k--)if(q=this.tableDomains[k].value,"esriFieldTypeString"!==this.dataTypeDropdown.get("value")&&(q=Number(q)),R.value.toString()===q.toString()){L.push({showInList:R.showInList,value:this.tableDomains[k].value,label:this.tableDomains[k].displayedLabel,isDefault:R.isDefault});this.tableDomains.splice(k,1);break}}));
K.forEach(this.tableDomains,x.hitch(this,function(R,q){L.push({showInList:!0,value:""+R.value,label:R.displayedLabel,isDefault:!1})}));return L},_checkIfDomainFieldSelected:function(){var L=!1;this._domainTableData&&(L=0<this._domainTableData.length?!0:!1);return L}})})},"widgets/SmartEditor/setting/ChooseFromLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/string dojo/dom-attr dojo/dom-style dojo/text!./ChooseFromLayer.html dijit/_TemplatedMixin jimu/BaseWidgetSetting jimu/dijit/Popup dijit/form/Select jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox jimu/dijit/_filter/ValueProviderFactory dojo/Evented".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f){return F([h,f,d],{baseClass:"jimu-widget-smartEditor-setting-chooseFromLayer",templateString:b,layerSelector:null,fieldsDropdown:null,chooseFromLayerPopup:null,valueProviderFactory:null,valueProvider:null,_isFirsTime:!0,postCreate:function(){this.inherited(arguments);this._createPopUp()},_addLayerSelectors:function(){var g=this._createLayerChooserMapArgs();g=new u(g);g.startup();this.layerSelector=new G({layerChooser:g});this.layerSelector.placeAt(this.layerSelectorDiv);
this.layerSelector.startup();if(0<this.layerSelector.layerChooser.getAllItems().length)var w=this.layerSelector.layerChooser.getAllItems()[0].layerInfo.layerObject;this.chooseFromLayerInfo&&this.chooseFromLayerInfo.layerId&&this._isFirsTime&&this.chooseFromLayerInfo.selectedValue==this.selectedPresetValue&&(g=this.layerInfos.getLayerInfoById(this.chooseFromLayerInfo.layerId))&&(w=g.layerObject);this.layerSelector.setSelectedLayer(w);this._addLayerFieldsOptions()},_createLayerChooserMapArgs:function(){return{multiple:!1,
createMapResponse:this.map.webMapResponse,filter:this._createFiltersForLayerSelector()}},_createFiltersForLayerSelector:function(){var g=u.createFeaturelayerFilter(["point","polyline","polygon"],!1,!1);var w=u.createImageServiceLayerFilter(!0);return u.orCombineFilters([g,w])},_addLayerFieldsOptions:function(){this.fieldsDropdown&&this.fieldsDropdown.destroy();this.valueProviderFactory&&(this.valueProviderFactory=null);this.valueProvider&&this.valueProvider.destroy();this.fieldsDropdown=new p({style:{width:"100%"}});
this.fieldsDropdown.placeAt(this.fieldsDropdownDiv);this.fieldsDropdown.startup();this.fieldsDropdown.set("options",this._createFieldsDropDownOpt());this.fieldsDropdown.options&&0<this.fieldsDropdown.options.length&&(this.fieldsDropdown.set("value",this.fieldsDropdown.options[0],!1),this.chooseFromLayerInfo&&this.chooseFromLayerInfo.field&&this._isFirsTime&&this.chooseFromLayerInfo.selectedValue==this.selectedPresetValue&&this.fieldsDropdown.set("value",this.chooseFromLayerInfo.field,!1),this._updateLabelForDomainField(this.selectedPresetValue),
this._createValueProvider());this.own(K(this.fieldsDropdown,"change",J.hitch(this,function(){e.set(this.domainFieldHint,"display","none");this._createValueProvider();this._updateLabelForDomainField("")})))},_createFieldsDropDownOpt:function(){var g=[];if(this.layerSelector.getSelectedItem()){var w=this.layerSelector.getSelectedItem().layerInfo.layerObject;x.forEach(w.fields,J.hitch(this,function(B){"esriFieldTypeString"!==this.dataType&&("esriFieldTypeGUID"!==this.dataType||B.type!==this.dataType&&
"esriFieldTypeGlobalID"!==B.type)&&("esriFieldTypeInteger"!==this.dataType||"esriFieldTypeSmallInteger"!==B.type&&"esriFieldTypeInteger"!==B.type&&"esriFieldTypeDouble"!==B.type&&"esriFieldTypeSingle"!==B.type&&"esriFieldTypeOID"!==B.type)||g.push({label:B.alias||B.name,value:B.name})}))}return g},_createValueProvider:function(){var g;this.layerSelector&&(g=this.layerSelector.getSelectedItem());if(g&&g.layerInfo&&g.layerInfo.layerObject){g=g.layerInfo;var w=g.layerObject;this.valueProviderFactory&&
(this.valueProviderFactory=null);this.valueProvider&&this.valueProvider.destroy();this.valueProviderFactory=new C({url:w.url,layerDefinition:w,featureLayerId:g.id});var B;var c=this.fieldsDropdown.getValue();x.some(w.fields,J.hitch(this,function(m){if(m.name===c)return B=m,!0}));if(c&&B){switch(B.type){case "esriFieldTypeString":g="string";w="stringOperatorIs";break;case "esriFieldTypeDate":g="date";w="dateOperatorIsOn";break;default:g="number",w="numberOperatorIs"}g={fieldObj:{name:c,label:c,dateFormat:"",
shortType:g,type:B.type},operator:w,interactiveObj:"",caseSensitive:!1,valueObj:{type:"unique"}};this.valueProvider=this.valueProviderFactory.getValueProvider(g,!1);this.own(K(this.valueProvider,"change",J.hitch(this,function(){var m=this.valueProvider.getPartObject()&&this.valueProvider.getPartObject().valueObj.value;this._updateLabelForDomainField(m)})));this.valueProvider&&(this.valueProvider.placeAt(this.valueProviderContainer),this.chooseFromLayerInfo&&this.chooseFromLayerInfo.selectedValue&&
this._isFirsTime&&this.chooseFromLayerInfo.selectedValue==this.selectedPresetValue&&(g.valueObj.value=this.chooseFromLayerInfo.selectedValue,this._isFirsTime=!1),this.valueProvider.setValueObject(g.valueObj),this.initialValue=g.valueObj.value?g.valueObj.value:"")}}},_updateLabelForDomainField:function(g){var w,B;(B=this.layerSelector?this.layerSelector.getSelectedItem():null)&&B.layerInfo&&B.layerInfo.layerObject&&(B=B.layerInfo.layerObject,B=B.getField(this.fieldsDropdown.getValue()),B.domain&&"esriFieldTypeString"!==
this.dataType&&x.some(B.domain.codedValues,J.hitch(this,function(c){if(g===c.code)return w=t.substitute(this.nls.chooseFromLayer.domainFieldHintLabel,{domainValue:c.code}),!0})));w?(a.set(this.domainFieldHint,"innerHTML",w),e.set(this.domainFieldHint,"display","block")):e.set(this.domainFieldHint,"display","none")},_createPopUp:function(){this._addLayerSelectors();this.chooseFromLayerPopup=new n({titleLabel:this.nls.chooseFromLayer.selectValueLabel,width:500,maxHeight:300,autoHeight:!0,"class":this.baseClass,
content:this,buttons:[{label:this.nls.ok,onClick:J.hitch(this,function(){this._getSelectedFieldValue();this.chooseFromLayerPopup.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:J.hitch(this,function(){this.emit("cancelButtonClicked");this.chooseFromLayerPopup.close()})}]});this.own(K(this.layerSelector,"selection-change",J.hitch(this,function(){this._addLayerFieldsOptions()})))},_getSelectedFieldValue:function(){if(this.valueProvider&&this.valueProvider.checkedNameDiv){var g=
this.valueProvider.getPartObject()?this.valueProvider.getPartObject().valueObj.value:"- empty -"!==this.valueProvider.checkedNameDiv.innerHTML&&this.initialValue?this.initialValue:"";this.emit("updatePresetValue",{layerId:this.layerSelector.getSelectedItem().layerInfo.layerObject.id,field:this.fieldsDropdown.getValue(),selectedValue:g})}}})})},"widgets/SmartEditor/setting/RelativeDates":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/on dojo/text!./RelativeDates.html dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/Popup dojo/dom-class jimu/utils dojo/query dijit/focus ../presetUtils dijit/form/Select jimu/dijit/LayerChooserFromMap jimu/dijit/LayerChooserFromMapWithDropbox jimu/dijit/_filter/ValueProviderFactory dojo/_base/array dojo/dom-style dojo/string dojo/dom-attr ../utils dojo/_base/kernel dijit/form/DateTextBox dijit/form/TimeTextBox dijit/form/NumberTextBox jimu/dijit/RadioBtn".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D){return F([e,J,a],{baseClass:"jimu-widget-smartEditor-setting-relativeDates",templateString:t,selectValuePopup:null,_isFirsTime:!0,initialValue:null,postCreate:function(){this._addLayerSelectors();this._eventListener();this._createSelectValuePopUp();this._support508ForSelectValuePopUp();K(window,"resize",x.hitch(this,function(){setTimeout(x.hitch(this,function(){this._setFieldPopupDimensions()}),1E3)}))},_eventListener:function(){this.fixedRadioButton.onStateChange=
x.hitch(this,function(){this.dateTypeChanged()});this.currentRadioButton.onStateChange=x.hitch(this,function(){this.dateTypeChanged()});this.PastRadioButton.onStateChange=x.hitch(this,function(){this.dateTypeChanged()});this.futureRadioButton.onStateChange=x.hitch(this,function(){this.dateTypeChanged()});this.own(K(this.yearsTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));this.own(K(this.monthsTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));
this.own(K(this.daysTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));this.own(K(this.minutesTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));this.own(K(this.hoursTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));this.own(K(this.secondsTextBox,"change",x.hitch(this,function(){this._showOrHideWarningContainer()})));this.customRadioButton.onStateChange=x.hitch(this,function(){this._dateValueOptionChange()});this.selectValueRadioButton.onStateChange=
x.hitch(this,function(){this._dateValueOptionChange()})},dateTypeChanged:function(){d.add(this.fixedDateContent,"esriCTHidden");d.add(this.currentDateContent,"esriCTHidden");d.add(this.pastOrFutureDateContent,"esriCTHidden");d.remove(this.valueLabel,"esriCTHidden");d.add(this.relativeDateWarningContainer,"esriCTHidden");this.fixedRadioButton.checked?(d.remove(this.fixedDateContent,"esriCTHidden"),this.hintForDateType.innerHTML=this.nls.relativeDates.hintForFixedDateType):this.currentRadioButton.checked?
(d.add(this.valueLabel,"esriCTHidden"),d.remove(this.currentDateContent,"esriCTHidden"),this.hintForDateType.innerHTML=this.nls.relativeDates.hintForCurrentDateType):this.PastRadioButton.checked?(d.remove(this.pastOrFutureDateContent,"esriCTHidden"),this.hintForDateType.innerHTML=this.nls.relativeDates.hintForPastDateType):this.futureRadioButton.checked&&(d.remove(this.pastOrFutureDateContent,"esriCTHidden"),this.hintForDateType.innerHTML=this.nls.relativeDates.hintForFutureDateType)},_createSelectValuePopUp:function(){this.selectValuePopup=
new b({titleLabel:this.nls.relativeDates.popupTitle,width:500,maxHeight:450,autoHeight:!0,"class":this.baseClass,content:this,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var N=this._getValues();N&&(!d.contains(this.pastOrFutureDateContent,"esriCTHidden")&&this._checkTextboxesWithZeroValue()?d.remove(this.relativeDateWarningContainer,"esriCTHidden"):(d.add(this.relativeDateWarningContainer,"esriCTHidden"),this.emit("updatePresetValue",N),this.selectValuePopup.close()))})},{label:this.nls.cancel,
classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){this.selectValuePopup.close()})}]});this.relativeDates&&this._setValue();this._setFieldPopupDimensions()},_setFieldPopupDimensions:function(){this.selectValuePopup&&(window.appInfo.isRunInMobile&&600>window.innerWidth?this.selectValuePopup.set("width",window.innerWidth-100):this.selectValuePopup.set("width",750))},_validateFixedDate:function(){return this.dateTextBox.isValid()?this.timeTextBox.isValid()?!0:(this.timeTextBox.focus(),
!1):(this.dateTextBox.focus(),!1)},_validatePastOrFutureDate:function(){return this.yearsTextBox.isValid()?this.monthsTextBox.isValid()?this.daysTextBox.isValid()?this.hoursTextBox.isValid()?this.minutesTextBox.isValid()?this.secondsTextBox.isValid()?!0:(this.secondsTextBox.focus(),!1):(this.minutesTextBox.focus(),!1):(this.hoursTextBox.focus(),!1):(this.daysTextBox.focus(),!1):(this.monthsTextBox.focus(),!1):(this.yearsTextBox.focus(),!1)},_getValues:function(){var N=!0,L={value:{}};if(this.fixedRadioButton.checked){if(this.customRadioButton.checked&&
(N=this._validateFixedDate())&&(L.dateType="fixed",L.dateTime=u.getDateFieldValue({type:"esriFieldTypeDate"},[this.dateTextBox,this.timeTextBox])),this.selectValueRadioButton.checked&&(L.dateType="fixed",this._getChooseFromLayerInfo()?L.chooseFromLayerInfo=this._getChooseFromLayerInfo():L.chooseFromLayerInfo=null,L.chooseFromLayerInfo&&L.chooseFromLayerInfo.selectedValue)){var R=L.chooseFromLayerInfo.selectedValue;L.dateTime="Invalid Date"!=new Date(R)?this._convertToEpoch(new Date(R)):parseInt(R)}}else if(this.currentRadioButton.checked)L.dateType=
"current";else if(this.PastRadioButton.checked){if(N=this._validatePastOrFutureDate())L=this._getValuesOfPastOrFutureDijits(),L.dateType="past"}else this.futureRadioButton.checked&&(N=this._validatePastOrFutureDate())&&(L=this._getValuesOfPastOrFutureDijits(),L.dateType="future");return N?L:N},_support508ForSelectValuePopUp:function(){var N=n(".jimu-btn-vacation",this.selectValuePopup.domNode)[0];h.initFirstFocusNode(this.selectValuePopup.domNode,this.selectValuePopup.closeBtnNode);p.focus(this.selectValuePopup.closeBtnNode);
h.initLastFocusNode(this.selectValuePopup.domNode,N)},_setValue:function(){if("fixed"===this.relativeDates.dateType)if(this.fixedRadioButton.domNode.click(),this.relativeDates.hasOwnProperty("chooseFromLayerInfo"))this.selectValueRadioButton.domNode.click();else{this.customRadioButton.domNode.click();var N=new Date(parseInt(this.relativeDates.dateTime,10));this.dateTextBox.set("value",N);this.timeTextBox.set("value",N)}"current"===this.relativeDates.dateType&&this.currentRadioButton.domNode.click();
"past"===this.relativeDates.dateType&&(this.PastRadioButton.domNode.click(),this._setValuesOfPastOrFutureDijits());"future"===this.relativeDates.dateType&&(this.futureRadioButton.domNode.click(),this._setValuesOfPastOrFutureDijits())},_setValuesOfPastOrFutureDijits:function(){this.yearsTextBox.set("value",this.relativeDates.year);this.monthsTextBox.set("value",this.relativeDates.month);this.daysTextBox.set("value",this.relativeDates.day);this.hoursTextBox.set("value",this.relativeDates.hour);this.minutesTextBox.set("value",
this.relativeDates.minute);this.secondsTextBox.set("value",this.relativeDates.second)},_getValuesOfPastOrFutureDijits:function(){var N={};N.year=this.yearsTextBox.value;N.month=this.monthsTextBox.value;N.day=this.daysTextBox.value;N.hour=this.hoursTextBox.value;N.minute=this.minutesTextBox.value;N.second=this.secondsTextBox.value;return N},_checkTextboxesWithZeroValue:function(){return 0!==this.yearsTextBox.value||0!==this.monthsTextBox.value||0!==this.daysTextBox.value||0!==this.hoursTextBox.value||
0!==this.minutesTextBox.value||0!==this.secondsTextBox.value?!1:!0},_showOrHideWarningContainer:function(){this._checkTextboxesWithZeroValue()?d.remove(this.relativeDateWarningContainer,"esriCTHidden"):d.add(this.relativeDateWarningContainer,"esriCTHidden")},_addLayerSelectors:function(){var N=this._createLayerChooserMapArgs();N=new C(N);N.startup();this.layerSelector=new f({layerChooser:N});this.layerSelector.placeAt(this.layerSelectorDiv);this.layerSelector.startup();if(0<this.layerSelector.layerChooser.getAllItems().length)var L=
this.layerSelector.layerChooser.getAllItems()[0].layerInfo.layerObject;this.relativeDates&&this.relativeDates.chooseFromLayerInfo&&this.relativeDates.chooseFromLayerInfo.layerId&&this._isFirsTime&&(N=this.layerInfos.getLayerInfoById(this.relativeDates.chooseFromLayerInfo.layerId))&&(L=N.layerObject);this.layerSelector.setSelectedLayer(L);this._addLayerFieldsOptions()},_createLayerChooserMapArgs:function(){return{multiple:!1,createMapResponse:this.map.webMapResponse,filter:this._createFiltersForLayerSelector()}},
_createFiltersForLayerSelector:function(){var N=C.createFeaturelayerFilter(["point","polyline","polygon"],!1,!1);var L=C.createImageServiceLayerFilter(!0);N=C.orCombineFilters([N,L]);dateLayerfilter=this._createDateLayerfilter();return C.andCombineFilters([N,dateLayerfilter])},_createDateLayerfilter:function(){return function(N){var L=!1;N.getLayerObject().then(function(R){R&&R.fields&&w.some(R.fields,function(q){if("esriFieldTypeDate"===q.type)return L=!0})});return L}},_addLayerFieldsOptions:function(){this.fieldsDropdown&&
this.fieldsDropdown.destroy();this.valueProviderFactory&&(this.valueProviderFactory=null);this.valueProvider&&this.valueProvider.destroy();this.fieldsDropdown=new G({style:{width:"100%"}});this.fieldsDropdown.placeAt(this.fieldsDropdownDiv);this.fieldsDropdown.startup();this.fieldsDropdown.set("options",this._createFieldsDropDownOpt());this.fieldsDropdown.options&&0<this.fieldsDropdown.options.length&&this.fieldsDropdown.set("value",this.fieldsDropdown.options[0]);this.relativeDates&&this.relativeDates.chooseFromLayerInfo&&
this.relativeDates.chooseFromLayerInfo.field&&this._isFirsTime&&this.fieldsDropdown.set("value",this.relativeDates.chooseFromLayerInfo.field);this._updateLabelForDomainField(this.selectedPresetValue);this.own(K(this.layerSelector,"selection-change",x.hitch(this,function(){this._addLayerFieldsOptions()})));this.own(K(this.fieldsDropdown,"change",x.hitch(this,function(){B.set(this.domainFieldHint,"display","none");this._createValueProvider();this._updateLabelForDomainField("")})))},_createFieldsDropDownOpt:function(){var N=
[];validFieldSet=[];if(this.layerSelector.getSelectedItem()){var L=this.layerSelector.getSelectedItem().layerInfo.layerObject;w.forEach(L.fields,x.hitch(this,function(R){"esriFieldTypeDate"===R.type&&N.push({label:R.alias||R.name,value:R.name})}))}return N},_createValueProvider:function(){var N;this.layerSelector&&(N=this.layerSelector.getSelectedItem());if(N&&N.layerInfo&&N.layerInfo.layerObject){N=N.layerInfo;var L=N.layerObject;this.valueProviderFactory&&(this.valueProviderFactory=null);this.valueProvider&&
this.valueProvider.destroy();this.valueProviderFactory=new g({url:L.url,layerDefinition:L,featureLayerId:N.id});var R;var q=this.fieldsDropdown.getValue();w.some(L.fields,x.hitch(this,function(O){if(O.name===q)return R=O,!0}));if(q&&R){if("esriFieldTypeDate"===R.type){var k="date";var E="dateOperatorIsOn"}k={fieldObj:{name:q,label:q,dateFormat:"",shortType:k,type:R.type},operator:E,interactiveObj:"",caseSensitive:!1,valueObj:{type:"unique"}};this.valueProvider=this.valueProviderFactory.getValueProvider(k,
!1);this.own(K(this.valueProvider,"change",x.hitch(this,function(){var O=this.valueProvider.getPartObject()&&this.valueProvider.getPartObject().valueObj.value;this._updateLabelForDomainField(O)})));this.valueProvider&&(this.valueProvider.placeAt(this.valueProviderContainer),this.relativeDates&&this.relativeDates.chooseFromLayerInfo&&this.relativeDates.chooseFromLayerInfo.selectedValue&&this._isFirsTime&&(k.valueObj.value=this.relativeDates.chooseFromLayerInfo.selectedValue,this._isFirsTime=!1),this.valueProvider.setValueObject(k.valueObj),
this.initialValue=k.valueObj.value?k.valueObj.value:"")}}},_dateValueOptionChange:function(){this.customRadioButton.checked&&(d.remove(this.customOptionContentNode,"esriCTHidden"),d.add(this.selectValueOptionContentNode,"esriCTHidden"),d.add(this.noValidLayerContentNode,"esriCTHidden"));this.selectValueRadioButton.checked&&(0<this.layerSelector.layerChooser.getAllItems().length?(d.remove(this.selectValueOptionContentNode,"esriCTHidden"),d.add(this.customOptionContentNode,"esriCTHidden"),d.add(this.noValidLayerContentNode,
"esriCTHidden")):(d.add(this.customOptionContentNode,"esriCTHidden"),d.remove(this.noValidLayerContentNode,"esriCTHidden")))},_getChooseFromLayerInfo:function(){if(this.valueProvider&&this.valueProvider.checkedNameDiv){var N=this.valueProvider.getPartObject()?this.valueProvider.getPartObject().valueObj.value:"- empty -"!==this.valueProvider.checkedNameDiv.innerHTML&&this.initialValue?this.initialValue:"";if("ar"===D.locale&&this.layerSelector){var L;if(L=this.layerSelector.getSelectedItem())L=A.getFieldInfosFromWebmap(L.layerInfo),
L=u.getFieldInfoByFieldName(L,this.fieldsDropdown.getValue()),"esriFieldTypeDate"===L.type&&(N=h.getDateByDateTimeStr(N),N=h.localizeDateTimeByFieldInfo(N,L))}return{layerId:this.layerSelector.getSelectedItem().layerInfo.layerObject.id,field:this.fieldsDropdown.getValue(),selectedValue:N}}},_convertToEpoch:function(N){return N=(N=N?new Date(N.getFullYear(),N.getMonth(),N.getDate(),N.getHours(),N.getMinutes(),N.getSeconds(),N.getMilliseconds()):N||null)&&N.getTime?N.getTime():N&&N.toGregorian?N.toGregorian().getTime():
N},_updateLabelForDomainField:function(N){var L,R,q={dateType:"fixed",dateTime:""};(R=this.layerSelector?this.layerSelector.getSelectedItem():null)&&R.layerInfo&&R.layerInfo.layerObject&&(R=R.layerInfo.layerObject,R=R.getField(this.fieldsDropdown.getValue()),R.domain&&"esriFieldTypeDate"===R.type&&w.some(R.domain.codedValues,x.hitch(this,function(k){if(N==k.code)return k=new Date(N),q.dateTime="Invalid Date"!=k?this._convertToEpoch(k):parseInt(N),L=c.substitute(this.nls.chooseFromLayer.domainFieldHintLabel,
{domainValue:u.getDateFromRelativeInfo(q,!0)}),!0})));L?(m.set(this.domainFieldHint,"innerHTML",L),B.set(this.domainFieldHint,"display","block")):B.set(this.domainFieldHint,"display","none")}})})},"widgets/SmartEditor/presetUtils":function(){define("dojo/_base/lang jimu/utils dojo/date dojo/_base/array dojo/dom-construct dijit/form/DateTextBox dijit/form/NumberSpinner dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/TextBox dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Editor dijit/form/SimpleTextarea dojo/store/Memory dojo/query dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f){return{integerFields:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],getFieldInfoByFieldName:function(g,w){var B={};K.some(g,function(c){if(c.name===w)return F.mixin(B,c),!0});return B},getDateFromRelativeInfo:function(g,w){var B=new Date;"fixed"===g.dateType?B=g.dateTime?new Date(g.dateTime):"":"future"===g.dateType?(B=x.add(B,"year",g.year),B=x.add(B,"month",g.month),B=x.add(B,"day",g.day),B=x.add(B,"hour",
g.hour),B=x.add(B,"minute",g.minute),B=x.add(B,"second",g.second)):"past"===g.dateType&&(g.year&&(B=x.add(B,"year",-1*g.year)),g.month&&(B=x.add(B,"month",-1*g.month)),g.day&&(B=x.add(B,"day",-1*g.day)),g.hour&&(B=x.add(B,"hour",-1*g.hour)),g.minute&&(B=x.add(B,"minute",-1*g.minute)),g.second&&(B=x.add(B,"second",-1*g.second)));return w&&""!==B?J.localizeDate(B):B},getDateFieldValue:function(g,w){if("esriFieldTypeDate"===g.type){if(w instanceof Array){var B,c;0<w.length&&w[0]&&(B=w[0].getValue());
1<w.length&&w[1]&&(c=w[1].getValue());var m=B&&c?new Date(B.getFullYear(),B.getMonth(),B.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds()):B||c||null}else m=w.getValue(),g.domain&&(m=Number(m));m=m&&m.getTime?m.getTime():m&&m.toGregorian?m.toGregorian().getTime():m}return m},isGuid:function(g){"{"===g[0]&&(g=g.substring(1,g.length-1));return/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(g)},validateGUID:function(g,
w){return this.isGuid(g)},isValidPresetValue:function(g){var w=!0;K.some(g,function(B){if(B.isValid&&!B.isValid())return w=!1,!0});return w},createPresetFieldContentNode:function(g){var w=[];if(g.domain){if("codedValue"===g.domain.type){var B=[];K.forEach(g.domain.codedValues,function(D){B.push({name:D.name,id:D.code})});var c=new d({"class":"ee-inputField",name:g.fieldName,store:new C({data:B}),searchAttr:"name",required:!0},t.create("div"))}else{c=null;switch(g.type){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":c=
{min:g.domain.minValue,max:g.domain.maxValue,places:0};break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":c={min:g.domain.minValue,max:g.domain.maxValue}}c=new e({"class":"ee-inputField",name:g.fieldName,smallDelta:1,constraints:c,required:!0},t.create("div"))}w.push(c)}else switch(g.type){case "esriFieldTypeGUID":c=new n({"class":"ee-inputField",name:g.fieldName,required:!0,trim:!0},t.create("div"));c.validator=F.hitch(this,this.validateGUID);w.push(c);break;case "esriFieldTypeDate":c=new a({"class":"ee-inputField",
name:g.fieldName,required:!0,fieldType:"date"},t.create("div"));w.push(c);g.format&&g.format.time&&!0===g.format.time&&(g=new p({"class":"ee-inputField",style:"margin-top:2px;",required:!0},t.create("div")),w.push(g));break;case "esriFieldTypeString":c=null;g.length&&Number(g.length)&&0<Number(g.length)&&(c=g.length);if(g.hasOwnProperty("stringFieldOption"))if("richtext"===g.stringFieldOption){var m=document.getElementsByTagName("head")[0];var A=window.apiUrl+"dojox/editor/plugins/resources/css/TextColor.css";
f('link[href\x3d"'+A+'"]',m)[0]||J.loadStyleLink("editor_plugins_resources_TextColor",A);A=window.apiUrl+"dojox/editor/plugins/resources/editorPlugins.css";f('link[href\x3d"'+A+'"]',m)[0]||J.loadStyleLink("editor_plugins_resources_editorPlugins",A);A=window.apiUrl+"dojox/editor/plugins/resources/css/PasteFromWord.css";f('link[href\x3d"'+A+'"]',m)[0]||J.loadStyleLink("editor_plugins_resources_PasteFromWord",A);c={"class":"ee-inputField ee-inputFieldRichText",trim:!0,maxLength:c,fieldType:"richtext",
required:!0};c["class"]+=" atiRichTextField";c.height="100%";c.width="100%";c.name=g.fieldName;c.plugins=["bold","italic","underline",J.getEditorTextColor("smartEditor"),J.getEditorBackgroundColor("smartEditor"),"|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList","insertUnorderedList","indent","outdent","|","createLink"];c=new u(c,t.create("div"))}else c="textarea"===g.stringFieldOption?new G({"class":"ee-inputField ee-inputFieldTextArea",name:g.fieldName,maxlength:c,
fieldType:"textarea",required:!0},t.create("div")):new n({"class":"ee-inputField",name:g.fieldName,maxlength:c,required:!0,trim:!0},t.create("div"));else c=new n({"class":"ee-inputField",name:g.fieldName,maxlength:c,required:!0,trim:!0},t.create("div"));w.push(c);break;case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":c=new b({"class":"ee-inputField",name:g.fieldName,required:!0,constraints:{places:0}},t.create("div"));w.push(c);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":c=
new b({"class":"ee-inputField",name:g.fieldName,required:!0},t.create("div"));w.push(c);break;default:c=new h({"class":"ee-unsupportField",name:g.fieldName,value:"N/A",readOnly:!0},t.create("div")),w.push(c)}return w},changeFieldToMostRestrictive:function(g,w){if(!g.hasOwnProperty("type")&&w.hasOwnProperty("type"))return w;w.length&&Number(w.length)&&0<Number(w.length)&&(g.length&&Number(g.length)?w.length<g.length&&(g.length=w.length):g.length=w.length);if(g.type===w.type)switch(w.type){case "esriFieldTypeString":g.hasOwnProperty("stringFieldOption")&&
w.hasOwnProperty("stringFieldOption")&&("richtext"===g.stringFieldOption&&"richtext"!==w.stringFieldOption?g.stringFieldOption=w.stringFieldOption:"textarea"===g.stringFieldOption&&"textbox"===w.stringFieldOption&&(g.stringFieldOption=w.stringFieldOption))}return g}}})},"widgets/SmartEditor/setting/RelativeDomains":function(){define("dojo/_base/declare dojo/Evented dojo/_base/lang dojo/on dojo/text!./RelativeDomains.html dijit/_WidgetsInTemplateMixin dojo/_base/array jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/SimpleTable jimu/dijit/Message jimu/utils dojo/query dijit/focus dojo/string dojo/dom-attr dijit/form/DateTextBox dijit/form/TimeTextBox dijit/form/NumberTextBox".split(" "),
function(F,J,x,K,t,a,e,b,d,h,n,p,u,G,C,f){return F([b,J,a],{baseClass:"jimu-widget-smartEditor-setting-relativeDomains",templateString:t,domainObj:[],selectDomainValuePopup:null,validNumericData:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],postCreate:function(){this.domainObj=[];this.selectDomainValuePopup=null;this._createDomainTable();this._createSelectValuePopUp();if(this.selectedDomainFields&&0<this.selectedDomainFields.length){var g=C.substitute(this.nls.relativeDomains.selectedDomainFieldsHint,
{domainFields:this.selectedDomainFields.join(", ")});f.set(this.domainFieldsHint,"innerHTML",g)}},postMixInProperties:function(){this.nls=x.mixin(this.nls,window.jimuNls.common)},_createDomainTable:function(){this._domainTable=new h({fields:[{name:"selectDomain",title:"",type:"checkbox",width:"10%"},{name:"domainValue",title:this.nls.relativeDomains.valueText,type:"text",width:"15%"},{name:"label",title:this.nls.label,type:"text",width:"55%"},{name:"defaultDomain",title:this.nls.relativeDomains.defaultText,
type:"radio",width:"10%"},{name:"actions",title:this.nls.action,type:"actions",width:"10%%",actions:["up","down"],"class":"actions"}],selectable:!1});this._domainTable.startup();this._domainTable.placeAt(this.tableParentContainer);this._setValues()},_createSelectValuePopUp:function(){this.selectDomainValuePopup=new d({titleLabel:this.nls.chooseFromLayer.selectValueLabel,width:800,height:500,autoHeight:!0,"class":this.baseClass,content:this,buttons:[{label:this.nls.ok,onClick:x.hitch(this,function(){var g=
this._getValue();g&&(this.emit("updatePresetValue",g),this.selectDomainValuePopup.close())})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:x.hitch(this,function(){this.selectDomainValuePopup.close()})}]})},_getValue:function(){var g="",w=[],B=this._domainTable.getData();if(this._isValidConfiguration(B))return e.forEach(B,x.hitch(this,function(c){var m={};m.showInList=c.selectDomain;m.value="esriFieldTypeString"!==this.dataType?Number(c.domainValue):c.domainValue;m.label=c.label;
m.isDefault=c.defaultDomain;m.isDefault&&(g=c.label);w.push(m)})),{domainData:w,defaultValue:g};new n({message:this.nls.relativeDomains.selectDefaultDomainMsg})},_setValues:function(){e.forEach(this.domainTableData,x.hitch(this,function(g){var w=this._domainTable.addRow({selectDomain:g.showInList,domainValue:""+g.value,label:g.label,defaultDomain:g.isDefault}).tr.cells[3].childNodes[0];var B=w.checked;this.own(K(w,"click",x.hitch(this,function(){B=B?w.checked=!1:w.checked=!0})))}))},_isValidConfiguration:function(g){var w=
!1,B=!1,c=!1;e.some(g,x.hitch(this,function(m){m.defaultDomain&&(c=!0,m.selectDomain&&(B=!0));m.selectDomain&&(w=!0)}));return c?c&&B:w?w:!1},_support508ForSelectValuePopUp:function(){var g=u(".jimu-btn-vacation",this.selectDomainValuePopup.domNode)[0];p.initFirstFocusNode(this.selectDomainValuePopup.domNode,this.selectDomainValuePopup.closeBtnNode);G.focus(this.selectDomainValuePopup.closeBtnNode);p.initLastFocusNode(this.selectDomainValuePopup.domNode,g)}})})},"widgets/SmartEditor/presetBuilderBackwardCompatibility":function(){define(["dojo/_base/lang",
"dojo/_base/array","jimu/utils","./presetUtils"],function(F,J,x,K){var t={createPresetGroups:function(a,e){t.config=a;t._jimuLayerInfos=e;if(a.editor.presetInfos&&0<Object.keys(a.editor.presetInfos).length&&(a.attributeActionGroups?a.attributeActionGroups&&!a.attributeActionGroups.hasOwnProperty("Preset")&&(a.attributeActionGroups.Preset={}):a.attributeActionGroups={Intersection:{},Address:{},Coordinates:{},Preset:{}},!(a.attributeActionGroups&&a.attributeActionGroups.Preset&&0<Object.keys(a.attributeActionGroups.Preset).length)))for(var b in a.editor.presetInfos)t._addPresetGroupForField(a.editor.configInfos||
a.editor.layerInfos,b)},_getDomainListForPresetGroup:function(a,e,b){var d=[];J.forEach(e.domain.codedValues,F.hitch(this,function(h){var n={showInList:!0,value:h.code,label:h.name,isDefault:!1};a.showOnlyDomainFields=!0;var p=t.config.editor.presetInfos[b][0];"esriFieldTypeInteger"===a.dataType&&(p=Number(p));0<t.config.editor.presetInfos[b].length?h.code===p&&(n.isDefault=!0):0===d.length&&(n.isDefault=!0);d.push(n)}));return d},_addPresetGroupForField:function(a,e){var b;J.some(a,F.hitch(this,
function(d){if(b)return!0;if(d.fieldValues&&d.fieldValues[e])for(var h=d.fieldValues[e],n=0;n<h.length;n++)if("Preset"===h[n].actionName&&h[n].enabled){h[n].attributeActionGroupName=e;var p=t._jimuLayerInfos.getLayerOrTableInfoById(d.featureLayer.id);if(p&&p.layerObject&&p.layerObject.fields){n=K.getFieldInfoByFieldName(p.layerObject.fields,e);p=x.getDefaultPortalFieldInfo(n).label+" ("+e+")";h={};h.name=p;0<["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle",
"esriFieldTypeDouble"].indexOf(n.type)?h.dataType="esriFieldTypeInteger":h.dataType=n.type;h.showOnlyDomainFields=!1;h.hideInPresetDisplay=!1;h.appliedOn=t._getPresetFieldsForAppliedOn(n,h);if(n.domain&&"range"!==n.domain.type)h.presetValue=t._getDomainListForPresetGroup(h,n,e);else if("esriFieldTypeDate"===n.type){var u,G;0<t.config.editor.presetInfos[e].length?(isNaN(t.config.editor.presetInfos[e][0])||""===t.config.editor.presetInfos[e][0]||(G=new Date(t.config.editor.presetInfos[e][0])),t.config.editor.presetInfos[e][1]&&
!isNaN(t.config.editor.presetInfos[e][1])&&(u=new Date(t.config.editor.presetInfos[e][1])),u=G&&u?new Date(G.getFullYear(),G.getMonth(),G.getDate(),u.getHours(),u.getMinutes(),u.getSeconds(),u.getMilliseconds()):G,h.presetValue=u?{dateType:"fixed",dateTime:u.getTime()}:{dateType:"fixed",dateTime:""}):h.presetValue={dateType:"fixed",dateTime:""}}else h.presetValue=0<t.config.editor.presetInfos[e].length?t.config.editor.presetInfos[e][0]:null;t.config.attributeActionGroups.Preset[h.name]=h;b=!0;break}}!b&&
d.relationshipInfos&&0<d.relationshipInfos.length&&(b=t._addPresetGroupForField(d.relationshipInfos,e))}));return b},_isPresetEnabledForLayer:function(a,e,b,d){if(a.fieldValues[e.name])for(var h=a.fieldValues[e.name],n=0;n<h.length;n++)if("Preset"===h[n].actionName&&h[n].enabled){var p=t._jimuLayerInfos.getLayerOrTableInfoById(a.featureLayer.id).layerObject.fields;K.getFieldInfoByFieldName(p,e.name).type===e.type&&(h[n].attributeActionGroupName=d.name,b.hasOwnProperty(a.featureLayer.id)?b[a.featureLayer.id].push(e.name):
b[a.featureLayer.id]=[e.name])}return b},_getPresetFieldsForAppliedOn:function(a,e){var b={};J.forEach(t.config.editor.configInfos||t.config.editor.layerInfos,F.hitch(this,function(d){d.fieldValues&&d.fieldValues[a.name]&&(b=t._isPresetEnabledForLayer(d,a,b,e));d.relationshipInfos&&0<d.relationshipInfos.length&&J.forEach(d.relationshipInfos,F.hitch(this,function(h){h.fieldValues&&h.fieldValues[a.name]&&(b=t._isPresetEnabledForLayer(h,a,b,e))}))}));return b}};return t})},"widgets/SmartEditor/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/SmartEditor/setting/EditFields.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"settingsDesc" data-dojo-attach-point\x3d"fieldsDesc"\x3e${nls.fieldsPage.description}\x3c/div\x3e\r\n    \r\n    \x3cdiv data-dojo-attach-point\x3d"fieldsTable"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"settingsNotes" data-dojo-attach-point\x3d"fieldsNotes"\x3e${nls.fieldsPage.fieldsNotes}\x3c/div\x3e\r\n    \x3cdiv class\x3d"attachmentsDesc" data-dojo-attach-point\x3d"attachmentsValidation"\x3e${nls.fieldsPage.smartAttachmentText}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/FieldValidation.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"settingsDesc" data-dojo-attach-point\x3d"validationDesc"\x3e${nls.actionPage.description}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"validationTable"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/SmartEditor/setting/FilterPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"submitWhenHidden"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"filterControl"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/CopyAttributes.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"settingsDesc" data-dojo-attach-point\x3d"validationDesc"\x3e${nls.actionPage.description}\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"copyAttributeTable"\x3e\x3c/div\x3e\r\n  \x3cdiv style\x3d"color:red; display: none;" class\x3d"settingsNotes" data-dojo-attach-point\x3d"warningNote"\x3e${nls.actionPage.copyAttributesNote}\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/SmartEditor/setting/Intersection.html":'\x3cdiv class\x3d"esriCTIntersectionMainContainer"\x3e\r\n    \x3cdiv syle\x3d"width:100%"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"groupInfoNode1"\x3e\r\n          \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n            \x3cdiv class\x3d"esriCTIntersectionGroupName"\x3e\r\n              \x3cdiv class\x3d"esriCTlabel"\x3e\r\n                ${nls.intersectionPage.groupNameLabel}\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriCTGroupInfoContainer"\x3e\r\n                \x3cdiv style\x3d"width: 75%;" data-dojo-attach-point\x3d"groupNameTextBoxNode"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTIntersectionDatatype"\x3e\r\n              \x3cdiv class\x3d"esriCTlabel"\x3e\r\n                ${nls.intersectionPage.dataTypeLabel}\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"esriCTGroupInfoContainer"\x3e\r\n                \x3cdiv style\x3d"width: 75%;" data-dojo-attach-point\x3d"dataTypeDropDownNode"\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"ignoreLayerRankingNode" class\x3d"esriCTlabel esriCTIgnoreLayerRankingLabel"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.intersectionPage.intersectingLayersLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"addLayerLink"\x3e\r\n        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addLayer"\x3e\r\n          \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\x3cspan class\x3d"add-label"\x3e\r\n            ${nls.intersectionPage.addLayerLinkText}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTIntersectionHint"\x3e${nls.intersectionPage.intersectionLayerHint}\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"layerTableNode"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"  data-dojo-attach-point\x3d"groupInfoNode2"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.intersectionPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable role\x3d"listbox" aria-haspopup\x3d"true" data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.customSelectLayer}" aria-label\x3d"${nls.customSelectLayer}"\x3e\r\n    \x3ccaption class\x3d"screen-readers-only-no-position"\x3e${nls.customSelectLayer}\x3c/caption\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SmartEditor/setting/layerAndFieldsApplyOn.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"esriCTSearchFieldNode" data-dojo-attach-point \x3d "searchNode"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point \x3d "layerAndFieldsMainDiv"\x3e\x3c/div\x3e\r\n  \x3cdiv style\x3d"margin-top: 5px;" class\x3d"esriCTHidden" data-dojo-attach-point \x3d "domainFieldHintMsg"\x3e\r\n    \x3cdiv class\x3d"esriCTDomainlistDiv"\x3e*\x3c/div\x3e\r\n    \x3cdiv\x3e${nls.actionPage.domainListTitle}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/Coordinates.html":'\x3cdiv style\x3d"max-height: 445px;padding: 0 5px;"\x3e\r\n  \x3cdiv class\x3d"esriCTCoordinateWidth" data-dojo-attach-point\x3d"coordianteDijitMainWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode1"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel"\x3e${nls.intersectionPage.groupNameLabel}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"groupNameTextBoxNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesSourceTitle}"\x3e\r\n        ${nls.coordinatesPage.coordinatesSourceTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%;" data-dojo-attach-point\x3d"coordinatesSourceNode"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesSelectTitle}"\x3e\r\n        ${nls.coordinatesPage.coordinatesSelectTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"selectCoordinateNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopUpLabel" title\x3d"${nls.coordinatesPage.coordinatesAttributeTitle}"\x3e\r\n        ${nls.coordinatesPage.coordinatesAttributeTitle}\x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTCoordinatePopupdijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTCoordinatePopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"selectAttributeNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode2"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.intersectionPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/Address.html":'\x3cdiv style\x3d"max-height: 445px;padding: 0 5px;"\x3e\r\n  \x3cdiv class\x3d"esriCTAddressWidth" data-dojo-attach-point\x3d"addressDijitMainWrapper"\x3e \r\n      \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode1"\x3e\r\n        \x3cdiv  class\x3d"esriCTlabel"\x3e\r\n          ${nls.intersectionPage.groupNameLabel}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTGroupInfoContainer"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"groupNameTextBoxNode" style\x3d"width: 95%"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTlabel" title\x3d"${nls.addressPage.selectFieldTitle}"\x3e${nls.addressPage.selectFieldTitle}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTGroupInfoContainer"\x3e\r\n      \x3cdiv class\x3d"esriCTSelectAttributeNode jimu-float-leading" data-dojo-attach-point\x3d"selectNode" style\x3d"width: 95%"\x3e\x3c/div\x3e\r\n      \x3ca data-dojo-attach-point\x3d"attributeInfoNode" style\x3d"line-height: 30px;" class\x3d"jimu-float-trailing" target\x3d"_blank" href\x3d"https://developers.arcgis.com/rest/geocode/api-reference/geocoding-service-output.htm"\x3e${nls.addressPage.questionMark}\x3c/a\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTHint"\x3e${nls.addressPage.geocoderHint}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTWrapper" data-dojo-attach-point\x3d"groupInfoNode2"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.intersectionPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTCreditWarningContainer"\x3e\r\n    \x3ca target\x3d"_blank" \r\n      href\x3d"https://doc.arcgis.com/en/arcgis-online/administer/credits.htm"\x3e${nls.addressPage.consumesCredits}\x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/EditDescription.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"editText"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/SmartEditor/setting/SmartActionGroup.html":'\x3cdiv class\x3d"esriCTSmartActionsGroupContainer"\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cdiv class\x3d"esriCTlabel"\x3e\r\n      ${nls.smartActionsPage.groupNameLabel}\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTLayerField"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"groupNameTextBoxNode"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cdiv class\x3d"esriCTlabelParentContainer"\x3e\r\n      \x3cdiv class\x3d"esriCTlabel"\x3e\r\n        ${nls.smartActionsPage.layerForExpressionLabel}\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"esriCTLayerFieldDropBox"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"layerSelectorDiv"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTHintCheck"\x3e\r\n      ${nls.smartActionsPage.layerForExpressionNote}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cdiv class\x3d"esriCTlabel"\x3e${nls.smartActionsPage.expressionText}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTExpression"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"expressionTextBoxNode" class\x3d"esriCTExpressionTextBoxNode"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"editExpressionIconNode" title\x3d"${nls.smartActionsPage.editExpressionLabel}"\x3e\r\n        \x3cdiv class\x3d"jimu-icon jimu-icon-edit" data-dojo-attach-point\x3d"editExpressionIconNode"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"submitWhenHiddenNode" class\x3d"esriCTlabel esriCTSubmitAttributeDataText"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n    \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n      \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.smartActionsPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n      \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/fieldset\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/Preset.html":'\x3cdiv class\x3d"esriCTPresetPopUpDiv"\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n        \x3cdiv style\x3d"width:50%; float:left;"\x3e\r\n            \x3cdiv class\x3d"esriCTPresetPopUpLabel"\x3e${nls.intersectionPage.groupNameLabel}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPresetPopupdijitWrapper"\x3e\r\n                \x3cdiv class\x3d"esriCTPresetPopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"groupNameDiv"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv style\x3d"width:50%; float:left;"\x3e\r\n            \x3cdiv class\x3d"esriCTPresetPopUpLabel"\x3e${nls.intersectionPage.dataTypeLabel}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPresetPopupdijitWrapper"\x3e\r\n                \x3cdiv class\x3d"esriCTPresetPopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"dataTypeDropdownDiv"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTRowContainer row esriCTHidden"\x3e\r\n        \x3cdiv style\x3d"width: 100%;" data-dojo-attach-point\x3d"showOnlyDomainFieldsNode" class\x3d"esriCTPresetPopUpLabel"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n        \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n            \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.smartActionsPage.layerAndFieldsApplyLabel}\x3c/legend\x3e\r\n            \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/fieldset\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTPresetPopUpLabel"\x3e${nls.presetPopup.presetValueLAbel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTPresetPopupdijitWrapper" data-dojo-attach-point\x3d"presetValuedijitWrapper"\x3e\r\n            \x3cdiv class\x3d"esriCTPresetPopupdijit" style\x3d"width: 100%" data-dojo-attach-point\x3d"presetValueDiv"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-btn esriCTSelectValueBtn" data-dojo-attach-point\x3d"selectPresetValueBtn"\r\n            data-dojo-attach-event\x3d"onClick:_onSelectPresetValueButtonClick"\x3e${nls.chooseFromLayer.selectValueLabel}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTRowContainer row"\x3e\r\n        \x3cdiv style\x3d"width: 100%;" data-dojo-attach-point\x3d"hideInPresetDisplayNode" class\x3d"esriCTPresetPopUpLabel"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/ChooseFromLayer.html":'\x3cdiv data-dojo-attach-point\x3d"layerSelectorPopUpDiv" class\x3d"esriCTlayerSelectorPopUpDiv"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"layerSelectorWrapper" class\x3d"esriCTWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.layersPage.layerSettingsTable.label}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTPopupSelect"\x3e\r\n            \x3cdiv class\x3d"esriCTLayerSelect" style\x3d"width: 100%" data-dojo-attach-point\x3d"layerSelectorDiv"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.chooseFromLayer.fieldLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTPopupSelect"\x3e\r\n            \x3cdiv class\x3d"esriCTlayerField" style\x3d"width: 100%" data-dojo-attach-point\x3d"fieldsDropdownDiv"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.chooseFromLayer.valueLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTPopupSelect"\x3e\r\n            \x3cdiv class\x3d"esriCTlayerFieldvalue" style\x3d"width: 100%" data-dojo-attach-point\x3d"valueProviderContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTDomainFieldHint esriCTHidden" data-dojo-attach-point\x3d"domainFieldHint"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/RelativeDates.html":'\x3cdiv\x3e\r\n    \x3cdiv\x3e\r\n        \x3cdiv class\x3d"esriCTLabel"\x3e${nls.relativeDates.dateTypeLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTRadioButtonContainer"\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTDateTypeLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn" id\x3d"fixedRadioButton" checked\r\n                    data-dojo-attach-point\x3d"fixedRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.dateTypeLabel}${nls.relativeDates.fixed}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"fixedRadioButton"\x3e\r\n                    ${nls.relativeDates.fixed}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTDateTypeLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn" id\x3d"currentRadioButton"  data-dojo-attach-point\x3d"currentRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.dateTypeLabel}${nls.relativeDates.current}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"currentRadioButton"\x3e\r\n                    ${nls.relativeDates.current}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTDateTypeLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn" id\x3d"PastRadioButton"  data-dojo-attach-point\x3d"PastRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.dateTypeLabel}${nls.relativeDates.past}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"PastRadioButton"\x3e\r\n                    ${nls.relativeDates.past}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTDateTypeLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn" id\x3d"futureRadioButton"  data-dojo-attach-point\x3d"futureRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.dateTypeLabel}${nls.relativeDates.future}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"futureRadioButton"\x3e\r\n                    ${nls.relativeDates.future}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTRelativeDatesHint" data-dojo-attach-point\x3d"hintForDateType"\x3e${nls.relativeDates.hintForFixedDateType}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTLabel" style\x3d"margin-top:10px;" data-dojo-attach-point\x3d"valueLabel"\x3e${nls.relativeDates.valueLabel}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTFixedDateContent" data-dojo-attach-point\x3d"fixedDateContent"\x3e\r\n        \x3cdiv class\x3d"esriCTFixedContentWrappper"\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTselectValueLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g2\'" type\x3d"radio" name\x3d"jimuradiobtn2" id\x3d"customRadioButton" checked\r\n                data-dojo-attach-point\x3d"customRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.customLabel}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"customRadioButton"\x3e\r\n                    ${nls.relativeDates.customLabel}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTRadioBtn esriCTselectValueLabel"\x3e\r\n                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" data-dojo-props\x3d"group: \'g2\'" type\x3d"radio" name\x3d"jimuradiobtn2" id\x3d"selectValueRadioButton"\r\n                data-dojo-attach-point\x3d"selectValueRadioButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.relativeDates.popupTitle}"\x3e\r\n                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"selectValueRadioButton"\x3e\r\n                    ${nls.relativeDates.popupTitle}\r\n                \x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"customOptionContentNode"\x3e\r\n        \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n            \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.date}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFixedContentDijit"\x3e\r\n                \x3cdiv style\x3d"width:95%" data-dojo-type\x3d"dijit/form/DateTextBox" required\x3d"false" data-dojo-attach-point\x3d"dateTextBox" tabindex\x3d"0" aria-label\x3d"${nls.date}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n            \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.time}\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFixedContentDijit"\x3e\r\n                \x3cdiv style\x3d"width: 95%" data-dojo-type\x3d"dijit/form/TimeTextBox" required\x3d"false" data-dojo-attach-point\x3d"timeTextBox" tabindex\x3d"0" aria-label\x3d"${nls.time}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTHidden"  data-dojo-attach-point\x3d"selectValueOptionContentNode"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"layerSelectorWrapper" class\x3d"esriCTWrapper"\x3e\r\n                \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.layersPage.layerSettingsTable.label}\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTFixedContentDijit"\x3e\r\n                    \x3cdiv class\x3d"esriCTLayerSelect" style\x3d"width: 95%" data-dojo-attach-point\x3d"layerSelectorDiv"\r\n                    aria-label\x3d"${nls.layersPage.layerSettingsTable.label}"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n                \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.chooseFromLayer.fieldLabel}\x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTFixedContentDijit"\x3e\r\n                    \x3cdiv class\x3d"esriCTlayerField" style\x3d"width: 95%" data-dojo-attach-point\x3d"fieldsDropdownDiv"\r\n                    aria-label\x3d"${nls.chooseFromLayer.fieldLabel}"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n                \x3cdiv class\x3d"esriCTPopUpLabel"\x3e${nls.relativeDates.valueLabel}\x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTFixedContentDijit"\x3e\r\n                    \x3cdiv class\x3d"esriCTlayerFieldvalue" style\x3d"width: 95%" data-dojo-attach-point\x3d"valueProviderContainer"\r\n                    aria-label\x3d"${nls.relativeDates.valueLabel}"\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTDomainFieldHint esriCTHidden" data-dojo-attach-point\x3d"domainFieldHint"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTHidden"  data-dojo-attach-point\x3d"noValidLayerContentNode" style\x3d"padding: 20px"\x3e\r\n            ${nls.actionPage.noValidFieldTypeMsg}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTHidden" style\x3d"width:100%" data-dojo-attach-point\x3d"currentDateContent"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTHidden esriCTPastOrFutureDateContent" data-dojo-attach-point\x3d"pastOrFutureDateContent"\x3e\r\n        \x3cdiv class\x3d"esriCTMarginForLabel"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTMarginForLabel"\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.years}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"yearsTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.years}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.months}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"monthsTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.months}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.days}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"daysTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.days}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTMarginForLabel" style\x3d"margin-top: 5px;"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTMarginForLabel"\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.hours}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"hoursTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.hours}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.minutes}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"minutesTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.minutes}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTFloatLeft"\x3e\r\n                \x3cdiv class\x3d"esriCTValueLabel"\x3e${nls.seconds}\x3c/div\x3e\r\n                \x3cdiv style\x3d"width:112px" data-dojo-type\x3d"dijit/form/NumberSpinner" required\x3d"true" value\x3d"0"\r\n                    data-dojo-props\x3d"constraints:{min:0,places:0},intermediateChanges:true" data-dojo-attach-point\x3d"secondsTextBox" tabindex\x3d"0"\r\n                    aria-label\x3d"${nls.seconds}"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTHidden esriCTDatesWarningContainer" data-dojo-attach-point\x3d"relativeDateWarningContainer"\x3e${nls.relativeDates.relativeDateWarning}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/RelativeDomains.html":'\x3cdiv\x3e\r\n  \x3cfieldset class\x3d"esriCTFieldset"\x3e\r\n    \x3cdiv class\x3d"esriCTDomainFieldsHint"data-dojo-attach-point\x3d"domainFieldsHint"\x3e\x3c/div\x3e\r\n    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.relativeDomains.fieldSetTitle}\x3c/legend\x3e\r\n    \x3cdiv class\x3d"esriCTTableParentContainer" data-dojo-attach-point\x3d"tableParentContainer"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/fieldset\x3e\r\n\x3c/div\x3e',"url:widgets/SmartEditor/setting/Setting.html":'\x3cdiv style\x3d"width:100%; height:100%;"\x3e\r\n    \x3cdiv style\x3d"height:100%;" data-dojo-attach-point\x3d"tabDiv"\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"layerSettingTabNode" class\x3d"esriCTTabNode" style\x3d"height: 100%;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"layerSettingsContainer" class\x3d"" style\x3d"margin-bottom: 10px;"\x3e\r\n                \x3cdiv class\x3d"esriCTRadioBtn"\x3e\r\n                    \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" id\x3d"webmapSettingsRadioBtn"\r\n                        data-dojo-props\x3d"group: \'g2\'" type\x3d"radio" name\x3d"jimusettingradiobtn"\r\n                        data-dojo-attach-point\x3d"webmapSettingsRadioBtn"\x3e\r\n                    \x3clabel class\x3d"esriCTRadioLabel" for\x3d"webmapSettingsRadioBtn"\x3e\r\n                        ${nls.layersPage.webmapSettingsRadioBtnLabel}\r\n                    \x3c/label\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTRadioBtn"\x3e\r\n                    \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" id\x3d"customSettingsRadioBtn"\r\n                        data-dojo-props\x3d"group: \'g2\'" type\x3d"radio" name\x3d"jimusettingradiobtn"\r\n                        data-dojo-attach-point\x3d"customSettingsRadioBtn"\x3e\r\n                    \x3clabel class\x3d"esriCTRadioLabel" for\x3d"customSettingsRadioBtn"\x3e\r\n                        ${nls.layersPage.customSettingsRadioBtnLabel}\r\n                    \x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"breadCrumbContainer" class\x3d"breadCrumbContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"layerTable" data-dojo-attach-point\x3d"tableLayerInfos" style\x3d"clear: both;height:100%;"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTMainLayerCheckBox"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"expandMainLayerNode" id\x3d"expandMainTable" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                    title\x3d"${nls.layersPage.expandMainTable}"/\x3e\r\n                \x3clabel class\x3d"checkLabel" for\x3d"expandMainTable"\r\n                    title\x3d"${nls.layersPage.expandMainTable}"\x3e${nls.layersPage.expandMainTable}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTRelatedLayerCheckBox"\x3e\r\n                \x3cinput  data-dojo-attach-point\x3d"expandRelatedTableNode" id\x3d"expandRelatedTable"\r\n                    data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.expandRelatedTable}" /\x3e\r\n                \x3clabel class\x3d"checkLabel" for\x3d"expandRelatedTable"\r\n                    title\x3d"${nls.layersPage.expandRelatedTable}"\x3e${nls.layersPage.expandRelatedTable}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"smartActionsTabNode" class\x3d"esriCTTabNode esriCTSmartActionsTabNode"\x3e\r\n            \x3cdiv\x3e\r\n                \x3cfieldset style\x3d"padding:10px;" class\x3d"esriCTFieldSet"\x3e\r\n                    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.smartActionsPage.definedActions}\x3c/legend\x3e\r\n                    \x3cdiv class\x3d""\x3e\r\n                        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addNewSmartAction" title\x3d"${nls.smartActionsPage.addNewSmartActionLinkText}"\x3e\r\n                            \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"add-label"\x3e\r\n                                ${nls.smartActionsPage.addNewSmartActionLinkText}\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTSmartActionsTableParent"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"smartActionsTableNode"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3c!-- Attribute Actions Tab Settings Starts --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"attributeActionsTabNode" class\x3d"esriCTTabNode esriCTAttributeActionsTabNode"\x3e\r\n            \x3c!-- intersection actions Table starts --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeActions"\x3e\r\n                \x3cfieldset style\x3d"padding:10px;" class\x3d"esriCTFieldSet"\x3e\r\n                    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.actionPage.copyAction.intersection}\x3c/legend\x3e\r\n                    \x3cdiv class\x3d""\x3e\r\n                        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addIntersectionAction" title\x3d"${nls.smartActionsPage.addNewSmartActionLinkText}"\r\n                            data-dojo-attach-event\x3d"onClick:_onIntersectionBtnClick"\x3e\r\n                            \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"add-label"\x3e\r\n                                ${nls.smartActionsPage.addNewSmartActionLinkText}\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTAttributeActionsTableParent"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"intersectionActionsTableNode"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- intersection actions Table ends --\x3e\r\n            \x3c!-- Address actions Table starts --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeActions"\x3e\r\n                \x3cfieldset style\x3d"padding:10px;" class\x3d"esriCTFieldSet"\x3e\r\n                    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.actionPage.copyAction.address}\x3c/legend\x3e\r\n                    \x3cdiv class\x3d""\x3e\r\n                        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addAddressAction" title\x3d"${nls.smartActionsPage.addNewSmartActionLinkText}"\r\n                        data-dojo-attach-event\x3d"onClick:_onAddressBtnClick"\x3e\r\n                            \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"add-label"\x3e\r\n                                ${nls.smartActionsPage.addNewSmartActionLinkText}\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTAttributeActionsTableParent"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"addressActionsTableNode"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Address actions Table ends --\x3e\r\n            \x3c!-- Coordinates actions Table starts --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeActions"\x3e\r\n                \x3cfieldset style\x3d"padding:10px;" class\x3d"esriCTFieldSet"\x3e\r\n                    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.actionPage.copyAction.coordinates}\x3c/legend\x3e\r\n                    \x3cdiv class\x3d""\x3e\r\n                        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addCoordinateAction" title\x3d"${nls.smartActionsPage.addNewSmartActionLinkText}"\r\n                        data-dojo-attach-event\x3d"onClick:_onCoordinateBtnClick"\x3e\r\n                            \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"add-label"\x3e\r\n                                ${nls.smartActionsPage.addNewSmartActionLinkText}\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTAttributeActionsTableParent"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"coordinatesActionsTableNode"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Coordinates actions Table ends --\x3e\r\n            \x3c!-- Preset actions Table starts --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeActions"\x3e\r\n                \x3cfieldset style\x3d"padding:10px;" class\x3d"esriCTFieldSet"\x3e\r\n                    \x3clegend class\x3d"esriCTLegendTitle"\x3e${nls.actionPage.copyAction.preset}\x3c/legend\x3e\r\n                    \x3cdiv class\x3d""\x3e\r\n                        \x3cdiv class\x3d"add-with-icon" data-dojo-attach-point\x3d"addPresetAction" title\x3d"${nls.smartActionsPage.addNewSmartActionLinkText}"\r\n                            data-dojo-attach-event\x3d"onClick:_onPresetBtnClick"\x3e\r\n                            \x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n                            \x3cspan class\x3d"add-label"\x3e\r\n                                ${nls.smartActionsPage.addNewSmartActionLinkText}\x3c/span\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"esriCTAttributeActionsTableParent"\x3e\r\n                        \x3cdiv data-dojo-attach-point\x3d"presetActionsTableNode"\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/fieldset\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Preset actions Table starts --\x3e\r\n        \x3c/div\x3e\r\n            \x3c!-- Attribute Actions Tab Settings Ends --\x3e\r\n\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"generalSettingTabNode" class\x3d"esriCTTabNode esriCTGeneralSettingTabNode"\x3e\r\n                \x3cdiv class\x3d"buttonSection"\x3e\r\n                    \x3cdiv class\x3d"jimu-btn jimu-trailing-margin1" data-dojo-attach-point\x3d"geocoderSettings"\x3e${nls.layersPage.geocoderSettingsText}\x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"overflow: hidden"\x3e\r\n                    \x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n                        \x3clegend class\x3d"esriCTFieldSetLegend"\x3e${nls.layersPage.featureTemplateLegendLabel}\x3c/legend\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"displayShapeSelector" id\x3d"displayShapeSelector"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.displayShapeSelectorTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"displayShapeSelector" title\x3d"${nls.layersPage.displayShapeSelectorTip}"\x3e${nls.layersPage.displayShapeSelector}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"createNewFeaturesFromExisting" id\x3d"createNewFeaturesFromExisting"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.createNewFeaturesFromExistingTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"createNewFeaturesFromExisting" title\x3d"${nls.layersPage.createNewFeaturesFromExistingTip}"\x3e${nls.layersPage.createNewFeaturesFromExisting}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption" style\x3d"text-indent: 25px;"\x3e\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"overrideDefaultsByCopiedFeature" id\x3d"overrideDefaultsByCopiedFeature"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.copiedFeaturesOverrideDefaultsTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"overrideDefaultsByCopiedFeature" title\x3d"${nls.layersPage.copiedFeaturesOverrideDefaultsTip}"\x3e${nls.layersPage.copiedFeaturesOverrideDefaults}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"displayPresetTop" id\x3d"displayPresetTop"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.displayPresetTopTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"displayPresetTop" title\x3d"${nls.layersPage.displayPresetTopTip}"\x3e${nls.layersPage.displayPresetTop}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"useFilterEditor" id\x3d"useFilterEditor"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.useFilterEditorTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"useFilterEditor" title\x3d"${nls.layersPage.useFilterEditorTip}"\x3e${nls.layersPage.useFilterEditor}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption" style\x3d"text-indent: 25px;"\x3e\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"groupFilteredTemplates" id\x3d"groupFilteredTemplates"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.groupFilteredTemplatesTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"groupFilteredTemplates" title\x3d"${nls.layersPage.groupFilteredTemplatesTip}"\x3e${nls.layersPage.groupFilteredTemplates}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"keepTemplateSelected" id\x3d"keepTemplateSelected"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.keepTemplateActiveTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"keepTemplateSelected" title\x3d"${nls.layersPage.keepTemplateActiveTip}"\x3e${nls.layersPage.keepTemplateActive}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"listenToGF" id\x3d"listenToGF" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                                title\x3d"${nls.layersPage.listenToGroupFilterTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"listenToGF" title\x3d"${nls.layersPage.listenToGroupFilterTip}"\x3e${nls.layersPage.listenToGroupFilter}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"editAddDataLayers" id\x3d"editAddDataLayers" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                                title\x3d"${nls.layersPage.editLayerAddedFromAddDataTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"editAddDataLayers" title\x3d"${nls.layersPage.editLayerAddedFromAddDataTip}"\x3e${nls.layersPage.editLayerAddedFromAddData}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n\r\n\r\n                    \x3c/fieldset\x3e\r\n                    \x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n                        \x3clegend class\x3d"esriCTFieldSetLegend"\x3e${nls.layersPage.saveSettingsLegendLabel}\x3c/legend\x3e\r\n\r\n                        \x3cdiv class\x3d"esriCTButtonPositionsLabel"\x3e${nls.layersPage.buttonPositionsLabel}\x3c/div\x3e\r\n                        \x3cdiv class\x3d"esriCTRadioBtnContainer"\x3e\r\n                            \x3cdiv class\x3d"esriCTRadioBtn"\x3e\r\n                                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" id\x3d"positionOfSaveButtonBelow"\r\n                                    data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn" checked\x3d"true"\r\n                                    data-dojo-attach-point\x3d"positionOfSaveButtonBelow"\x3e\r\n                                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"positionOfSaveButtonBelow"\x3e\r\n                                    ${nls.layersPage.belowEditLabel}\r\n                                \x3c/label\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv class\x3d"esriCTRadioBtn"\x3e\r\n                                \x3cinput data-dojo-type\x3d"jimu/dijit/RadioBtn" id\x3d"positionOfSaveButtonAbove"\r\n                                    data-dojo-props\x3d"group: \'g1\'" type\x3d"radio" name\x3d"jimuradiobtn"\r\n                                    data-dojo-attach-point\x3d"positionOfSaveButtonAbove"\x3e\r\n                                \x3clabel class\x3d"esriCTRadioLabel" for\x3d"positionOfSaveButtonAbove"\x3e\r\n                                    ${nls.layersPage.aboveEditLabel}\r\n                                \x3c/label\x3e\r\n                            \x3c/div\x3e\r\n\r\n\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"displayPromptOnSave" id\x3d"displayPromptOnSave"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.promptOnSaveTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"displayPromptOnSave" title\x3d"${nls.layersPage.promptOnSaveTip}"\x3e${nls.layersPage.promptOnSave}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"displayPromptOnDelete" id\x3d"displayPromptOnDelete"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.promptOnDeleteTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"displayPromptOnDelete" title\x3d"${nls.layersPage.promptOnDeleteTip}"\x3e${nls.layersPage.promptOnDelete}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"autoSaveEdits" id\x3d"autoSaveEdits"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.autoSaveEdits}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"autoSaveEdits" title\x3d"${nls.layersPage.autoSaveEdits}"\x3e${nls.layersPage.autoSaveEdits}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"autoSaveAttrUpdates" id\x3d"autoSaveAttrUpdates"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.autoSaveAttrUpdates}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"autoSaveAttrUpdates" title\x3d"${nls.layersPage.autoSaveAttrUpdates}"\x3e${nls.layersPage.autoSaveAttrUpdates}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"removeOnSave" id\x3d"removeOnSave" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                                title\x3d"${nls.layersPage.removeOnSaveTip}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"removeOnSave" title\x3d"${nls.layersPage.removeOnSaveTip}"\x3e${nls.layersPage.removeOnSave}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption" style\x3d"display: inline-block;"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"switchToMultilineInput" id\x3d"multilineCheckBox" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                                title\x3d"${nls.layersPage.switchToMultilineInput}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"multilineCheckBox" title\x3d"${nls.layersPage.switchToMultilineInput}"\x3e${nls.layersPage.switchToMultilineInput}\x3c/label\x3e\r\n                            \x3cdiv class\x3d"esriCTMaxCharacterLimitTextBox"\x3e\r\n                                \x3cdiv data-dojo-attach-point\x3d"maxCharacter" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true"\r\n                                    value\x3d"35" data-dojo-props\x3d"constraints: {min:0}" required\x3d"true" style\x3d"width:100%"\x3e\x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/div\x3e\r\n\r\n                    \x3c/fieldset\x3e\r\n                    \x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n                        \x3clegend class\x3d"esriCTFieldSetLegend"\x3e${nls.layersPage.geometrySettingsLegendLabel}\x3c/legend\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"editGeometryDefault" id\x3d"editGeometryDefault"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.geometryEditDefault}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"editGeometryDefault" title\x3d"${nls.layersPage.geometryEditDefault}"\x3e${nls.layersPage.geometryEditDefault}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"enableLockingMapNavigation" id\x3d"enableLockingMapNavigation"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.enableLockingMapNavigation}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"enableLockingMapNavigation" title\x3d"${nls.layersPage.enableLockingMapNavigation}"\x3e${nls.layersPage.enableLockingMapNavigation}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"enableMovingSelectedFeatureToGPS" id\x3d"enableMovingSelectedFeatureToGPS"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.enableMovingSelectedFeatureToGPS}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"enableMovingSelectedFeatureToGPS" title\x3d"${nls.layersPage.enableMovingSelectedFeatureToGPS}"\x3e${nls.layersPage.enableMovingSelectedFeatureToGPS}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n\r\n\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"enableMovingSelectedFeatureToXY" id\x3d"enableMovingSelectedFeatureToXY"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.enableMovingSelectedFeatureToXY}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"enableMovingSelectedFeatureToXY" title\x3d"${nls.layersPage.enableMovingSelectedFeatureToXY}"\x3e${nls.layersPage.enableMovingSelectedFeatureToXY}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption" title\x3d"${nls.layersPage.featuresSelectionToleranceTooltip}"\x3e\r\n                            \x3cdiv class\x3d"esriCTGlobalTleranceParentDiv"\x3e\r\n                                \x3cdiv class\x3d"esriCTGlobalToleranceTextbox"\x3e\r\n                                    \x3cdiv data-dojo-attach-point\x3d"featuresSelectionTolerance" value\x3d"5"\r\n                                    data-dojo-type\x3d"dijit/form/NumberSpinner"\r\n                                    data-dojo-props\x3d"smallDelta:5, constraints:{min:0,max:1000,places:0}" style\x3d"width:100%"\x3e\x3c/div\x3e\r\n                                \x3c/div\x3e\r\n                                \x3cdiv style\x3d"width: 75%; margin-left: 10px; margin-right: 10px;" class\x3d"esriCTLabel"\x3e\r\n                                    ${nls.layersPage.featuresSelectionTolerance}\x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/fieldset\x3e\r\n                    \x3cfieldset class\x3d"esriCTFieldSet"\x3e\r\n                        \x3clegend class\x3d"esriCTFieldSetLegend"\x3e${nls.layersPage.actionsSettingsLegendLabel}\x3c/legend\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"valuePicker" id\x3d"valuePickerEnable" data-dojo-type\x3d"dijit/form/CheckBox"\r\n                                title\x3d"${nls.layersPage.enableValuePickerHint}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"valuePickerEnable" title\x3d"${nls.layersPage.enableValuePickerHint}"\x3e${nls.layersPage.enableValuePicker}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"enableAttributeUpdates" id\x3d"enableAttributeUpdates"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.enableAttributeUpdates}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"enableAttributeUpdates" title\x3d"${nls.layersPage.enableAttributeUpdates}"\x3e${nls.layersPage.enableAttributeUpdates}\x3c/label\x3e\r\n\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption" style\x3d"text-indent: 25px;"\x3e\r\n\r\n                            \x3cinput class\x3d"check" data-dojo-attach-point\x3d"enableAutomaticAttributeUpdates" id\x3d"enableAutomaticAttributeUpdates"\r\n                                data-dojo-type\x3d"dijit/form/CheckBox" title\x3d"${nls.layersPage.enableAutomaticAttributeUpdates}" /\x3e\r\n                            \x3clabel class\x3d"checkLabel" for\x3d"enableAutomaticAttributeUpdates" title\x3d"${nls.layersPage.enableAutomaticAttributeUpdates}"\x3e${nls.layersPage.enableAutomaticAttributeUpdates}\x3c/label\x3e\r\n                        \x3c/div\x3e\r\n                        \x3cdiv class\x3d"checkOption"\x3e\r\n                            \x3cdiv class\x3d"esriCTGlobalTleranceParentDiv"\x3e\r\n                              \x3cdiv class\x3d"esriCTGlobalToleranceTextbox"\x3e\r\n                                  \x3cdiv data-dojo-attach-point\x3d"globalTolerance" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true"\r\n                                      value\x3d"0" data-dojo-props\x3d"constraints: {min:0}" required\x3d"true" style\x3d"width:100%"\x3e\x3c/div\x3e\r\n                              \x3c/div\x3e\r\n  \r\n                              \x3cdiv class\x3d"esriCTGlobalToleranceDropbox"\x3e\r\n                                  \x3cselect style\x3d"width: 100%;" data-dojo-attach-point\x3d"globalToleranceUnit" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n                                      \x3coption value\x3d"miles"\x3e${nls.units.miles}\x3c/option\x3e\r\n                                      \x3coption value\x3d"kilometers"\x3e${nls.units.kilometers}\x3c/option\x3e\r\n                                      \x3coption value\x3d"meters"\x3e${nls.units.meters}\x3c/option\x3e\r\n                                      \x3coption value\x3d"feet"\x3e${nls.units.feet}\x3c/option\x3e\r\n                                  \x3c/select\x3e\r\n                              \x3c/div\x3e\r\n  \r\n                              \x3cdiv class\x3d"esriCTLabel esriCTIntersectionToleranceLabel"\x3e${nls.intersectionTolerance.intersectionTitle}\x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/div\x3e\r\n                          \x3cdiv class\x3d"checkOption"\x3e\r\n                            \x3cdiv class\x3d"esriCTGlobalTleranceParentDiv"\x3e\r\n                                \x3cdiv class\x3d"esriCTGlobalToleranceTextbox"\x3e\r\n                                    \x3cdiv data-dojo-attach-point\x3d"globalPixelsTolerance" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true"\r\n                                        value\x3d"20" data-dojo-props\x3d"constraints: {min:0}" required\x3d"true" style\x3d"width:100%"\x3e\x3c/div\x3e\r\n                                \x3c/div\x3e\r\n                                \x3cdiv style\x3d"width: 75%; margin-left: 10px; margin-right: 10px;" class\x3d"esriCTLabel"\x3e\r\n                                    ${nls.intersectionTolerance.pixelsToleranceTitle}\x3c/div\x3e\r\n                            \x3c/div\x3e\r\n                        \x3c/div\x3e\r\n                    \x3c/fieldset\x3e\r\n                \x3c/div\x3e\r\n\r\n                \x3cdiv class\x3d"edit-description-title" title\x3d"${nls.layersPage.editDescriptionTip}"\x3e${nls.layersPage.editDescription}\x3c/div\x3e\r\n\r\n                \x3cdiv class\x3d"edit-description-box"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"editorDescription"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n\r\n            \x3c/div\x3e\r\n\r\n        \x3c/div\x3e\r\n    \x3cdiv class\x3d"tableInfos-loading" data-dojo-attach-point\x3d"tableInfosLoading"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/SmartEditor/setting/css/style.css":".jimu-widget-smartEditor-setting-relativeDates .esriCTRadioBtn {width: 25%; float: left; text-indent: 20px; padding: 5px 0px 5px 0px;}.jimu-widget-smartEditor-setting-relativeDates .esriCTselectValueLabel {width: 50% !important;}.jimu-widget-smartEditor-setting-relativeDates .esriCTDateTypeLabel {min-width: fit-content;}.jimu-widget-smartEditor-setting-relativeDates .esriCTLabel,.jimu-widget-smartEditor-setting-relativeDates .esriCTFixedContentWrappper {padding: 5px 0px 5px 0px; width: 100%; overflow: hidden;}.jimu-widget-smartEditor-setting-relativeDates .esriCTValueLabel {margin-bottom: 5px;}.jimu-widget-smartEditor-setting-relativeDates .esriCTPastOrFutureDateContent {width: 100%; margin-left: 20px;}.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTPastOrFutureDateContent {margin-left: none; margin-right: 20px;}.jimu-widget-smartEditor-setting-relativeDates .esriCTFixedContentLabel {width: 25%; float: left;}.jimu-widget-smartEditor-setting-relativeDates .esriCTFixedContentDijit {width: 75%; float: right;}.jimu-widget-smartEditor-setting-relativeDates .esriCTFloatLeft {width: 33%; float: left;}.jimu-widget-smartEditor-setting-relativeDates .esriCTFloatRight {width: 33%; float: right;}.jimu-widget-smartEditor-setting-relativeDates .esriCTHidden {display: none;}.jimu-widget-smartEditor-setting-relativeDates .esriCTRadioButtonContainer {width: 100%; height: 30px; display: inline-table;}.jimu-widget-smartEditor-setting-relativeDates .esriCTMarginForLabel {width: 100%; padding: 2px 0px 1px 0px; overflow: hidden;}.jimu-widget-smartEditor-setting-relativeDates .esriCTFixedDateContent {width:100%;}.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTFloatRight,.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTFixedContentDijit {float:left;}.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTRadioBtn,.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTFixedContentLabel,.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTFloatLeft {float: right;}.jimu-widget-smartEditor-setting-relativeDates .esriCTRelativeDatesHint {font-size: 12px; color: #a0acbf; font-style: oblique; width: 100%; margin-top: 5px;}.jimu-widget-smartEditor-setting-relativeDates .esriCTDatesWarningContainer {font-size: 12px; color: red; width: 100%; margin-top: 5px; padding: 5px 0px 5px 0px; overflow: hidden; font-style: italic;}.jimu-widget-smartEditor-setting-relativeDates .esriCTRadioLabel {vertical-align: middle;}.jimu-widget-smartEditor-setting-relativeDates .esriCTPopUpLabel {width: 25%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; line-height: 30px; text-indent: 20px;}.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTPopUpLabel {float: right}.jimu-widget-smartEditor-setting-relativeDates .esriCTWrapper {width: 100%; overflow: hidden; margin-bottom: 5px; padding-bottom: 5px;}.jimu-rtl .jimu-widget-smartEditor-setting-relativeDates .esriCTPopupSelect{float: left;}@media (max-width: 600px) {.jimu-widget-smartEditor-setting-relativeDates .esriCTRadioBtn {width: 50%;} .jimu-widget-smartEditor-setting-relativeDates .esriCTFloatLeft {width: 50%;}}@media (max-width: 320px) {.jimu-widget-smartEditor-setting-relativeDates .esriCTRadioBtn {width: 100%;} .jimu-widget-smartEditor-setting-relativeDates .esriCTFloatLeft {width:100%;}}.jimu-widget-smartEditor-setting-relativeDates .esriCTDomainFieldHint {font-size: 13px; color: #a0acbf; font-style: oblique; margin-top: 5px;}.jimu-widget-smartEditor-setting {margin: 0; padding: 0; font-size: 15px; overflow: hidden;}.esriCTEllipsis {overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-smartEditor-setting-address .esriCTHint {margin-top: 10px; float: left; font-size: 13px; color: #a0acbf; font-style: oblique;}.jimu-widget-smartEditor-setting .esriCTHint {float: left; font-size: 12px; color: #a0acbf; font-style: oblique; width: 100%; margin-left: 40px; padding-bottom: 5px;}.jimu-widget-smartEditor-setting .edit-description-box {width: calc(100% - 4px); height: 215px; position: relative; padding-top: 5px;}.jimu-widget-smartEditor-setting .edit-description-title {padding-top: 10px; width: calc(100% - 4px);}.jimu-widget-smartEditor-setting .dijitEditorIFrameContainer,.jimu-widget-smartEditor-edit-description .dijitEditorIFrameContainer {background-color: #ffffff; border: none !important; width: 100% !important; height: 145px !important;}.jimu-widget-smartEditor-setting .warningIcon {background-image: url(../images/warning.png); width: 18px; height: 18px; margin-right: 30px; float: right; background-size: 18px; margin-top: 7px; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting .warningIcon {margin-right: 0px; margin-left: 30px; float: left;}.jimu-widget-smartEditor-setting .table-field-icon {background-image: url(../images/table.png); width: 16px; height: 16px; margin-left: 5px;}.jimu-widget-smartEditor-setting .table-field-icon:hover {background-image: url(../images/tableHover.png);}.jimu-rtl .jimu-widget-smartEditor-setting .table-field-icon {margin-left: 0; margin-right: 5px;}.jimu-widget-smartEditor-setting .editable {width: 100px;}.jimu-widget-smartEditor-setting .layer {width: 200px;}.jimu-widget-smartEditor-setting .update {width: 135px; padding-left: 0px;}.jimu-widget-smartEditor-setting .disable {width: 220px; padding-left: 0px;}.jimu-widget-smartEditor-setting .actions {width: 75px; padding-right: 1px !important;}.jimu-widget-smartEditor-setting .layersTableAction {width: 70px;}.jimu-widget-smartEditor-setting .description {width: 90px;}.jimu-widget-smartEditor-setting-fields .required {width: 7px; color: red; padding-left: 0 !important; padding-right: 0 !important;}.jimu-widget-smartEditor-setting-fields .editable {width: 120px;}.jimu-widget-smartEditor-setting-fields .visible {width: 90px;}.jimu-widget-smartEditor-setting-fields .preset {width: 120px;}.jimu-widget-smartEditor-setting-fields .fieldName {width: 190px;}.jimu-widget-smartEditor-setting-fields .fieldLabel {}.jimu-widget-smartEditor-setting-fields .settingsDesc {padding-bottom: 10px; font-size: 14px;}.jimu-widget-smartEditor-setting-fields .settingsNotes {padding-top: 10px; font-size: 14px;}.jimu-widget-smartEditor-setting-fields .actions {width: 80px; padding-right: 2px !important;}.jimu-widget-smartEditor-setting-fields .attachmentsDesc {color: #24B5CC; font-size: small; max-width: 100%; cursor: pointer; padding-top: 10px; float: left;}.jimu-rtl .jimu-widget-smartEditor-setting-fields .attachmentsDesc {float: right;}.jimu-widget-smartEditor-rule-table .rule {width: 185px;}.jimu-widget-smartEditor-rule-table .expression {overflow: hidden;}.jimu-widget-smartEditor-rule-table .actions {width: 100px;}.jimu-widget-smartEditor-rule-table .settingsDesc {font-size: 14px; padding-bottom: 10px;}.jimu-widget-smartEditor-rule-table .settingsNotes {padding-top: 10px; font-size: 14px;}.jimu-widget-smartEditor-rule-table .editGroupHint {margin-top: 5px; padding-top: 5px; float: left; font-size: 12px; color: #a0acbf; font-style: oblique; width: 100%; padding-bottom: 5px;}.jimu-widget-smartEditor-setting .setting-table {width: 100%;}.jimu-widget-smartEditor-setting .setting-table \x3e thead \x3e tr \x3e th, .jimu-widget-smartEditor-setting .setting-table \x3e tbody \x3e tr \x3e td {height: 40px; line-height: 40px; vertical-align: middle;}.jimu-widget-smartEditor-setting .input-table \x3e tbody \x3e tr \x3e .first {width: auto; min-width: 160px; text-align: left;}.jimu-rtl .jimu-widget-smartEditor-setting .input-table \x3e tbody \x3e tr \x3e .first {text-align: right;}.jimu-widget-smartEditor-setting .input-table \x3e tbody \x3e tr \x3e .second {width: auto;}.jimu-widget-smartEditor-setting .input-table \x3e tbody \x3e tr \x3e .second \x3e span {display: inline-block; height: 40px; line-height: 40px;}.jimu-widget-smartEditor-setting .dijitArrowButtonContainer {width: 17px;}.jimu-widget-smartEditor-setting .dijitSelect {height: 30px; width: 100%;}.jimu-widget-smartEditor-setting .checkOption {padding-top: 5px; padding-bottom: 5px; padding-left: 5px;}.jimu-widget-smartEditor-setting .check {margin-left: 15px; margin-right: 5px;}.jimu-widget-smartEditor-setting .esriCTRelatedLayerCheckBox {margin: 0; position: absolute; bottom: 0px;}.jimu-widget-smartEditor-setting .esriCTMainLayerCheckBox {margin: 0; position: absolute; bottom: 20px;}.jimu-widget-smartEditor-setting .esriCTFieldSet {height: auto; width: calc(100% - 4px); border: 1px solid #a0acbf; border-radius: 5px; font-size: 14px; color: #596679; margin: 10px 0px 10px 0px;}.jimu-widget-smartEditor-setting .esriCTFieldSetLegend {margin-left: 15px; font-weight: bold;}.jimu-widget-smartEditor-setting .esriCTButtonPositionsLabel {padding-left: 5px; padding-bottom: 5px; padding-top: 5px; margin-left: 15px; width: 100%;}.jimu-widget-smartEditor-setting .esriCTRadioBtnContainer {margin-left: 20px; display: inline-flex}.jimu-widget-smartEditor-setting .esriCTRadioLabel {vertical-align: top; padding-right: 40px;}.jimu-widget-smartEditor-setting .jimu-image-chooser {right: inherit !important;}.jimu-widget-smartEditor-setting .editor-container .uploaderInsideNode embed {display: none;}jimu-widget-smartEditor-edit-description .jimu-image-chooser {right: inherit !important;}jimu-widget-smartEditor-edit-description .editor-container .uploaderInsideNode embed {display: none;}.jimu-widget-smartEditor-setting a.attDescrip {width: 20px; height: 20px; display: block; background: transparent url(../images/desc.png) center center no-repeat; text-align: center; vertical-align: middle; z-index: 9999;}jimu-widget-smartEditor-setting a.attDescrip:hover {background-image: url(../images/descHover.png);}.jimu-widget-smartEditor-filter-page .submithide {padding-left: 4px; font-size: 12px;}.jimu-widget-smartEditor-filter-page {height: 100%;}.jimu-widget-smartEditor-filter-page \x3e div:nth-child(2) {height: calc(100% - 65px);}.jimu-widget-smartEditor-filter-page .jimu-single-filter .dijit-form-Select\x3etbody\x3etr\x3etd\x3e.dijitButtonText {height: 22px !important;}.jimu-widget-smartEditor-setting .nextArrowIcon {height: 20px; width: 20px; background-position: center; background-repeat: no-repeat; background-size: 20px; background-image: url(../images/nextArrow.png); float: left;}.jimu-widget-smartEditor-setting .breadCrumbTitle {float: left;}.jimu-rtl .jimu-widget-smartEditor-setting .nextArrowIcon {float: right; -webkit-transform: rotate(180deg); -moz-transform: rotate(180deg); -ms-transform: rotate(180deg); -o-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-smartEditor-setting .breadCrumbTitle {float: right;}.jimu-widget-smartEditor-setting .breadCrumbTitleActive {color: #24B5CC; cursor: pointer;}.jimu-widget-smartEditor-setting .breadCrumbContainer {padding: 0 0 5px 0; width: 100%; float: left; color: #898989; font-family: \"Avenir Medium\";}.jimu-widget-smartEditor-setting .tableInfos-loading {top: 65px; position: relative;}.esriCTCopyAction {height: 15px; width: 15px; background-position: center; background-repeat: no-repeat; background-size: 15px; background-image: url(../images/copy.png); float: left; cursor: pointer; margin-left: 1px;}.esriCTCopyAction:hover {background-image: url(../images/copyHover.png);}.jimu-rtl .esriCTCopyAction {float: right; margin-right: 5px;}.jimu-widget-smartEditor-setting .buttonSection {margin-bottom: 10px;}.jimu-widget-smartEditor-setting-coordinates .esriCTSelectTitle {padding-top: 5px; padding-bottom: 5px;}.jimu-widget-smartEditor-setting-intersection .esriCTIntersectionMainContainer,.jimu-widget-smartEditor-setting-address .esriCTAddressMainContainer{max-height: 500px; padding: 0 5px;}.claro .jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer .dijitSelect {height: 27px; margin-top: 1px; width: 100%; float: left;}.jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer {float: left;}.jimu-widget-smartEditor-setting-intersection .esriCTIntersectionTableMaxHeight .jimu-simple-table{max-height: 200px;}.jimu-widget-smartEditor-setting-intersection .jimu-popup \x3e .content {overflow-y: hidden;}.jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer .dijitSelectLabel {overflow: hidden; width: 200px; float: left;}.jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer .dijitSelect .dijitInputField {overflow: hidden;}.jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer .dijitSelectLabel {text-align: left;}.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTDropDownContainer .dijitSelectLabel {text-align: right;}.jimu-widget-smartEditor-setting-address .esriCTRowContainer, .jimu-widget-smartEditor-setting-intersection .esriCTRowContainer {width: 100%; overflow: hidden; margin-bottom: 10px;}.jimu-widget-smartEditor-setting-address .esriCTlabel, .jimu-widget-smartEditor-setting-intersection .esriCTlabel {width: 30%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; font-size: 14px; color: #596679; line-height: 30px;}.jimu-widget-smartEditor-setting-address .esriCTGroupInfoContainer{padding-left: 25px; width: 70%; float: right; display: inline-block;}.jimu-widget-smartEditor-setting-intersection .esriCTGroupInfoContainer {padding-left: 25px; width: 70%; float: right;}.jimu-rtl .jimu-widget-smartEditor-setting-address .esriCTGroupInfoContainer {float: left}.jimu-widget-smartEditor-setting-address .esriCTCreditWarningContainer {font-size: 13px;}.jimu-widget-smartEditor-setting-intersection .esriCTDataTypeDropdown .dijitSelectLabel {width: 198px;}.claro .jimu-widget-smartEditor-setting-intersection .esriCTDataTypeDropdown .dijitSelect {height: 30px;}.jimu-widget-smartEditor-setting-intersection .esriCTIgnoreLayerRankingLabel {width: 100%; padding: 0px; float: none; line-height: normal;}.jimu-widget-smartEditor-setting-address .esriCTFieldset, .jimu-widget-smartEditor-setting-intersection .esriCTFieldset,.jimu-widget-smartEditor-setting-presetPopup .esriCTFieldset, .jimu-widget-smartEditor-setting-coordinates .esriCTFieldset, .jimu-widget-smartEditor-setting-address .esriCTFieldset, .jimu-widget-smartEditor-setting-relativeDomains .esriCTFieldset{height: auto; width: 100%; border: 1px solid #a0acbf! important; border-radius: 5px; font-size: 14px; color: #596679; min-width: 0px; padding: 10px;}.jimu-widget-smartEditor-setting-address .esriCTLegendTitle, .jimu-widget-smartEditor-setting-intersection .esriCTLegendTitle,.jimu-widget-smartEditor-setting-presetPopup .esriCTLegendTitle, .jimu-widget-smartEditor-setting .esriCTLegendTitle,.jimu-widget-smartEditor-setting-coordinates .esriCTLegendTitle, .jimu-widget-smartEditor-setting-address .esriCTLegendTitle {margin-left: 5px; font-weight: bold;}.jimu-rtl .jimu-widget-smartEditor-setting-address .esriCTLegendTitle, .jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTLegendTitle,.jimu-rtl .jimu-widget-smartEditor-setting-presetPopup .esriCTLegendTitle, .jimu-rtl .jimu-widget-smartEditor-setting .esriCTLegendTitle,.jimu-rtl .jimu-widget-smartEditor-setting-coordinates .esriCTLegendTitle, .jimu-rtl .jimu-widget-smartEditor-setting-address .esriCTLegendTitle {margin-left: 0px; margin-right: 5px;}.jimu-widget-smartEditor-setting-intersection .esriCTToleranceSettingsIcon {background-image: url(../images/settings.png); cursor: pointer; width: 16px; height: 16px; float: right;}.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTToleranceSettingsIcon {float: left;}.jimu-widget-smartEditor-setting-intersection .esriCTToleranceValueText {height: 25px; width: 85%; float: left; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTToleranceValueText {float: right;}.jimu-widget-smartEditor-setting-intersection .esriCTpopupFieldContent {height: auto; width: 200px; min-height: 160px;}.jimu-widget-smartEditor-setting-intersection .esriCTPopupLabels {font-size: 14px; color: #596679;}.jimu-widget-smartEditor-setting-intersection .esriCTMargin {margin-top: 10px;}.jimu-widget-smartEditor-setting-intersection .esriCTToleranceUnitDropdown {width: 100%;}.claro .jimu-widget-smartEditor-setting-intersection .esriCTToleranceParentDiv .dijitDropDownButton {margin: 0px;}.claro .jimu-widget-smartEditor-setting-intersection .esriCTToleranceParentDiv .dijitDropDownButton .dijitButtonNode {background: none; border: none; width: 25px; box-shadow: none; padding: 0;}.claro .jimu-widget-smartEditor-setting-intersection .esriCTToleranceParentDiv .dijitArrowButtonInner {display: none;}.jimu-widget-smartEditor-setting-intersection .esriCTIntersectionHint {font-size: 13px; color: #a0acbf; font-style: oblique; margin-bottom: 5px;}.jimu-widget-smartEditor-setting-preset .esriCTFieldTitle {padding-top: 5px; padding-bottom: 5px; float: left; width: calc(100% - 20px);}.jimu-rtl .jimu-widget-smartEditor-setting-preset .esriCTFieldTitle {float: right;}.jimu-widget-smartEditor-setting-preset .esriCTDeletePreset {float: right; margin-top: 7px;}.jimu-widget-smartEditor-setting-preset .ee-presetValue-label-header-field, .jimu-widget-smartEditor-setting-preset .field-alias-label {width: 40%;}.jimu-widget-smartEditor-setting-preset .ee-presetValue-value-header-field, .jimu-widget-smartEditor-setting-preset .preset-value-editable {width: 100%; margin-bottom: 6px;}.jimu-widget-smartEditor-setting-preset .ee-inputField {width: 100%;}.jimu-widget-smartEditor-setting-preset .ee-inputFieldTextArea {width: 100%!important; resize: vertical; overflow: auto; font-family: inherit; line-height: 20px !important; font-size: 14px; min-height: 70px;}.jimu-widget-smartEditor-setting-preset .ee-inputFieldRichText {width: 100%!important; margin: 5px auto;}.jimu-widget-smartEditor-setting-preset .esriCTPresetContent {overflow-y: auto; padding-right: 5px; max-height: 500px;}.jimu-rtl .jimu-widget-smartEditor-setting-preset .esriCTPresetContent {padding-right: 0px; padding-left: 5px;}.jimu-widget-smartEditor-setting-preset .esriCTPresetHint {padding-bottom: 10px; font-size: 14px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTFieldSet {width: 100%;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTFieldSetLegend {margin-right: 20px;}.jimu-rtl .jimu-widget-smartEditor-setting .checkOption {padding-right: 5px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTRadioBtnContainer {margin-right: 20px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTRadioLabel {padding-right: 0px; padding-left: 40px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTButtonPositionsLabel {margin-right: 20px; padding-right: 5px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTHint {text-indent: 70px; margin-left: 0px;}.jimu-rtl .jimu-widget-smartEditor-setting .check {margin-right: 15px; margin-left: 5px;}.jimu-widget-smartEditor-setting .esriCTLabel {width: 25%; float: left; margin-top: 6px; font-size: 14px; color: #596679;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTLabel,.jimu-rtl .jimu-widget-smartEditor-setting-address .esriCTlabel,.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTlabel {float: right;}.jimu-widget-smartEditor-setting .esriCTGlobalTleranceParentDiv {width: calc(100% - 4px); overflow: hidden; clear: both; margin-top: 3px; padding-bottom: 3px;}.jimu-widget-smartEditor-setting .esriCTGlobalToleranceTextbox {width: 10%; float: left; margin-left: 15px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTGlobalToleranceTextbox {float: right; margin-right: 15px;}.jimu-widget-smartEditor-setting .esriCTMaxCharacterLimitTextBox {float: right; margin-left: 10px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTMaxCharacterLimitTextBox {float: left; margin-left: 0px; margin-right: 10px;}.jimu-widget-smartEditor-setting .esriCTGlobalToleranceDropbox {width: 25%; float: left; font-size: 14px; color: #596679; padding-right: 10px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTGlobalToleranceDropbox {float: right; padding-right: 10px;}.jimu-widget-smartEditor-setting-intersection .esriCTToleranceParentDiv {width: 100%;}.jimu-widget-smartEditor-setting .esriCTAddNewSmartActionLink {margin: 0px 10px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTAddNewSmartActionLink {float: right;}.jimu-widget-smartEditor-setting .esriCTSmartActionsTableParent {width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .row {clear: both;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTlabel {width: 40%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; min-width: 250px; font-size: 14px; color: #596679; line-height: 30px;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTlabel {padding: 0px 0px 0px 10px; float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTSmartActionsGroupContainer {max-height: 550px; padding: 0 5px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerFieldDropBox {width: 59%; float: left;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerFieldDropBox {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTFieldset {height: 235px; width: 100%; border: 1px solid #a0acbf! important; border-radius: 5px; font-size: 14px; color: #596679; min-width: 0px; padding: 10px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTHintCheck {float: left; font-size: 13px; color: #a0acbf; font-style: oblique; line-height: 20px; padding-left: 10px; padding-right: 15px; padding-top: 5px;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTHintCheck {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTExpression {width: 59%; float: left;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTExpression {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLegendTitle,.jimu-widget-smartEditor-setting-presetPopup .esriCTLegendTitle {margin-left: 5px; font-weight: bold;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTLegendTitle,.jimu-widget-smartEditor-setting-presetPopup .esriCTLegendTitle {margin-left: 0px; margin-right: 5px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTHeaderIcon {height: 30px; width: 20px; background-repeat: no-repeat; background-position: center center; display: inline-block; vertical-align: top; margin: 0 5px; cursor: pointer;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTHideCol {background-image: url(../images/hide.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTRequiredCol {background-image: url(../images/required.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTDisableIcon {background-image: url(../images/disable.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableParentContainer,.jimu-widget-smartEditor-setting-presetPopup .esriCTTableParentContainer,.jimu-widget-smartEditor-setting-address .esriCTTableParentContainer,.jimu-widget-smartEditor-setting-relativeDomains .esriCTTableParentContainer {width: 100%;}.jimu-widget-smartEditor-setting-relativeDomains .esriCTDomainFieldsHint{padding-bottom: 10px; font-size: 14px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableMainNode {width: 100%; border-collapse: collapse; height: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableRow {width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerNameRow {line-height: 28px; width: 100%; display: table;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerNameRowParent {background-color: #eee; width: 44%; height: 28px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerFieldRow:hover {background-color: #eee; color: #7989a0;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableTH {background-color: #888888; padding: 0 5px; border-left: 2px solid #fff; height: 58px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableHeaderTitle {float: left; font-weight: bold; color: white; text-align: left; width: calc(100% - 20px); line-height: 30px; text-overflow: ellipsis; white-space: nowrap; overflow: hidden;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTablePriorityTitle {float: left; text-align: left; width: calc(100% - 20px); text-overflow: ellipsis; white-space: nowrap; overflow: hidden;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTTablePriorityTitle {text-align: right;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableHeaderTitle {float: right; text-align: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableHeaderIcon {float: right; height: 30px; width: 20px; background-repeat: no-repeat; background-position: center center; vertical-align: top; cursor: pointer;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityPopupIcon {float: left; height: 30px; width: 20px; background-repeat: no-repeat; background-position: center center; vertical-align: top; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityPopupIcon {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup tr.esriCTSmartActionGroupRow.esriCTLayerFieldRow {width: 100%; float: left;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerFields {padding-left: 25px; width: 45.9%;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTCheckBoxTD {padding: 0 5px;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTCheckBoxTD {padding: 0;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTCheckBoxMainDiv {float: left;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTCheckBoxMainDiv {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityIconMainDiv, .jimu-widget-smartEditor-setting .esriCTPriorityIconMainDiv {width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityIcons, .jimu-widget-smartEditor-setting .esriCTPriorityIcons {float: left; width: 12px; height: 12px; background-size: 12px; background-repeat: no-repeat; margin: 0 10px;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityIcons, .jimu-rtl .jimu-widget-smartEditor-setting .esriCTPriorityIcons {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityEditIcon {float: right; margin-right: 5px; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityEditIcon {float: left;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTSearchFieldNode,.jimu-widget-smartEditor-setting-smartActionGroup .esriCTSearchFieldNode {margin-bottom: 10px;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTExistingExpressionDiv,.jimu-widget-smartEditor-setting-smartActionGroup .esriCTExistingExpressionDiv {background-image: url(../images/warning.png); width: 18px; height: 18px; float: left; background-size: 18px; cursor: pointer;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDomainlistDiv {color: #0000ff; width: 10px; height: 15px; float: left; cursor: pointer; font-size: 20px; font-weight: bold;}.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDomainlistDiv,.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTExistingExpressionDiv,.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTExistingExpressionDiv {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTHide, .jimu-widget-smartEditor-setting .esriCTHide {background-image: url(../images/hide.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTRequired, .jimu-widget-smartEditor-setting .esriCTRequired {background-image: url(../images/required.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTDisabled, .jimu-widget-smartEditor-setting .esriCTDisabled {background-image: url(../images/disable.png);}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTExpandAllNode,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTExpandAllNode {margin: 5px 0;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTToggleLayerIcon,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTToggleLayerIcon{height: 15px; width: 15px; float: left; background-position: center center; background-repeat: no-repeat; background-size: 15px 15px; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTToggleLayerIcon,.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTToggleLayerIcon{float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTToggleLayerCollapsed,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTToggleLayerCollapsed {background-image: url('../images/collapse.png');}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTToggleLayerExpanded,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTToggleLayerExpanded{background-image: url('../images/expand.png');}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDojoCheckBoxLabel {margin-left: 5px; vertical-align: middle;}.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDojoCheckBoxLabel {margin-left: 0px; margin-right: 5px; vertical-align: inherit;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerTitle {float: left; margin-left: 5px; font-weight: bold; width: 94%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerTitle {float: right; margin-left: 0px; margin-right: 5px;}.jimu-widget-smartEditor-setting-address .esriCTHidden, .jimu-widget-smartEditor-setting-intersection .esriCTHidden, .jimu-widget-smartEditor-setting-smartActionGroup .esriCTHidden, .jimu-widget-smartEditor-setting .esriCTHidden,.jimu-widget-smartEditor-setting-presetPopup .esriCTHidden, .jimu-widget-smartEditor-setting-coordinates .esriCTHidden {display: none;}.jimu-widget-smartEditor-setting .esriCTVisibility {visibility: hidden;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTExpressionTextBoxNode {float: left; width: calc(100% - 26px);}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTExpressionTextBoxNode {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTextBoxNode {width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .editExpressionIconNode {float: left; height: 30px; line-height: 30px; padding-left: 10px; padding-top: 3px; cursor: pointer;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .editExpressionIconNode {float: right; padding-left: 0px; padding-right: 10px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerField {float: left; width: 59%;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTLayerField {float: right;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTGroupNameTextBox {width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTRowContainer {width: 100%; overflow: hidden; margin-bottom: 10px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTlabelParentContainer {width: 100%; clear: both;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityColumnParentContainer {width: 100%; overflow: hidden;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityColumnParentDiv {clear: both; width: 100%; overflow: hidden;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityNumberDiv {width: 100%; overflow: hidden; height: 17px; color: white;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTSAHeaderCheckbox {padding-left: 4px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityOneDiv, .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityTwoDiv, .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityThreeDiv {width: 32px; float: left; padding-left: 8px;}.jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityOneDiv, .jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityTwoDiv, .jimu-rtl .jimu-widget-smartEditor-setting-smartActionGroup .esriCTPriorityThreeDiv {float: right; padding-left: 0px; padding-right: 8px;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTSubmitAttributeDataText {width: 100%; padding: 0px; float: none; line-height: normal;}.jimu-widget-smartEditor-setting .esriCTDefinedFor {margin-left: 0px;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTDefinedFor {margin-right: 0px; margin-left: 10px;}.jimu-widget-smartEditor-setting .esriCTAttributeActionsTableParent {width: 100%;}.jimu-widget-smartEditor-setting .esriCTAttributeActions {margin-top: 10px;}.jimu-widget-smartEditor-setting .esriCTAttributeActionContainer{margin-bottom: 10px; height: 30px;}.jimu-widget-smartEditor-setting .jimu-tab3 {height: 100%; overflow: hidden;}.jimu-widget-smartEditor-setting .esriCTSmartActionsTabNode {overflow-y: auto;}.jimu-widget-smartEditor-setting .esriCTAttributeActionsTabNode,.jimu-widget-smartEditor-setting .esriCTGeneralSettingTabNode {height: calc(100% - 45px); overflow: auto;}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {.jimu-widget-smartEditor-setting .jimu-viewstack {height: calc(100% - 45px);}}.jimu-widget-smartEditor-setting .esriCTTabNode {padding: 10px;}.jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopUpDiv {max-height: 445px; padding: 0 5px;}.jimu-widget-smartEditor-setting-presetPopup .esriCTWrapper,.jimu-widget-smartEditor-setting-coordinates .esriCTWrapper,.jimu-widget-smartEditor-setting-address .esriCTWrapper{width: 100%; overflow: hidden; margin-bottom: 10px;}.jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopUpLabel{width: 30%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; font-size: 14px; color: #596679; line-height: 30px;}.jimu-rtl .jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopUpLabel,.jimu-rtl .jimu-widget-smartEditor-setting-coordinates .esriCTCoordinatePopUpLabel,.jimu-rtl.jimu-widget-smartEditor-setting-address .esriCTAddressPopuplabel {float: right;}.jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopupdijitWrapper {width: 50%; float: left; padding-bottom: 5px;}.jimu-widget-smartEditor-setting-presetPopup .esriCTPresetValueTime{margin-top: 2px;}.jimu-rtl .jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopupdijitWrapper,.jimu-rtl .jimu-widget-smartEditor-setting-coordinates .esriCTCoordinatePopupdijitWrapper {float: right;}.jimu-widget-smartEditor-setting-presetPopup .esriCTSelectValueBtn {float: left; margin-left: 10px; line-height: 28px;}.jimu-rtl .jimu-widget-smartEditor-setting-presetPopup .esriCTSelectValueBtn {float: right; margin-right: 10px;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTOverrideForPreset {max-height: 205px; overflow-y: auto;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTLayerMainDiv{padding-top: 5px; background-color: #eee;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTLayercheckBox{padding-left: 25px; font-weight: bold;}.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTLayercheckBox{padding-right: 25px}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTFieldsDiv{padding-left: 5px; padding-top: 5px;}.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTFieldsDiv{padding-right: 5px}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDomainlistDiv,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTExistingExpressionDiv {margin-right: 4px;}.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTDomainlistDiv,.jimu-rtl .jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTExistingExpressionDiv {margin-left: 4px;}.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .esriCTVisibilityHidden {visibility: hidden;}.jimu-widget-smartEditor-setting-chooseFromLayer .esriCTPopUpLabel {width: 30%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; font-size: 14px; color: #596679; line-height: 30px;}.jimu-rtl .jimu-widget-smartEditor-setting-chooseFromLayer .esriCTPopUpLabel{float: right}.jimu-widget-smartEditor-setting-chooseFromLayer .esriCTDomainFieldHint {font-size: 13px; color: #a0acbf; font-style: oblique; margin-top: 5px;}.jimu-widget-smartEditor-setting-chooseFromLayer .esriCTWrapper {width: 100%; overflow: hidden; margin-bottom: 5px; padding-bottom: 5px;}.jimu-widget-smartEditor-setting-chooseFromLayer .esriCTPopupSelect {width: 70%; float:right;}.jimu-rtl .jimu-widget-smartEditor-setting-chooseFromLayer .esriCTPopupSelect{float: left;}.jimu-widget-smartEditor-setting-coordinates .esriCTCoordianteDijitMainWrapper{width: 100%;}.jimu-widget-smartEditor-setting-coordinates .esriCTCoordinatePopUpLabel {width: 40%; padding: 0px 10px 0px 0px; word-break: break-word; float: left; font-size: 14px; color: #596679; line-height: 30px;}.jimu-widget-smartEditor-setting-coordinates .esriCTCoordinatePopupdijitWrapper{width: 60%; float: left; padding-bottom: 5px;}.jimu-widget-smartEditor-setting-intersection .esriCTIntersectionGroupName {width: 50%; float: left;}.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTIntersectionGroupName {float: right;}.jimu-widget-smartEditor-setting-intersection .esriCTIntersectionDatatype {width: 50%; float: right;}.jimu-rtl .jimu-widget-smartEditor-setting-intersection .esriCTIntersectionDatatype {float: left;}.jimu-widget-smartEditor-setting-coordinates .esriCTCoordinateWidth,.jimu-widget-smartEditor-setting-address .esriCTAddressWidth {width: 70%;}.jimu-widget-smartEditor-setting-coordinates .esriCTFullWidth,.jimu-widget-smartEditor-setting-address .esriCTFullWidth,.jimu-widget-smartEditor-setting-intersection esriCTFullWidth{width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle-group,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle-group {padding: 5px;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle-group .checkbox-inline,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle-group .switch-toggle.dijitCheckBox,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle.dijitCheckBox,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #adadad; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px; margin-left: 2px;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle.dijitCheckBox:before,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle.dijitCheckBox:before {content: \"\"; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 14px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle.dijitCheckBox input,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle.dijitCheckBox.dijitCheckBoxChecked,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-smartEditor-setting-smartActionGroup .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before,.jimu-widget-smartEditor-setting-layersAndFieldsApplyOn .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 2px;}.jimu-widget-smartEditor-setting .esriCTIntersectionToleranceLabel {width: 60%;}.jimu-rtl .jimu-widget-smartEditor-setting .esriCTIntersectionToleranceLabel {margin-right: 10px;}.jimu-widget-smartEditor-setting .head-section {position: sticky; top:0;}.jimu-widget-smartEditor-setting .esriCTSmartActionsTableParent .jimu-simple-table .body-section {height: calc(100% - 36px);}.jimu-widget-smartEditor-setting .layerTable .jimu-simple-table .body-section {}.jimu-widget-smartEditor-setting .layerTable td.checkbox-td {padding-left: 0px;}.jimu-widget-smartEditor-setting .layerTable td.checkbox-td.edit {padding-left: 8px;}.jimu-widget-smartEditor-setting .esriCTSmartActionsTableParent .jimu-simple-table {max-height: 250px; overflow-y: auto;}.jimu-widget-smartEditor-setting-smartActionGroup tr.esriCTTableRow \x3e th {position: sticky; top: 0;}.jimu-widget-smartEditor-setting-smartActionGroup .esriCTTableParentContainer {height: 100%; width: 100%;}.jimu-widget-smartEditor-setting-smartActionGroup .tableBodyScroll table {clear: both; display: inline-table;}.jimu-widget-smartEditor-setting-smartActionGroup .tableBodyScroll tbody {position: absolute; overflow-y: auto; clear: both; height: 142px;}.claro .dijitSelectLabel {text-overflow: ellipsis; text-align: justify; overflow: hidden; vertical-align: middle;}.jimu-widget-smartEditor-setting-intersection .esriCTGroupInfoContainer .dijitSelectLabel,.jimu-widget-smartEditor-setting-presetPopup .esriCTPresetPopupdijitWrapper .dijitSelectLabel,.jimu-widget-smartEditor-setting .esriCTGlobalToleranceDropbox .dijitSelectLabel {width: 175px;}.jimu-widget-smartEditor-setting-address .esriCTAddressWidth .esriCTGroupInfoContainer .dijitSelectLabel,.jimu-widget-smartEditor-setting-coordinates .esriCTCoordinateWidth .esriCTWrapper .dijitSelectLabel {width: 200px;}.jimu-widget-smartEditor-setting-chooseFromLayer .esriCTPopupSelect .dijitSelectLabel {width: 255px;}.jimu-widget-smartEditor-setting-intersection .esriCTpopupFieldContent .dijitSelectLabel {width: 160px;}.jimu-widget-smartEditor-setting-coordinates .esriCTFullWidth .esriCTWrapper .dijitSelectLabel {width: 165px;}.jimu-widget-smartEditor-setting-address .esriCTFullWidth .esriCTGroupInfoContainer .dijitSelectLabel {width: 275px;}",
"*now":function(F){F(['dojo/i18n!*preload*widgets/SmartEditor/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/SimpleTable jimu/LayerInfos/LayerInfos dojo/_base/lang dojo/on dojo/string dojo/query dijit/registry dojo/_base/array ./EditFields ./EditDescription ./SmartActionGroup ../utils dijit/Editor dojo/dom-style dojo/dom-attr dojo/dom-class dojo/sniff jimu/utils dojo/_base/html jimu/dijit/_GeocodeServiceChooserContent jimu/dijit/Popup esri/request esri/lang jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/LoadingIndicator jimu/dijit/TabContainer3 dojo/dom-construct dojo/promise/all dojo/Deferred jimu/portalUtils ./Intersection ./Coordinates ./Address ./Preset ../presetBuilderBackwardCompatibility jimu/dijit/EditorXssFilter jimu/dijit/LayerChooserFromMap dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/ViewSource dijit/_editor/plugins/FontChoice dojox/editor/plugins/Preview dijit/_editor/plugins/TextColor dojox/editor/plugins/ToolbarLineBreak dojox/editor/plugins/FindReplace dojox/editor/plugins/PasteFromWord dojox/editor/plugins/InsertAnchor dojox/editor/plugins/Blockquote dojox/editor/plugins/UploadImage jimu/dijit/EditorChooseImage jimu/dijit/EditorTextColor jimu/dijit/EditorBackgroundColor dijit/form/CheckBox jimu/dijit/RadioBtn".split(" "),function(F,
J,x,K,t,a,e,b,d,h,n,p,u,G,C,f,g,w,B,c,m,A,D,N,L,R,q,k,E,O,l,y,M,S,Q,V,W,Y,I,P,X){return F([x,J],{baseClass:"jimu-widget-smartEditor-setting",_jimuLayerInfos:null,_layersTable:null,_configInfos:null,_editFields:null,_currentTableIds:[],_currentConfigInfoInTable:null,_configuredGeocoderSettings:{},_configuredPresetInfos:{},_totalLayers:[],postMixInProperties:function(){this.nls.units={};a.mixin(this.nls.units,window.jimuNls.units)},postCreate:function(){this.nls=a.mixin(this.nls,window.jimuNls.common);
this.nls=a.mixin(this.nls,window.jimuNls.timeUnit);this.editorXssFilter=P.getInstance();this._configuredGeocoderSettings={};this._configuredPresetInfos={};this._currentTableIds=[];this._totalLayers=[];this._initTabs();this._loading=new E({hidden:!0});this._loading.placeAt(this.domNode);this._loading.startup();this._createLayerChooserFromMap()},_processConfig:function(){if(!this.config.editor.hasOwnProperty("presetInfos")&&this.config.editor.layerInfos){var z=this.config.editor.layerInfos;n.forEach(z,
a.hitch(this,function(r){r.fieldValues={};n.forEach(r.fieldInfos,a.hitch(this,function(v){if(v.hasOwnProperty("canPresetValue")&&v.canPresetValue){var H=[{actionName:"Intersection",enabled:!1},{actionName:"Address",enabled:!1},{actionName:"Coordinates",enabled:!1},{actionName:"Preset",enabled:!0}];r.fieldValues[v.fieldName]=a.clone(H);this._configuredPresetInfos[v.fieldName]=[]}}))}));this.config.editor.presetInfos=this._configuredPresetInfos}I.createPresetGroups(this.config,this._jimuLayerInfos)},
startup:function(){this.inherited(arguments);t.getInstance(this.map,this.map.itemInfo).then(a.hitch(this,function(z){this._jimuLayerInfos=z;this._processConfig();this._init();this.setConfig();this._initEditor();this.webmapSettingsRadioBtn.onStateChange=a.hitch(this,function(){this.webmapSettingsRadioBtn.get("checked")&&this._onWebMapSettingsRadioBtnChecked()});this.customSettingsRadioBtn.onStateChange=a.hitch(this,function(){this.customSettingsRadioBtn.get("checked")&&this._onCustomSettingsRadioBtnChecked()});
this.own(e(this.valuePicker,"click",a.hitch(this,function(){this.valuePicker.get("checked")&&(this.enableAttributeUpdates.set("checked",!0),this.enableAutomaticAttributeUpdates.set("checked",!0))})))}))},_onWebMapSettingsRadioBtnChecked:function(){this._getConfigForCurrentDisplayedLayers();this._updateLayersTable()},_onCustomSettingsRadioBtnChecked:function(){this._updateLayersTable()},_updateLayersTable:function(){this._layersTable.clear();if(this._currentTableIds.length&&0<this._currentTableIds.length){var z;
n.some(this._configInfos,a.hitch(this,function(r){if(this._currentTableIds[this._currentTableIds.length-1]===r.featureLayer.id)return z=r,!0}));n.forEach(z.relationshipInfos,a.hitch(this,function(r){r.layerInfo=this._jimuLayerInfos.getLayerOrTableInfoById(r.featureLayer.id)}));this._setLayersTable(z.relationshipInfos,!0)}else this._setLayersTable(this._configInfos,!1)},destroy:function(){this._jimuLayerInfos=null;delete this._jimuLayerInfos;this._layersTable=null;delete this._layersTable;this._configInfos=
null;delete this._configInfos;this._editFields=null;delete this._editFields;this._editDescriptions=null;delete this._editDescriptions;this.inherited(arguments)},_init:function(){this._initSettings();this._initLayersTable();this.own(e(this.addNewSmartAction,"click",a.hitch(this,function(){this._configureGroupSmartAction()})));this._initsmartActionsTable();this._initAllAttributeActions()},_initTabs:function(){this.tab=new O({tabs:[{title:this.nls.layersPage.layerSettings,content:this.layerSettingTabNode},
{title:this.nls.layersPage.smartActionsTabTitle,content:this.smartActionsTabNode},{title:this.nls.layersPage.attributeActionsTabTitle,content:this.attributeActionsTabNode},{title:this.nls.layersPage.generalSettings,content:this.generalSettingTabNode}]});this.own(e(this.tab,"tabChanged",a.hitch(this,function(){this.tab.containerNode.scrollTop=0;2===this.tab.getSelectedIndex()?this._resetHeight(this.attributeActionsTabNode):3===this.tab.getSelectedIndex()&&this._resetHeight(this.generalSettingTabNode)})));
this.tab.placeAt(this.tabDiv);this.own(e(this.geocoderSettings,"click",a.hitch(this,function(){this._openServiceChooser(!0)})))},_initLayersTable:function(){var z={fields:[{name:"edit",title:this.nls.layersPage.layerSettingsTable.edit,type:"checkbox","class":"editable"},{name:"label",title:this.nls.layersPage.layerSettingsTable.label,type:"text","class":"layer"},{name:"allowUpdateOnly",title:this.nls.layersPage.layerSettingsTable.allowUpdateOnly,type:"checkbox","class":"update"},{name:"allowDelete",
title:this.nls.layersPage.layerSettingsTable.allowDelete,type:"checkbox","class":"update"},{name:"disableGeometryUpdate",title:this.nls.layersPage.layerSettingsTable.update,type:"checkbox","class":"disable"},{name:"specialType",type:"extension",title:this.nls.layersPage.layerSettingsTable.description,create:a.hitch(this,this._createSpecialType),setValue:a.hitch(this,this._setValue4SpecialType),getValue:a.hitch(this,this._getValueOfSpecialType),"class":"description"},{name:"actions",title:this.nls.actions,
type:"actions","class":"actions layersTableAction",actions:["edit"]},{name:"allowUpdateOnlyHidden",type:"checkbox",hidden:!0},{name:"allowDeleteHidden",type:"checkbox",hidden:!0},{name:"disableGeometryUpdateHidden",type:"checkbox",hidden:!0}],selectable:!1,autoHeight:!1,style:{maxHeight:"calc(100% - 100px)"}};g.set(this.layerSettingTabNode.parentElement,"height","calc(100% - 45px)");this._layersTable=new K(z);this._layersTable.placeAt(this.tableLayerInfos);this._layersTable.startup();this._addBreadCrumb(this.nls.layersPage.allLayers,
!0);d("th.simple-table-field",this._layersTable.domNode).forEach(function(r){switch(void 0===r.innerText||""===r.innerText?"":r.innerText.replace(/(\r\n|\n|\r)/gm,"")){case this.nls.layersPage.layerSettingsTable.edit:r.title=this.nls.layersPage.layerSettingsTable.editTip;r.alt=this.nls.layersPage.layerSettingsTable.editTip;break;case this.nls.layersPage.layerSettingsTable.label:r.title=this.nls.layersPage.layerSettingsTable.labelTip;r.alt=this.nls.layersPage.layerSettingsTable.labelTip;break;case this.nls.layersPage.layerSettingsTable.allowUpdateOnly:r.title=
this.nls.layersPage.layerSettingsTable.allowUpdateOnlyTip;r.alt=this.nls.layersPage.layerSettingsTable.allowUpdateOnlyTip;break;case this.nls.layersPage.layerSettingsTable.allowDelete:r.title=this.nls.layersPage.layerSettingsTable.allowDeleteTip;r.alt=this.nls.layersPage.layerSettingsTable.allowDeleteTip;break;case this.nls.layersPage.layerSettingsTable.update:r.title=this.nls.layersPage.layerSettingsTable.updateTip;r.alt=this.nls.layersPage.layerSettingsTable.updateTip;break;case this.nls.layersPage.layerSettingsTable.description:r.title=
this.nls.layersPage.layerSettingsTable.descriptionTip;r.alt=this.nls.layersPage.layerSettingsTable.descriptionTip;break;case this.nls.actions:r.title=this.nls.layersPage.layerSettingsTable.actionsTip,r.alt=this.nls.layersPage.layerSettingsTable.actionsTip}},this);this.own(e(this._layersTable,"actions-edit",a.hitch(this,this._onEditFieldInfoClick)))},_createSpecialType:function(z){var r=A.create("a",{"class":"attDescrip"},z);this.own(e(r,"click",a.hitch(this,function(){this._onDescriptionClick(z.parentNode)})))},
_setValue4SpecialType:function(){},_getValueOfSpecialType:function(){},_initSettings:function(){this.config.editor.hasOwnProperty("honorWebMapConfiguration")&&this.config.editor.honorWebMapConfiguration?this.webmapSettingsRadioBtn.set("checked",!0):this.customSettingsRadioBtn.set("checked",!0);this.config.editor.hasOwnProperty("expandRelatedTableOnLoad")?this.expandRelatedTableNode.set("checked",this.config.editor.expandRelatedTableOnLoad):this.expandRelatedTableNode.set("checked",!1);this.config.editor.hasOwnProperty("expandMainLayerOnLoad")?
this.expandMainLayerNode.set("checked",this.config.editor.expandMainLayerOnLoad):this.expandMainLayerNode.set("checked",!0);this.useFilterEditor.set("checked",this.config.editor.useFilterEditor);this.config.editor.hasOwnProperty("displayShapeSelector")?this.displayShapeSelector.set("checked",this.config.editor.displayShapeSelector):this.displayShapeSelector.set("checked",!1);this.config.editor.hasOwnProperty("groupFilteredTemplates")?this.groupFilteredTemplates.set("checked",this.config.editor.groupFilteredTemplates):
this.groupFilteredTemplates.set("checked",!1);this.own(e(this.useFilterEditor,"click",a.hitch(this,function(){this.useFilterEditor.get("checked")||this.groupFilteredTemplates.set("checked",!1)})));this.own(e(this.groupFilteredTemplates,"click",a.hitch(this,function(){this.groupFilteredTemplates.get("checked")&&this.useFilterEditor.set("checked",!0)})));this.config.editor.hasOwnProperty("createNewFeaturesFromExisting")?this.createNewFeaturesFromExisting.set("checked",this.config.editor.createNewFeaturesFromExisting):
this.createNewFeaturesFromExisting.set("checked",!1);this.config.editor.hasOwnProperty("overrideDefaultsByCopiedFeature")?this.overrideDefaultsByCopiedFeature.set("checked",this.config.editor.overrideDefaultsByCopiedFeature):this.overrideDefaultsByCopiedFeature.set("checked",!1);this.own(e(this.createNewFeaturesFromExisting,"click",a.hitch(this,function(){this.createNewFeaturesFromExisting.get("checked")||this.overrideDefaultsByCopiedFeature.set("checked",!1)})));this.own(e(this.overrideDefaultsByCopiedFeature,
"click",a.hitch(this,function(){this.overrideDefaultsByCopiedFeature.get("checked")&&this.createNewFeaturesFromExisting.set("checked",!0)})));this.config.editor.hasOwnProperty("displayPresetTop")?this.displayPresetTop.set("checked",this.config.editor.displayPresetTop):this.displayPresetTop.set("checked",!1);this.displayPromptOnSave.set("checked",this.config.editor.displayPromptOnSave);this.displayPromptOnDelete.set("checked",this.config.editor.displayPromptOnDelete);this.removeOnSave.set("checked",
this.config.editor.removeOnSave);this.config.editor.hasOwnProperty("listenToGF")?this.listenToGF.set("checked",this.config.editor.listenToGF):this.listenToGF.set("checked",!1);this.config.editor.hasOwnProperty("editAddDataLayers")?this.editAddDataLayers.set("checked",this.config.editor.editAddDataLayers):this.editAddDataLayers.set("checked",!1);this.config.editor.hasOwnProperty("keepTemplateSelected")?this.keepTemplateSelected.set("checked",this.config.editor.keepTemplateSelected):this.keepTemplateSelected.set("checked",
!1);this.config.editor.hasOwnProperty("editGeometryDefault")?this.editGeometryDefault.set("checked",this.config.editor.editGeometryDefault):this.editGeometryDefault.set("checked",!1);this.config.editor.hasOwnProperty("showValuePicker")?this.valuePicker.set("checked",this.config.editor.showValuePicker):this.valuePicker.set("checked",!1);this.config.editor.hasOwnProperty("autoSaveEdits")?this.autoSaveEdits.set("checked",this.config.editor.autoSaveEdits):this.autoSaveEdits.set("checked",!1);this.config.editor.hasOwnProperty("enableAttributeUpdates")?
this.enableAttributeUpdates.set("checked",this.config.editor.enableAttributeUpdates):this.enableAttributeUpdates.set("checked",!1);this.own(e(this.autoSaveEdits,"click",a.hitch(this,function(){this.autoSaveEdits.get("checked")&&!this.autoSaveAttrUpdates.get("checked")&&this.removeOnSave.set("checked",!0)})));this.config.editor.hasOwnProperty("enableAutomaticAttributeUpdates")?this.enableAutomaticAttributeUpdates.set("checked",this.config.editor.enableAutomaticAttributeUpdates):this.enableAutomaticAttributeUpdates.set("checked",
!1);this.own(e(this.enableAttributeUpdates,"click",a.hitch(this,function(){this.enableAttributeUpdates.get("checked")||this.enableAutomaticAttributeUpdates.set("checked",!1)})));this.own(e(this.enableAutomaticAttributeUpdates,"click",a.hitch(this,function(){this.enableAutomaticAttributeUpdates.get("checked")&&this.enableAttributeUpdates.set("checked",!0)})));this.config.editor.hasOwnProperty("enableLockingMapNavigation")?this.enableLockingMapNavigation.set("checked",this.config.editor.enableLockingMapNavigation):
this.enableLockingMapNavigation.set("checked",!1);this.config.editor.hasOwnProperty("enableMovingSelectedFeatureToGPS")?this.enableMovingSelectedFeatureToGPS.set("checked",this.config.editor.enableMovingSelectedFeatureToGPS):this.enableMovingSelectedFeatureToGPS.set("checked",!1);this.config.editor.hasOwnProperty("enableMovingSelectedFeatureToXY")?this.enableMovingSelectedFeatureToXY.set("checked",this.config.editor.enableMovingSelectedFeatureToXY):this.enableMovingSelectedFeatureToXY.set("checked",
!1);this.config.editor.hasOwnProperty("showActionButtonsAbove")?this.positionOfSaveButtonBelow.set("checked",!this.config.editor.showActionButtonsAbove):this.positionOfSaveButtonBelow.set("checked",!0);this.config.editor.hasOwnProperty("showActionButtonsAbove")?this.positionOfSaveButtonAbove.set("checked",this.config.editor.showActionButtonsAbove):this.positionOfSaveButtonAbove.set("checked",!1);this.config.editor.hasOwnProperty("canSwitchToMultilineInput")?this.switchToMultilineInput.set("checked",
this.config.editor.canSwitchToMultilineInput):this.switchToMultilineInput.set("checked",!1);this.config.editor.hasOwnProperty("featuresSelectionTolerance")?this.featuresSelectionTolerance.set("value",this.config.editor.featuresSelectionTolerance):this.featuresSelectionTolerance.set("value","20");this.config.editor.hasOwnProperty("autoSaveAttrUpdates")?this.autoSaveAttrUpdates.set("checked",this.config.editor.autoSaveAttrUpdates):this.autoSaveAttrUpdates.set("checked",!1);this.own(e(this.autoSaveAttrUpdates,
"change",a.hitch(this,function(){this.autoSaveAttrUpdates.get("checked")?(this.removeOnSave.set("checked",!1),this.removeOnSave.set("disabled",!0)):this.removeOnSave.set("disabled",!1)})))},setConfig:function(){var z=(new E({hidden:!1})).placeAt(this.tableInfosLoading);this._fetchDefaultGeocoder().then(a.hitch(this,function(r){this._getTableInfos().then(a.hitch(this,function(){this._configInfos=C.getConfigInfos(this._jimuLayerInfos,this.config.editor.layerInfos,!1,!1);var v={};this.config.editor.layerInfos&&
0<this.config.editor.layerInfos.length&&(n.forEach(this.config.editor.layerInfos,function(H){H.hasOwnProperty("_editFlag")||(H._editFlag=!0);v[H.featureLayer.id]=H._editFlag}),n.forEach(this._configInfos,function(H){v.hasOwnProperty(H.featureLayer.id)?H._editFlag=v[H.featureLayer.id]:H._editFlag=!1}));n.forEach(this._configInfos,function(H){H.fieldValidations||(H.fieldValidations={})});this._configuredGeocoderSettings=this.config.geocoderSettings?a.clone(this.config.geocoderSettings):r;this._configuredPresetInfos=
this.config.editor.presetInfos?a.clone(this.config.editor.presetInfos):{};this._currentConfigInfoInTable=this._configInfos;this._setLayersTable(this._configInfos,!1);this.config.editor.defaultToleranceSettings?(this.globalTolerance.set("value",this.config.editor.defaultToleranceSettings.value),this.globalToleranceUnit.set("value",this.config.editor.defaultToleranceSettings.unit)):(this.globalTolerance.set("value",0),this.globalToleranceUnit.set("value","meters"));this.config.editor.hasOwnProperty("defaultPixelsTolerance")&&
this.globalPixelsTolerance.set("value",this.config.editor.defaultPixelsTolerance);this.config.editor.maxLimitToMultilineTextBox||0===this.config.editor.maxLimitToMultilineTextBox?this.maxCharacter.set("value",this.config.editor.maxLimitToMultilineTextBox):this.maxCharacter.set("value",35);setTimeout(a.hitch(this,function(){this.resize();z.destroy()}),200)}))}))},_fetchOrgsHelperServiecs:function(){var z=new M;this.appConfig.portalUrl&&""!==a.trim(this.appConfig.portalUrl)?S.getPortalSelfInfo(this.appConfig.portalUrl).then(a.hitch(this,
function(r){r=r&&r.helperServices;var v="";r&&r.geocode&&0<r.geocode.length&&r.geocode[0].url&&(v=r.geocode[0].url);z.resolve(v)}),a.hitch(this,function(){z.resolve("")})):z.resolve("");return z.promise},_fetchDefaultGeocoder:function(){var z=new M;this._fetchOrgsHelperServiecs().then(a.hitch(this,function(r){var v={};L({url:r,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(a.hitch(this,function(H){H&&H.candidateFields&&(v.url=r,v.fields=a.clone(H.candidateFields));z.resolve(v)}),
a.hitch(this,function(){z.resolve(v)}))}));return z.promise},_getTableInfos:function(){var z=[],r=this._jimuLayerInfos.getTableInfoArray();n.forEach(r,function(v){z.push(v.getLayerObject())},this);return y(z)},_setLayersTable:function(z,r){var v=null,H=!1,T;if(r&&this._currentTableIds&&0<this._currentTableIds.length){var U=this._configInfos;n.forEach(this._currentTableIds,function(ba,ja){n.some(U,function(ha){if(ha.featureLayer.id===ba)return U=ha,!0});1<this._currentTableIds.length&&ja+1<this._currentTableIds.length&&
(U=U.relationshipInfos)},this);U.relationshipInfos=z}this._currentConfigInfoInTable=z;n.forEach(z,function(ba){if(this.webmapSettingsRadioBtn.checked)var ja=C.createDefaultConfigInfo(ba.layerInfo);var ha=this._layersTable.addRow({label:ba.layerInfo.title,edit:this.webmapSettingsRadioBtn.checked?ja._editFlag:ba._editFlag?!0:!1,allowUpdateOnly:this.webmapSettingsRadioBtn.checked?ja.allowUpdateOnly:ba.allowUpdateOnly,allowUpdateOnlyHidden:null===ba.allowUpdateOnly?!1:ba.allowUpdateOnly,allowDelete:this.webmapSettingsRadioBtn.checked?
ja.featureLayer.layerAllowsDelete:ba.allowDelete,allowDeleteHidden:null===ba.allowDelete?!1:ba.allowDelete,disableGeometryUpdate:r?!0:this.webmapSettingsRadioBtn.checked?ja.disableGeometryUpdate:ba.disableGeometryUpdate,disableGeometryUpdateHidden:null===ba.disableGeometryUpdate?!1:ba.disableGeometryUpdate});T=g.get(ha.tr,"height");ba.layerInfo.isTable&&(H=!0);ha.tr._configInfo=ba;this.webmapSettingsRadioBtn.checked&&(v=d(".editable",ha.tr),v.forEach(function(da){h.getEnclosingWidget(da.childNodes[0]).setStatus(!1)}));
ha.tr._layerId=ba.layerInfo.layerObject.id;v=d(".allowDelete",ha.tr);!1===ba.featureLayer.layerAllowsDelete&&v.forEach(function(da){h.getEnclosingWidget(da.childNodes[0]).setStatus(!1)});this.webmapSettingsRadioBtn.checked&&v.forEach(function(da){da=h.getEnclosingWidget(da.childNodes[0]);da.setStatus(!1);ja.allowDelete&&da.setValue(!0)});v=d(".allowUpdateOnly",ha.tr);(!1===ba.featureLayer.layerAllowsCreate||this.webmapSettingsRadioBtn.checked)&&v.forEach(function(da){da=h.getEnclosingWidget(da.childNodes[0]);
da.setValue(!1);da.setStatus(!1)});v=d(".allowUpdateOnly",ha.tr);v.forEach(function(da){da=h.getEnclosingWidget(da.childNodes[0]);!1===ba.featureLayer.layerAllowsUpdate&&(da.setValue(!1),da.setStatus(!1));r&&!ba.layerInfo.isTable&&(da.setValue(!0),da.setStatus(!1))});v=d(".disableGeometryUpdate",ha.tr);v.forEach(function(da){da=h.getEnclosingWidget(da.childNodes[0]);if(!1===ba.featureLayer.layerAllowGeometryUpdates||this.webmapSettingsRadioBtn.checked)da.setValue(!1),da.setStatus(!1);r&&(da.setValue(!0),
da.setStatus(!1))});!1===ba.featureLayer.layerAllowsUpdate&&!1===ba.featureLayer.layerAllowsCreate&&(v=d(".edit, .disableGeometryUpdate",ha.tr),v.forEach(function(da){da=h.getEnclosingWidget(da.childNodes[0]);da.setValue(!1);da.setStatus(!1)}));var ia=this._layersTable._getThCheckBox("disableGeometryUpdate");ia&&(r?(ia.setValue(!1),ia.setStatus(!1)):ia.setStatus(!0));if(r&&!ba.layerInfo.isTable){ia=d(".edit, .editable",ha.tr)[0];var ka=l.create("div",{"class":"warningIcon",style:"display:none",title:this.nls.layersPage.layerSettingsTable.allowUpdateOnly});
l.place(ka,ia,"first");ia=h.getEnclosingWidget(ia.childNodes[1]);this.own(e(ia,"change",a.hitch(this,function(da){da?g.set(ka,"display","block"):g.set(ka,"display","none")})));!0===ba._editFlag&&g.set(ka,"display","block")}ia=[];ba.relationshipInfos&&0!==ba.relationshipInfos.length?this._isValidRelationship(ba.relationshipInfos)&&(ia=ba.relationshipInfos):(ia=this._getRelatedTableInfo(ba.layerInfo.layerObject),ba.relationshipInfos=ia,n.forEach(ba.relationshipInfos,function(da){da._editFlag=!1}));
0<ia.length&&(ia[0].layerInfo||(ia=C.getConfigInfos(this._jimuLayerInfos,ia,!1,!0,!0),n.forEach(ba.relationshipInfos,function(da){da.hasOwnProperty("_editFlag")||(da._editFlag=!1)})),this._addTableFieldActionIcon(ha.tr,ia));d(".jimu-icon-edit",ha.tr)[0].title=this.nls.layersPage.layerSettingsTable.fieldsTip;if(ha=this._layersTable._getThCheckBox("allowUpdateOnly"))r&&!H?(ha.setValue(!1),ha.setStatus(!1)):ha.setStatus(!0)},this);var Z=this._layersTable._getThCheckBox("edit"),aa=this._layersTable._getThCheckBox("allowUpdateOnly"),
fa=this._layersTable._getThCheckBox("allowDelete"),ca=this._layersTable._getThCheckBox("disableGeometryUpdate"),ea=this.webmapSettingsRadioBtn.checked?!1:!0;Z.setStatus(ea);aa.setStatus(ea);fa.setStatus(ea);ca.setStatus(ea);g.set(this._layersTable.domNode,"height",T*z.length+37+"px")},_isValidRelationship:function(z){var r=!1;n.some(this._jimuLayerInfos.getLayerInfoArray(),a.hitch(this,function(v){n.forEach(z,a.hitch(this,function(H){if(v.id===H.featureLayer.id)return r=!0}))}));r||n.some(this._jimuLayerInfos.getTableInfoArray(),
a.hitch(this,function(v){n.forEach(z,a.hitch(this,function(H){if(v.id===H.featureLayer.id)return r=!0}))}));return r},_onDescriptionClick:function(z){var r=this._layersTable.getRowData(z);if(this.webmapSettingsRadioBtn.checked)var v=C.createDefaultConfigInfo(z._configInfo.layerInfo);r&&(this.webmapSettingsRadioBtn.checked?v._editFlag:r.edit)&&(this._editDescriptions=new u({nls:this.nls,_configInfo:z._configInfo,_layerName:r.label}),this._editDescriptions.popupEditDescription())},_onEditFieldInfoClick:function(z){var r=
this._layersTable.getRowData(z);this.webmapSettingsRadioBtn.checked&&C.createDefaultConfigInfo(z._configInfo.layerInfo);this._editFields=new p({nls:this.nls,_configInfo:z._configInfo,_layerName:r.label,isEditableLayer:null!==r.edit?r.edit:z._configInfo.layerInfo.layerObject.isEditable(),_geocoderSettings:this._configuredGeocoderSettings,_configuredPresetInfos:this._configuredPresetInfos,layerInfos:this._jimuLayerInfos,isRelatedLayer:1<=this._currentTableIds.length?!0:!1,honorWebMapSettings:this.webmapSettingsRadioBtn.checked,
editUtils:C,map:this.map,_smartActionsTable:this._smartActionsTable,_attributeActionsTable:{Intersection:this._intersectionActionGroupTable,Address:this._addressActionGroupTable,Coordinates:this._coordinatesActionGroupTable,Preset:this._presetActionGroupTable},_tab:this.tab});this._editFields.popupEditPage();this.own(e(this._editFields,"SetGeocoder",a.hitch(this,this._openServiceChooser)));this.own(e(this._editFields,"RemoveFromGroup",a.hitch(this,function(v){v&&(n.forEach(v.smartActionGroupInfo,
function(H){this._removeFromGroup(H)},this),n.forEach(v.attributeActionGroupInfo,function(H){this._removeFromAttributeActionGroup(H)},this))})))},_getText:function(){return this._editorObj.get("value")},_initEditor:function(){if(!this._editorObj)if(this._initEditorPluginsCSS(),this._editorObj=new f({plugins:["bold","italic","underline",m.getEditorTextColor("smartEditor"),m.getEditorBackgroundColor("smartEditor"),"|","justifyLeft","justifyCenter","justifyRight","justifyFull","|","insertOrderedList",
"insertUnorderedList","indent","outdent"],extraPlugins:["|","createLink","unlink","pastefromword","|","undo","redo","|","viewSource","toolbarlinebreak",{name:"dijit._editor.plugins.FontChoice",command:"fontName",custom:"Arial;Comic Sans MS;Courier New;Garamond;Tahoma;Times New Roman;Verdana".split(";")},"fontSize","formatBlock"],style:"font-family:Verdana;"},this.editorDescription),g.set(this._editorObj.domNode,{width:"100%",height:"100%"}),this._editorObj.set("value",this.editorXssFilter.sanitize(void 0===
this.config.editor.editDescription||null===this.config.editor.editDescription?this.nls.layersPage.title:this.config.editor.editDescription)),this._editorObj.startup(),8!==c("ie"))this._editorObj.resize({w:"100%",h:"100%"});else{var z=A.getMarginBox(this.editorDescription);this._editorObj.resize({w:z.w,h:z.h})}},_initEditorPluginsCSS:function(){var z=document.getElementsByTagName("head")[0];var r=window.apiUrl+"dojox/editor/plugins/resources/css/TextColor.css";d('link[href\x3d"'+r+'"]',z)[0]||m.loadStyleLink("editor_plugins_resources_TextColor",
r);r=window.apiUrl+"dojox/editor/plugins/resources/editorPlugins.css";d('link[href\x3d"'+r+'"]',z)[0]||m.loadStyleLink("editor_plugins_resources_editorPlugins",r);r=window.apiUrl+"dojox/editor/plugins/resources/css/PasteFromWord.css";d('link[href\x3d"'+r+'"]',z)[0]||m.loadStyleLink("editor_plugins_resources_PasteFromWord",r)},_resetSettingsConfig:function(){this.config.editor.displayPromptOnSave=void 0===this.displayPromptOnSave.checked?!1:this.displayPromptOnSave.checked;this.config.editor.displayPromptOnDelete=
void 0===this.displayPromptOnDelete.checked?!1:this.displayPromptOnDelete.checked;this.config.editor.removeOnSave=void 0===this.removeOnSave.checked?!1:this.removeOnSave.checked;this.config.editor.canSwitchToMultilineInput=void 0===this.switchToMultilineInput.checked?!1:this.switchToMultilineInput.checked;this.config.editor.useFilterEditor=void 0===this.useFilterEditor.checked?!1:this.useFilterEditor.checked;this.config.editor.groupFilteredTemplates=void 0===this.groupFilteredTemplates.checked?!1:
this.groupFilteredTemplates.checked;this.config.editor.displayShapeSelector=void 0===this.displayShapeSelector.checked?!1:this.displayShapeSelector.checked;this.config.editor.createNewFeaturesFromExisting=void 0===this.createNewFeaturesFromExisting.checked?!1:this.createNewFeaturesFromExisting.checked;this.config.editor.overrideDefaultsByCopiedFeature=void 0===this.overrideDefaultsByCopiedFeature.checked?!1:this.overrideDefaultsByCopiedFeature.checked;this.config.editor.displayPresetTop=void 0===
this.displayPresetTop.checked?!1:this.displayPresetTop.checked;this.config.editor.listenToGF=void 0===this.listenToGF.checked?!1:this.listenToGF.checked;this.config.editor.editAddDataLayers=void 0===this.editAddDataLayers.checked?!1:this.editAddDataLayers.checked;this.config.editor.keepTemplateSelected=void 0===this.keepTemplateSelected.checked?!1:this.keepTemplateSelected.checked;this.config.editor.editGeometryDefault=void 0===this.editGeometryDefault.checked?!1:this.editGeometryDefault.checked;
this.config.editor.showValuePicker=void 0===this.valuePicker.checked?!1:this.valuePicker.checked;this.config.editor.autoSaveEdits=void 0===this.autoSaveEdits.checked?!1:this.autoSaveEdits.checked;this.config.editor.enableAttributeUpdates=void 0===this.enableAttributeUpdates.checked?!1:this.enableAttributeUpdates.checked;this.config.editor.enableAutomaticAttributeUpdates=void 0===this.enableAutomaticAttributeUpdates.checked?!1:this.enableAutomaticAttributeUpdates.checked;this.config.editor.enableLockingMapNavigation=
void 0===this.enableLockingMapNavigation.checked?!1:this.enableLockingMapNavigation.checked;this.config.editor.enableMovingSelectedFeatureToGPS=void 0===this.enableMovingSelectedFeatureToGPS.checked?!1:this.enableMovingSelectedFeatureToGPS.checked;this.config.editor.enableMovingSelectedFeatureToXY=void 0===this.enableMovingSelectedFeatureToXY.checked?!1:this.enableMovingSelectedFeatureToXY.checked;this.config.editor.showActionButtonsAbove=this.positionOfSaveButtonAbove.checked?!0:!1;this.config.editor.featuresSelectionTolerance=
this.featuresSelectionTolerance.get("value");this.config.editor.autoSaveAttrUpdates=void 0===this.autoSaveAttrUpdates.checked?!1:this.autoSaveAttrUpdates.checked},_getConfigForCurrentDisplayedLayers:function(){if(this._currentConfigInfoInTable){var z=this._layersTable.getData();n.forEach(this._currentConfigInfoInTable,function(r,v){r._editFlag=z[v].edit;r.allowUpdateOnly=null===z[v].allowUpdateOnly?z[v].allowUpdateOnlyHidden:z[v].allowUpdateOnly;r.allowDelete=null===z[v].allowDelete?z[v].allowDeleteHidden:
z[v].allowDelete;r.disableGeometryUpdate=null===z[v].disableGeometryUpdate?z[v].disableGeometryUpdateHidden:z[v].disableGeometryUpdate},this)}},_getCurrentConfigInfo:function(z){var r=[];n.forEach(z,function(v){v.hasOwnProperty("featureLayer")&&(v.featureLayer.hasOwnProperty("layerAllowsCreate")&&delete v.featureLayer.layerAllowsCreate,v.featureLayer.hasOwnProperty("layerAllowsUpdate")&&delete v.featureLayer.layerAllowsUpdate,v.featureLayer.hasOwnProperty("layerAllowsDelete")&&delete v.featureLayer.layerAllowsDelete,
v.featureLayer.hasOwnProperty("layerAllowGeometryUpdates")&&delete v.featureLayer.layerAllowGeometryUpdates);v.fieldInfos=this._resetFieldInfos(v.fieldInfos);if(v.hasOwnProperty("fieldValidations"))for(var H in v.fieldValidations)v.fieldValidations.hasOwnProperty(H)&&n.forEach(v.fieldValidations[H],function(T){T.hasOwnProperty("expression")&&delete T.expression});v.layerInfo&&delete v.layerInfo;r.push(v);v.relationshipInfos&&0<v.relationshipInfos.length&&(v.relationshipInfos=this._getCurrentConfigInfo(v.relationshipInfos))},
this);return r},getConfig:function(){if(!this.globalTolerance.isValid())return new q({message:this.nls.layersPage.toleranceErrorMsg}),!1;if(!this.globalPixelsTolerance.isValid())return new q({message:this.nls.layersPage.pixelsToleranecErrorMsg}),!1;if(!this.maxCharacter.isValid()||isNaN(this.maxCharacter.get("value")))return new q({message:this.nls.layersPage.invalidMaxCharacterErrorMsg}),!1;if(!this.featuresSelectionTolerance.isValid())return new q({message:this.nls.layersPage.featuresSelectionToleranceErrorMsg}),
!1;var z=new M;this._loading.show();setTimeout(a.hitch(this,function(){this._resetSettingsConfig();this.config.editor.editDescription=this._getText();this.config.editor.defaultToleranceSettings={value:this.globalTolerance.getValue(),unit:this.globalToleranceUnit.getValue()};this.config.editor.defaultPixelsTolerance=this.globalPixelsTolerance.get("value");this.config.editor.maxLimitToMultilineTextBox=this.maxCharacter.getValue();this.customSettingsRadioBtn.checked&&this._getConfigForCurrentDisplayedLayers();
if(this.customSettingsRadioBtn.checked){var r=this._validateFieldInfos(this._configInfos);if(r.layerID&&!r.isValidFields)return r=this._jimuLayerInfos.getLayerOrTableInfoById(r.layerID).layerObject,this._loading.hide(),q({message:b.substitute(this.nls.fieldsPage.noDisplayFieldWarningMsg,{layerName:r.name})}),!1}r=this._getCurrentConfigInfo(this._configInfos);if(0===r.length)return this._loading.hide(),new q({message:this.nls.layersPage.noConfigedLayersError}),!1;this.config.editor.layerInfos=r;this._configuredGeocoderSettings&&
this._configuredGeocoderSettings.hasOwnProperty("url")?this.config.geocoderSettings=a.clone(this._configuredGeocoderSettings):this.config.geocoderSettings=null;this.config.editor.presetInfos={};this.config.smartActionGroups=this._getSmartActionGroupConfig();if(this.config.attributeActionGroups&&(this._getPresetGroupOrder(),r=this._validatePresetGroup(),!r.isValid))return this._loading.hide(),q({message:b.substitute(this.nls.attributeActionsPage.presetNoFieldWarningMsg,{groupName:r.groupName})}),this.tab.selectTab(this.nls.layersPage.attributeActionsTabTitle),
!1;this.config.editor.honorWebMapConfiguration=this.webmapSettingsRadioBtn.checked?!0:!1;this.config.editor.expandRelatedTableOnLoad=this.expandRelatedTableNode.checked?!0:!1;this.config.editor.expandMainLayerOnLoad=this.expandMainLayerNode.checked?!0:!1;this._loading.hide();z.resolve(this.config)}),200);return z.promise},_validatePresetGroup:function(){var z=!0,r="";if(this.config.attributeActionGroups&&this.config.attributeActionGroups.Preset)for(var v=0;v<this.config.attributeActionGroups.presetOrder.length;v++)n.some(this.config.attributeActionGroups.presetOrder,
a.hitch(this,function(H){if(!this._hasFieldsInPresetGroup(this.config.attributeActionGroups.Preset[H]))return z=!1,r=H,!0}));return{isValid:z,groupName:r}},_hasFieldsInPresetGroup:function(z){var r=!1,v;for(v in z.appliedOn)if(0<z.appliedOn[v].length){r=!0;break}return r},_getPresetGroupOrder:function(){this.config.attributeActionGroups.presetOrder=[];for(var z=this._presetActionGroupTable.getRows(),r=0;r<z.length;r++)this.config.attributeActionGroups.presetOrder.push(z[r]._configInfo.name)},_resetFieldInfos:function(z){return n.map(z,
function(r){var v={};v.fieldName=void 0===r.fieldName?"":r.fieldName;v.isEditable=void 0===r.isEditable?!0:r.isEditable;v.visible=void 0===r.visible?!0:r.visible;return v})},_validateFieldInfos:function(z){var r=!1,v;n.some(z,function(H){r=!1;v=H.featureLayer.id;0===H.fieldInfos.length&&(r=!0);n.some(H.fieldInfos,function(T,U){if(T.visible)return r=!0},this);if(!r)return!0});return{isValidFields:r,layerID:v}},_getRelatedTableInfo:function(z){var r=[];if(z){var v=z.url.substr(0,z.url.lastIndexOf("/")+
1);z=a.clone(z.relationships);z=n.filter(z,function(H){return"esriRelRoleDestination"!==H.role});n.forEach(z,a.hitch(this,function(H){var T=!1;n.forEach(this.map.webMapResponse.itemInfo.itemData.tables,a.hitch(this,function(U){var Z;U&&U.url&&U.url.replace(/.*?:\/\//g,"")===(v+H.relatedTableId).replace(/.*?:\/\//g,"")&&(U=this._jimuLayerInfos.getLayerOrTableInfoById(U.id))&&(U=C.getConfigInfo(U,{}),U.relationshipId=H.id,(Z=this._getSmartActionsForRelation(U.featureLayer.id))||(Z={}),U.fieldValidations=
Z,(Z=this._getAttributeActionsForRelation(U.featureLayer.id))||(Z={}),U.fieldValues=Z,r.push(U),T=!0)}));T||n.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,a.hitch(this,function(U){var Z;U&&U.url&&U.url.replace(/.*?:\/\//g,"")===(v+H.relatedTableId).replace(/.*?:\/\//g,"")&&(U=this._jimuLayerInfos.getLayerOrTableInfoById(U.id))&&(U=C.getConfigInfo(U,{}),U.relationshipId=H.id,(Z=this._getSmartActionsForRelation(U.featureLayer.id))||(Z={}),U.fieldValidations=Z,(Z=this._getAttributeActionsForRelation(U.featureLayer.id))||
(Z={}),U.fieldValues=Z,r.push(U))}))}))}return r},_addTableFieldActionIcon:function(z,r){var v=d(".action-item-parent",z)[0];var H=d(".jimu-icon-edit",z)[0];d(".action-item-parent",z)[0]&&g.set(d(".action-item-parent",z)[0],"width","60px");d(".actions-td.simple-table-cell",z);z.tableFieldDiv=l.create("div",{"class":"action-item jimu-float-leading row-edit-div jimu-icon table-field-icon",title:this.nls.layersPage.layerSettingsTable.relationTip},v);l.place(z.tableFieldDiv,H,"after");this.own(e(z.tableFieldDiv,
"click",a.hitch(this,function(){var T=this._layersTable.getRowData(z);this.customSettingsRadioBtn.checked&&this._getConfigForCurrentDisplayedLayers();this._addBreadCrumb(T.label);this._currentTableIds.push(z._layerId);this._layersTable.clear();this._updateValidationsAccordingToGroups(r);this._setLayersTable(r,!0)})))},_updateValidationsAccordingToGroups:function(z){if(this._currentTableIds&&0<this._currentTableIds.length){var r=this._configInfos;n.some(this._currentTableIds,function(H,T){n.some(r,
function(U){if(U.featureLayer.id===H)return r=U,!0});1<this._currentTableIds.length&&T+1<this._currentTableIds.length&&(r=r.relationshipInfos)},this)}if(r&&r.relationshipInfos){var v=r.relationshipInfos;v.length===z.length&&n.forEach(z,function(H){n.some(v,function(T){if(T.featureLayer.id===H.featureLayer.id)return H.fieldValidations=T.fieldValidations,H.fieldValues=T.fieldValues,!0})},this)}},_addBreadCrumb:function(z,r){var v;var H=l.create("div",{},this.breadCrumbContainer);e(H,"click",a.hitch(this,
function(T){this._onBreadCrumbSectionClick(H,T)}));(v=d(".breadCrumbTitle",this.domNode))&&0<v.length&&B.add(v[v.length-1],"breadCrumbTitleActive");r?w.set(H,"breadIndex",-1):(l.create("div",{"class":"nextArrowIcon"},H),w.set(H,"breadIndex",this._currentTableIds.length));l.create("div",{"class":"breadCrumbTitle",innerHTML:z},H)},_onBreadCrumbSectionClick:function(z,r){z=d(".breadCrumbTitle",z)[0];if(B.contains(z,"breadCrumbTitleActive")){var v=parseInt(w.get(r.currentTarget,"breadIndex"),10);r=d("div[breadIndex]").length;
B.remove(z,"breadCrumbTitleActive");for(z=v+1;z<=r;z++)l.destroy(d("div[breadIndex\x3d"+z+"]")[0]);if(this._currentTableIds&&0<this._currentTableIds.length){var H=this._configInfos;n.some(this._currentTableIds,function(T,U){if(v+1===U)return!0;n.some(H,function(Z){if(Z.featureLayer.id===T)return H=Z,!0});1<this._currentTableIds.length&&U+1<this._currentTableIds.length&&(H=H.relationshipInfos)},this);this.customSettingsRadioBtn.checked&&this._getConfigForCurrentDisplayedLayers();this._currentTableIds.splice(v+
1,this._currentTableIds.length);this._layersTable.clear();this._setLayersTable(H,-1===v?!1:!0)}}},_openServiceChooser:function(z){var r="";this._configuredGeocoderSettings&&this._configuredGeocoderSettings.url&&(r=this._configuredGeocoderSettings.url);this.serviceChooserContent=new D({url:r});this.geocoderPopupShelter=new k({hidden:!0});r=l.create("div");l.create("div",{innerHTML:this.nls.geocoderPage.hintMsg,style:{"font-size":"14px","padding-bottom":"5px"}},r);r.appendChild(this.serviceChooserContent.domNode);
this.geocoderPopup=new N({titleLabel:this.nls.geocoderPage.setGeocoderURL,autoHeight:!0,content:r,container:window.jimuConfig.layoutId,width:640});this.geocoderPopupShelter.placeAt(this.geocoderPopup.domNode);A.setStyle(this.serviceChooserContent.domNode,"width","580px");A.addClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content");this.serviceChooserContent.own(e(this.serviceChooserContent,"validate-click",a.hitch(this,function(){A.removeClass(this.serviceChooserContent.domNode,
"override-geocode-service-chooser-content")})));this.serviceChooserContent.own(e(this.serviceChooserContent,"ok",a.hitch(this,function(v){this._onSelectLocatorUrlOk(v,z)})));this.serviceChooserContent.own(e(this.serviceChooserContent,"cancel",a.hitch(this,"_onSelectLocatorUrlCancel")))},_onSelectLocatorUrlOk:function(z,r){z&&z[0]&&z[0].url&&this.domNode&&(this.geocoderPopupShelter.show(),L({url:z[0].url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(a.hitch(this,function(v){this.geocoderPopupShelter.hide();
v&&v.candidateFields?(this._configuredGeocoderSettings.url=z[0].url,this._configuredGeocoderSettings.fields=a.clone(v.candidateFields),n.forEach(this._configuredGeocoderSettings.fields,function(H){delete H.localizedNames}),this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null),r||this._editFields.geocoderConfigured()):new q({message:this.nls.locatorWarning})}),a.hitch(this,function(){this.geocoderPopupShelter.hide();new q({message:R.substitute({URL:this._getRequestUrl(z[0].url)},
a.clone(this.nls.invalidUrlTip))})})))},_onSelectLocatorUrlCancel:function(){this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null)},_initsmartActionsTable:function(){this._smartActionsTable=new K({fields:[{name:"name",title:this.nls.smartActionsPage.smartActionsTable.name,type:"text",width:"25%"},{name:"expression",title:this.nls.smartActionsPage.smartActionsTable.expression,type:"text",width:"50%"},{name:"definedOn",title:this.nls.smartActionsPage.smartActionsTable.definedFor,
type:"empty",width:"15%"},{name:"actions",title:this.nls.actions,type:"actions","class":"actions",width:"10%",actions:["edit","delete"]}],selectable:!1});this.own(e(this._smartActionsTable,"actions-edit",a.hitch(this,this._configureGroupSmartAction)));this._smartActionsTable.onBeforeRowDelete=a.hitch(this,this._onDeleteSmartActionsClick);this._smartActionsTable.placeAt(this.smartActionsTableNode);this._smartActionsTable.startup();this.config.smartActionGroups&&this._populateSmartActionGroups()},_getSmartActionGroupConfig:function(){var z,
r={};this._smartActionsTable&&(z=this._smartActionsTable.getRows())&&0<z.length&&n.forEach(z,function(v){v._configInfo&&(r[v._configInfo.name]=v._configInfo)});return r},_populateSmartActionGroups:function(){for(var z in this.config.smartActionGroups)this._addSmartActionGroupRow(this.config.smartActionGroups[z])},_onDeleteSmartActionsClick:function(z){var r=new N({titleLabel:this.nls.smartActionsPage.deleteGroupPopupTitle,width:450,maxHeight:445,autoHeight:!0,content:this.nls.smartActionsPage.deleteGroupPopupMsg,
"class":this.baseClass,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){this._configureGroupSmartAction(z,!0);r.close();this._smartActionsTable.deleteRow(z)})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:a.hitch(this,function(){r.close()})}]})},_removeFromGroup:function(z){if(this.config.smartActionGroups&&this.config.smartActionGroups[z.groupName]){var r=this.config.smartActionGroups[z.groupName];r.appliedOn[z.layerId]&&(r.appliedOn[z.layerId][z.fieldName][z.action]=
!1,this._updateSmartActionTablesDefiendForCol(z.groupName))}this._removeGroupNameFromLayerFields(z)},_updateSmartActionTablesDefiendForCol:function(z){if(this._smartActionsTable){var r=this._smartActionsTable.getRows(),v=this.config.smartActionGroups[z];n.some(r,function(H){if(this._smartActionsTable.getRowData(H).name===z){var T=this._checkPriorityStatus(v);this._addDefinedFor(T,H);return!0}},this)}},_removeGroupNameFromLayerFields:function(z){var r,v=[];if(v=this._getLayersFieldValidations(v,this._configInfos,
z.layerId))for(var H=0;H<v.length;H++)if(r=v[H])for(var T in r)r&&r[T]&&T===z.fieldName&&n.some(r[T],function(U){if(U&&z.action===U.actionName&&U.filter&&U.filter.hasOwnProperty("smartActionGroupName")&&U.filter.smartActionGroupName===z.groupName)return delete U.filter.smartActionGroupName,!0},this)},_getLayersFieldValidations:function(z,r,v){n.forEach(r,function(H){H.featureLayer&&H.featureLayer.id===v&&H.fieldValidations&&(z||(z=[]),z.push(H.fieldValidations));H.relationshipInfos&&(z=this._getLayersFieldValidations(z,
H.relationshipInfos,v))},this);return z},_configureGroupSmartAction:function(z,r){var v={nls:this.nls,map:this.map,filterInfo:{filter:""},layerForExpression:"",name:"",prevName:null,submitWhenHidden:!1,appliedOn:null,existingGroupNames:[],_configInfos:this._configInfos,_jimuLayerInfos:this._jimuLayerInfos,editUtils:C};this.config.smartActionGroups&&(v.existingGroupNames=Object.keys(this.config.smartActionGroups));v.existingGroups=this._getSmartActionGroupConfig();z&&(v.appliedOn=z._configInfo.appliedOn,
v.submitWhenHidden=z._configInfo.submitWhenHidden,v.name=z._configInfo.name,v.prevName=a.clone(z._configInfo.name),v.filterInfo=z._configInfo.filterInfo,v.layerForExpression=z._configInfo.layerForExpression);v=new G(v);this.own(e(v,"groupInfoUpdated",a.hitch(this,function(H){z?(z._configInfo=H,this._smartActionsTable.editRow(z,{name:H.name,expression:H.filterInfo.expression})):this._addSmartActionGroupRow(H);this.config.smartActionGroups=this._getSmartActionGroupConfig();this._updateSmartActionTablesDefiendForColForAllRows()})));
r?(this.config.smartActionGroups.hasOwnProperty(v.name)&&delete this.config.smartActionGroups[v.name],v.deleteGroup()):(v.showDialog(),setTimeout(a.hitch(this,function(){var H=d(".esriCTTableMainNode.tableBodyScroll",this.smartActionsTableNode.domNode),T=d(".tableBodyScroll\x3etbody",this.smartActionsTableNode.domNode);if(H.length&&T.length){var U=g.getComputedStyle(H[0].parentElement).height;g.set(H[0],"height",U);H=g.getComputedStyle(d(".tableBodyScroll\x3ethead",this.smartActionsTableNode.domNode)[0]).height;
g.set(T[0],"height",parseFloat(U)-parseFloat(H)-10+"px");g.set(T[0],"overflow-y","auto");g.set(T[0],"max-height","calc(100% - 10px)")}}),200))},_addSmartActionGroupRow:function(z){var r=this._smartActionsTable.addRow({name:z.name,expression:z.filterInfo.expression});r.success&&(r.tr._configInfo=z,z=this._checkPriorityStatus(z),this._addDefinedFor(z,r.tr))},_updateSmartActionTablesDefiendForColForAllRows:function(){if(this._smartActionsTable){var z=this._smartActionsTable.getRows();n.forEach(z,function(r){var v=
this._checkPriorityStatus(r._configInfo);this._addDefinedFor(v,r);return!0},this)}},_addDefinedFor:function(z,r){var v;(r=d(".simple-table-cell",r)[2])&&l.empty(r);r=l.create("div",{"class":"esriCTPriorityIconMainDiv"},r);var H=!0;for(v in z){if(H){H=!1;var T="esriCTPriorityIcons esriCT"+v+" esriCTDefinedFor"}else T="esriCTPriorityIcons esriCT"+v;z[v]||(T+=" esriCTVisibility");l.create("div",{"class":T,title:this.nls.actionPage.actions[v.toLowerCase()]},r)}},_checkPriorityStatus:function(z){var r;
for(r in z.appliedOn){for(var v in z.appliedOn[r]){if(!H)var H=z.appliedOn[r][v].Hide;if(!T)var T=z.appliedOn[r][v].Required;if(!U)var U=z.appliedOn[r][v].Disabled;if(H&&T&&U)break}if(H&&T&&U)break}return{Hide:H,Required:T,Disabled:U}},_getFieldValidationsFromGroup:function(z,r,v){var H={},T;for(T in z.appliedOn[r]){var U=v&&v[T]?v[T]:null;if(z.appliedOn[r][T].Hide||z.appliedOn[r][T].Required||z.appliedOn[r][T].Disabled)U||(U=[{actionName:"Hide"},{actionName:"Required"},{actionName:"Disabled"}]),
H[T]=U;var Z={submitWhenHidden:!1,filter:a.clone(z.filterInfo.filter),expression:z.filterInfo.filter.expr};Z.filter.smartActionGroupName=z.name;z.appliedOn[r][T].Hide&&(U[0]=a.mixin(U[0],Z),U[0].submitWhenHidden=z.submitWhenHidden);z.appliedOn[r][T].Required&&(U[1]=a.mixin(U[1],Z));z.appliedOn[r][T].Disabled&&(U[2]=a.mixin(U[2],Z))}return H},_getSmartActionsForRelation:function(z){var r;if(this.config.smartActionGroups)for(var v in this.config.smartActionGroups)this.config.smartActionGroups[v].appliedOn.hasOwnProperty(z)&&
(r=this._getFieldValidationsFromGroup(this.config.smartActionGroups[v],z,r));return r},_getFieldValuesFromGroup:function(z,r,v){var H={},T;for(T in z.appliedOn[r]){var U=v&&v[T]?v[T]:null;-1<z.appliedOn[r].indexOf(T)&&(U||(U=[{actionName:"Intersection",enabled:!1,fields:[]},{actionName:"Address",enabled:!1},{actionName:"Coordinates",enabled:!1,coordinatesSystem:"MapSpatialReference",field:"x"},{actionName:"Preset",enabled:!0,attributeActionGroupName:z.name}]),H[T]=U)}return H},_getAttributeActionsForRelation:function(z){var r;
if(this.config.attributeActionGroups&&this.config.attributeActionGroups.Preset)for(var v in this.config.attributeActionGroups.Preset)this.config.attributeActionGroups.Preset[v].appliedOn.hasOwnProperty(z)&&(r=this._getFieldValuesFromGroup(this.config.attributeActionGroups.Preset[v],z,r));return r},_createLayerChooserFromMap:function(){var z=this._createLayerChooserMapArgs();this._layerChooserFromMap=new X(z);this._layerChooserFromMap.startup();z=this._layerChooserFromMap.layerInfosObj.getLayerInfoArray();
var r=this._layerChooserFromMap.layerInfosObj.getTableInfoArray();r&&0<r.length&&(z=z.concat(r));this._getAllFilteredLayers(z,[])},_createLayerChooserMapArgs:function(){return{multiple:!1,createMapResponse:this.map.webMapResponse,filter:this._createFiltersForLayerSelector()}},_createFiltersForLayerSelector:function(){return X.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0)},_isLayerEditable:function(z){var r=!1;z&&z.layerObject&&(z=z.layerObject.getEditCapabilities(),z.canCreate||z.canUpdate||
z.canDelete||z.canUpdateGeometry)&&(r=!0);return r},_getAllFilteredLayers:function(z,r){n.forEach(z,a.hitch(this,function(v){if(v.isLeaf()){var H=new M;this._layerChooserFromMap.filter(v).then(a.hitch(this,function(T){T&&this._isLayerEditable(v)&&this._totalLayers.push(v);H.resolve()}));r.push(H)}else this._getAllFilteredLayers(v.newSubLayers,r)}))},_onDeleteAttributeActionsClick:function(z,r){var v=new N({titleLabel:this.nls.attributeActionsPage.deleteGroupPopupTitle,width:450,maxHeight:445,autoHeight:!0,
content:this.nls.attributeActionsPage.deleteGroupPopupMsg,"class":this.baseClass,buttons:[{label:this.nls.ok,onClick:a.hitch(this,function(){"Intersection"===r?(this._configureIntersectionActionGroup(z,!0),this._intersectionActionGroupTable.deleteRow(z)):"Address"===r?(this._configureAddressActionGroup(z,!0),this._addressActionGroupTable.deleteRow(z)):"Coordinates"===r?(this._configureCoordinatesActionGroup(z,!0),this._coordinatesActionGroupTable.deleteRow(z)):"Preset"===r&&(this._configurePresetActionGroup(z,
!0),this._presetActionGroupTable.deleteRow(z));v.close()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:a.hitch(this,function(){v.close()})}]})},_initAttributeActionsTable:function(z,r,v){var H=["edit","delete"];r&&(H=["up","down","edit","delete"]);r=[{name:"name",title:this.nls.attributeActionsPage.name,type:"text"},{name:"dataType",title:this.nls.attributeActionsPage.type,type:"text"},{name:"actions",title:this.nls.actions,type:"actions","class":"actions",actions:H}];v&&r.splice(2,
0,{name:"coordinateSourceTableValue",title:this.nls.coordinatesPage.coordinatesSourceTitle,type:"text"});v=new K({fields:r,selectable:!1});v.placeAt(z);v.startup();return v},_getAllLayersFieldValues:function(z,r,v){n.forEach(r,function(H){H.featureLayer&&H.featureLayer.id===v&&(H.fieldValues?z||(z=[]):H.fieldValues={},z.push(H.fieldValues));H.relationshipInfos&&(z=this._getAllLayersFieldValues(z,H.relationshipInfos,v))},this);return z},_removeAttributeGroupNameFromLayerFields:function(z){var r,v=
[];if((v=this._getAllLayersFieldValues(v,this._configInfos,z.layerId))&&0<v.length)for(var H=0;H<v.length;H++)if(r=v[H])for(var T in r)if(r&&r[T]&&T===z.fieldName)for(var U=r[T],Z=0;Z<U.length;Z++)U[Z].actionName===z.action&&U[Z].hasOwnProperty("attributeActionGroupName")&&U[Z].attributeActionGroupName===z.groupName&&delete U[Z].attributeActionGroupName},_removeFromAttributeActionGroup:function(z){if(this.config.attributeActionGroups&&this.config.attributeActionGroups[z.action]){var r=this.config.attributeActionGroups[z.action][z.groupName];
if(r.appliedOn[z.layerId]&&-1<r.appliedOn[z.layerId].indexOf(z.fieldName)){var v=r.appliedOn[z.layerId].indexOf(z.fieldName);r.appliedOn[z.layerId].splice(v,1)}}this._removeAttributeGroupNameFromLayerFields(z)},_initAllAttributeActions:function(){this._intersectionActionGroupTable=this._initAttributeActionsTable(this.intersectionActionsTableNode);this.own(e(this._intersectionActionGroupTable,"actions-edit",a.hitch(this,this._configureIntersectionActionGroup)));this._intersectionActionGroupTable.onBeforeRowDelete=
a.hitch(this,function(z){this._onDeleteAttributeActionsClick(z,"Intersection")});this._addressActionGroupTable=this._initAttributeActionsTable(this.addressActionsTableNode);this.own(e(this._addressActionGroupTable,"actions-edit",a.hitch(this,this._configureAddressActionGroup)));this._addressActionGroupTable.onBeforeRowDelete=a.hitch(this,function(z){this._onDeleteAttributeActionsClick(z,"Address")});this._coordinatesActionGroupTable=this._initAttributeActionsTable(this.coordinatesActionsTableNode,
!1,!0);this.own(e(this._coordinatesActionGroupTable,"actions-edit",a.hitch(this,this._configureCoordinatesActionGroup)));this._coordinatesActionGroupTable.onBeforeRowDelete=a.hitch(this,function(z){this._onDeleteAttributeActionsClick(z,"Coordinates")});this._presetActionGroupTable=this._initAttributeActionsTable(this.presetActionsTableNode,!0);this.own(e(this._presetActionGroupTable,"actions-edit",a.hitch(this,this._configurePresetActionGroup)));this._presetActionGroupTable.onBeforeRowDelete=a.hitch(this,
function(z){this._onDeleteAttributeActionsClick(z,"Preset")});this.config.attributeActionGroups&&this._populateAttributeActionGroups()},_addAttributeActionGroupRow:function(z,r){var v=z.name;var H=z.dataType;if("Intersection"===r){var T=this._intersectionActionGroupTable;H=this.nls.dataType[z.dataType]}else if("Address"===r)T=this._addressActionGroupTable;else if("Coordinates"===r){H=z.attributeInfo.field;r=z.attributeInfo.coordinatesSystem;T=this._coordinatesActionGroupTable;H="MGRS"===r?this.nls.coordinatesPage.MGRS:
this.nls.coordinatesPage[r][H];var U=z.attributeInfo&&"undefined"!==typeof z.attributeInfo.coordinatesSource?z.attributeInfo.coordinatesSource:"featureLocation"}else"Preset"===r&&(T=this._presetActionGroupTable,H=this.nls.dataType[z.dataType]);T&&(T=U?T.addRow({name:v,dataType:H,coordinateSourceTableValue:this.nls.coordinatesPage[U]}):T.addRow({name:v,dataType:H}),T.success&&(T.tr._configInfo=z))},_hasFieldsInPresetGroup:function(z){var r=!1,v;for(v in z.appliedOn)if(0<z.appliedOn[v].length){r=!0;
break}return r},_populateAttributeActionGroups:function(){for(var z in this.config.attributeActionGroups)if("presetOrder"!==z){var r=this.config.attributeActionGroups[z];if("Preset"===z){this.config.attributeActionGroups.hasOwnProperty("presetOrder")||(this.config.attributeActionGroups.presetOrder=Object.keys(r));for(var v=0;v<this.config.attributeActionGroups.presetOrder.length;v++){var H=this.config.attributeActionGroups.presetOrder[v],T=r[H];this._addAttributeActionGroupRow(T,z)}}else for(H in r)T=
r[H],this._addAttributeActionGroupRow(T,z)}},_getAttributeActionGroupConfig:function(){return{Intersection:this._getAttributeGroupsForAction(this._intersectionActionGroupTable),Address:this._getAttributeGroupsForAction(this._addressActionGroupTable),Coordinates:this._getAttributeGroupsForAction(this._coordinatesActionGroupTable),Preset:this._getAttributeGroupsForAction(this._presetActionGroupTable)}},_getAttributeGroupsForAction:function(z){var r={};z&&(z=z.getRows())&&0<z.length&&n.forEach(z,function(v){v._configInfo&&
(r[v._configInfo.name]=v._configInfo)});return r},_configureIntersectionActionGroup:function(z,r){var v={nls:this.nls,map:this.map,isGroup:!0,isDelete:r,layerInfos:this._jimuLayerInfos,existingGroupNames:[],appliedOn:null,_configInfos:this._configInfos,_fieldType:"esriFieldTypeString",_fieldValues:{Intersection:{fields:[]}},editUtils:C};this.config.attributeActionGroups&&this.config.attributeActionGroups.Intersection&&(v.existingGroupNames=Object.keys(this.config.attributeActionGroups.Intersection));
v.existingGroups=this._getAttributeActionGroupConfig().Intersection;z&&(v.appliedOn=z._configInfo.appliedOn,v.name=z._configInfo.name,v._fieldType=z._configInfo.dataType,v.prevName=a.clone(z._configInfo.name),v._fieldValues.Intersection=z._configInfo.attributeInfo);v=new Q(v);this.own(e(v,"groupInfoUpdated",a.hitch(this,function(H){z?(z._configInfo=H,this._intersectionActionGroupTable.editRow(z,{name:H.name,dataType:this.nls.dataType[H.dataType]})):this._addAttributeActionGroupRow(H,"Intersection");
this.config.attributeActionGroups=this._getAttributeActionGroupConfig()})));r&&(this.config.attributeActionGroups.Intersection.hasOwnProperty(z._configInfo.name)&&delete this.config.attributeActionGroups.Intersection[z._configInfo.name],v.deleteGroup())},_onIntersectionBtnClick:function(){this._configureIntersectionActionGroup()},_configureAddressActionGroup:function(z,r){var v={nls:this.nls,map:this.map,isGroup:!0,isDelete:r,_totalLayers:this._totalLayers,layerInfos:this._jimuLayerInfos,existingGroupNames:[],
_configInfos:this._configInfos,appliedOn:null,_geocoderSettings:this._configuredGeocoderSettings,_fieldValues:{Address:{field:"",enabled:!0}},editUtils:C};this.config.attributeActionGroups&&this.config.attributeActionGroups.Address&&(v.existingGroupNames=Object.keys(this.config.attributeActionGroups.Address));v.existingGroups=this._getAttributeActionGroupConfig().Address;z&&(v.appliedOn=z._configInfo.appliedOn,v.name=z._configInfo.name,v.prevName=a.clone(z._configInfo.name),v._fieldValues.Address=
z._configInfo.attributeInfo);v=new W(v);this.own(e(v,"groupInfoUpdated",a.hitch(this,function(H){z?(z._configInfo=H,this._addressActionGroupTable.editRow(z,{name:H.name,dataType:H.dataType})):this._addAttributeActionGroupRow(H,"Address");this.config.attributeActionGroups=this._getAttributeActionGroupConfig()})));r&&(this.config.attributeActionGroups.Address.hasOwnProperty(z._configInfo.name)&&delete this.config.attributeActionGroups.Address[z._configInfo.name],v.deleteGroup())},_onAddressBtnClick:function(){this._configuredGeocoderSettings?
this._configureAddressActionGroup():this._openServiceChooser()},_configureCoordinatesActionGroup:function(z,r){var v={nls:this.nls,map:this.map,isGroup:!0,isDelete:r,_totalLayers:this._totalLayers,layerInfos:this._jimuLayerInfos,existingGroupNames:[],_configInfos:this._configInfos,appliedOn:null,coordinatesSavedDataTypes:this._filterAttributeDropDownOptions(z),_geocoderSettings:this._configuredGeocoderSettings,_fieldValues:{Coordinates:{coordinatesSystem:"MapSpatialReference",field:"x",enabled:!0,
coordinatesSource:"featureLocation"}},editUtils:C};this.config.attributeActionGroups&&this.config.attributeActionGroups.Coordinates&&(v.existingGroupNames=Object.keys(this.config.attributeActionGroups.Coordinates));v.existingGroups=this._getAttributeActionGroupConfig().Coordinates;z&&(v.appliedOn=z._configInfo.appliedOn,v.name=z._configInfo.name,v.prevName=a.clone(z._configInfo.name),v._fieldValues.Coordinates=z._configInfo.attributeInfo);v=new V(v);this.own(e(v,"groupInfoUpdated",a.hitch(this,function(H){if(z){z._configInfo=
H;var T=H.attributeInfo&&"undefined"!==typeof H.attributeInfo.coordinatesSource?H.attributeInfo.coordinatesSource:"featureLocation";this._coordinatesActionGroupTable.editRow(z,{name:H.name,dataType:H.dataType,coordinatesSource:T,coordinateSourceTableValue:this.nls.coordinatesPage[T]})}else this._addAttributeActionGroupRow(H,"Coordinates");this.config.attributeActionGroups=this._getAttributeActionGroupConfig()})));r&&(this.config.attributeActionGroups.Coordinates.hasOwnProperty(z._configInfo.name)&&
delete this.config.attributeActionGroups.Coordinates[z._configInfo.name],v.deleteGroup())},_onCoordinateBtnClick:function(){var z=this._coordinatesActionGroupTable.getRows();z&&18>z.length?this._configureCoordinatesActionGroup():new q({message:this.nls.coordinatesPage.allGroupsCreatedMsg})},_configurePresetActionGroup:function(z,r){var v={nls:this.nls,map:this.map,isDelete:r,_totalLayers:this._totalLayers,layerInfos:this._jimuLayerInfos,_configuredPresetInfos:this._configuredPresetInfos,existingGroupNames:[],
_configInfos:this._configInfos,appliedOn:null,dataType:"esriFieldTypeString",editUtils:C};this.config.attributeActionGroups&&this.config.attributeActionGroups.Preset&&(v.existingGroupNames=Object.keys(this.config.attributeActionGroups.Preset));v.existingGroups=this._getAttributeActionGroupConfig().Preset;z&&(v.appliedOn=z._configInfo.appliedOn,v.name=z._configInfo.name,v.dataType=z._configInfo.dataType,v.showOnlyDomainFields=z._configInfo.showOnlyDomainFields,v.hideInPresetDisplay=z._configInfo.hideInPresetDisplay,
v.prevName=a.clone(z._configInfo.name),v.presetValue=z._configInfo.presetValue,v.chooseFromLayerInfo=z._configInfo.chooseFromLayerInfo);v=new Y(v);this.own(e(v,"groupInfoUpdated",a.hitch(this,function(H){z?(z._configInfo=H,this._presetActionGroupTable.editRow(z,{name:H.name,dataType:this.nls.dataType[H.dataType]})):this._addAttributeActionGroupRow(H,"Preset");this.config.attributeActionGroups=this._getAttributeActionGroupConfig()})));r&&(this.config.attributeActionGroups.Preset.hasOwnProperty(z._configInfo.name)&&
delete this.config.attributeActionGroups.Preset[z._configInfo.name],v.deleteGroup())},_onPresetBtnClick:function(){this._configurePresetActionGroup()},_filterAttributeDropDownOptions:function(z){var r,v;var H={featureLocation:{},myLocation:{}};H.featureLocation.MapSpatialReference=["X","Y","X Y","Y X"];H.featureLocation.LatLong=["Latitude","Longitude","Latitude Longitude","Longitude Latitude"];H.featureLocation.MGRS=["MGRS"];H.myLocation.MapSpatialReference=["X","Y","X Y","Y X"];H.myLocation.LatLong=
["Latitude","Longitude","Latitude Longitude","Longitude Latitude"];H.myLocation.MGRS=["MGRS"];(r=this._coordinatesActionGroupTable.getRows())&&0<r.length&&n.forEach(r,a.hitch(this,function(T){var U="featureLocation";z&&z._configInfo.attributeInfo.coordinatesSource===T._configInfo.attributeInfo.coordinatesSource&&z._configInfo.dataType===T._configInfo.dataType||(v=T._configInfo.dataType,"Latitude Longitude"===T._configInfo.dataType&&T._configInfo.attributeInfo&&"xy"===T._configInfo.attributeInfo.field&&
(v="Longitude Latitude"),T._configInfo.attributeInfo&&T._configInfo.attributeInfo.coordinatesSource&&(U=T._configInfo.attributeInfo.coordinatesSource),-1<H[U].MapSpatialReference.indexOf(v)?(T=H[U].MapSpatialReference.indexOf(v),H[U].MapSpatialReference.splice(T,1)):-1<H[U].LatLong.indexOf(v)?(T=H[U].LatLong.indexOf(v),H[U].LatLong.splice(T,1)):-1<H[U].MGRS.indexOf(v)&&H[U].MGRS.splice(0,1))}));return H},_resetHeight:function(z){g.set(z,"height",z.offsetParent.offsetHeight-50+"px")}})});