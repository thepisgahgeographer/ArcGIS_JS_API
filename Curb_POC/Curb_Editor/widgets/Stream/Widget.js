// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Stream/StreamControl":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-attr dojo/dom-style dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./StreamControl.html jimu/dijit/DrawBox ./FilterItem jimu/dijit/CheckBox dijit/form/RadioButton esri/symbols/jsonUtils esri/symbols/SimpleFillSymbol esri/graphic jimu/dijit/SimpleTable dijit/form/NumberSpinner jimu/dijit/LoadingShelter".split(" "),
function(m,b,n,e,k,a,q,g,u,r,v,t,p,d,l,y,A,B,C){return m([u,r,v],{baseClass:"jimu-widget-stream",templateString:t,map:null,streamLayer:null,isStreaming:!0,mapExtentChangeHandler:null,config:null,filterItems:[],postCreate:function(){this.inherited(arguments);this.spatialFilterToggle=new l({checked:!1,label:this.nls.useSpatialFilter,onChange:b.hitch(this,this._toggleSpatialFilter)});this.spatialFilterToggle.placeAt(this.spatialFilterToggleDiv);this.attrFilterToggle=new l({checked:!1,label:this.nls.useAttributeFilter,
onChange:b.hitch(this,this._toggleAttributeFilter)});this.attrFilterToggle.placeAt(this.attrFilterToggleDiv);this.config&&this._applyConfig();this.streamLayer&&this._bindEvents()},_applyConfig:function(){!0!==this.config.startStop&&a.set(this.startBtn,"display","none");!0!==this.config.clear&&a.set(this.clearBtn,"display","none");!0!==this.config.drawPrevious&&a.set(this.drawPreviousSection,"display","none");!0!==this.config.spatialFilter?(a.set(this.spatialFilterControl,"display","none"),a.set(this.spatialFilterSection,
"display","none")):this.config.mapExtentFilter&&this.config.drawExtentFilter?(this._createMapAreaFilterControl(!0),this._createDrawAreaFilterControl(!0)):this.config.mapExtentFilter?this._createMapAreaFilterControl(!1):this.config.drawExtentFilter?this._createDrawAreaFilterControl(!1):(a.set(this.spatialFilterControl,"display","none"),a.set(this.spatialFilterSection,"display","none"));if(this.config.attrFilter&&0<this.config.filterList.length){var c,f,h=!1;n.forEach(this.config.filterList,b.hitch(this,
function(w,x){f=1===this.config.filterList.length?"checkbox":"radio";var z=!0===w.inherited&&w.definitionExpression===this.streamLayer.getDefinitionExpression();c=new d({uid:this.id,config:w,type:f,streamLayer:this.streamLayer,index:x,checked:z,nls:this.nls});c.placeAt(this.attrFilterSection);this.filterItems.push(c);h=h||z}));h&&this.attrFilterToggle.setValue(!0)}else a.set(this.attrFilterControl,"display","none"),a.set(this.attrFilterSection,"display","none");this.config.spatialFilter||this.config.attrFilter&&
0!==this.config.filterList.length||a.set(this.filterLabelSection,"display","none")},_createMapAreaFilterControl:function(c){var f=g.create("div",{"class":"filterOption"},this.spatialFilterSection);c?(this.mapAreaControl=new y({id:this.id+"_mapAreaObservations",name:this.id+"_sf",value:"mapArea"}),this.mapAreaControl.placeAt(f),this.own(e(this.mapAreaControl,"change",b.hitch(this,this._mapAreaFilterChange))),g.create("label",{"class":"jimu-widget-normal","for":this.id+"_mapAreaObservations",innerHTML:this.nls.showMapAreaObservations},
f)):(this.mapAreaControl=new l({checked:!1,label:this.nls.showMapAreaObservations,onChange:b.hitch(this,this._mapAreaFilterChange)}),this.mapAreaControl.placeAt(f))},_createDrawAreaFilterControl:function(c){var f=g.create("div",{"class":"filterOption"},this.spatialFilterSection);c?(this.drawAreaControl=new y({id:this.id+"_drawAreaObservations",name:this.id+"_sf",value:"drawArea"}),this.drawAreaControl.placeAt(f),this.own(e(this.drawAreaControl,"change",b.hitch(this,this._drawAreaFilterChange))),g.create("label",
{"class":"jimu-widget-normal","for":this.id+"_drawAreaObservations",innerHTML:this.nls.showObservationsByDrawing},f)):(this.drawAreaControl=new l({checked:!1,label:this.nls.showObservationsByDrawing,onChange:b.hitch(this,this._drawAreaFilterChange)}),this.drawAreaControl.placeAt(f));this.drawToolDiv=g.create("div",{style:"display:none"},f);this.drawTool=new p({map:this.map,showClear:!0,keepOneGraphic:!0,geoTypes:["EXTENT"],types:["polygon"]});this.config.drawSymbol&&this.drawTool.setPolygonSymbol(A.fromJson(this.config.drawSymbol));
this.drawTool.placeAt(this.drawToolDiv);this.own(e(this.drawTool,"draw-end",b.hitch(this,function(h){h=new C(h.toJson());h.symbol.setStyle(B.STYLE_NULL);this.drawTool.addGraphic(h);var w=e(this.streamLayer,"filter-change",b.hitch(this,function(x){w.remove();x.filter.geometry&&"extent"===x.filter.geometry.type&&setTimeout(b.hitch(this,function(){this._clearOutsideGraphics(x.filter.geometry)}),100)}));this.streamLayer.setGeometryDefinition(h.geometry)})));this.own(e(this.drawTool,"clear",b.hitch(this,
function(){this.streamLayer.setGeometryDefinition(this.map.extent)})))},_mapAreaFilterChange:function(c){c?(this.streamLayer&&this.streamLayer.setGeometryDefinition(this.map.extent),this._addMapExtentChangeHandler()):this._removeMapExtentChangeHandler()},_drawAreaFilterChange:function(c){c?a.set(this.drawToolDiv,"display",""):(this.drawTool.clear(),a.set(this.drawToolDiv,"display","none"))},_bindEvents:function(){"none"!==a.get(this.startBtn,"display")&&this.own(e(this.startBtn,"click",b.hitch(this,
function(){(this.isStreaming=!this.isStreaming)?(q.add(this.startBtn,"stop"),k.set(this.startBtnLabel,"innerHTML",this.nls.stopStreaming),this.startStreaming()):(q.remove(this.startBtn,"stop"),k.set(this.startBtnLabel,"innerHTML",this.nls.startStreaming),this.stopStreaming())})));"none"!==a.get(this.clearBtn,"display")&&this.own(e(this.clearBtn,"click",b.hitch(this,function(){this.streamLayer.clear()})));if("none"!==a.get(this.drawPreviousSection,"display")){var c=this.streamLayer.maximumTrackPoints||
1;this.previousSpinner.set("value",c-1);this.streamLayer.setMaximumTrackPoints(c);this.own(e(this.previousSpinner,"change",b.hitch(this,function(f){this.streamLayer.setMaximumTrackPoints(f+1)})))}},_clearOutsideGraphics:function(c){this.streamLayer.clear()},destroy:function(){this.inherited(arguments);this._removeMapExtentChangeHandler()},stopStreaming:function(){this.streamLayer.disconnect(b.hitch(this,function(){this.streamLayer.clear()}))},startStreaming:function(){this.streamLayer.connect()},
_removeMapExtentChangeHandler:function(){this.mapExtentChangeHandler&&"function"===typeof this.mapExtentChangeHandler.remove&&(this.mapExtentChangeHandler.remove(),this.mapExtentChangeHandler=null)},_addMapExtentChangeHandler:function(){null===this.mapExtentChangeHandler&&(this.mapExtentChangeHandler=e(this.map,"extent-change",b.hitch(this,this._mapExtentChange)))},_mapExtentChange:function(c){this.streamLayer&&this.streamLayer.setGeometryDefinition(c.extent)},_toggleSpatialFilter:function(c){c?a.set(this.spatialFilterSection,
"display",""):(a.set(this.spatialFilterSection,"display","none"),a.set(this.drawToolDiv,"display","none"),this.mapAreaControl&&("jimu.dijit.CheckBox"===this.mapAreaControl.dealaredClass?this.mapAreaControl.setValue(!1):this.mapAreaControl.set("checked",!1)),this.drawAreaControl&&(this.drawTool.clear(),"jimu.dijit.CheckBox"===this.drawAreaControl.dealaredClass?this.drawAreaControl.setValue(!1):this.drawAreaControl.set("checked",!1)),this._removeMapExtentChangeHandler(),this.streamLayer&&this.streamLayer.setGeometryDefinition(null))},
_toggleAttributeFilter:function(c){c?a.set(this.attrFilterSection,"display",""):(a.set(this.attrFilterSection,"display","none"),n.forEach(this.filterItems,function(f){f.unCheck()}),this.streamLayer&&this.streamLayer.setDefinitionExpression(null))}})})},"widgets/Stream/FilterItem":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-style dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./FilterItem.html jimu/dijit/CheckBox dijit/form/RadioButton jimu/dijit/FilterParameters jimu/filterUtils jimu/utils".split(" "),
function(m,b,n,e,k,a,q,g,u,r,v,t,p){return m([a,q],{baseClass:"jimu-widget-stream-filterItem",templateString:g,streamLayer:null,config:null,type:null,checked:!1,uid:"",index:0,askForValues:!0,postCreate:function(){this.inherited(arguments);this._init()},_init:function(){if("checkbox"===this.type)this.control=new u({checked:this.checked,label:this.config.name,onChange:b.hitch(this,this._checkBoxChange)}),this.control.placeAt(this.controlSection);else if("radio"===this.type){var d=k.create("div",{},
this.controlSection);this.control=new r({checked:this.checked,value:this.config.name,name:this.uid+"_attFilterItem",id:this.uid+"_attFilterItem_"+this.index});this.own(n(this.control,"change",b.hitch(this,function(l){this._checkBoxChange(l)})));this.control.placeAt(d);k.create("label",{"class":"jimu-widget-normal",innerHTML:p.sanitizeHTML(this.config.name),"for":this.uid+"_attFilterItem_"+this.index},d)}this.attrParamsDijit=new v;this.attrParamsDijit.placeAt(this.attrFilterParams);this.attrParamsDijit.startup();
this.attrParamsDijit.build(this.streamLayer.url,this.streamLayer,this.config.filterInfo);(this.askForValues=(new t).isAskForValues(this.config.filterInfo))?this.own(n(this.applyAttrFilterBtn,"click",b.hitch(this,this._applyFilter))):e.set(this.applyAttrFilterBtn,"display","none")},unCheck:function(){"checkbox"===this.type?this.control.setValue(!1):"radio"===this.type&&this.control.set("checked",!1);e.set(this.filterSection,"display","none")},_applyFilter:function(){var d=this.attrParamsDijit.getFilterExpr();
d&&"string"===typeof d&&(this.streamLayer.setDefinitionExpression(d),this.streamLayer.clear())},_checkBoxChange:function(d){d?this.askForValues?e.set(this.filterSection,"display",""):this._applyFilter():(e.set(this.filterSection,"display","none"),"checkbox"===this.type&&this.streamLayer&&this.streamLayer.setDefinitionExpression(null))}})})},"widgets/Stream/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Stream/StreamControl.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"jimu-widget-title" data-dojo-attach-point\x3d"controlLabelSection"\x3e\r\n    ${nls.streamControls}\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"controlButton stop" data-dojo-attach-point\x3d"startBtn"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading jimu-leading-margin1 runningIcon"\x3e\x3c/div\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal jimu-leading-margin1 btnLabel"\r\n           data-dojo-attach-point\x3d"startBtnLabel"\x3e${nls.stopStreaming}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"controlButton" data-dojo-attach-point\x3d"clearBtn"\x3e\r\n    \x3cdiv class\x3d"jimu-float-leading jimu-leading-margin1 clearIcon"\x3e\x3c/div\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal jimu-leading-margin1 btnLabel"\x3e${nls.clearObservation}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"drawPreviousSection" class\x3d"drawControl"\x3e\r\n    \x3clabel class\x3d"jimu-widget-normal btnLabel"\x3e${nls.previousObservations}\x26nbsp;\x3c/label\x3e\r\n    \x3cinput data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"height:32px;width:30%;float:right;"\r\n           data-dojo-props\x3d"smallDelta:1, intermediateChanges:true, constraints:{min:1,max:100,places:0}"\r\n           data-dojo-attach-point\x3d"previousSpinner"\r\n    /\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-widget-title filterLabel"\r\n      data-dojo-attach-point\x3d"filterLabelSection"\x3e\r\n    ${nls.streamFilter}\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"spatialFilterControl" class\x3d"filterControl"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"spatialFilterToggleDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"spatialFilterSection" class\x3d"filterControl" style\x3d"display:none"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attrFilterControl" class\x3d"filterControl"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attrFilterToggleDiv"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"attrFilterSection" class\x3d"filterControl" style\x3d"display:none"\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Stream/FilterItem.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"controlSection"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"filterSection" style\x3d"display:none"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"attrFilterParams"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"applyAttrFilterBtn"\x3e\r\n      ${nls.applyAttrFilter}\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Stream/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"errorTipPanel" class\x3d"jimu-widget" style\x3d"display:none"\x3e\r\n    ${nls.noStreamLayer}\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"selectionPanel"\x3e\r\n    \x3cdiv\x3e\r\n      \x3clabel class\x3d"jimu-widget-title"\x3e${nls.selectStreamLayer}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"layerSelect"\x3e\r\n      \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"streamSelect"\r\n              style\x3d"width:100%; height:32px"\x3e\x3c/select\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"settingPanel"\x3e\r\n\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter"\r\n       data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Stream/css/style.css":".jimu-widget-stream{}.jimu-widget-stream .layerSelect{margin: 12px 0;}.jimu-widget-stream .controllerLabel{font-size: 1.2em; color: #838383; font-weight: normal; cursor: pointer;}.jimu-widget-stream .filterOption{margin-left: 20px; margin-top: 10px; margin-bottom: 5px;}.jimu-widget-stream .jimu-widget-stream-filterItem{margin-left: 20px; margin-top: 10px; margin-bottom: 5px;}.jimu-widget-stream .controlButton{width: 100%; height: 32px; margin-top: 12px; background-color: #FFFFFF; border: solid 1px #D7D7D7; cursor: pointer;}.jimu-widget-stream .controlButton:hover{background-color: #EAEAEA;}.jimu-widget-stream .drawControl{margin-top: 12px; width: 100%;}.jimu-widget-stream .filterLabel{margin-top: 12px;}.jimu-widget-stream .filterControl{margin: 12px 0; width: 100%;}.jimu-widget-stream .btnLabel{line-height: 32px; cursor: pointer;}.jimu-widget-stream .drawControl .btnLabel{line-height: 40px;}.jimu-widget-stream .controlButton .runningIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/play_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton:hover .runningIcon{background: url(images/play_over.png);}.jimu-widget-stream .controlButton.stop .runningIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/stop_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton.stop:hover .runningIcon{background: url(images/stop_over.png);}.jimu-widget-stream .controlButton .clearIcon{width: 14px; height: 14px; margin-top: 7px; background: transparent url(images/clear_normal.png) center top no-repeat;}.jimu-widget-stream .controlButton:hover .clearIcon{background: url(images/clear_over.png);}.jimu-widget-stream .jimu-checkbox .label{font-size: 12px;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/Stream/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-style dijit/_WidgetsInTemplateMixin jimu/BaseWidget jimu/dijit/ViewStack ./StreamControl dijit/form/Select jimu/dijit/LoadingShelter".split(" "),function(m,b,n,e,k,a,q,g,u){return m([q,a],{baseClass:"jimu-widget-stream",streamControls:[],postCreate:function(){this.inherited(arguments);var r,v,t=[],p=[];this.config.streamLayers&&0<this.config.streamLayers.length&&n.forEach(this.config.streamLayers,function(d,l){if(v=this.map.getLayer(d.layerId))r=
new u({nls:this.nls,id:this.id+"_"+d.layerId,map:this.map,config:d,streamLayer:this.map.getLayer(d.layerId)}),p.push(r),t.push({label:d.layerName,value:l})},this);0===p.length?(k.set(this.errorTipPanel,"display",""),k.set(this.selectionPanel,"display","none")):(this.viewStack=new g({nodeType:1,views:p}),this.viewStack.placeAt(this.settingPanel),this.streamSelect.addOption(t),this.streamSelect.set("value",0),this.own(e(this.streamSelect,"change",b.hitch(this,function(d){this.viewStack.switchView(d)}))))}})});