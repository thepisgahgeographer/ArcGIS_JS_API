// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/ThreatAnalysis/setting/newThreatType.html":'\x3cdiv\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTDeafultIconWrapper"\x3e\r\n      \x3cspan class\x3d"esriCTDefaultLabel"\x3e${nls.chooseDefaultThreatTypeIconLabel}\x3c/span\x3e\r\n      \x3cdiv class\x3d"esriCTDefaultIcon" data-dojo-attach-point\x3d"defaultThreatTypeIcon"\r\n        title\x3d"${nls.defaultThreatTypeIconTooltip}"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTLabel"\x3e${nls.threatTypeCatagoryLabel}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTDijitControl"\x3e\r\n      \x3cdiv class\x3d"esriCTDijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTDijitWrapper" data-dojo-attach-point\x3d"threatCatagorySelect"\r\n          data-dojo-type\x3d"dijit/form/Select"\x3e\r\n          \x3coption value\x3d"chemicalThreatCatogory" selected\x3d"selected"\x3e${nls.chemicalThreatCatagoryLabel}\r\n          \x3c/option\x3e\r\n          \x3coption value\x3d"lpgThreatCatogary"\x3e${nls.lpgThreatCatagoryLabel}\x3c/option\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTLabel"\x3e${nls.threatTypeLabel}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTDijitControl"\x3e\r\n      \x3cdiv class\x3d"esriCTDijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTDijitWrapper" data-dojo-attach-point\x3d"threatTypeTextBox"\r\n          data-dojo-type\x3d"dijit/form/ValidationTextBox" trim\x3d"true" required\x3d"true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTLabel" data-dojo-attach-point\x3d"mandatoryDistanceLabelNode"\x3e${nls.mandatoryDistance}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTDijitControl"\x3e\r\n      \x3cdiv class\x3d"esriCTDijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTDijitWrapper" data-dojo-attach-point\x3d"mandatoryEvacuationDistance"\r\n          data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min: 0.01}" required\x3d"true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTLabel" data-dojo-attach-point\x3d"safeDistanceLabelNode"\x3e${nls.safeDistance}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTDijitControl"\x3e\r\n      \x3cdiv class\x3d"esriCTDijitWrapper"\x3e\r\n        \x3cdiv class\x3d"esriCTDijitWrapper" data-dojo-attach-point\x3d"safeEvacuationDistance"\r\n          data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min: 0.01}" required\x3d"true"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"esriCTWrapper"\x3e\r\n    \x3cdiv class\x3d"esriCTLabel"\x3e${nls.units}\x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTDijitControl"\x3e\r\n      \x3cdiv class\x3d"esriCTDijitWrapper" data-dojo-attach-point\x3d"unitType" data-dojo-props\x3d"trim:true, propercase:true"\r\n        data-dojo-type\x3d"dijit/form/TextBox" disabled\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"newThreatTypeDiv"\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./newThreatType.html dojo/_base/lang jimu/dijit/Popup dojo/Evented dojo/number ./defaultThreatTypes dojo/on dojo/_base/array dijit/form/ValidationTextBox dijit/form/TextBox dijit/form/Select".split(" "),function(g,h,k,l,m,c,n,p,d,q,f,r){return g([h,k,l,p],{templateString:m,baseClass:"jimu-widget-threatAnalysis-newThreatTypePopup",prevThreatType:null,selectedThreatType:null,constructor:function(){},
postCreate:function(){this.table&&this.currentRowData.threatType&&(this.prevThreatType=this.currentRowData.threatType,this.threatTypeTextBox.set("value",this.currentRowData.threatType),this.mandatoryEvacuationDistance.set("value",this.isChemicalThreat?this.currentRowData.mandatoryDistance:this.currentRowData.fireBallDiameter),this.safeEvacuationDistance.set("value",this.currentRowData.safeDistance));this.isAddThreat||(this.isChemicalThreat?this.threatCatagorySelect.setValue("chemicalThreatCatogory"):
this.threatCatagorySelect.setValue("lpgThreatCatogary"));this.isAddThreat?this.threatCatagorySelect.set("disabled",!1):this.threatCatagorySelect.set("disabled",!0);this.unitType.set("value","feet"===this.selectedUnitType.toLowerCase()?this.nls.feet:this.nls.meters);this._threatTypeTextBoxValidator();this._createPopUp();this._handleClickEvents()},_handleClickEvents:function(){this.own(f(this.defaultThreatTypeIcon,"click",c.hitch(this,function(){this.defaultThreatTypeObj=new q({nls:this.nls,unitType:this.selectedUnitType,
threatCatogary:this.threatCatagorySelect.get("value"),isAddThreat:this.isAddThreat});this.own(f(this.defaultThreatTypeObj,"selectedDefaultThreat",c.hitch(this,function(a){var b="chemicalThreatInfo"===a.threatInfoType?a.Bldg_Dist:a.Fireball_Dia;var e="chemicalThreatInfo"===a.threatInfoType?a.Outdoor_Dist:a.Safe_Dist;this.threatTypeTextBox.set("value",a.displayedValue);b=a.Unit.toLowerCase()===this.selectedUnitType.toLowerCase()?b:.3048*b;this.mandatoryEvacuationDistance.set("value",d.format(b,{places:2}));
b=a.Unit.toLowerCase()===this.selectedUnitType.toLowerCase()?e:.3048*e;this.safeEvacuationDistance.set("value",d.format(b,{places:2}));this.selectedThreatType=a.Threat;this.threatCatagorySelect.setValue("chemicalThreatInfo"===a.threatInfoType?"chemicalThreatCatogory":"lpgThreatCatogary")})))})));this.own(f(this.threatCatagorySelect,"change",c.hitch(this,function(a){"chemicalThreatCatogory"===a?(this.mandatoryDistanceLabelNode.innerHTML=this.nls.mandatoryDistance,this.safeDistanceLabelNode.innerHTML=
this.nls.safeDistance):(this.mandatoryDistanceLabelNode.innerHTML=this.nls.fireBallDiameterLable,this.safeDistanceLabelNode.innerHTML=this.nls.lpgSafeDistanceLable)})))},_createPopUp:function(){this.newThreatTypePopup=new n({titleLabel:this.isAddThreat?this.nls.newThreatTypePopupLabel:this.nls.editThreatLabel,width:600,maxHeight:300,autoHeight:!0,"class":this.baseClass,content:this,buttons:[{label:this.nls.ok,onClick:c.hitch(this,function(){if(this.threatTypeTextBox.isValid())if(this.mandatoryEvacuationDistance.isValid())if(this.safeEvacuationDistance.isValid()){if(this.currentRow&&
this.table){var a={};a.threatType=this.threatTypeTextBox.value;var b=this.isChemicalThreat?"mandatoryDistance":"fireBallDiameter";a[b]=d.format(this.mandatoryEvacuationDistance.get("value"),{places:2});a.safeDistance=d.format(this.safeEvacuationDistance.get("value"),{places:2});a.unit=this.unitType.value;this.currentRow.threatType=this.threatTypeTextBox.value;this.currentRow[b]=d.format(this.mandatoryEvacuationDistance.get("value"),{places:2});this.currentRow.safeDistance=d.format(this.safeEvacuationDistance.get("value"),
{places:2});this.currentRow.unit=this.selectedUnitType;this.table.editRow(this.currentRow,a)}else"chemicalThreatCatogory"===this.threatCatagorySelect.get("value")?this.emit("addNewThreat",{Threat:this.threatTypeTextBox.value,Bldg_Dist:this.mandatoryEvacuationDistance.get("value"),Outdoor_Dist:this.safeEvacuationDistance.get("value"),Unit:this.selectedUnitType,threatInfoType:"chemicalThreatInfo"}):this.emit("addNewThreat",{Threat:this.threatTypeTextBox.value,Fireball_Dia:this.mandatoryEvacuationDistance.get("value"),
Safe_Dist:this.safeEvacuationDistance.get("value"),Unit:this.selectedUnitType,threatInfoType:"lpgThreatInfo"});this.newThreatTypePopup.close()}else this.safeEvacuationDistance.focus();else this.mandatoryEvacuationDistance.focus();else this.threatTypeTextBox.focus()})},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],onClick:c.hitch(this,function(){this.newThreatTypePopup.close()})}]})},_isDuplicateThreatTypeName:function(a){var b=!1,e="chemicalThreatCatogory"===this.threatCatagorySelect.get("value")?
this.existingChemicalThreatNames:this.existingLPGThreatNames;r.some(e,c.hitch(this,function(t){if(a.toLowerCase()===t.toLowerCase())return b=!0}));return b},_threatTypeTextBoxValidator:function(){this.threatTypeTextBox.validator=c.hitch(this,function(a){return a?a!==this.prevThreatType&&this._isDuplicateThreatTypeName(a)?(this.threatTypeTextBox.set("invalidMessage",this.nls.uniqueThreatTypeMsg),!1):!0:(this.threatTypeTextBox.set("invalidMessage",this.nls.requiredThreatTypeMsg),!1)})}})});